const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dist-DEkc0cdZ.js","assets/es-CpEmyloG.js","assets/react-BP9S31LX.js","assets/client-Lo9oiyFk.js","assets/client-CJtVAOC4.js"])))=>i.map(i=>d[i]);
import{a as e,c as t,i as n,n as r,o as i,r as a,s as o,t as s}from"./react-BP9S31LX.js";import{$ as c,$t as l,A as u,At as d,B as f,Bt as p,C as m,Ct as h,D as g,Dt as _,E as v,Et as y,F as b,Ft as x,G as S,Gt as C,H as w,Ht as T,I as E,It as D,J as O,Jt as k,K as A,Kt as j,L as ee,Lt as te,M,Mt as ne,N as re,Nt as ie,O as ae,Ot as oe,P as se,Pt as ce,Q as le,Qt as N,R as ue,Rt as de,S as fe,St as pe,T as me,Tt as he,U as ge,Ut as _e,V as ve,Vt as P,W as ye,Wt as be,X as xe,Xt as Se,Y as Ce,Yt as we,Z as Te,Zt as Ee,_ as De,_t as Oe,a as ke,an as Ae,at as je,b as Me,bt as Ne,c as Pe,cn as Fe,ct as Ie,d as Le,dn as Re,dt as ze,en as Be,et as Ve,f as He,fn as Ue,ft as We,g as Ge,gn as Ke,gt as qe,h as Je,hn as Ye,ht as Xe,i as Ze,in as Qe,it as $e,j as et,jt as tt,k as nt,kt as rt,l as it,ln as at,lt as ot,m as st,mn as ct,mt as lt,n as ut,nn as dt,nt as ft,o as pt,on as mt,ot as ht,p as gt,pn as _t,pt as vt,q as yt,qt as bt,r as xt,rn as St,rt as Ct,s as wt,sn as Tt,st as Et,t as Dt,tn as F,tt as Ot,u as kt,un as At,ut as jt,v as Mt,vt as Nt,w as Pt,wt as Ft,x as It,xt as Lt,y as Rt,yt as zt,z as Bt,zt as Vt}from"./globals-Cod-OZK3.js";import{n as Ht,t as Ut}from"./client-CJtVAOC4.js";import{X as Wt,bn as Gt,en as Kt,fn as qt,tn as Jt,zt as Yt}from"./es-CpEmyloG.js";var Xt=t(Ut()),I=t(s(),1),Zt=function(e,t){return Zt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Zt(e,t)};function Qt(e,t){if(typeof t!=`function`&&t!==null)throw TypeError(`Class extends value `+String(t)+` is not a constructor or null`);Zt(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var L=function(){return L=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},L.apply(this,arguments)};function $t(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function en(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})}function tn(e){var t=typeof Symbol==`function`&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length==`number`)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?`Object is not iterable.`:`Symbol.iterator is not defined.`)}function R(e,t){var n=typeof Symbol==`function`&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)a.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return a}function nn(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)r[i]=a[o];return r}function z(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||=Array.prototype.slice.call(t,0,r),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}function rn(e,t,n,r){if(n===`a`&&!r)throw TypeError(`Private accessor was defined without a getter`);if(typeof t==`function`?e!==t||!r:!t.has(e))throw TypeError(`Cannot read private member from an object whose class did not declare it`);return n===`m`?r:n===`a`?r.call(e):r?r.value:t.get(e)}function an(e,t){let n=(0,I.useRef)(!0),r=(0,I.useRef)(null);C(()=>(n.current=!0,()=>{n.current=!1}),[]),C(()=>{n.current?n.current=!1:(!r.current||t.some((e,t)=>!Object.is(e,r[t])))&&e(),r.current=t},t)}function on(e,t){let n=[];for(;e&&e!==document.documentElement;)y(e,t)&&n.push(e),e=e.parentElement;return n}var sn=0,cn=new Map;function ln(e){let[t,n]=(0,I.useState)();return C(()=>{if(!e)return;let t=cn.get(e);if(t)n(t.element.id);else{let r=`react-aria-description-${sn++}`;n(r);let i=document.createElement(`div`);i.id=r,i.style.display=`none`,i.textContent=e,document.body.appendChild(i),t={refCount:0,element:i},cn.set(e,t)}return t.refCount++,()=>{t&&--t.refCount===0&&(t.element.remove(),cn.delete(e))}},[e]),{"aria-describedby":e?t:void 0}}function un(e,t,n,r){let i=be(n),a=n==null;(0,I.useEffect)(()=>{if(a||!e.current)return;let n=e.current;return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[e,t,r,a,i])}function dn(e,t){let n=fn(e,t,`left`),r=fn(e,t,`top`),i=t.offsetWidth,a=t.offsetHeight,o=e.scrollLeft,s=e.scrollTop,{borderTopWidth:c,borderLeftWidth:l,scrollPaddingTop:u,scrollPaddingRight:d,scrollPaddingBottom:f,scrollPaddingLeft:p}=getComputedStyle(e),m=o+parseInt(l,10),h=s+parseInt(c,10),g=m+e.clientWidth,_=h+e.clientHeight,v=parseInt(u,10)||0,y=parseInt(f,10)||0,b=parseInt(d,10)||0,x=parseInt(p,10)||0;n<=o+x?o=n-parseInt(l,10)-x:n+i>g-b&&(o+=n+i-g+b),r<=h+v?s=r-parseInt(c,10)-v:r+a>_-y&&(s+=r+a-_+y),e.scrollLeft=o,e.scrollTop=s}function fn(e,t,n){let r=n===`left`?`offsetLeft`:`offsetTop`,i=0;for(;t.offsetParent&&(i+=t[r],t.offsetParent!==e);){if(t.offsetParent.contains(e)){i-=e[r];break}t=t.offsetParent}return i}function pn(e,t){if(e&&document.contains(e)){let o=document.scrollingElement||document.documentElement;if(window.getComputedStyle(o).overflow!==`hidden`){var n;let{left:o,top:s}=e.getBoundingClientRect();e==null||(n=e.scrollIntoView)==null||n.call(e,{block:`nearest`});let{left:c,top:l}=e.getBoundingClientRect();if(Math.abs(o-c)>1||Math.abs(s-l)>1){var r,i,a;t==null||(i=t.containingElement)==null||(r=i.scrollIntoView)==null||r.call(i,{block:`center`,inline:`center`}),(a=e.scrollIntoView)==null||a.call(e,{block:`nearest`})}}else{let t=on(e);for(let n of t)dn(n,e)}}}var mn=`react-aria-clear-focus`,hn=`react-aria-focus`;function gn(e){return ie()?e.metaKey:e.ctrlKey}var _n=new Map;function vn(e){let{locale:t}=bt(),n=t+(e?Object.entries(e).sort((e,t)=>e[0]<t[0]?-1:1).join():``);if(_n.has(n))return _n.get(n);let r=new Intl.Collator(t,e);return _n.set(n,r),r}var yn=500;function bn(e){let{isDisabled:t,onLongPressStart:n,onLongPressEnd:r,onLongPress:i,threshold:a=yn,accessibilityDescription:o}=e,s=(0,I.useRef)(void 0),{addGlobalListener:c,removeGlobalListener:l}=oe(),{pressProps:u}=Lt({isDisabled:t,onPressStart(e){if(e.continuePropagation(),(e.pointerType===`mouse`||e.pointerType===`touch`)&&(n&&n({...e,type:`longpressstart`}),s.current=setTimeout(()=>{e.target.dispatchEvent(new PointerEvent(`pointercancel`,{bubbles:!0})),Vt(e.target).activeElement!==e.target&&x(e.target),i&&i({...e,type:`longpress`}),s.current=void 0},a),e.pointerType===`touch`)){let t=e=>{e.preventDefault()};c(e.target,`contextmenu`,t,{once:!0}),c(window,`pointerup`,()=>{setTimeout(()=>{l(e.target,`contextmenu`,t)},30)},{once:!0})}},onPressEnd(e){s.current&&clearTimeout(s.current),r&&(e.pointerType===`mouse`||e.pointerType===`touch`)&&r({...e,type:`longpressend`})}}),d=ln(i&&!t?o:void 0);return{longPressProps:te(u,d)}}function xn(e,t){let n=t?.isDisabled,[r,i]=(0,I.useState)(!1);return C(()=>{if(e?.current&&!n){let t=()=>{if(e.current){let t=vt(e.current,{tabbable:!0});i(!!t.nextNode())}};t();let n=new MutationObserver(t);return n.observe(e.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:[`tabIndex`,`disabled`]}),()=>{n.disconnect()}}}),n?!1:r}function Sn(e){let t=Tn(Vt(e));t!==e&&(t&&Cn(t,e),e&&wn(e,t))}function Cn(e,t){e.dispatchEvent(new FocusEvent(`blur`,{relatedTarget:t})),e.dispatchEvent(new FocusEvent(`focusout`,{bubbles:!0,relatedTarget:t}))}function wn(e,t){e.dispatchEvent(new FocusEvent(`focus`,{relatedTarget:t})),e.dispatchEvent(new FocusEvent(`focusin`,{bubbles:!0,relatedTarget:t}))}function Tn(e){let t=de(e),n=t?.getAttribute(`aria-activedescendant`);return n&&e.getElementById(n)||t}function En(e,t,n){let{type:r}=e,{isOpen:i}=t;(0,I.useEffect)(()=>{n&&n.current&&h.set(n.current,t.close)});let a;r===`menu`?a=!0:r===`listbox`&&(a=`listbox`);let o=_e();return{triggerProps:{"aria-haspopup":a,"aria-expanded":i,"aria-controls":i?o:void 0,onPress:t.toggle},overlayProps:{id:o}}}function Dn(e){let t=k(),n=t?.labelPlacement;return(0,I.useMemo)(()=>{let t=e.labelPlacement??n??`inside`;return t===`inside`&&!e.label?`outside`:t},[e.labelPlacement,n,e.label])}function On(e){let t=k(),n=t?.labelPlacement;return(0,I.useMemo)(()=>{let t=e.labelPlacement??n??`inside`;return t===`inside`&&!e.label?`outside`:t},[e.labelPlacement,n,e.label])}var kn=Ct({slots:{base:`inline-flex`,tabList:[`flex`,`p-1`,`h-fit`,`gap-2`,`items-center`,`flex-nowrap`,`overflow-x-scroll`,`scrollbar-hide`,`bg-default-100`],tab:[`z-0`,`w-full`,`px-3`,`py-1`,`flex`,`group`,`relative`,`justify-center`,`items-center`,`outline-solid outline-transparent`,`cursor-pointer`,`transition-opacity`,`tap-highlight-transparent`,`data-[disabled=true]:cursor-not-allowed`,`data-[disabled=true]:opacity-30`,`data-[hover-unselected=true]:opacity-disabled`,...Ot],tabContent:[`relative`,`z-10`,`text-inherit`,`whitespace-nowrap`,`transition-colors`,`text-default-500`,`group-data-[selected=true]:text-foreground`],cursor:[`absolute`,`z-0`,`bg-white`],panel:[`py-3`,`px-1`,`outline-solid outline-transparent`,`data-[inert=true]:hidden`,...Ot],tabWrapper:[]},variants:{variant:{solid:{cursor:`inset-0`},light:{tabList:`bg-transparent dark:bg-transparent`,cursor:`inset-0`},underlined:{tabList:`bg-transparent dark:bg-transparent`,cursor:`h-[2px] w-[80%] bottom-0 shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]`},bordered:{tabList:`bg-transparent dark:bg-transparent border-medium border-default-200 shadow-xs`,cursor:`inset-0`}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{tabList:`rounded-medium`,tab:`h-7 text-tiny rounded-small`,cursor:`rounded-small`},md:{tabList:`rounded-medium`,tab:`h-8 text-small rounded-small`,cursor:`rounded-small`},lg:{tabList:`rounded-large`,tab:`h-9 text-medium rounded-medium`,cursor:`rounded-medium`}},radius:{none:{tabList:`rounded-none`,tab:`rounded-none`,cursor:`rounded-none`},sm:{tabList:`rounded-medium`,tab:`rounded-small`,cursor:`rounded-small`},md:{tabList:`rounded-medium`,tab:`rounded-small`,cursor:`rounded-small`},lg:{tabList:`rounded-large`,tab:`rounded-medium`,cursor:`rounded-medium`},full:{tabList:`rounded-full`,tab:`rounded-full`,cursor:`rounded-full`}},fullWidth:{true:{base:`w-full`,tabList:`w-full`}},isDisabled:{true:{tabList:`opacity-disabled pointer-events-none`}},disableAnimation:{true:{tab:`transition-none`,tabContent:`transition-none`}},placement:{top:{},start:{tabList:`flex-col`,panel:`py-0 px-3`,tabWrapper:`flex`},end:{tabList:`flex-col`,panel:`py-0 px-3`,tabWrapper:`flex flex-row-reverse`},bottom:{tabWrapper:`flex flex-col-reverse`}}},defaultVariants:{color:`default`,variant:`solid`,size:`md`,fullWidth:!1,isDisabled:!1},compoundVariants:[{variant:[`solid`,`bordered`,`light`],color:`default`,class:{cursor:[`bg-background`,`dark:bg-default`,`shadow-small`],tabContent:`group-data-[selected=true]:text-default-foreground`}},{variant:[`solid`,`bordered`,`light`],color:`primary`,class:{cursor:$e.solid.primary,tabContent:`group-data-[selected=true]:text-primary-foreground`}},{variant:[`solid`,`bordered`,`light`],color:`secondary`,class:{cursor:$e.solid.secondary,tabContent:`group-data-[selected=true]:text-secondary-foreground`}},{variant:[`solid`,`bordered`,`light`],color:`success`,class:{cursor:$e.solid.success,tabContent:`group-data-[selected=true]:text-success-foreground`}},{variant:[`solid`,`bordered`,`light`],color:`warning`,class:{cursor:$e.solid.warning,tabContent:`group-data-[selected=true]:text-warning-foreground`}},{variant:[`solid`,`bordered`,`light`],color:`danger`,class:{cursor:$e.solid.danger,tabContent:`group-data-[selected=true]:text-danger-foreground`}},{variant:`underlined`,color:`default`,class:{cursor:`bg-foreground`,tabContent:`group-data-[selected=true]:text-foreground`}},{variant:`underlined`,color:`primary`,class:{cursor:`bg-primary`,tabContent:`group-data-[selected=true]:text-primary`}},{variant:`underlined`,color:`secondary`,class:{cursor:`bg-secondary`,tabContent:`group-data-[selected=true]:text-secondary`}},{variant:`underlined`,color:`success`,class:{cursor:`bg-success`,tabContent:`group-data-[selected=true]:text-success`}},{variant:`underlined`,color:`warning`,class:{cursor:`bg-warning`,tabContent:`group-data-[selected=true]:text-warning`}},{variant:`underlined`,color:`danger`,class:{cursor:`bg-danger`,tabContent:`group-data-[selected=true]:text-danger`}},{disableAnimation:!0,variant:`underlined`,class:{tab:[`after:content-['']`,`after:absolute`,`after:bottom-0`,`after:h-[2px]`,`after:w-[80%]`,`after:opacity-0`,`after:shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]`,`data-[selected=true]:after:opacity-100`]}},{disableAnimation:!0,color:`default`,variant:[`solid`,`bordered`,`light`],class:{tab:`data-[selected=true]:bg-default data-[selected=true]:text-default-foreground`}},{disableAnimation:!0,color:`primary`,variant:[`solid`,`bordered`,`light`],class:{tab:`data-[selected=true]:bg-primary data-[selected=true]:text-primary-foreground`}},{disableAnimation:!0,color:`secondary`,variant:[`solid`,`bordered`,`light`],class:{tab:`data-[selected=true]:bg-secondary data-[selected=true]:text-secondary-foreground`}},{disableAnimation:!0,color:`success`,variant:[`solid`,`bordered`,`light`],class:{tab:`data-[selected=true]:bg-success data-[selected=true]:text-success-foreground`}},{disableAnimation:!0,color:`warning`,variant:[`solid`,`bordered`,`light`],class:{tab:`data-[selected=true]:bg-warning data-[selected=true]:text-warning-foreground`}},{disableAnimation:!0,color:`danger`,variant:[`solid`,`bordered`,`light`],class:{tab:`data-[selected=true]:bg-danger data-[selected=true]:text-danger-foreground`}},{disableAnimation:!0,color:`default`,variant:`underlined`,class:{tab:`data-[selected=true]:after:bg-foreground`}},{disableAnimation:!0,color:`primary`,variant:`underlined`,class:{tab:`data-[selected=true]:after:bg-primary`}},{disableAnimation:!0,color:`secondary`,variant:`underlined`,class:{tab:`data-[selected=true]:after:bg-secondary`}},{disableAnimation:!0,color:`success`,variant:`underlined`,class:{tab:`data-[selected=true]:after:bg-success`}},{disableAnimation:!0,color:`warning`,variant:`underlined`,class:{tab:`data-[selected=true]:after:bg-warning`}},{disableAnimation:!0,color:`danger`,variant:`underlined`,class:{tab:`data-[selected=true]:after:bg-danger`}}],compoundSlots:[{variant:`underlined`,slots:[`tab`,`tabList`,`cursor`],class:[`rounded-none`]}]}),An=Ct({slots:{base:[`group inline-flex flex-col relative`],label:[`block`,`absolute`,`z-10`,`origin-top-left`,`flex-shrink-0`,`rtl:origin-top-right`,`subpixel-antialiased`,`text-small`,`text-foreground-500`,`pointer-events-none`,`group-data-[has-label-outside=true]:pointer-events-auto`],mainWrapper:`w-full flex flex-col`,trigger:`relative px-3 gap-3 w-full inline-flex flex-row items-center shadow-xs outline-solid outline-transparent tap-highlight-transparent`,innerWrapper:`inline-flex h-fit w-[calc(100%_-theme(spacing.6))] min-h-4 items-center gap-1.5 box-border`,selectorIcon:`absolute end-3 w-4 h-4`,spinner:`absolute end-3`,value:[`text-foreground-500`,`font-normal`,`w-full`,`text-start`],listboxWrapper:`scroll-py-6 w-full`,listbox:``,popoverContent:`w-full p-1 overflow-hidden`,clearButton:[`w-4`,`h-4`,`z-10`,`mb-4`,`relative`,`start-auto`,`appearance-none`,`outline-none`,`select-none`,`opacity-70`,`hover:!opacity-100`,`cursor-pointer`,`active:!opacity-70`,`rounded-full`,...Ot],helperWrapper:`p-1 flex relative flex-col gap-1.5 group-data-[has-helper=true]:flex`,description:`text-tiny text-foreground-400`,errorMessage:`text-tiny text-danger`,endWrapper:`flex end-18`,endContent:`mb-4`},variants:{variant:{flat:{trigger:[`bg-default-100`,`data-[hover=true]:bg-default-200`,`group-data-[focus=true]:bg-default-200`],clearButton:`mb-4`},faded:{trigger:[`bg-default-100`,`border-medium`,`border-default-200`,`data-[hover=true]:border-default-400 data-[focus=true]:border-default-400 data-[open=true]:border-default-400`],value:`group-data-[has-value=true]:text-default-foreground`,clearButton:`mb-4`},bordered:{trigger:[`border-medium`,`border-default-200`,`data-[hover=true]:border-default-400`,`data-[open=true]:border-default-foreground`,`data-[focus=true]:border-default-foreground`],value:`group-data-[has-value=true]:text-default-foreground`,clearButton:`mb-4`},underlined:{trigger:[`!px-1`,`!pb-0`,`!gap-0`,`relative`,`box-border`,`border-b-medium`,`shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]`,`border-default-200`,`!rounded-none`,`hover:border-default-300`,`after:content-['']`,`after:w-0`,`after:origin-center`,`after:bg-default-foreground`,`after:absolute`,`after:left-1/2`,`after:-translate-x-1/2`,`after:-bottom-[2px]`,`after:h-[2px]`,`data-[open=true]:after:w-full`,`data-[focus=true]:after:w-full`],value:`group-data-[has-value=true]:text-default-foreground`,clearButton:`mb-4 me-2`}},color:{default:{},primary:{selectorIcon:`text-primary`},secondary:{selectorIcon:`text-secondary`},success:{selectorIcon:`text-success`},warning:{selectorIcon:`text-warning`},danger:{selectorIcon:`text-danger`}},size:{sm:{label:`text-tiny`,trigger:`h-8 min-h-8 px-2 rounded-small`,value:`text-small`,clearButton:`text-medium`},md:{trigger:`h-10 min-h-10 rounded-medium`,value:`text-small`,clearButton:`text-large`},lg:{trigger:`h-12 min-h-12 rounded-large`,value:`text-medium`,clearButton:`mb-5 text-large`}},radius:{none:{trigger:`rounded-none`},sm:{trigger:`rounded-small`},md:{trigger:`rounded-medium`},lg:{trigger:`rounded-large`},full:{trigger:`rounded-full`}},labelPlacement:{outside:{base:`flex flex-col`,clearButton:`mb-0`},"outside-left":{base:`flex-row items-center flex-nowrap data-[has-helper=true]:items-start`,label:`relative pe-2 text-foreground`,clearButton:`mb-0`},inside:{label:`text-tiny cursor-pointer`,trigger:`flex-col items-start justify-center gap-0`}},fullWidth:{true:{base:`w-full`},false:{base:`min-w-40`}},isClearable:{true:{clearButton:`peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block`,endContent:`ms-3`}},isDisabled:{true:{base:`opacity-disabled pointer-events-none`,trigger:`pointer-events-none`}},isInvalid:{true:{label:`!text-danger`,value:`!text-danger`,selectorIcon:`text-danger`}},isRequired:{true:{label:`after:content-['*'] after:text-danger after:ms-0.5`}},isMultiline:{true:{label:`relative`,trigger:`!h-auto`},false:{value:`truncate`}},disableAnimation:{true:{trigger:`after:transition-none`,base:`transition-none`,label:`transition-none`,selectorIcon:`transition-none`},false:{base:`transition-background motion-reduce:transition-none !duration-150`,label:[`will-change-auto`,`origin-top-left`,`rtl:origin-top-right`,`!duration-200`,`!ease-out`,`transition-[transform,color,left,opacity,translate,scale]`,`motion-reduce:transition-none`],selectorIcon:`transition-transform duration-150 ease motion-reduce:transition-none`,clearButton:[`transition-opacity`,`motion-reduce:transition-none`]}},disableSelectorIconRotation:{true:{},false:{selectorIcon:`data-[open=true]:rotate-180`}}},defaultVariants:{variant:`flat`,color:`default`,size:`md`,fullWidth:!0,isDisabled:!1,isMultiline:!1,disableSelectorIconRotation:!1},compoundVariants:[{variant:`flat`,color:`default`,class:{value:`group-data-[has-value=true]:text-default-foreground`,trigger:[`bg-default-100`,`data-[hover=true]:bg-default-200`]}},{variant:`flat`,color:`primary`,class:{trigger:[`bg-primary-100`,`text-primary`,`data-[hover=true]:bg-primary-50`,`group-data-[focus=true]:bg-primary-50`],value:`text-primary`,label:`text-primary`}},{variant:`flat`,color:`secondary`,class:{trigger:[`bg-secondary-100`,`text-secondary`,`data-[hover=true]:bg-secondary-50`,`group-data-[focus=true]:bg-secondary-50`],value:`text-secondary`,label:`text-secondary`}},{variant:`flat`,color:`success`,class:{trigger:[`bg-success-100`,`text-success-600`,`dark:text-success`,`data-[hover=true]:bg-success-50`,`group-data-[focus=true]:bg-success-50`],value:`text-success-600 dark:text-success`,label:`text-success-600 dark:text-success`}},{variant:`flat`,color:`warning`,class:{trigger:[`bg-warning-100`,`text-warning-600`,`dark:text-warning`,`data-[hover=true]:bg-warning-50`,`group-data-[focus=true]:bg-warning-50`],value:`text-warning-600 dark:text-warning`,label:`text-warning-600 dark:text-warning`}},{variant:`flat`,color:`danger`,class:{trigger:[`bg-danger-100`,`text-danger`,`dark:text-danger-500`,`data-[hover=true]:bg-danger-50`,`group-data-[focus=true]:bg-danger-50`],value:`text-danger dark:text-danger-500`,label:`text-danger dark:text-danger-500`}},{variant:`faded`,color:`primary`,class:{trigger:`data-[hover=true]:border-primary data-[focus=true]:border-primary data-[open=true]:border-primary`,label:`text-primary`}},{variant:`faded`,color:`secondary`,class:{trigger:`data-[hover=true]:border-secondary data-[focus=true]:border-secondary data-[open=true]:border-secondary`,label:`text-secondary`}},{variant:`faded`,color:`success`,class:{trigger:`data-[hover=true]:border-success data-[focus=true]:border-success data-[open=true]:border-success`,label:`text-success`}},{variant:`faded`,color:`warning`,class:{trigger:`data-[hover=true]:border-warning data-[focus=true]:border-warning data-[open=true]:border-warning`,label:`text-warning`}},{variant:`faded`,color:`danger`,class:{trigger:`data-[hover=true]:border-danger data-[focus=true]:border-danger data-[open=true]:border-danger`,label:`text-danger`}},{variant:`underlined`,color:`default`,class:{value:`group-data-[has-value=true]:text-foreground`}},{variant:`underlined`,color:`primary`,class:{trigger:`after:bg-primary`,label:`text-primary`}},{variant:`underlined`,color:`secondary`,class:{trigger:`after:bg-secondary`,label:`text-secondary`}},{variant:`underlined`,color:`success`,class:{trigger:`after:bg-success`,label:`text-success`}},{variant:`underlined`,color:`warning`,class:{trigger:`after:bg-warning`,label:`text-warning`}},{variant:`underlined`,color:`danger`,class:{trigger:`after:bg-danger`,label:`text-danger`}},{variant:`bordered`,color:`primary`,class:{trigger:[`data-[open=true]:border-primary`,`data-[focus=true]:border-primary`],label:`text-primary`}},{variant:`bordered`,color:`secondary`,class:{trigger:[`data-[open=true]:border-secondary`,`data-[focus=true]:border-secondary`],label:`text-secondary`}},{variant:`bordered`,color:`success`,class:{trigger:[`data-[open=true]:border-success`,`data-[focus=true]:border-success`],label:`text-success`}},{variant:`bordered`,color:`warning`,class:{trigger:[`data-[open=true]:border-warning`,`data-[focus=true]:border-warning`],label:`text-warning`}},{variant:`bordered`,color:`danger`,class:{trigger:[`data-[open=true]:border-danger`,`data-[focus=true]:border-danger`],label:`text-danger`}},{labelPlacement:`inside`,color:`default`,class:{label:`group-data-[filled=true]:text-default-600`}},{labelPlacement:`outside`,color:`default`,class:{label:`group-data-[filled=true]:text-foreground`}},{radius:`full`,size:[`sm`],class:{trigger:`px-3`}},{radius:`full`,size:`md`,class:{trigger:`px-4`}},{radius:`full`,size:`lg`,class:{trigger:`px-5`}},{disableAnimation:!1,variant:[`faded`,`bordered`],class:{trigger:`transition-colors motion-reduce:transition-none`}},{disableAnimation:!1,variant:`underlined`,class:{trigger:`after:transition-width motion-reduce:after:transition-none`}},{variant:[`flat`,`faded`],class:{trigger:[...Ot]}},{isInvalid:!0,variant:`flat`,class:{trigger:[`bg-danger-50`,`data-[hover=true]:bg-danger-100`,`group-data-[focus=true]:bg-danger-50`]}},{isInvalid:!0,variant:`bordered`,class:{trigger:`!border-danger group-data-[focus=true]:border-danger`}},{isInvalid:!0,variant:`underlined`,class:{trigger:`after:bg-danger`}},{labelPlacement:`inside`,size:`sm`,class:{trigger:`h-12 min-h-12 py-1.5 px-3`}},{labelPlacement:`inside`,size:`md`,class:{trigger:`h-14 min-h-14 py-2`}},{labelPlacement:`inside`,size:`lg`,class:{label:`text-medium`,trigger:`h-16 min-h-16 py-2.5 gap-0`}},{labelPlacement:`outside`,isMultiline:!1,class:{base:`group relative justify-end`,label:[`pb-0`,`z-20`,`top-1/2`,`-translate-y-1/2`,`group-data-[filled=true]:start-0`]}},{labelPlacement:[`inside`],class:{label:`group-data-[filled=true]:scale-85`}},{labelPlacement:`inside`,size:[`sm`,`md`],class:{label:`text-small`}},{labelPlacement:`inside`,isMultiline:!1,size:`sm`,class:{label:[`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]`],innerWrapper:`group-data-[has-label=true]:pt-4`}},{labelPlacement:`inside`,isMultiline:!1,size:`md`,class:{label:[`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]`],innerWrapper:`group-data-[has-label=true]:pt-4`}},{labelPlacement:`inside`,isMultiline:!1,size:`lg`,class:{label:[`text-medium`,`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]`],innerWrapper:`group-data-[has-label=true]:pt-5`}},{labelPlacement:`inside`,variant:[`faded`,`bordered`],isMultiline:!1,size:`sm`,class:{label:[`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]`]}},{labelPlacement:`inside`,variant:[`faded`,`bordered`],isMultiline:!1,size:`md`,class:{label:[`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]`]}},{labelPlacement:`inside`,variant:[`faded`,`bordered`],isMultiline:!1,size:`lg`,class:{label:[`text-medium`,`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]`]}},{labelPlacement:`inside`,variant:`underlined`,isMultiline:!1,size:`sm`,class:{label:[`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]`]}},{labelPlacement:`inside`,variant:`underlined`,isMultiline:!1,size:`md`,class:{label:[`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]`]}},{labelPlacement:`inside`,variant:`underlined`,isMultiline:!1,size:`lg`,class:{label:[`text-medium`,`group-data-[filled=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]`]}},{labelPlacement:`outside`,size:`sm`,isMultiline:!1,class:{label:[`start-2`,`text-tiny`,`group-data-[filled=true]:-translate-y-[calc(100%_+var(--heroui-font-size-tiny)/2_+_16px)]`,`group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_26px)]`],base:`data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]`}},{labelPlacement:`outside`,isMultiline:!1,size:`md`,class:{label:[`start-3`,`text-small`,`group-data-[filled=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]`,`group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_30px)]`],base:`data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]`}},{labelPlacement:`outside`,isMultiline:!1,size:`lg`,class:{label:[`start-3`,`text-medium`,`group-data-[filled=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]`,`group-data-[has-helper=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_34px)]`],base:`data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]`}},{labelPlacement:`outside-left`,size:`sm`,class:{label:`group-data-[has-helper=true]:pt-2`}},{labelPlacement:`outside-left`,size:`md`,class:{label:`group-data-[has-helper=true]:pt-3`}},{labelPlacement:`outside-left`,size:`lg`,class:{label:`group-data-[has-helper=true]:pt-4`}},{labelPlacement:`outside`,isMultiline:!0,class:{label:`pb-1.5`}},{labelPlacement:[`inside`,`outside`],class:{label:[`pe-2`,`max-w-full`,`text-ellipsis`,`overflow-hidden`]}},{labelPlacement:[`outside`,`outside-left`],isClearable:!0,class:{endContent:[`mt-4`],clearButton:[`group-data-[has-end-content=true]:mt-4`]}},{isClearable:!1,labelPlacement:[`outside`,`outside-left`],class:{endContent:[`mt-4`]}},{isClearable:!0,variant:[`underlined`],class:{clearButton:[`relative group-data-[has-end-content=true]:left-2`],endContent:[`me-2`]}},{isClearable:!1,variant:[`underlined`],class:{endContent:[`me-2`]}},{isClearable:!0,size:`sm`,class:{endContent:`ms-2`}}]}),jn=Ct({slots:{base:`group flex flex-col data-[hidden=true]:hidden`,label:[`absolute`,`z-10`,`pointer-events-none`,`origin-top-left`,`shrink-0`,`rtl:origin-top-right`,`subpixel-antialiased`,`block`,`text-small`,`text-foreground-500`],mainWrapper:`h-full`,inputWrapper:`relative w-full inline-flex tap-highlight-transparent flex-row items-center shadow-xs px-3 gap-3`,innerWrapper:`inline-flex w-full items-center h-full box-border`,input:[`w-full font-normal bg-transparent !outline-solid outline-transparent placeholder:text-foreground-500 focus-visible:outline-solid outline-transparent`,`data-[has-start-content=true]:ps-1.5`,`data-[has-end-content=true]:pe-1.5`,`data-[type=color]:rounded-none`,`file:cursor-pointer file:bg-transparent file:border-0`,`autofill:bg-transparent bg-clip-text`],clearButton:[`p-2`,`-m-2`,`z-10`,`absolute`,`end-3`,`start-auto`,`pointer-events-none`,`appearance-none`,`outline-solid outline-transparent`,`select-none`,`opacity-0`,`cursor-pointer`,`active:!opacity-70`,`rounded-full`,...Ot],helperWrapper:`hidden group-data-[has-helper=true]:flex p-1 relative flex-col gap-1.5`,description:`text-tiny text-foreground-400`,errorMessage:`text-tiny text-danger`},variants:{variant:{flat:{inputWrapper:[`bg-default-100`,`data-[hover=true]:bg-default-200`,`group-data-[focus=true]:bg-default-100`]},faded:{inputWrapper:[`bg-default-100`,`border-medium`,`border-default-200`,`data-[hover=true]:border-default-400 focus-within:border-default-400`],value:`group-data-[has-value=true]:text-default-foreground`},bordered:{inputWrapper:[`border-medium`,`border-default-200`,`data-[hover=true]:border-default-400`,`group-data-[focus=true]:border-default-foreground`]},underlined:{inputWrapper:[`!px-1`,`!pb-0`,`!gap-0`,`relative`,`box-border`,`border-b-medium`,`shadow-[0_1px_0px_0_rgba(0,0,0,0.05)]`,`border-default-200`,`!rounded-none`,`hover:border-default-300`,`after:content-['']`,`after:w-0`,`after:origin-center`,`after:bg-default-foreground`,`after:absolute`,`after:left-1/2`,`after:-translate-x-1/2`,`after:-bottom-[2px]`,`after:h-[2px]`,`group-data-[focus=true]:after:w-full`],innerWrapper:`pb-1`,label:`group-data-[filled-within=true]:text-foreground`}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},size:{sm:{label:`text-tiny`,inputWrapper:`h-8 min-h-8 px-2 rounded-small`,input:`text-small`,clearButton:`text-medium`},md:{inputWrapper:`h-10 min-h-10 rounded-medium`,input:`text-small`,clearButton:`text-large hover:!opacity-100`},lg:{label:`text-medium`,inputWrapper:`h-12 min-h-12 rounded-large`,input:`text-medium`,clearButton:`text-large hover:!opacity-100`}},radius:{none:{inputWrapper:`rounded-none`},sm:{inputWrapper:`rounded-small`},md:{inputWrapper:`rounded-medium`},lg:{inputWrapper:`rounded-large`},full:{inputWrapper:`rounded-full`}},labelPlacement:{outside:{mainWrapper:`flex flex-col`},"outside-left":{base:`flex-row items-center flex-nowrap data-[has-helper=true]:items-start`,inputWrapper:`flex-1`,mainWrapper:`flex flex-col`,label:`relative text-foreground pe-2 ps-2 pointer-events-auto`},"outside-top":{mainWrapper:`flex flex-col`,label:`relative text-foreground pb-2 pointer-events-auto`},inside:{label:`cursor-text`,inputWrapper:`flex-col items-start justify-center gap-0`,innerWrapper:`group-data-[has-label=true]:items-end`}},fullWidth:{true:{base:`w-full`},false:{}},isClearable:{true:{input:`peer pe-6 input-search-cancel-button-none`,clearButton:[`peer-data-[filled=true]:pointer-events-auto`,`peer-data-[filled=true]:opacity-70 peer-data-[filled=true]:block`,`peer-data-[filled=true]:scale-100`]}},isDisabled:{true:{base:`opacity-disabled pointer-events-none`,inputWrapper:`pointer-events-none`,label:`pointer-events-none`}},isInvalid:{true:{label:`!text-danger`,input:`!placeholder:text-danger !text-danger`}},isRequired:{true:{label:`after:content-['*'] after:text-danger after:ms-0.5`}},isMultiline:{true:{label:`relative`,inputWrapper:`!h-auto`,innerWrapper:`items-start group-data-[has-label=true]:items-start`,input:`resize-none data-[hide-scroll=true]:scrollbar-hide`,clearButton:`absolute top-2 right-2 rtl:right-auto rtl:left-2 z-10`}},disableAnimation:{true:{input:`transition-none`,inputWrapper:`transition-none`,label:`transition-none`},false:{inputWrapper:`transition-background motion-reduce:transition-none !duration-150`,label:[`will-change-auto`,`!duration-200`,`!ease-out`,`motion-reduce:transition-none`,`transition-[transform,color,left,opacity,translate,scale]`],clearButton:[`scale-90`,`ease-out`,`duration-150`,`transition-[opacity,transform]`,`motion-reduce:transition-none`,`motion-reduce:scale-100`]}}},defaultVariants:{variant:`flat`,color:`default`,size:`md`,fullWidth:!0,isDisabled:!1,isMultiline:!1},compoundVariants:[{variant:`flat`,color:`default`,class:{input:`group-data-[has-value=true]:text-default-foreground`}},{variant:`flat`,color:`primary`,class:{inputWrapper:[`bg-primary-100`,`data-[hover=true]:bg-primary-50`,`text-primary`,`group-data-[focus=true]:bg-primary-50`,`placeholder:text-primary`],input:`placeholder:text-primary`,label:`text-primary`}},{variant:`flat`,color:`secondary`,class:{inputWrapper:[`bg-secondary-100`,`text-secondary`,`data-[hover=true]:bg-secondary-50`,`group-data-[focus=true]:bg-secondary-50`,`placeholder:text-secondary`],input:`placeholder:text-secondary`,label:`text-secondary`}},{variant:`flat`,color:`success`,class:{inputWrapper:[`bg-success-100`,`text-success-600`,`dark:text-success`,`placeholder:text-success-600`,`dark:placeholder:text-success`,`data-[hover=true]:bg-success-50`,`group-data-[focus=true]:bg-success-50`],input:`placeholder:text-success-600 dark:placeholder:text-success`,label:`text-success-600 dark:text-success`}},{variant:`flat`,color:`warning`,class:{inputWrapper:[`bg-warning-100`,`text-warning-600`,`dark:text-warning`,`placeholder:text-warning-600`,`dark:placeholder:text-warning`,`data-[hover=true]:bg-warning-50`,`group-data-[focus=true]:bg-warning-50`],input:`placeholder:text-warning-600 dark:placeholder:text-warning`,label:`text-warning-600 dark:text-warning`}},{variant:`flat`,color:`danger`,class:{inputWrapper:[`bg-danger-100`,`text-danger`,`dark:text-danger-500`,`placeholder:text-danger`,`dark:placeholder:text-danger-500`,`data-[hover=true]:bg-danger-50`,`group-data-[focus=true]:bg-danger-50`],input:`placeholder:text-danger dark:placeholder:text-danger-500`,label:`text-danger dark:text-danger-500`}},{variant:`faded`,color:`primary`,class:{label:`text-primary`,inputWrapper:`data-[hover=true]:border-primary focus-within:border-primary`}},{variant:`faded`,color:`secondary`,class:{label:`text-secondary`,inputWrapper:`data-[hover=true]:border-secondary focus-within:border-secondary`}},{variant:`faded`,color:`success`,class:{label:`text-success`,inputWrapper:`data-[hover=true]:border-success focus-within:border-success`}},{variant:`faded`,color:`warning`,class:{label:`text-warning`,inputWrapper:`data-[hover=true]:border-warning focus-within:border-warning`}},{variant:`faded`,color:`danger`,class:{label:`text-danger`,inputWrapper:`data-[hover=true]:border-danger focus-within:border-danger`}},{variant:`underlined`,color:`default`,class:{input:`group-data-[has-value=true]:text-foreground`}},{variant:`underlined`,color:`primary`,class:{inputWrapper:`after:bg-primary`,label:`text-primary`}},{variant:`underlined`,color:`secondary`,class:{inputWrapper:`after:bg-secondary`,label:`text-secondary`}},{variant:`underlined`,color:`success`,class:{inputWrapper:`after:bg-success`,label:`text-success`}},{variant:`underlined`,color:`warning`,class:{inputWrapper:`after:bg-warning`,label:`text-warning`}},{variant:`underlined`,color:`danger`,class:{inputWrapper:`after:bg-danger`,label:`text-danger`}},{variant:`bordered`,color:`primary`,class:{inputWrapper:`group-data-[focus=true]:border-primary`,label:`text-primary`}},{variant:`bordered`,color:`secondary`,class:{inputWrapper:`group-data-[focus=true]:border-secondary`,label:`text-secondary`}},{variant:`bordered`,color:`success`,class:{inputWrapper:`group-data-[focus=true]:border-success`,label:`text-success`}},{variant:`bordered`,color:`warning`,class:{inputWrapper:`group-data-[focus=true]:border-warning`,label:`text-warning`}},{variant:`bordered`,color:`danger`,class:{inputWrapper:`group-data-[focus=true]:border-danger`,label:`text-danger`}},{labelPlacement:`inside`,color:`default`,class:{label:`group-data-[filled-within=true]:text-default-600`}},{labelPlacement:`outside`,color:`default`,class:{label:`group-data-[filled-within=true]:text-foreground`}},{radius:`full`,size:[`sm`],class:{inputWrapper:`px-3`}},{radius:`full`,size:`md`,class:{inputWrapper:`px-4`}},{radius:`full`,size:`lg`,class:{inputWrapper:`px-5`}},{disableAnimation:!1,variant:[`faded`,`bordered`],class:{inputWrapper:`transition-colors motion-reduce:transition-none`}},{disableAnimation:!1,variant:`underlined`,class:{inputWrapper:`after:transition-width motion-reduce:after:transition-none`}},{variant:[`flat`,`faded`],class:{inputWrapper:[...ft]}},{isInvalid:!0,variant:`flat`,class:{inputWrapper:[`!bg-danger-50`,`data-[hover=true]:!bg-danger-100`,`group-data-[focus=true]:!bg-danger-50`]}},{isInvalid:!0,variant:`bordered`,class:{inputWrapper:`!border-danger group-data-[focus=true]:!border-danger`}},{isInvalid:!0,variant:`underlined`,class:{inputWrapper:`after:!bg-danger`}},{labelPlacement:`inside`,size:`sm`,class:{inputWrapper:`h-12 py-1.5 px-3`}},{labelPlacement:`inside`,size:`md`,class:{inputWrapper:`h-14 py-2`}},{labelPlacement:`inside`,size:`lg`,class:{inputWrapper:`h-16 py-2.5 gap-0`}},{labelPlacement:`inside`,size:`sm`,variant:[`bordered`,`faded`],class:{inputWrapper:`py-1`}},{labelPlacement:[`inside`,`outside`],class:{label:[`group-data-[filled-within=true]:pointer-events-auto`]}},{labelPlacement:`outside`,isMultiline:!1,class:{base:`relative justify-end`,label:[`pb-0`,`z-20`,`top-1/2`,`-translate-y-1/2`,`group-data-[filled-within=true]:start-0`]}},{labelPlacement:[`inside`],class:{label:[`group-data-[filled-within=true]:scale-85`]}},{labelPlacement:[`inside`],variant:`flat`,class:{innerWrapper:`pb-0.5`}},{variant:`underlined`,size:`sm`,class:{innerWrapper:`pb-1`}},{variant:`underlined`,size:[`md`,`lg`],class:{innerWrapper:`pb-1.5`}},{labelPlacement:`inside`,size:[`sm`,`md`],class:{label:`text-small`}},{labelPlacement:`inside`,isMultiline:!1,size:`sm`,class:{label:[`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px)]`]}},{labelPlacement:`inside`,isMultiline:!1,size:`md`,class:{label:[`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px)]`]}},{labelPlacement:`inside`,isMultiline:!1,size:`lg`,class:{label:[`text-medium`,`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px)]`]}},{labelPlacement:`inside`,variant:[`faded`,`bordered`],isMultiline:!1,size:`sm`,class:{label:[`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_8px_-_var(--heroui-border-width-medium))]`]}},{labelPlacement:`inside`,variant:[`faded`,`bordered`],isMultiline:!1,size:`md`,class:{label:[`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_6px_-_var(--heroui-border-width-medium))]`]}},{labelPlacement:`inside`,variant:[`faded`,`bordered`],isMultiline:!1,size:`lg`,class:{label:[`text-medium`,`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_8px_-_var(--heroui-border-width-medium))]`]}},{labelPlacement:`inside`,variant:`underlined`,isMultiline:!1,size:`sm`,class:{label:[`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-tiny)/2_-_5px)]`]}},{labelPlacement:`inside`,variant:`underlined`,isMultiline:!1,size:`md`,class:{label:[`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_3.5px)]`]}},{labelPlacement:`inside`,variant:`underlined`,size:`lg`,isMultiline:!1,class:{label:[`text-medium`,`group-data-[filled-within=true]:-translate-y-[calc(50%_+_var(--heroui-font-size-small)/2_-_4px)]`]}},{labelPlacement:`outside`,size:`sm`,isMultiline:!1,class:{label:[`start-2`,`text-tiny`,`group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-tiny)/2_+_16px)]`],base:`data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_8px)]`}},{labelPlacement:`outside`,size:`md`,isMultiline:!1,class:{label:[`start-3`,`end-auto`,`text-small`,`group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_20px)]`],base:`data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_10px)]`}},{labelPlacement:`outside`,size:`lg`,isMultiline:!1,class:{label:[`start-3`,`end-auto`,`text-medium`,`group-data-[filled-within=true]:-translate-y-[calc(100%_+_var(--heroui-font-size-small)/2_+_24px)]`],base:`data-[has-label=true]:mt-[calc(var(--heroui-font-size-small)_+_12px)]`}},{labelPlacement:`outside-left`,size:`sm`,class:{label:`group-data-[has-helper=true]:pt-2`}},{labelPlacement:`outside-left`,size:`md`,class:{label:`group-data-[has-helper=true]:pt-3`}},{labelPlacement:`outside-left`,size:`lg`,class:{label:`group-data-[has-helper=true]:pt-4`}},{labelPlacement:[`outside`,`outside-left`],isMultiline:!0,class:{inputWrapper:`py-2`}},{labelPlacement:`outside`,isMultiline:!0,class:{label:`pb-1.5`}},{labelPlacement:`inside`,isMultiline:!0,class:{label:`pb-0.5`,input:`pt-0`}},{isMultiline:!0,disableAnimation:!1,class:{input:`transition-height !duration-100 motion-reduce:transition-none`}},{labelPlacement:[`inside`,`outside`],class:{label:[`pe-2`,`max-w-full`,`text-ellipsis`,`overflow-hidden`]}},{isMultiline:!0,radius:`full`,class:{inputWrapper:`data-[has-multiple-rows=true]:rounded-large`}},{isClearable:!0,isMultiline:!0,class:{clearButton:[`group-data-[has-value=true]:opacity-70 group-data-[has-value=true]:block`,`group-data-[has-value=true]:scale-100`,`group-data-[has-value=true]:pointer-events-auto`]}},{isClearable:!0,isDisabled:!0,class:{clearButton:`peer-data-[filled=true]:pointer-events-none`}}]}),Mn=Ct({slots:{base:`w-full relative flex flex-col gap-1 p-1 overflow-clip`,list:`w-full flex flex-col gap-0.5 outline-solid outline-transparent`,emptyContent:[`h-10`,`px-2`,`py-1.5`,`w-full`,`h-full`,`text-foreground-400`,`text-start`]}}),Nn=Ct({slots:{base:[`flex`,`group`,`gap-2`,`items-center`,`justify-between`,`relative`,`px-2`,`py-1.5`,`w-full`,`h-full`,`box-border`,`rounded-small`,`subpixel-antialiased`,`outline-solid outline-transparent`,`cursor-pointer`,`tap-highlight-transparent`,...Ot,`data-[focus-visible=true]:dark:ring-offset-background-content1`],wrapper:`w-full flex flex-col items-start justify-center min-w-0`,title:`flex-1 text-small font-normal w-full`,description:[`w-full`,`text-tiny`,`text-foreground-500`,`group-hover:text-current`],selectedIcon:[`text-inherit`,`w-3`,`h-3`,`shrink-0`],shortcut:[`px-1`,`py-0.5`,`rounded-sm`,`font-sans`,`text-foreground-500`,`text-tiny`,`border-small`,`border-default-300`,`group-hover:border-current`]},variants:{variant:{solid:{base:``},bordered:{base:`border-medium border-transparent bg-transparent`},light:{base:`bg-transparent`},faded:{base:[`border-small border-transparent hover:border-default data-[hover=true]:bg-default-100`,`data-[selectable=true]:focus:border-default data-[selectable=true]:focus:bg-default-100`]},flat:{base:``},shadow:{base:`data-[hover=true]:shadow-lg`}},color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},showDivider:{true:{base:[`mb-1.5`,`after:content-['']`,`after:absolute`,`after:-bottom-1`,`after:left-0`,`after:right-0`,`after:h-divider`,`after:bg-divider`]},false:{}},isDisabled:{true:{base:`opacity-disabled pointer-events-none`}},disableAnimation:{true:{},false:{base:`data-[hover=true]:transition-colors`}},hasTitleTextChild:{true:{title:`truncate`}},hasDescriptionTextChild:{true:{description:`truncate`}}},defaultVariants:{variant:`solid`,color:`default`,showDivider:!1},compoundVariants:[{variant:`solid`,color:`default`,class:{base:[`data-[hover=true]:bg-default`,`data-[hover=true]:text-default-foreground`,`data-[selectable=true]:focus:bg-default`,`data-[selectable=true]:focus:text-default-foreground`]}},{variant:`solid`,color:`primary`,class:{base:[`data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground`,`data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground`]}},{variant:`solid`,color:`secondary`,class:{base:[`data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground`,`data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground`]}},{variant:`solid`,color:`success`,class:{base:[`data-[hover=true]:bg-success data-[hover=true]:text-success-foreground`,`data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground`]}},{variant:`solid`,color:`warning`,class:{base:[`data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground`,`data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground`]}},{variant:`solid`,color:`danger`,class:{base:[`data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground`,`data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground`]}},{variant:`shadow`,color:`default`,class:{base:[`data-[hover=true]:shadow-default/50 data-[hover=true]:bg-default data-[hover=true]:text-default-foreground`,`data-[selectable=true]:focus:shadow-default/50 data-[selectable=true]:focus:bg-default data-[selectable=true]:focus:text-default-foreground`]}},{variant:`shadow`,color:`primary`,class:{base:[`data-[hover=true]:shadow-primary/30 data-[hover=true]:bg-primary data-[hover=true]:text-primary-foreground`,`data-[selectable=true]:focus:shadow-primary/30 data-[selectable=true]:focus:bg-primary data-[selectable=true]:focus:text-primary-foreground`]}},{variant:`shadow`,color:`secondary`,class:{base:[`data-[hover=true]:shadow-secondary/30 data-[hover=true]:bg-secondary data-[hover=true]:text-secondary-foreground`,`data-[selectable=true]:focus:shadow-secondary/30 data-[selectable=true]:focus:bg-secondary data-[selectable=true]:focus:text-secondary-foreground`]}},{variant:`shadow`,color:`success`,class:{base:[`data-[hover=true]:shadow-success/30 data-[hover=true]:bg-success data-[hover=true]:text-success-foreground`,`data-[selectable=true]:focus:shadow-success/30 data-[selectable=true]:focus:bg-success data-[selectable=true]:focus:text-success-foreground`]}},{variant:`shadow`,color:`warning`,class:{base:[`data-[hover=true]:shadow-warning/30 data-[hover=true]:bg-warning data-[hover=true]:text-warning-foreground`,`data-[selectable=true]:focus:shadow-warning/30 data-[selectable=true]:focus:bg-warning data-[selectable=true]:focus:text-warning-foreground`]}},{variant:`shadow`,color:`danger`,class:{base:[`data-[hover=true]:shadow-danger/30 data-[hover=true]:bg-danger data-[hover=true]:text-danger-foreground`,`data-[selectable=true]:focus:shadow-danger/30 data-[selectable=true]:focus:bg-danger data-[selectable=true]:focus:text-danger-foreground`]}},{variant:`bordered`,color:`default`,class:{base:[`data-[hover=true]:border-default`,`data-[selectable=true]:focus:border-default`]}},{variant:`bordered`,color:`primary`,class:{base:[`data-[hover=true]:border-primary data-[hover=true]:text-primary`,`data-[selectable=true]:focus:border-primary data-[selectable=true]:focus:text-primary`]}},{variant:`bordered`,color:`secondary`,class:{base:[`data-[hover=true]:border-secondary data-[hover=true]:text-secondary`,`data-[selectable=true]:focus:border-secondary data-[selectable=true]:focus:text-secondary`]}},{variant:`bordered`,color:`success`,class:{base:[`data-[hover=true]:border-success data-[hover=true]:text-success`,`data-[selectable=true]:focus:border-success data-[selectable=true]:focus:text-success`]}},{variant:`bordered`,color:`warning`,class:{base:[`data-[hover=true]:border-warning data-[hover=true]:text-warning`,`data-[selectable=true]:focus:border-warning data-[selectable=true]:focus:text-warning`]}},{variant:`bordered`,color:`danger`,class:{base:[`data-[hover=true]:border-danger data-[hover=true]:text-danger`,`data-[selectable=true]:focus:border-danger data-[selectable=true]:focus:text-danger`]}},{variant:`flat`,color:`default`,class:{base:[`data-[hover=true]:bg-default/40`,`data-[hover=true]:text-default-foreground`,`data-[selectable=true]:focus:bg-default/40`,`data-[selectable=true]:focus:text-default-foreground`]}},{variant:`flat`,color:`primary`,class:{base:[`data-[hover=true]:bg-primary/20 data-[hover=true]:text-primary`,`data-[selectable=true]:focus:bg-primary/20 data-[selectable=true]:focus:text-primary`]}},{variant:`flat`,color:`secondary`,class:{base:[`data-[hover=true]:bg-secondary/20 data-[hover=true]:text-secondary`,`data-[selectable=true]:focus:bg-secondary/20 data-[selectable=true]:focus:text-secondary`]}},{variant:`flat`,color:`success`,class:{base:[`data-[hover=true]:bg-success/20 data-[hover=true]:text-success`,`data-[selectable=true]:focus:bg-success/20 data-[selectable=true]:focus:text-success`]}},{variant:`flat`,color:`warning`,class:{base:[`data-[hover=true]:bg-warning/20 data-[hover=true]:text-warning`,`data-[selectable=true]:focus:bg-warning/20 data-[selectable=true]:focus:text-warning`]}},{variant:`flat`,color:`danger`,class:{base:[`data-[hover=true]:bg-danger/20 data-[hover=true]:text-danger`,`data-[selectable=true]:focus:bg-danger/20 data-[selectable=true]:focus:text-danger`]}},{variant:`faded`,color:`default`,class:{base:[`data-[hover=true]:text-default-foreground`,`data-[selectable=true]:focus:text-default-foreground`]}},{variant:`faded`,color:`primary`,class:{base:[`data-[hover=true]:text-primary`,`data-[selectable=true]:focus:text-primary`]}},{variant:`faded`,color:`secondary`,class:{base:[`data-[hover=true]:text-secondary`,`data-[selectable=true]:focus:text-secondary`]}},{variant:`faded`,color:`success`,class:{base:[`data-[hover=true]:text-success`,`data-[selectable=true]:focus:text-success`]}},{variant:`faded`,color:`warning`,class:{base:[`data-[hover=true]:text-warning`,`data-[selectable=true]:focus:text-warning`]}},{variant:`faded`,color:`danger`,class:{base:[`data-[hover=true]:text-danger`,`data-[selectable=true]:focus:text-danger`]}},{variant:`light`,color:`default`,class:{base:[`data-[hover=true]:text-default-500`,`data-[selectable=true]:focus:text-default-500`]}},{variant:`light`,color:`primary`,class:{base:[`data-[hover=true]:text-primary`,`data-[selectable=true]:focus:text-primary`]}},{variant:`light`,color:`secondary`,class:{base:[`data-[hover=true]:text-secondary`,`data-[selectable=true]:focus:text-secondary`]}},{variant:`light`,color:`success`,class:{base:[`data-[hover=true]:text-success`,`data-[selectable=true]:focus:text-success`]}},{variant:`light`,color:`warning`,class:{base:[`data-[hover=true]:text-warning`,`data-[selectable=true]:focus:text-warning`]}},{variant:`light`,color:`danger`,class:{base:[`data-[hover=true]:text-danger`,`data-[selectable=true]:focus:text-danger`]}}]}),Pn=Ct({slots:{base:`relative mb-2`,heading:`pl-1 text-tiny text-foreground-500`,group:`data-[has-title=true]:pt-1`,divider:`mt-2`}}),Fn=Ct({base:`flex flex-col gap-2 items-start`}),In=Ct({slots:{base:[`flex`,`flex-col`,`relative`,`overflow-hidden`,`h-auto`,`outline-solid outline-transparent`,`text-foreground`,`box-border`,`bg-content1`,...Ot],header:[`flex`,`p-3`,`z-10`,`w-full`,`justify-start`,`items-center`,`shrink-0`,`overflow-inherit`,`color-inherit`,`subpixel-antialiased`],body:[`relative`,`flex`,`flex-1`,`w-full`,`p-3`,`flex-auto`,`flex-col`,`place-content-inherit`,`align-items-inherit`,`h-auto`,`break-words`,`text-left`,`overflow-y-auto`,`subpixel-antialiased`],footer:[`p-3`,`h-auto`,`flex`,`w-full`,`items-center`,`overflow-hidden`,`color-inherit`,`subpixel-antialiased`]},variants:{shadow:{none:{base:`shadow-none`},sm:{base:`shadow-small`},md:{base:`shadow-medium`},lg:{base:`shadow-large`}},radius:{none:{base:`rounded-none`,header:`rounded-none`,footer:`rounded-none`},sm:{base:`rounded-small`,header:`rounded-t-small`,footer:`rounded-b-small`},md:{base:`rounded-medium`,header:`rounded-t-medium`,footer:`rounded-b-medium`},lg:{base:`rounded-large`,header:`rounded-t-large`,footer:`rounded-b-large`}},fullWidth:{true:{base:`w-full`}},isHoverable:{true:{base:`data-[hover=true]:bg-content2 dark:data-[hover=true]:bg-content2`}},isPressable:{true:{base:`cursor-pointer`}},isBlurred:{true:{base:[`bg-background/80`,`dark:bg-background/20`,`backdrop-blur-md`,`backdrop-saturate-150`]}},isFooterBlurred:{true:{footer:[`bg-background/10`,`backdrop-blur`,`backdrop-saturate-150`]}},isDisabled:{true:{base:`opacity-disabled cursor-not-allowed`}},disableAnimation:{true:``,false:{base:`transition-transform-background motion-reduce:transition-none`}}},compoundVariants:[{isPressable:!0,class:`data-[pressed=true]:scale-[0.97] tap-highlight-transparent`}],defaultVariants:{radius:`lg`,shadow:`md`,fullWidth:!1,isHoverable:!1,isPressable:!1,isDisabled:!1,isFooterBlurred:!1}}),Ln=Ct({slots:{base:`flex flex-grow flex-row w-full items-center py-3 px-4 gap-x-1`,mainWrapper:`h-full flex-grow min-h-10 ms-2 flex flex-col box-border items-start text-inherit justify-center`,title:`text-small w-full font-medium block text-inherit leading-5`,description:`pl-[1px] text-small font-normal text-inherit`,closeButton:`relative text-inherit translate-x-1 -translate-y-1`,iconWrapper:`flex-none relative w-9 h-9 rounded-full grid place-items-center`,alertIcon:`fill-current w-6 absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2`},variants:{color:{default:{},primary:{},secondary:{},success:{},warning:{},danger:{}},variant:{solid:{},flat:{},faded:{base:`border-small`},bordered:{base:`border-small bg-transparent`}},radius:{none:{base:`rounded-none`},sm:{base:`rounded-small`},md:{base:`rounded-medium`},lg:{base:`rounded-large`},full:{base:`rounded-full`}},hideIcon:{true:{iconWrapper:`hidden`}},hideIconWrapper:{true:{base:`gap-x-0`,iconWrapper:`!bg-transparent !shadow-none !border-none`}},hasContent:{false:{base:`items-center`,mainWrapper:`justify-center items-center`}}},defaultVariants:{color:`default`,variant:`flat`,radius:`md`,hideIcon:!1,hideIconWrapper:!1},compoundVariants:[{variant:`solid`,color:`default`,class:{base:$e.solid.default,closeButton:`data-[hover]:bg-default-100`,alertIcon:`text-default-foreground`}},{variant:`solid`,color:`primary`,class:{base:$e.solid.primary}},{variant:`solid`,color:`secondary`,class:{base:$e.solid.secondary}},{variant:`solid`,color:`success`,class:{base:$e.solid.success}},{variant:`solid`,color:`warning`,class:{base:$e.solid.warning}},{variant:`solid`,color:`danger`,class:{base:$e.solid.danger}},{variant:[`flat`,`faded`],color:`default`,class:{base:[$e.flat.default,`bg-default-100 dark:bg-default-50/50`,`text-default-foreground`],description:`text-default-600`,closeButton:`text-default-400`,iconWrapper:`bg-default-50 dark:bg-default-100 border-default-200`}},{variant:[`flat`,`faded`],color:`primary`,class:{base:[$e.flat.primary,`bg-primary-50 dark:bg-primary-50/50`],closeButton:`text-primary-500 data-[hover]:bg-primary-200`,iconWrapper:`bg-primary-50 dark:bg-primary-100 border-primary-100`}},{variant:[`flat`,`faded`],color:`secondary`,class:{base:[$e.flat.secondary,`bg-secondary-50 dark:bg-secondary-50/50`],closeButton:`text-secondary-500 data-[hover]:bg-secondary-200`,iconWrapper:`bg-secondary-50 dark:bg-secondary-100 border-secondary-100`}},{variant:[`flat`,`faded`],color:`success`,class:{base:[$e.flat.success,`bg-success-50 dark:bg-success-50/50`],closeButton:`text-success-500 data-[hover]:bg-success-200`,iconWrapper:`bg-success-50 dark:bg-success-100 border-success-100`}},{variant:[`flat`,`faded`],color:`warning`,class:{base:[$e.flat.warning,`bg-warning-50 dark:bg-warning-50/50`],closeButton:`text-warning-500 data-[hover]:bg-warning-200`,iconWrapper:`bg-warning-50 dark:bg-warning-100 border-warning-100`}},{variant:[`flat`,`faded`],color:`danger`,class:{base:[$e.flat.danger,`bg-danger-50 dark:bg-danger-50/50`],closeButton:`text-danger-500 data-[hover]:bg-danger-200`,iconWrapper:`bg-danger-50 dark:bg-danger-100 border-danger-100`}},{variant:`faded`,color:`default`,class:{base:`border-default-300 dark:border-default-200`}},{variant:`faded`,color:`primary`,class:{base:`border-primary-200 dark:border-primary-100`}},{variant:`faded`,color:`secondary`,class:{base:`border-secondary-200`}},{variant:`faded`,color:`success`,class:{base:`border-success-300 dark:border-success-100`}},{variant:`faded`,color:`warning`,class:{base:`border-warning-300 dark:border-warning-100`}},{variant:`faded`,color:`danger`,class:{base:`border-danger-200 dark:border-danger-100`}},{variant:`bordered`,color:`default`,class:{base:[$e.bordered.default],description:`text-default-600`,closeButton:`text-default-400`}},{variant:`bordered`,color:`primary`,class:{base:[$e.bordered.primary],closeButton:`data-[hover]:bg-primary-50`}},{variant:`bordered`,color:`secondary`,class:{base:[$e.bordered.secondary],closeButton:`data-[hover]:bg-secondary-50`}},{variant:`bordered`,color:`success`,class:{base:[$e.bordered.success],closeButton:`data-[hover]:bg-success-50`}},{variant:`bordered`,color:`warning`,class:{base:[$e.bordered.warning],closeButton:`data-[hover]:bg-warning-100`}},{variant:`bordered`,color:`danger`,class:{base:[$e.bordered.danger],closeButton:`data-[hover]:bg-danger-50`}},{variant:[`flat`,`bordered`,`faded`],class:{iconWrapper:`shadow-small`}},{variant:[`flat`,`faded`],class:{iconWrapper:`shadow-small border-1`}},{variant:`bordered`,color:`default`,class:{iconWrapper:`bg-default-200 dark:bg-default-100`}},{variant:`bordered`,color:`primary`,class:{iconWrapper:`bg-primary-100 dark:bg-primary-50`}},{variant:`bordered`,color:`secondary`,class:{iconWrapper:`bg-secondary-100 dark:bg-secondary-50`}},{variant:`bordered`,color:`success`,class:{iconWrapper:`bg-success-100 dark:bg-success-50`}},{variant:`bordered`,color:`warning`,class:{iconWrapper:`bg-warning-100 dark:bg-warning-50`}},{variant:`bordered`,color:`danger`,class:{iconWrapper:`bg-danger-100 dark:bg-danger-50`}}]}),Rn=r(((exports,t)=>{t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}})),zn=r(((exports,t)=>{t.exports=function(e){return!e||typeof e==`string`?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!==`String`)}})),Bn=r(((exports,t)=>{var n=zn(),r=Array.prototype.concat,i=Array.prototype.slice,a=t.exports=function(e){for(var t=[],a=0,o=e.length;a<o;a++){var s=e[a];n(s)?t=r.call(t,i.call(s)):t.push(s)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}})),Vn=r(((exports,t)=>{var n=Rn(),r=Bn(),i=Object.hasOwnProperty,a=Object.create(null);for(var o in n)i.call(n,o)&&(a[n[o]]=o);var s=t.exports={to:{},get:{}};s.get=function(e){var t=e.substring(0,3).toLowerCase(),n,r;switch(t){case`hsl`:n=s.get.hsl(e),r=`hsl`;break;case`hwb`:n=s.get.hwb(e),r=`hwb`;break;default:n=s.get.rgb(e),r=`rgb`;break}return n?{model:r,value:n}:null},s.get.rgb=function(e){if(!e)return null;var t=/^#([a-f0-9]{3,4})$/i,r=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,a=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,s=/^(\w+)$/,l=[0,0,0,1],u,d,f;if(u=e.match(r)){for(f=u[2],u=u[1],d=0;d<3;d++){var p=d*2;l[d]=parseInt(u.slice(p,p+2),16)}f&&(l[3]=parseInt(f,16)/255)}else if(u=e.match(t)){for(u=u[1],f=u[3],d=0;d<3;d++)l[d]=parseInt(u[d]+u[d],16);f&&(l[3]=parseInt(f+f,16)/255)}else if(u=e.match(a)){for(d=0;d<3;d++)l[d]=parseInt(u[d+1],0);u[4]&&(u[5]?l[3]=parseFloat(u[4])*.01:l[3]=parseFloat(u[4]))}else if(u=e.match(o)){for(d=0;d<3;d++)l[d]=Math.round(parseFloat(u[d+1])*2.55);u[4]&&(u[5]?l[3]=parseFloat(u[4])*.01:l[3]=parseFloat(u[4]))}else if(u=e.match(s))return u[1]===`transparent`?[0,0,0,0]:i.call(n,u[1])?(l=n[u[1]],l[3]=1,l):null;else return null;for(d=0;d<3;d++)l[d]=c(l[d],0,255);return l[3]=c(l[3],0,1),l},s.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]),r=(parseFloat(t[1])%360+360)%360,i=c(parseFloat(t[2]),0,100),a=c(parseFloat(t[3]),0,100),o=c(isNaN(n)?1:n,0,1);return[r,i,a,o]}return null},s.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]),r=(parseFloat(t[1])%360+360)%360,i=c(parseFloat(t[2]),0,100),a=c(parseFloat(t[3]),0,100),o=c(isNaN(n)?1:n,0,1);return[r,i,a,o]}return null},s.to.hex=function(){var e=r(arguments);return`#`+l(e[0])+l(e[1])+l(e[2])+(e[3]<1?l(Math.round(e[3]*255)):``)},s.to.rgb=function(){var e=r(arguments);return e.length<4||e[3]===1?`rgb(`+Math.round(e[0])+`, `+Math.round(e[1])+`, `+Math.round(e[2])+`)`:`rgba(`+Math.round(e[0])+`, `+Math.round(e[1])+`, `+Math.round(e[2])+`, `+e[3]+`)`},s.to.rgb.percent=function(){var e=r(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),i=Math.round(e[2]/255*100);return e.length<4||e[3]===1?`rgb(`+t+`%, `+n+`%, `+i+`%)`:`rgba(`+t+`%, `+n+`%, `+i+`%, `+e[3]+`)`},s.to.hsl=function(){var e=r(arguments);return e.length<4||e[3]===1?`hsl(`+e[0]+`, `+e[1]+`%, `+e[2]+`%)`:`hsla(`+e[0]+`, `+e[1]+`%, `+e[2]+`%, `+e[3]+`)`},s.to.hwb=function(){var e=r(arguments),t=``;return e.length>=4&&e[3]!==1&&(t=`, `+e[3]),`hwb(`+e[0]+`, `+e[1]+`%, `+e[2]+`%`+t+`)`},s.to.keyword=function(e){return a[e.slice(0,3)]};function c(e,t,n){return Math.min(Math.max(t,e),n)}function l(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?`0`+t:t}}));function Hn(e){return ce()?e.altKey:e.ctrlKey}function Un(e,t){let n=`[data-key="${CSS.escape(String(t))}"]`,r=e.current?.dataset.collection;return r&&(n=`[data-collection="${CSS.escape(r)}"]${n}`),e.current?.querySelector(n)}var Wn=new WeakMap;function Gn(e){let t=_e();return Wn.set(e,t),t}function Kn(e){return Wn.get(e)}var qn=1e3;function Jn(e){let{keyboardDelegate:t,selectionManager:n,onTypeSelect:r}=e,i=(0,I.useRef)({search:``,timeout:void 0}).current;return{typeSelectProps:{onKeyDownCapture:t.getKeyForSearch?e=>{let a=Yn(e.key);if(!(!a||e.ctrlKey||e.metaKey||!e.currentTarget.contains(e.target)||i.search.length===0&&a===` `)){if(a===` `&&i.search.trim().length>0&&(e.preventDefault(),`continuePropagation`in e||e.stopPropagation()),i.search+=a,t.getKeyForSearch!=null){let e=t.getKeyForSearch(i.search,n.focusedKey);e??=t.getKeyForSearch(i.search),e!=null&&(n.setFocusedKey(e),r&&r(e))}clearTimeout(i.timeout),i.timeout=setTimeout(()=>{i.search=``},qn)}}:void 0}}}function Yn(e){return e.length===1||!/^[A-Z]/i.test(e)?e:``}var Xn=t(Ht(),1);function Zn(e){let{selectionManager:t,keyboardDelegate:n,ref:r,autoFocus:i=!1,shouldFocusWrap:a=!1,disallowEmptySelection:o=!1,disallowSelectAll:s=!1,escapeKeyBehavior:c=`clearSelection`,selectOnFocus:l=t.selectionBehavior===`replace`,disallowTypeAhead:u=!1,shouldUseVirtualFocus:d,allowsTabNavigation:f=!1,isVirtualized:p,scrollRef:m=r,linkBehavior:h=`action`}=e,{direction:g}=bt(),_=tt(),v=e=>{if(e.altKey&&e.key===`Tab`&&e.preventDefault(),!r.current?.contains(e.target))return;let i=(n,i)=>{if(n!=null){if(t.isLink(n)&&h===`selection`&&l&&!Hn(e)){(0,Xn.flushSync)(()=>{t.setFocusedKey(n,i)});let a=Un(r,n),o=t.getItemProps(n);a&&_.open(a,e,o.href,o.routerOptions);return}if(t.setFocusedKey(n,i),t.isLink(n)&&h===`override`)return;e.shiftKey&&t.selectionMode===`multiple`?t.extendSelection(n):l&&!Hn(e)&&t.replaceSelection(n)}};switch(e.key){case`ArrowDown`:if(n.getKeyBelow){let r=t.focusedKey==null?n.getFirstKey?.call(n):n.getKeyBelow?.call(n,t.focusedKey);r==null&&a&&(r=n.getFirstKey?.call(n,t.focusedKey)),r!=null&&(e.preventDefault(),i(r))}break;case`ArrowUp`:if(n.getKeyAbove){let r=t.focusedKey==null?n.getLastKey?.call(n):n.getKeyAbove?.call(n,t.focusedKey);r==null&&a&&(r=n.getLastKey?.call(n,t.focusedKey)),r!=null&&(e.preventDefault(),i(r))}break;case`ArrowLeft`:if(n.getKeyLeftOf){let r=t.focusedKey==null?null:n.getKeyLeftOf?.call(n,t.focusedKey);r==null&&a&&(r=g===`rtl`?n.getFirstKey?.call(n,t.focusedKey):n.getLastKey?.call(n,t.focusedKey)),r!=null&&(e.preventDefault(),i(r,g===`rtl`?`first`:`last`))}break;case`ArrowRight`:if(n.getKeyRightOf){let r=t.focusedKey==null?null:n.getKeyRightOf?.call(n,t.focusedKey);r==null&&a&&(r=g===`rtl`?n.getLastKey?.call(n,t.focusedKey):n.getFirstKey?.call(n,t.focusedKey)),r!=null&&(e.preventDefault(),i(r,g===`rtl`?`last`:`first`))}break;case`Home`:if(n.getFirstKey){if(t.focusedKey===null&&e.shiftKey)return;e.preventDefault();let r=n.getFirstKey(t.focusedKey,gn(e));t.setFocusedKey(r),r!=null&&(gn(e)&&e.shiftKey&&t.selectionMode===`multiple`?t.extendSelection(r):l&&t.replaceSelection(r))}break;case`End`:if(n.getLastKey){if(t.focusedKey===null&&e.shiftKey)return;e.preventDefault();let r=n.getLastKey(t.focusedKey,gn(e));t.setFocusedKey(r),r!=null&&(gn(e)&&e.shiftKey&&t.selectionMode===`multiple`?t.extendSelection(r):l&&t.replaceSelection(r))}break;case`PageDown`:if(n.getKeyPageBelow&&t.focusedKey!=null){let r=n.getKeyPageBelow(t.focusedKey);r!=null&&(e.preventDefault(),i(r))}break;case`PageUp`:if(n.getKeyPageAbove&&t.focusedKey!=null){let r=n.getKeyPageAbove(t.focusedKey);r!=null&&(e.preventDefault(),i(r))}break;case`a`:gn(e)&&t.selectionMode===`multiple`&&s!==!0&&(e.preventDefault(),t.selectAll());break;case`Escape`:c===`clearSelection`&&!o&&t.selectedKeys.size!==0&&(e.stopPropagation(),e.preventDefault(),t.clearSelection());break;case`Tab`:if(!f){if(e.shiftKey)r.current.focus();else{let e=vt(r.current,{tabbable:!0}),t,n;do n=e.lastChild(),n&&(t=n);while(n);t&&!t.contains(document.activeElement)&&x(t)}break}}},y=(0,I.useRef)({top:0,left:0});un(m,`scroll`,p?void 0:()=>{y.current={top:m.current?.scrollTop??0,left:m.current?.scrollLeft??0}});let b=e=>{if(t.isFocused){e.currentTarget.contains(e.target)||t.setFocused(!1);return}if(e.currentTarget.contains(e.target)){if(t.setFocused(!0),t.focusedKey==null){let r=e=>{e!=null&&(t.setFocusedKey(e),l&&!t.isSelected(e)&&t.replaceSelection(e))},i=e.relatedTarget;i&&e.currentTarget.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_FOLLOWING?r(t.lastSelectedKey??n.getLastKey?.call(n)):r(t.firstSelectedKey??n.getFirstKey?.call(n))}else !p&&m.current&&(m.current.scrollTop=y.current.top,m.current.scrollLeft=y.current.left);if(t.focusedKey!=null&&m.current){let e=Un(r,t.focusedKey);e instanceof HTMLElement&&(!e.contains(document.activeElement)&&!d&&x(e),Nt()===`keyboard`&&pn(e,{containingElement:r.current}))}}},S=e=>{e.currentTarget.contains(e.relatedTarget)||t.setFocused(!1)},C=(0,I.useRef)(!1);un(r,hn,d?e=>{let{detail:n}=e;e.stopPropagation(),t.setFocused(!0),n?.focusStrategy===`first`&&(C.current=!0)}:void 0);let w=be(()=>{let e=n.getFirstKey?.call(n)??null;if(e==null){let e=de();Sn(r.current),wn(e,null),t.collection.size>0&&(C.current=!1)}else t.setFocusedKey(e),C.current=!1});an(()=>{C.current&&w()},[t.collection,w]);let T=be(()=>{t.collection.size>0&&(C.current=!1)});an(()=>{T()},[t.focusedKey,T]),un(r,mn,d?e=>{e.stopPropagation(),t.setFocused(!1),e.detail?.clearFocusKey&&t.setFocusedKey(null)}:void 0);let E=(0,I.useRef)(i),D=(0,I.useRef)(!1);(0,I.useEffect)(()=>{if(E.current){let e=null;i===`first`&&(e=n.getFirstKey?.call(n)??null),i===`last`&&(e=n.getLastKey?.call(n)??null);let a=t.selectedKeys;if(a.size){for(let n of a)if(t.canSelectItem(n)){e=n;break}}t.setFocused(!0),t.setFocusedKey(e),e==null&&!d&&r.current&&Oe(r.current),t.collection.size>0&&(E.current=!1,D.current=!0)}});let O=(0,I.useRef)(t.focusedKey),k=(0,I.useRef)(null);(0,I.useEffect)(()=>{if(t.isFocused&&t.focusedKey!=null&&(t.focusedKey!==O.current||D.current)&&m.current&&r.current){let e=Nt(),n=Un(r,t.focusedKey);if(!(n instanceof HTMLElement))return;(e===`keyboard`||D.current)&&(k.current&&cancelAnimationFrame(k.current),k.current=requestAnimationFrame(()=>{m.current&&(dn(m.current,n),e!==`virtual`&&pn(n,{containingElement:r.current}))}))}!d&&t.isFocused&&t.focusedKey==null&&O.current!=null&&r.current&&Oe(r.current),O.current=t.focusedKey,D.current=!1}),(0,I.useEffect)(()=>()=>{k.current&&cancelAnimationFrame(k.current)},[]),un(r,`react-aria-focus-scope-restore`,e=>{e.preventDefault(),t.setFocused(!0)});let A={onKeyDown:v,onFocus:b,onBlur:S,onMouseDown(e){m.current===e.target&&e.preventDefault()}},{typeSelectProps:j}=Jn({keyboardDelegate:n,selectionManager:t});u||(A=te(j,A));let ee;d||(ee=t.focusedKey==null?0:-1);let M=Gn(t.collection);return{collectionProps:te(A,{tabIndex:ee,"data-collection":M})}}function Qn(e){let{id:t,selectionManager:n,key:r,ref:i,shouldSelectOnPressUp:a,shouldUseVirtualFocus:o,focus:s,isDisabled:c,onAction:l,allowsDifferentPressOrigin:u,linkBehavior:f=`action`}=e,p=tt();t=_e(t);let m=e=>{if(e.pointerType===`keyboard`&&Hn(e))n.toggleSelection(r);else{if(n.selectionMode===`none`)return;if(n.isLink(r)){if(f===`selection`&&i.current){let t=n.getItemProps(r);p.open(i.current,e,t.href,t.routerOptions),n.setSelectedKeys(n.selectedKeys);return}else if(f===`override`||f===`none`)return}n.selectionMode===`single`?n.isSelected(r)&&!n.disallowEmptySelection?n.toggleSelection(r):n.replaceSelection(r):e&&e.shiftKey?n.extendSelection(r):n.selectionBehavior===`toggle`||e&&(gn(e)||e.pointerType===`touch`||e.pointerType===`virtual`)?n.toggleSelection(r):n.replaceSelection(r)}};(0,I.useEffect)(()=>{r===n.focusedKey&&n.isFocused&&(o?Sn(i.current):s?s():document.activeElement!==i.current&&i.current&&Oe(i.current))},[i,r,n.focusedKey,n.childFocusStrategy,n.isFocused,o]),c||=n.isDisabled(r);let h={};!o&&!c?h={tabIndex:r===n.focusedKey?0:-1,onFocus(e){e.target===i.current&&n.setFocusedKey(r)}}:c&&(h.onMouseDown=e=>{e.preventDefault()});let g=n.isLink(r)&&f===`override`,_=n.isLink(r)&&f!==`selection`&&f!==`none`,v=!c&&n.canSelectItem(r)&&!g,y=(l||_)&&!c,b=y&&(n.selectionBehavior===`replace`?!v:!v||n.isEmpty),x=y&&v&&n.selectionBehavior===`replace`,S=b||x,C=(0,I.useRef)(null),w=S&&v,T=(0,I.useRef)(!1),E=(0,I.useRef)(!1),D=n.getItemProps(r),O=e=>{l&&l(),_&&i.current&&p.open(i.current,e,D.href,D.routerOptions)},k={ref:i};if(a?(k.onPressStart=e=>{C.current=e.pointerType,T.current=w,e.pointerType===`keyboard`&&(!S||er())&&m(e)},u?(k.onPressUp=b?void 0:e=>{e.pointerType===`mouse`&&v&&m(e)},k.onPress=b?O:e=>{e.pointerType!==`keyboard`&&e.pointerType!==`mouse`&&v&&m(e)}):k.onPress=e=>{if(b||x&&e.pointerType!==`mouse`){if(e.pointerType===`keyboard`&&!$n())return;O(e)}else e.pointerType!==`keyboard`&&v&&m(e)}):(k.onPressStart=e=>{C.current=e.pointerType,T.current=w,E.current=b,v&&(e.pointerType===`mouse`&&!b||e.pointerType===`keyboard`&&(!y||er()))&&m(e)},k.onPress=e=>{(e.pointerType===`touch`||e.pointerType===`pen`||e.pointerType===`virtual`||e.pointerType===`keyboard`&&S&&$n()||e.pointerType===`mouse`&&E.current)&&(S?O(e):v&&m(e))}),h[`data-collection`]=Kn(n.collection),h[`data-key`]=r,k.preventFocusOnPress=o,o&&(k=te(k,{onPressStart(e){e.pointerType!==`touch`&&(n.setFocused(!0),n.setFocusedKey(r))},onPress(e){e.pointerType===`touch`&&(n.setFocused(!0),n.setFocusedKey(r))}})),D)for(let e of[`onPressStart`,`onPressEnd`,`onPressChange`,`onPress`,`onPressUp`,`onClick`])D[e]&&(k[e]=P(k[e],D[e]));let{pressProps:A,isPressed:j}=Lt(k),ee=x?e=>{C.current===`mouse`&&(e.stopPropagation(),e.preventDefault(),O(e))}:void 0,{longPressProps:M}=bn({isDisabled:!w,onLongPress(e){e.pointerType===`touch`&&(m(e),n.setSelectionBehavior(`toggle`))}}),ne=e=>{C.current===`touch`&&T.current&&e.preventDefault()},re=f!==`none`&&n.isLink(r)?e=>{d.isOpening||e.preventDefault()}:void 0;return{itemProps:te(h,v||b||o&&!c?A:{},w?M:{},{onDoubleClick:ee,onDragStartCapture:ne,onClick:re,id:t},o?{onMouseDown:e=>e.preventDefault()}:void 0),isPressed:j,isSelected:n.isSelected(r),isFocused:n.isFocused&&n.focusedKey===r,isDisabled:c,allowsSelection:v,hasAction:S}}function $n(){return window.event?.key===`Enter`}function er(){let e=window.event;return e?.key===` `||e?.code===`Space`}var tr=class{getItemRect(e){let t=this.ref.current;if(!t)return null;let n=e==null?null:Un(this.ref,e);if(!n)return null;let r=t.getBoundingClientRect(),i=n.getBoundingClientRect();return{x:i.left-r.left+t.scrollLeft,y:i.top-r.top+t.scrollTop,width:i.width,height:i.height}}getContentSize(){let e=this.ref.current;return{width:e?.scrollWidth??0,height:e?.scrollHeight??0}}getVisibleRect(){let e=this.ref.current;return{x:e?.scrollLeft??0,y:e?.scrollTop??0,width:e?.offsetWidth??0,height:e?.offsetHeight??0}}constructor(e){this.ref=e}},nr=class{isDisabled(e){return this.disabledBehavior===`all`&&(e.props?.isDisabled||this.disabledKeys.has(e.key))}findNextNonDisabled(e,t){let n=e;for(;n!=null;){let e=this.collection.getItem(n);if(e?.type===`item`&&!this.isDisabled(e))return n;n=t(n)}return null}getNextKey(e){let t=e;return t=this.collection.getKeyAfter(t),this.findNextNonDisabled(t,e=>this.collection.getKeyAfter(e))}getPreviousKey(e){let t=e;return t=this.collection.getKeyBefore(t),this.findNextNonDisabled(t,e=>this.collection.getKeyBefore(e))}findKey(e,t,n){let r=e,i=this.layoutDelegate.getItemRect(r);if(!i||r==null)return null;let a=i;do{if(r=t(r),r==null)break;i=this.layoutDelegate.getItemRect(r)}while(i&&n(a,i)&&r!=null);return r}isSameRow(e,t){return e.y===t.y||e.x!==t.x}isSameColumn(e,t){return e.x===t.x||e.y!==t.y}getKeyBelow(e){return this.layout===`grid`&&this.orientation===`vertical`?this.findKey(e,e=>this.getNextKey(e),this.isSameRow):this.getNextKey(e)}getKeyAbove(e){return this.layout===`grid`&&this.orientation===`vertical`?this.findKey(e,e=>this.getPreviousKey(e),this.isSameRow):this.getPreviousKey(e)}getNextColumn(e,t){return t?this.getPreviousKey(e):this.getNextKey(e)}getKeyRightOf(e){let t=this.direction===`ltr`?`getKeyRightOf`:`getKeyLeftOf`;return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,e=>this.layoutDelegate[t](e))):this.layout===`grid`?this.orientation===`vertical`?this.getNextColumn(e,this.direction===`rtl`):this.findKey(e,e=>this.getNextColumn(e,this.direction===`rtl`),this.isSameColumn):this.orientation===`horizontal`?this.getNextColumn(e,this.direction===`rtl`):null}getKeyLeftOf(e){let t=this.direction===`ltr`?`getKeyLeftOf`:`getKeyRightOf`;return this.layoutDelegate[t]?(e=this.layoutDelegate[t](e),this.findNextNonDisabled(e,e=>this.layoutDelegate[t](e))):this.layout===`grid`?this.orientation===`vertical`?this.getNextColumn(e,this.direction===`ltr`):this.findKey(e,e=>this.getNextColumn(e,this.direction===`ltr`),this.isSameColumn):this.orientation===`horizontal`?this.getNextColumn(e,this.direction===`ltr`):null}getFirstKey(){let e=this.collection.getFirstKey();return this.findNextNonDisabled(e,e=>this.collection.getKeyAfter(e))}getLastKey(){let e=this.collection.getLastKey();return this.findNextNonDisabled(e,e=>this.collection.getKeyBefore(e))}getKeyPageAbove(e){let t=this.ref.current,n=this.layoutDelegate.getItemRect(e);if(!n)return null;if(t&&!y(t))return this.getFirstKey();let r=e;if(this.orientation===`horizontal`){let e=Math.max(0,n.x+n.width-this.layoutDelegate.getVisibleRect().width);for(;n&&n.x>e&&r!=null;)r=this.getKeyAbove(r),n=r==null?null:this.layoutDelegate.getItemRect(r)}else{let e=Math.max(0,n.y+n.height-this.layoutDelegate.getVisibleRect().height);for(;n&&n.y>e&&r!=null;)r=this.getKeyAbove(r),n=r==null?null:this.layoutDelegate.getItemRect(r)}return r??this.getFirstKey()}getKeyPageBelow(e){let t=this.ref.current,n=this.layoutDelegate.getItemRect(e);if(!n)return null;if(t&&!y(t))return this.getLastKey();let r=e;if(this.orientation===`horizontal`){let e=Math.min(this.layoutDelegate.getContentSize().width,n.y-n.width+this.layoutDelegate.getVisibleRect().width);for(;n&&n.x<e&&r!=null;)r=this.getKeyBelow(r),n=r==null?null:this.layoutDelegate.getItemRect(r)}else{let e=Math.min(this.layoutDelegate.getContentSize().height,n.y-n.height+this.layoutDelegate.getVisibleRect().height);for(;n&&n.y<e&&r!=null;)r=this.getKeyBelow(r),n=r==null?null:this.layoutDelegate.getItemRect(r)}return r??this.getLastKey()}getKeyForSearch(e,t){if(!this.collator)return null;let n=this.collection,r=t||this.getFirstKey();for(;r!=null;){let t=n.getItem(r);if(!t)return null;let i=t.textValue.slice(0,e.length);if(t.textValue&&this.collator.compare(i,e)===0)return r;r=this.getNextKey(r)}return null}constructor(...e){if(e.length===1){let t=e[0];this.collection=t.collection,this.ref=t.ref,this.collator=t.collator,this.disabledKeys=t.disabledKeys||new Set,this.disabledBehavior=t.disabledBehavior||`all`,this.orientation=t.orientation||`vertical`,this.direction=t.direction,this.layout=t.layout||`stack`,this.layoutDelegate=t.layoutDelegate||new tr(t.ref)}else this.collection=e[0],this.disabledKeys=e[1],this.ref=e[2],this.collator=e[3],this.layout=`stack`,this.orientation=`vertical`,this.disabledBehavior=`all`,this.layoutDelegate=new tr(this.ref);this.layout===`stack`&&this.orientation===`vertical`&&(this.getKeyLeftOf=void 0,this.getKeyRightOf=void 0)}};function rr(e){let{selectionManager:t,collection:n,disabledKeys:r,ref:i,keyboardDelegate:a,layoutDelegate:o}=e,s=vn({usage:`search`,sensitivity:`base`}),c=t.disabledBehavior,l=(0,I.useMemo)(()=>a||new nr({collection:n,disabledKeys:r,disabledBehavior:c,ref:i,collator:s,layoutDelegate:o}),[a,o,n,r,i,s,c]),{collectionProps:u}=Zn({...e,ref:i,selectionManager:t,keyboardDelegate:l});return{listProps:u}}var B=t(Gt(),1),ir=e=>(0,B.jsx)(`svg`,{fill:`none`,height:`24`,viewBox:`0 0 24 24`,width:`24`,xmlns:`http://www.w3.org/2000/svg`,...e,children:(0,B.jsx)(`path`,{d:`M12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22ZM12.75 16C12.75 16.41 12.41 16.75 12 16.75C11.59 16.75 11.25 16.41 11.25 16L11.25 11C11.25 10.59 11.59 10.25 12 10.25C12.41 10.25 12.75 10.59 12.75 11L12.75 16ZM11.08 7.62C11.13 7.49 11.2 7.39 11.29 7.29C11.39 7.2 11.5 7.13 11.62 7.08C11.74 7.03 11.87 7 12 7C12.13 7 12.26 7.03 12.38 7.08C12.5 7.13 12.61 7.2 12.71 7.29C12.8 7.39 12.87 7.49 12.92 7.62C12.97 7.74 13 7.87 13 8C13 8.13 12.97 8.26 12.92 8.38C12.87 8.5 12.8 8.61 12.71 8.71C12.61 8.8 12.5 8.87 12.38 8.92C12.14 9.02 11.86 9.02 11.62 8.92C11.5 8.87 11.39 8.8 11.29 8.71C11.2 8.61 11.13 8.5 11.08 8.38C11.03 8.26 11 8.13 11 8C11 7.87 11.03 7.74 11.08 7.62Z`})}),ar=({strokeWidth:e=1.5,...t})=>(0,B.jsx)(`svg`,{"aria-hidden":`true`,fill:`none`,focusable:`false`,height:`1em`,role:`presentation`,stroke:`currentColor`,strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:e,viewBox:`0 0 24 24`,width:`1em`,...t,children:(0,B.jsx)(`path`,{d:`m6 9 6 6 6-6`})}),or=class e extends Set{constructor(t,n,r){super(t),t instanceof e?(this.anchorKey=n??t.anchorKey,this.currentKey=r??t.currentKey):(this.anchorKey=n??null,this.currentKey=r??null)}};function sr(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function cr(e){let{selectionMode:t=`none`,disallowEmptySelection:n=!1,allowDuplicateSelectionEvents:r,selectionBehavior:i=`toggle`,disabledBehavior:a=`all`}=e,o=(0,I.useRef)(!1),[,s]=(0,I.useState)(!1),c=(0,I.useRef)(null),l=(0,I.useRef)(null),[,u]=(0,I.useState)(null),d=(0,I.useMemo)(()=>lr(e.selectedKeys),[e.selectedKeys]),f=(0,I.useMemo)(()=>lr(e.defaultSelectedKeys,new or),[e.defaultSelectedKeys]),[p,m]=Ft(d,f,e.onSelectionChange),h=(0,I.useMemo)(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),[g,_]=(0,I.useState)(i);i===`replace`&&g===`toggle`&&typeof p==`object`&&p.size===0&&_(`replace`);let v=(0,I.useRef)(i);return(0,I.useEffect)(()=>{i!==v.current&&(_(i),v.current=i)},[i]),{selectionMode:t,disallowEmptySelection:n,selectionBehavior:g,setSelectionBehavior:_,get isFocused(){return o.current},setFocused(e){o.current=e,s(e)},get focusedKey(){return c.current},get childFocusStrategy(){return l.current},setFocusedKey(e,t=`first`){c.current=e,l.current=t,u(e)},selectedKeys:p,setSelectedKeys(e){(r||!sr(e,p))&&m(e)},disabledKeys:h,disabledBehavior:a}}function lr(e,t){return e?e===`all`?`all`:new or(e):t}function ur(e){return null}ur.getCollectionNode=function*(e,t){let{childItems:n,title:r,children:i}=e,a=e.title||e.children,o=e.textValue||(typeof a==`string`?a:``)||e[`aria-label`]||``;!o&&t?.suppressTextValueWarning,yield{type:`item`,props:e,rendered:a,textValue:o,"aria-label":e[`aria-label`],hasChildNodes:dr(e),*childNodes(){if(n)for(let e of n)yield{type:`item`,value:e};else if(r){let e=[];I.Children.forEach(i,t=>{e.push({type:`item`,element:t})}),yield*e}}}};function dr(e){return e.hasChildItems==null?!!(e.childItems||e.title&&I.Children.count(e.children)>0):e.hasChildItems}var fr=ur,pr=class{build(e,t){return this.context=t,mr(()=>this.iterateCollection(e))}*iterateCollection(e){let{children:t,items:n}=e;if(I.isValidElement(t)&&t.type===I.Fragment)yield*this.iterateCollection({children:t.props.children,items:n});else if(typeof t==`function`){if(!n)throw Error(`props.children was a function but props.items is missing`);let e=0;for(let r of n)yield*this.getFullNode({value:r,index:e},{renderer:t}),e++}else{let e=[];I.Children.forEach(t,t=>{t&&e.push(t)});let n=0;for(let t of e){let e=this.getFullNode({element:t,index:n},{});for(let t of e)n++,yield t}}}getKey(e,t,n,r){if(e.key!=null)return e.key;if(t.type===`cell`&&t.key!=null)return`${r}${t.key}`;let i=t.value;if(i!=null){let e=i.key??i.id;if(e==null)throw Error(`No key found for item`);return e}return r?`${r}.${t.index}`:`$.${t.index}`}getChildState(e,t){return{renderer:t.renderer||e.renderer}}*getFullNode(e,t,n,r){if(I.isValidElement(e.element)&&e.element.type===I.Fragment){let i=[];I.Children.forEach(e.element.props.children,e=>{i.push(e)});let a=e.index??0;for(let e of i)yield*this.getFullNode({element:e,index:a++},t,n,r);return}let i=e.element;if(!i&&e.value&&t&&t.renderer){let n=this.cache.get(e.value);if(n&&(!n.shouldInvalidate||!n.shouldInvalidate(this.context))){n.index=e.index,n.parentKey=r?r.key:null,yield n;return}i=t.renderer(e.value)}if(I.isValidElement(i)){let a=i.type;if(typeof a!=`function`&&typeof a.getCollectionNode!=`function`){let e=i.type;throw Error(`Unknown element <${e}> in collection.`)}let o=a.getCollectionNode(i.props,this.context),s=e.index??0,c=o.next();for(;!c.done&&c.value;){let a=c.value;e.index=s;let l=a.key??null;l??=a.element?null:this.getKey(i,e,t,n);let u=[...this.getFullNode({...a,key:l,index:s,wrapper:hr(e.wrapper,a.wrapper)},this.getChildState(t,a),n?`${n}${i.key}`:i.key,r)];for(let t of u){if(t.value=a.value??e.value??null,t.value&&this.cache.set(t.value,t),e.type&&t.type!==e.type)throw Error(`Unsupported type <${gr(t.type)}> in <${gr(r?.type??`unknown parent type`)}>. Only <${gr(e.type)}> is supported.`);s++,yield t}c=o.next(u)}return}if(e.key==null||e.type==null)return;let a=this,o={type:e.type,props:e.props,key:e.key,parentKey:r?r.key:null,value:e.value??null,level:r?r.level+1:0,index:e.index,rendered:e.rendered,textValue:e.textValue??``,"aria-label":e[`aria-label`],wrapper:e.wrapper,shouldInvalidate:e.shouldInvalidate,hasChildNodes:e.hasChildNodes||!1,childNodes:mr(function*(){if(!e.hasChildNodes||!e.childNodes)return;let n=0;for(let r of e.childNodes()){r.key!=null&&(r.key=`${o.key}${r.key}`);let e=a.getFullNode({...r,index:n},a.getChildState(t,r),o.key,o);for(let t of e)n++,yield t}})};yield o}constructor(){this.cache=new WeakMap}};function mr(e){let t=[],n=null;return{*[Symbol.iterator](){for(let e of t)yield e;n||=e();for(let e of n)t.push(e),yield e}}}function hr(e,t){if(e&&t)return n=>e(t(n));if(e)return e;if(t)return t}function gr(e){return e[0].toUpperCase()+e.slice(1)}function _r(e,t,n){let r=(0,I.useMemo)(()=>new pr,[]),{children:i,items:a,collection:o}=e;return(0,I.useMemo)(()=>{if(o)return o;let e=r.build({children:i,items:a},n);return t(e)},[r,i,a,o,n,t])}function vr(e,t){return typeof t.getChildren==`function`?t.getChildren(e.key):e.childNodes}function yr(e){return br(e,0)}function br(e,t){if(t<0)return;let n=0;for(let r of e){if(n===t)return r;n++}}function xr(e,t,n){if(t.parentKey===n.parentKey)return t.index-n.index;let r=[...Sr(e,t),t],i=[...Sr(e,n),n],a=r.slice(0,i.length).findIndex((e,t)=>e!==i[t]);return a===-1?r.findIndex(e=>e===n)>=0?1:(i.findIndex(e=>e===t),-1):(t=r[a],n=i[a],t.index-n.index)}function Sr(e,t){let n=[],r=t;for(;r?.parentKey!=null;)r=e.getItem(r.parentKey),r&&n.unshift(r);return n}var Cr=new WeakMap;function wr(e){let t=Cr.get(e);if(t!=null)return t;let n=0,r=t=>{for(let i of t)i.type===`section`?r(vr(i,e)):i.type===`item`&&n++};return r(e),Cr.set(e,n),n}var Tr=class e{get selectionMode(){return this.state.selectionMode}get disallowEmptySelection(){return this.state.disallowEmptySelection}get selectionBehavior(){return this.state.selectionBehavior}setSelectionBehavior(e){this.state.setSelectionBehavior(e)}get isFocused(){return this.state.isFocused}setFocused(e){this.state.setFocused(e)}get focusedKey(){return this.state.focusedKey}get childFocusStrategy(){return this.state.childFocusStrategy}setFocusedKey(e,t){(e==null||this.collection.getItem(e))&&this.state.setFocusedKey(e,t)}get selectedKeys(){return this.state.selectedKeys===`all`?new Set(this.getSelectAllKeys()):this.state.selectedKeys}get rawSelection(){return this.state.selectedKeys}isSelected(e){if(this.state.selectionMode===`none`)return!1;let t=this.getKey(e);return t==null?!1:this.state.selectedKeys===`all`?this.canSelectItem(t):this.state.selectedKeys.has(t)}get isEmpty(){return this.state.selectedKeys!==`all`&&this.state.selectedKeys.size===0}get isSelectAll(){if(this.isEmpty)return!1;if(this.state.selectedKeys===`all`)return!0;if(this._isSelectAll!=null)return this._isSelectAll;let e=this.getSelectAllKeys(),t=this.state.selectedKeys;return this._isSelectAll=e.every(e=>t.has(e)),this._isSelectAll}get firstSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let n=this.collection.getItem(t);(!e||n&&xr(this.collection,n,e)<0)&&(e=n)}return e?.key??null}get lastSelectedKey(){let e=null;for(let t of this.state.selectedKeys){let n=this.collection.getItem(t);(!e||n&&xr(this.collection,n,e)>0)&&(e=n)}return e?.key??null}get disabledKeys(){return this.state.disabledKeys}get disabledBehavior(){return this.state.disabledBehavior}extendSelection(e){if(this.selectionMode===`none`)return;if(this.selectionMode===`single`){this.replaceSelection(e);return}let t=this.getKey(e);if(t==null)return;let n;if(this.state.selectedKeys===`all`)n=new or([t],t,t);else{let e=this.state.selectedKeys,r=e.anchorKey??t;n=new or(e,r,t);for(let i of this.getKeyRange(r,e.currentKey??t))n.delete(i);for(let e of this.getKeyRange(t,r))this.canSelectItem(e)&&n.add(e)}this.state.setSelectedKeys(n)}getKeyRange(e,t){let n=this.collection.getItem(e),r=this.collection.getItem(t);return n&&r?xr(this.collection,n,r)<=0?this.getKeyRangeInternal(e,t):this.getKeyRangeInternal(t,e):[]}getKeyRangeInternal(e,t){if(this.layoutDelegate?.getKeyRange)return this.layoutDelegate.getKeyRange(e,t);let n=[],r=e;for(;r!=null;){let e=this.collection.getItem(r);if(e&&(e.type===`item`||e.type===`cell`&&this.allowsCellSelection)&&n.push(r),r===t)return n;r=this.collection.getKeyAfter(r)}return[]}getKey(e){let t=this.collection.getItem(e);if(!t||t.type===`cell`&&this.allowsCellSelection)return e;for(;t&&t.type!==`item`&&t.parentKey!=null;)t=this.collection.getItem(t.parentKey);return!t||t.type!==`item`?null:t.key}toggleSelection(e){if(this.selectionMode===`none`)return;if(this.selectionMode===`single`&&!this.isSelected(e)){this.replaceSelection(e);return}let t=this.getKey(e);if(t==null)return;let n=new or(this.state.selectedKeys===`all`?this.getSelectAllKeys():this.state.selectedKeys);n.has(t)?n.delete(t):this.canSelectItem(t)&&(n.add(t),n.anchorKey=t,n.currentKey=t),!(this.disallowEmptySelection&&n.size===0)&&this.state.setSelectedKeys(n)}replaceSelection(e){if(this.selectionMode===`none`)return;let t=this.getKey(e);if(t==null)return;let n=this.canSelectItem(t)?new or([t],t,t):new or;this.state.setSelectedKeys(n)}setSelectedKeys(e){if(this.selectionMode===`none`)return;let t=new or;for(let n of e){let e=this.getKey(n);if(e!=null&&(t.add(e),this.selectionMode===`single`))break}this.state.setSelectedKeys(t)}getSelectAllKeys(){let e=[],t=n=>{for(;n!=null;){if(this.canSelectItem(n)){let r=this.collection.getItem(n);r?.type===`item`&&e.push(n),r?.hasChildNodes&&(this.allowsCellSelection||r.type!==`item`)&&t(yr(vr(r,this.collection))?.key??null)}n=this.collection.getKeyAfter(n)}};return t(this.collection.getFirstKey()),e}selectAll(){!this.isSelectAll&&this.selectionMode===`multiple`&&this.state.setSelectedKeys(`all`)}clearSelection(){!this.disallowEmptySelection&&(this.state.selectedKeys===`all`||this.state.selectedKeys.size>0)&&this.state.setSelectedKeys(new or)}toggleSelectAll(){this.isSelectAll?this.clearSelection():this.selectAll()}select(e,t){this.selectionMode!==`none`&&(this.selectionMode===`single`?this.isSelected(e)&&!this.disallowEmptySelection?this.toggleSelection(e):this.replaceSelection(e):this.selectionBehavior===`toggle`||t&&(t.pointerType===`touch`||t.pointerType===`virtual`)?this.toggleSelection(e):this.replaceSelection(e))}isSelectionEqual(e){if(e===this.state.selectedKeys)return!0;let t=this.selectedKeys;if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;for(let n of t)if(!e.has(n))return!1;return!0}canSelectItem(e){if(this.state.selectionMode===`none`||this.state.disabledKeys.has(e))return!1;let t=this.collection.getItem(e);return!(!t||t!=null&&t.props?.isDisabled||t.type===`cell`&&!this.allowsCellSelection)}isDisabled(e){var t;return this.state.disabledBehavior===`all`&&(this.state.disabledKeys.has(e)||!!((t=this.collection.getItem(e))!=null&&t.props?.isDisabled))}isLink(e){var t;return!!((t=this.collection.getItem(e))!=null&&t.props?.href)}getItemProps(e){return this.collection.getItem(e)?.props}withCollection(t){return new e(t,this.state,{allowsCellSelection:this.allowsCellSelection,layoutDelegate:this.layoutDelegate||void 0})}constructor(e,t,n){this.collection=e,this.state=t,this.allowsCellSelection=n?.allowsCellSelection??!1,this._isSelectAll=null,this.layoutDelegate=n?.layoutDelegate||null}},Er=new WeakMap,Dr=[];function Or(e,t=document.body){let n=new Set(e),r=new Set,i=e=>{for(let t of e.querySelectorAll(`[data-live-announcer], [data-react-aria-top-layer]`))n.add(t);let t=e=>{if(n.has(e)||e.parentElement&&r.has(e.parentElement)&&e.parentElement.getAttribute(`role`)!==`row`)return NodeFilter.FILTER_REJECT;for(let t of n)if(e.contains(t))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},i=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:t}),o=t(e);if(o===NodeFilter.FILTER_ACCEPT&&a(e),o!==NodeFilter.FILTER_REJECT){let e=i.nextNode();for(;e!=null;)a(e),e=i.nextNode()}},a=e=>{let t=Er.get(e)??0;e.getAttribute(`aria-hidden`)===`true`&&t===0||(t===0&&e.setAttribute(`aria-hidden`,`true`),r.add(e),Er.set(e,t+1))};Dr.length&&Dr[Dr.length-1].disconnect(),i(t);let o=new MutationObserver(e=>{for(let t of e){if(t.type!==`childList`||t.addedNodes.length===0)continue;if(![...n,...r].some(e=>e.contains(t.target))){for(let e of t.removedNodes)e instanceof Element&&(n.delete(e),r.delete(e));for(let e of t.addedNodes)(e instanceof HTMLElement||e instanceof SVGElement)&&(e.dataset.liveAnnouncer===`true`||e.dataset.reactAriaTopLayer===`true`)?n.add(e):e instanceof Element&&i(e)}}});o.observe(t,{childList:!0,subtree:!0});let s={visibleNodes:n,hiddenNodes:r,observe(){o.observe(t,{childList:!0,subtree:!0})},disconnect(){o.disconnect()}};return Dr.push(s),()=>{o.disconnect();for(let e of r){let t=Er.get(e);if(t==null)continue;t===1?(e.removeAttribute(`aria-hidden`),Er.delete(e)):Er.set(e,t-1)}s===Dr[Dr.length-1]?(Dr.pop(),Dr.length&&Dr[Dr.length-1].observe()):Dr.splice(Dr.indexOf(s),1)}}function kr(e){let t=Dr[Dr.length-1];if(t&&!t.visibleNodes.has(e))return t.visibleNodes.add(e),()=>{t.visibleNodes.delete(e)}}function Ar(e){let t=k(),[n,r]=ht(e,le.variantKeys),{ref:i,as:a,children:o,color:s=`default`,size:c=`md`,variant:l=`solid`,radius:u,isDisabled:d=!1,isIconOnly:f=!1,disableRipple:p=t?.disableRipple??!1,disableAnimation:m=t?.disableAnimation??!1,className:h,...g}=n,_=a||`div`,v=at(i),y=(0,I.useMemo)(()=>le({...r,className:h}),[mt(r),h]),b=(0,I.useMemo)(()=>({size:c,color:s,variant:l,radius:u,isIconOnly:f,isDisabled:d,disableAnimation:m,disableRipple:p,fullWidth:!!e?.fullWidth}),[c,s,l,u,d,f,m,p,e?.fullWidth]),x=(0,I.useCallback)(()=>({role:`group`,...g}),[g]);return{Component:_,children:o,domRef:v,context:b,classNames:y,getButtonGroupProps:x}}var jr=je((e,t)=>{let{Component:n,domRef:r,context:i,children:a,classNames:o,getButtonGroupProps:s}=Ar({...e,ref:t});return(0,B.jsx)(ee,{value:i,children:(0,B.jsx)(n,{ref:r,className:o,...s(),children:a})})});jr.displayName=`HeroUI.ButtonGroup`;var Mr=jr,[Nr,Pr]=At({name:`CardContext`,strict:!0,errorMessage:"useCardContext: `context` is undefined. Seems you forgot to wrap component within <Card />"}),Fr=je((e,t)=>{let{as:n,className:r,children:i,...a}=e,o=n||`div`,s=at(t),{slots:c,classNames:l}=Pr(),u=Be(l?.body,r);return(0,B.jsx)(o,{ref:s,className:c.body?.call(c,{class:u}),...a,children:i})});Fr.displayName=`HeroUI.CardBody`;var Ir=Fr;function Lr(e){let t=k(),[n,r]=ht(e,In.variantKeys),{ref:i,as:a,children:o,onClick:s,onPress:c,autoFocus:u,className:d,classNames:f,allowTextSelectionOnPress:p=!0,...m}=n,h=at(i),g=a||(e.isPressable?`button`:`div`),_=typeof g==`string`,v=e.disableAnimation??t?.disableAnimation??!1,y=e.disableRipple??t?.disableRipple??!1,b=Be(f?.base,d),{onClear:x,onPress:S,ripples:C}=se(),w=(0,I.useCallback)(e=>{y||v||h.current&&S(e)},[y,v,h,S]),{buttonProps:T,isPressed:D}=E({onPress:l(c,w),elementType:a,isDisabled:!e.isPressable,onClick:s,allowTextSelectionOnPress:p,...m},h),{hoverProps:O,isHovered:A}=lt({isDisabled:!e.isHoverable,...m}),{isFocusVisible:j,isFocused:ee,focusProps:te}=We({autoFocus:u}),M=(0,I.useMemo)(()=>In({...r,disableAnimation:v}),[mt(r),v]),ne=(0,I.useMemo)(()=>({slots:M,classNames:f,disableAnimation:v,isDisabled:e.isDisabled,isFooterBlurred:e.isFooterBlurred,fullWidth:e.fullWidth}),[M,f,e.isDisabled,e.isFooterBlurred,v,e.fullWidth]),re=(0,I.useCallback)((t={})=>({ref:h,className:M.base({class:b}),tabIndex:e.isPressable?0:-1,"data-hover":F(A),"data-pressed":F(D),"data-focus":F(ee),"data-focus-visible":F(j),"data-disabled":F(e.isDisabled),...Qe(e.isPressable?{...T,...te,role:`button`}:{},e.isHoverable?O:{},we(m,{enabled:_}),we(t))}),[h,M,b,_,e.isPressable,e.isHoverable,e.isDisabled,A,D,j,T,te,O,m]),ie=(0,I.useCallback)(()=>({ripples:C,onClear:x}),[C,x]);return{context:ne,domRef:h,Component:g,classNames:f,children:o,isHovered:A,isPressed:D,disableAnimation:v,isPressable:e.isPressable,isHoverable:e.isHoverable,disableRipple:y,handlePress:w,isFocusVisible:j,getCardProps:re,getRippleProps:ie}}var Rr=je((e,t)=>{let{children:n,context:r,Component:i,isPressable:a,disableAnimation:o,disableRipple:s,getCardProps:c,getRippleProps:l}=Lr({...e,ref:t});return(0,B.jsxs)(i,{...c(),children:[(0,B.jsx)(Nr,{value:r,children:n}),a&&!o&&!s&&(0,B.jsx)(b,{...l()})]})});Rr.displayName=`HeroUI.Card`;var zr=Rr,Br={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},Vr={...Br,customError:!0,valid:!1},Hr={isInvalid:!1,validationDetails:Br,validationErrors:[]},Ur=(0,I.createContext)({}),Wr=`__formValidationState`+Date.now();function Gr(e){if(e[Wr]){let{realtimeValidation:t,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}=e[Wr];return{realtimeValidation:t,displayValidation:n,updateValidation:r,resetValidation:i,commitValidation:a}}return Kr(e)}function Kr(e){let{isInvalid:t,validationState:n,name:r,value:i,builtinValidation:a,validate:o,validationBehavior:s=`aria`}=e;n&&(t||=n===`invalid`);let c=t===void 0?null:{isInvalid:t,validationErrors:[],validationDetails:Vr},l=(0,I.useMemo)(()=>{if(!o||i==null)return null;let e=Jr(o,i);return Yr(e)},[o,i]);a?.validationDetails.valid&&(a=void 0);let u=(0,I.useContext)(Ur),d=(0,I.useMemo)(()=>r?Array.isArray(r)?r.flatMap(e=>qr(u[e])):qr(u[r]):[],[u,r]),[f,p]=(0,I.useState)(u),[m,h]=(0,I.useState)(!1);u!==f&&(p(u),h(!1));let g=(0,I.useMemo)(()=>Yr(m?[]:d),[m,d]),_=(0,I.useRef)(Hr),[v,y]=(0,I.useState)(Hr),b=(0,I.useRef)(Hr),x=()=>{if(!S)return;C(!1);let e=l||a||_.current;Xr(e,b.current)||(b.current=e,y(e))},[S,C]=(0,I.useState)(!1);return(0,I.useEffect)(x),{realtimeValidation:c||g||l||a||Hr,displayValidation:s===`native`?c||g||v:c||g||l||a||v,updateValidation(e){s===`aria`&&!Xr(v,e)?y(e):_.current=e},resetValidation(){let e=Hr;Xr(e,b.current)||(b.current=e,y(e)),s===`native`&&C(!1),h(!0)},commitValidation(){s===`native`&&C(!0),h(!0)}}}function qr(e){return e?Array.isArray(e)?e:[e]:[]}function Jr(e,t){if(typeof e==`function`){let n=e(t);if(n&&typeof n!=`boolean`)return qr(n)}return[]}function Yr(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:Vr}:null}function Xr(e,t){return e===t?!0:!!e&&!!t&&e.isInvalid===t.isInvalid&&e.validationErrors.length===t.validationErrors.length&&e.validationErrors.every((e,n)=>e===t.validationErrors[n])&&Object.entries(e.validationDetails).every(([e,n])=>t.validationDetails[e]===n)}function Zr(e,t,n){let{validationBehavior:r,focus:i}=e;C(()=>{if(r===`native`&&n?.current&&!n.current.disabled){let e=t.realtimeValidation.isInvalid?t.realtimeValidation.validationErrors.join(` `)||`Invalid value.`:``;n.current.setCustomValidity(e),n.current.hasAttribute(`title`)||(n.current.title=``),t.realtimeValidation.isInvalid||t.updateValidation($r(n.current))}});let a=(0,I.useRef)(!1),o=be(()=>{a.current||t.resetValidation()}),s=be(e=>{t.displayValidation.isInvalid||t.commitValidation();let r=n?.current?.form;if(!e.defaultPrevented&&n&&r&&ei(r)===n.current){var a;i?i():(a=n.current)==null||a.focus(),zt(`keyboard`)}e.preventDefault()}),c=be(()=>{t.commitValidation()});(0,I.useEffect)(()=>{let e=n?.current;if(!e)return;let t=e.form,r=t?.reset;return t&&(t.reset=()=>{a.current=!window.event||window.event.type===`message`&&window.event.target instanceof MessagePort,r?.call(t),a.current=!1}),e.addEventListener(`invalid`,s),e.addEventListener(`change`,c),t?.addEventListener(`reset`,o),()=>{e.removeEventListener(`invalid`,s),e.removeEventListener(`change`,c),t?.removeEventListener(`reset`,o),t&&(t.reset=r)}},[n,s,c,o,r])}function Qr(e){let t=e.validity;return{badInput:t.badInput,customError:t.customError,patternMismatch:t.patternMismatch,rangeOverflow:t.rangeOverflow,rangeUnderflow:t.rangeUnderflow,stepMismatch:t.stepMismatch,tooLong:t.tooLong,tooShort:t.tooShort,typeMismatch:t.typeMismatch,valueMissing:t.valueMissing,valid:t.valid}}function $r(e){return{isInvalid:!e.validity.valid,validationDetails:Qr(e),validationErrors:e.validationMessage?[e.validationMessage]:[]}}function ei(e){for(let t=0;t<e.elements.length;t++){let n=e.elements[t];if(!n.validity.valid)return n}return null}function ti(e){let{id:t,label:n,"aria-labelledby":r,"aria-label":i,labelElementType:a=`label`}=e;t=_e(t);let o=_e(),s={};n&&(r=r?`${o} ${r}`:o,s={id:o,htmlFor:a===`label`?t:void 0});let c=_({id:t,"aria-label":i,"aria-labelledby":r});return{labelProps:s,fieldProps:c}}function ni(e){let{description:t,errorMessage:n,isInvalid:r,validationState:i}=e,{labelProps:a,fieldProps:o}=ti(e),s=T([!!t,!!n,r,i]),c=T([!!t,!!n,r,i]);return o=te(o,{"aria-describedby":[s,c,e[`aria-describedby`]].filter(Boolean).join(` `)||void 0}),{labelProps:a,fieldProps:o,descriptionProps:{id:s},errorMessageProps:{id:c}}}var ri=Symbol(`default`);function ii(e){let t=(0,I.useRef)(null),n=(0,I.useRef)(void 0),r=(0,I.useCallback)(t=>{if(typeof e==`function`){let n=e,r=n(t);return()=>{typeof r==`function`?r():n(null)}}else if(e)return e.current=t,()=>{e.current=null}},[e]);return(0,I.useMemo)(()=>({get current(){return t.current},set current(e){t.current=e,n.current&&=(n.current(),void 0),e!=null&&(n.current=r(e))}}),[r])}function ai(e,t){let n=(0,I.useContext)(e);if(t===null)return null;if(n&&typeof n==`object`&&`slots`in n&&n.slots){let e=new Intl.ListFormat().format(Object.keys(n.slots).map(e=>`"${e}"`));if(!t&&!n.slots[ri])throw Error(`A slot prop is required. Valid slot names are ${e}.`);let r=t||ri;if(!n.slots[r])throw Error(`Invalid slot "${t}". Valid slot names are ${e}.`);return n.slots[r]}return n}function oi(e,t,n){let{ref:r,...i}=ai(n,e.slot)||{},a=ii((0,I.useMemo)(()=>Ae(t,r),[t,r])),o=Qe(i,e);return`style`in i&&i.style&&`style`in e&&e.style&&(typeof i.style==`function`||typeof e.style==`function`?o.style=t=>{let n=typeof i.style==`function`?i.style(t):i.style,r={...t.defaultStyle,...n},a=typeof e.style==`function`?e.style({...t,defaultStyle:r}):e.style;return{...r,...a}}:o.style={...i.style,...e.style}),[o,a]}var si=(0,I.createContext)(null),ci=(0,I.forwardRef)(function(e,t){[e,t]=oi(e,t,si);let{validationErrors:n,validationBehavior:r=`native`,children:i,className:a,...o}=e,s=(0,I.useMemo)(()=>Fn({className:a}),[a]);return(0,B.jsx)(`form`,{noValidate:r!==`native`,...o,ref:t,className:s,children:(0,B.jsx)(si.Provider,{value:{...e,validationBehavior:r},children:(0,B.jsx)(Ur.Provider,{value:n??{},children:i})})})}),li=(0,I.forwardRef)(function(e,t){let n=k(),r=e.validationBehavior??n?.validationBehavior??`native`;return(0,B.jsx)(ci,{...e,ref:t,validationBehavior:r})}),ui=e=>typeof e==`object`&&!!e&&e.nodeType===1,di=(e,t)=>(!t||e!==`hidden`)&&e!==`visible`&&e!==`clip`,fi=(e,t)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){let n=getComputedStyle(e,null);return di(n.overflowY,t)||di(n.overflowX,t)||(e=>{let t=(e=>{if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch{return null}})(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)})(e)}return!1},pi=(e,t,n,r,i,a,o,s)=>a<e&&o>t||a>e&&o<t?0:a<=e&&s<=n||o>=t&&s>=n?a-e-r:o>t&&s<n||a<e&&s>n?o-t+i:0,mi=e=>e.parentElement??(e.getRootNode().host||null),hi=(e,t)=>{if(typeof document>`u`)return[];let{scrollMode:n,block:r,inline:i,boundary:a,skipOverflowHiddenElements:o}=t,s=typeof a==`function`?a:e=>e!==a;if(!ui(e))throw TypeError(`Invalid target`);let c=document.scrollingElement||document.documentElement,l=[],u=e;for(;ui(u)&&s(u);){if(u=mi(u),u===c){l.push(u);break}u!=null&&u===document.body&&fi(u)&&!fi(document.documentElement)||u!=null&&fi(u,o)&&l.push(u)}let d=window.visualViewport?.width??innerWidth,f=window.visualViewport?.height??innerHeight,{scrollX:p,scrollY:m}=window,{height:h,width:g,top:_,right:v,bottom:y,left:b}=e.getBoundingClientRect(),{top:x,right:S,bottom:C,left:w}=(e=>{let t=window.getComputedStyle(e);return{top:parseFloat(t.scrollMarginTop)||0,right:parseFloat(t.scrollMarginRight)||0,bottom:parseFloat(t.scrollMarginBottom)||0,left:parseFloat(t.scrollMarginLeft)||0}})(e),T=r===`start`||r===`nearest`?_-x:r===`end`?y+C:_+h/2-x+C,E=i===`center`?b+g/2-w+S:i===`end`?v+S:b-w,D=[];for(let e=0;e<l.length;e++){let t=l[e],{height:a,width:o,top:s,right:u,bottom:x,left:S}=t.getBoundingClientRect();if(n===`if-needed`&&_>=0&&b>=0&&y<=f&&v<=d&&(t===c&&!fi(t)||_>=s&&y<=x&&b>=S&&v<=u))return D;let C=getComputedStyle(t),w=parseInt(C.borderLeftWidth,10),O=parseInt(C.borderTopWidth,10),k=parseInt(C.borderRightWidth,10),A=parseInt(C.borderBottomWidth,10),j=0,ee=0,te=`offsetWidth`in t?t.offsetWidth-t.clientWidth-w-k:0,M=`offsetHeight`in t?t.offsetHeight-t.clientHeight-O-A:0,ne=`offsetWidth`in t?t.offsetWidth===0?0:o/t.offsetWidth:0,re=`offsetHeight`in t?t.offsetHeight===0?0:a/t.offsetHeight:0;if(c===t)j=r===`start`?T:r===`end`?T-f:r===`nearest`?pi(m,m+f,f,O,A,m+T,m+T+h,h):T-f/2,ee=i===`start`?E:i===`center`?E-d/2:i===`end`?E-d:pi(p,p+d,d,w,k,p+E,p+E+g,g),j=Math.max(0,j+m),ee=Math.max(0,ee+p);else{j=r===`start`?T-s-O:r===`end`?T-x+A+M:r===`nearest`?pi(s,x,a,O,A+M,T,T+h,h):T-(s+a/2)+M/2,ee=i===`start`?E-S-w:i===`center`?E-(S+o/2)+te/2:i===`end`?E-u+k+te:pi(S,u,o,w,k+te,E,E+g,g);let{scrollLeft:e,scrollTop:n}=t;j=re===0?0:Math.max(0,Math.min(n+j/re,t.scrollHeight-a/re+M)),ee=ne===0?0:Math.max(0,Math.min(e+ee/ne,t.scrollWidth-o/ne+te)),T+=n-j,E+=e-ee}D.push({el:t,top:j,left:ee})}return D},gi=e=>!1===e?{block:`end`,inline:`nearest`}:(e=>e===Object(e)&&Object.keys(e).length!==0)(e)?e:{block:`start`,inline:`nearest`};function _i(e,t){if(!e.isConnected||!(e=>{let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1})(e))return;if((e=>typeof e==`object`&&typeof e.behavior==`function`)(t))return t.behavior(hi(e,t));let n=typeof t==`boolean`||t==null?void 0:t.behavior;for(let{el:r,top:i,left:a}of hi(e,gi(t)))r.scroll({top:i,left:a,behavior:n})}var vi=je((e,t)=>{let{Component:n,children:r,startContent:i,endContent:a,thumbIcon:o,getBaseProps:s,getInputProps:c,getWrapperProps:l,getThumbProps:u,getThumbIconProps:d,getLabelProps:f,getStartContentProps:p,getEndContentProps:m}=g({...e,ref:t}),h=typeof o==`function`?o(d({includeStateProps:!0})):o&&(0,I.cloneElement)(o,d()),_=i&&(0,I.cloneElement)(i,p()),v=a&&(0,I.cloneElement)(a,m());return(0,B.jsxs)(n,{...s(),children:[(0,B.jsx)(`input`,{...c()}),(0,B.jsxs)(`span`,{...l(),children:[i&&_,(0,B.jsx)(`span`,{...u(),children:o&&h}),a&&v]}),r&&(0,B.jsx)(`span`,{...f(),children:r})]})});vi.displayName=`HeroUI.Switch`;var yi=vi;function bi(e={}){let{rerender:t=!1,delay:n=0}=e,r=(0,I.useRef)(!1),[i,a]=(0,I.useState)(!1);return(0,I.useEffect)(()=>{r.current=!0;let e=null;return t&&(n>0?e=setTimeout(()=>{a(!0)},n):a(!0)),()=>{r.current=!1,t&&a(!1),e&&clearTimeout(e)}},[t]),[(0,I.useCallback)(()=>r.current,[]),i]}function xi(e,t){let{inputElementType:n=`input`,isDisabled:r=!1,isRequired:i=!1,isReadOnly:a=!1,type:o=`text`,validationBehavior:s=`aria`}=e,[c,l]=Ft(e.value,e.defaultValue||``,e.onChange),{focusableProps:u}=qe(e,t),d=Gr({...e,value:c}),{isInvalid:f,validationErrors:m,validationDetails:h}=d.displayValidation,{labelProps:g,fieldProps:_,descriptionProps:v,errorMessageProps:y}=ni({...e,isInvalid:f,errorMessage:e.errorMessage||m}),b=D(e,{labelable:!0}),x={type:o,pattern:e.pattern},[S]=(0,I.useState)(c);return he(t,e.defaultValue??S,l),Zr(e,d,t),(0,I.useEffect)(()=>{if(t.current instanceof p(t.current).HTMLTextAreaElement){let e=t.current;Object.defineProperty(e,`defaultValue`,{get:()=>e.value,set:()=>{},configurable:!0})}},[t]),{labelProps:g,inputProps:te(b,n===`input`?x:void 0,{disabled:r,readOnly:a,required:i&&s===`native`,"aria-required":i&&s===`aria`||void 0,"aria-invalid":f||void 0,"aria-errormessage":e[`aria-errormessage`],"aria-activedescendant":e[`aria-activedescendant`],"aria-autocomplete":e[`aria-autocomplete`],"aria-haspopup":e[`aria-haspopup`],"aria-controls":e[`aria-controls`],value:c,onChange:e=>l(e.target.value),autoComplete:e.autoComplete,autoCapitalize:e.autoCapitalize,maxLength:e.maxLength,minLength:e.minLength,name:e.name,form:e.form,placeholder:e.placeholder,inputMode:e.inputMode,autoCorrect:e.autoCorrect,spellCheck:e.spellCheck,enterKeyHint:e.enterKeyHint,onCopy:e.onCopy,onCut:e.onCut,onPaste:e.onPaste,onCompositionEnd:e.onCompositionEnd,onCompositionStart:e.onCompositionStart,onCompositionUpdate:e.onCompositionUpdate,onSelect:e.onSelect,onBeforeInput:e.onBeforeInput,onInput:e.onInput,...u,..._}),descriptionProps:v,errorMessageProps:y,isInvalid:f,validationErrors:m,validationDetails:h}}function Si(e){let t=k(),{validationBehavior:n}=ai(si)||{},[r,i]=ht(e,jn.variantKeys),{ref:a,as:o,type:s,label:c,baseRef:u,wrapperRef:d,description:f,className:p,classNames:m,autoFocus:h,startContent:g,endContent:_,onClear:v,onChange:y,validationState:b,validationBehavior:x=n??t?.validationBehavior??`native`,innerWrapperRef:S,onValueChange:C=()=>{},...w}=r,T=(0,I.useCallback)(e=>{C(e??``)},[C]),[E,D]=(0,I.useState)(!1),O=o||`div`,A=e.disableAnimation??t?.disableAnimation??!1,j=at(a),ee=at(u),te=at(d),M=at(S),[ne,re]=Ft(r.value,r.defaultValue??``,T),ie=s===`file`,ae=(j?.current?.files?.length??0)>0,oe=[`date`,`time`,`month`,`week`,`range`].includes(s),se=!St(ne)||oe||ae,ce=se||E,le=s===`hidden`,N=e.isMultiline,de=Be(m?.base,p,se?`is-filled`:``),fe=(0,I.useCallback)(()=>{var e;ie?j.current.value=``:re(``),v?.(),(e=j.current)==null||e.focus()},[re,v,ie]);ue(()=>{j.current&&re(j.current.value)},[j.current]);let{labelProps:pe,inputProps:me,isInvalid:he,validationErrors:ge,validationDetails:_e,descriptionProps:ve,errorMessageProps:P}=xi({...e,validationBehavior:x,autoCapitalize:e.autoCapitalize,value:ne,"aria-label":e.label?e[`aria-label`]:Fe(e[`aria-label`],e.placeholder),inputElementType:N?`textarea`:`input`,onChange:re},j);ie&&(delete me.value,delete me.onChange);let{isFocusVisible:ye,isFocused:be,focusProps:xe}=We({autoFocus:h,isTextInput:!0}),{isHovered:Se,hoverProps:Ce}=lt({isDisabled:!!e?.isDisabled}),{isHovered:Te,hoverProps:Ee}=lt({isDisabled:!!e?.isDisabled}),{focusProps:De,isFocusVisible:Oe}=We(),{focusWithinProps:ke}=Xe({onFocusWithinChange:D}),{pressProps:Ae}=Lt({isDisabled:!!e?.isDisabled||!!e?.isReadOnly,onPress:fe}),je=b===`invalid`||he,Me=On({labelPlacement:e.labelPlacement,label:c}),Ne=typeof r.errorMessage==`function`?r.errorMessage({isInvalid:je,validationErrors:ge,validationDetails:_e}):r.errorMessage||ge?.join(` `),Pe=!!v||e.isClearable,Ie=!!c||!!f||!!Ne,Le=!!r.placeholder,Re=!!c,ze=!!f||!!Ne,Ve=Me===`outside-left`,He=Me===`outside-top`,Ue=Me===`outside`||Ve||He,Ge=Me===`inside`,Ke=j.current?(!j.current.value||j.current.value===``||!ne||ne===``)&&Le:!1,qe=!!g,Je=Ue?Ve||He||Le||Me===`outside`&&qe:!1,Ye=Me===`outside`&&!Le&&!qe,Ze=(0,I.useMemo)(()=>jn({...i,isInvalid:je,labelPlacement:Me,isClearable:Pe,disableAnimation:A}),[mt(i),je,Me,Pe,qe,A]),$e=(0,I.useCallback)((t={})=>({ref:ee,className:Ze.base({class:de}),"data-slot":`base`,"data-filled":F(se||Le||qe||Ke||ie),"data-filled-within":F(ce||Le||qe||Ke||ie),"data-focus-within":F(E),"data-focus-visible":F(ye),"data-readonly":F(e.isReadOnly),"data-focus":F(be),"data-hover":F(Se||Te),"data-required":F(e.isRequired),"data-invalid":F(je),"data-disabled":F(e.isDisabled),"data-has-elements":F(Ie),"data-has-helper":F(ze),"data-has-label":F(Re),"data-has-value":F(!Ke),"data-hidden":F(le),...ke,...t}),[Ze,de,se,be,Se,Te,je,ze,Re,Ie,Ke,qe,E,ye,ce,Le,ke,le,e.isReadOnly,e.isRequired,e.isDisabled]),et=(0,I.useCallback)((e={})=>({"data-slot":`label`,className:Ze.label({class:m?.label}),...Qe(pe,Ee,e)}),[Ze,Te,pe,m?.label]),tt=(0,I.useCallback)(t=>{t.key===`Escape`&&ne&&(Pe||v)&&!e.isReadOnly&&(re(``),v?.())},[ne,re,v,Pe,e.isReadOnly]),nt=(0,I.useCallback)((t={})=>({"data-slot":`input`,"data-filled":F(se),"data-filled-within":F(ce),"data-has-start-content":F(qe),"data-has-end-content":F(!!_),"data-type":s,className:Ze.input({class:Be(m?.input,se?`is-filled`:``,N?`pe-0`:``,s===`password`?`[&::-ms-reveal]:hidden`:``)}),...Qe(xe,me,we(w,{enabled:!0,labelable:!0,omitEventNames:new Set(Object.keys(me))}),t),"aria-readonly":F(e.isReadOnly),onChange:l(me.onChange,y),onKeyDown:l(me.onKeyDown,t.onKeyDown,tt),ref:j}),[Ze,ne,xe,me,w,se,ce,qe,_,m?.input,e.isReadOnly,e.isRequired,y,tt]),rt=(0,I.useCallback)((e={})=>({ref:te,"data-slot":`input-wrapper`,"data-hover":F(Se||Te),"data-focus-visible":F(ye),"data-focus":F(be),className:Ze.inputWrapper({class:Be(m?.inputWrapper,se?`is-filled`:``)}),...Qe(e,Ce),onClick:e=>{j.current&&e.currentTarget===e.target&&j.current.focus()},style:{cursor:`text`,...e.style}}),[Ze,Se,Te,ye,be,ne,m?.inputWrapper]),it=(0,I.useCallback)((e={})=>({...e,ref:M,"data-slot":`inner-wrapper`,onClick:e=>{j.current&&e.currentTarget===e.target&&j.current.focus()},className:Ze.innerWrapper({class:Be(m?.innerWrapper,e?.className)})}),[Ze,m?.innerWrapper]),ot=(0,I.useCallback)((e={})=>({...e,"data-slot":`main-wrapper`,className:Ze.mainWrapper({class:Be(m?.mainWrapper,e?.className)})}),[Ze,m?.mainWrapper]),st=(0,I.useCallback)((e={})=>({...e,"data-slot":`helper-wrapper`,className:Ze.helperWrapper({class:Be(m?.helperWrapper,e?.className)})}),[Ze,m?.helperWrapper]),ct=(0,I.useCallback)((e={})=>({...e,...ve,"data-slot":`description`,className:Ze.description({class:Be(m?.description,e?.className)})}),[Ze,m?.description]),ut=(0,I.useCallback)((e={})=>({...e,...P,"data-slot":`error-message`,className:Ze.errorMessage({class:Be(m?.errorMessage,e?.className)})}),[Ze,P,m?.errorMessage]),dt=(0,I.useCallback)((t={})=>({...t,type:`button`,tabIndex:-1,disabled:e.isDisabled,"aria-label":`clear input`,"data-slot":`clear-button`,"data-focus-visible":F(Oe),className:Ze.clearButton({class:Be(m?.clearButton,t?.className)}),...Qe(Ae,De)}),[Ze,Oe,Ae,De,m?.clearButton]);return{Component:O,classNames:m,domRef:j,label:c,description:f,startContent:g,endContent:_,labelPlacement:Me,isClearable:Pe,hasHelper:ze,hasStartContent:qe,isLabelOutside:Je,isOutsideLeft:Ve,isOutsideTop:He,isLabelOutsideAsPlaceholder:Ye,shouldLabelBeOutside:Ue,shouldLabelBeInside:Ge,hasPlaceholder:Le,isInvalid:je,errorMessage:Ne,getBaseProps:$e,getLabelProps:et,getInputProps:nt,getMainWrapperProps:ot,getInputWrapperProps:rt,getInnerWrapperProps:it,getHelperWrapperProps:st,getDescriptionProps:ct,getErrorMessageProps:ut,getClearButtonProps:dt}}var Ci=je((e,t)=>{let{Component:n,label:r,description:i,isClearable:a,startContent:o,endContent:s,labelPlacement:c,hasHelper:l,isOutsideLeft:u,isOutsideTop:d,shouldLabelBeOutside:f,errorMessage:p,isInvalid:m,getBaseProps:h,getLabelProps:g,getInputProps:_,getInnerWrapperProps:v,getInputWrapperProps:y,getMainWrapperProps:b,getHelperWrapperProps:x,getDescriptionProps:S,getErrorMessageProps:C,getClearButtonProps:w}=Si({...e,ref:t}),T=r?(0,B.jsx)(`label`,{...g(),children:r}):null,E=(0,I.useMemo)(()=>a?(0,B.jsx)(`button`,{...w(),children:s||(0,B.jsx)(O,{})}):s,[a,w]),D=(0,I.useMemo)(()=>{let e=m&&p;return!l||!(e||i)?null:(0,B.jsx)(`div`,{...x(),children:e?(0,B.jsx)(`div`,{...C(),children:p}):(0,B.jsx)(`div`,{...S(),children:i})})},[l,m,p,i,x,C,S]),k=(0,I.useMemo)(()=>(0,B.jsxs)(`div`,{...v(),children:[o,(0,B.jsx)(`input`,{..._()}),E]}),[o,E,_,v]),A=(0,I.useMemo)(()=>f?(0,B.jsxs)(`div`,{...b(),children:[(0,B.jsxs)(`div`,{...y(),children:[!u&&!d?T:null,k]}),D]}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(`div`,{...y(),children:[T,k]}),D]}),[c,D,f,T,k,p,i,b,y,C,S]);return(0,B.jsxs)(n,{...h(),children:[u||d?T:null,A]})});Ci.displayName=`HeroUI.Input`;var wi=Ci;function Ti(){return Ti=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ti.apply(null,arguments)}function Ei(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Di=I.useLayoutEffect,Oi=function(e){var t=I.useRef(e);return Di(function(){t.current=e}),t},ki=function(e,t){if(typeof e==`function`){e(t);return}e.current=t},Ai=function(e,t){var n=I.useRef();return I.useCallback(function(r){e.current=r,n.current&&ki(n.current,null),n.current=t,t&&ki(t,r)},[t])},ji={"min-height":`0`,"max-height":`none`,height:`0`,visibility:`hidden`,overflow:`hidden`,position:`absolute`,"z-index":`-1000`,top:`0`,right:`0`,display:`block`},Mi=function(e){Object.keys(ji).forEach(function(t){e.style.setProperty(t,ji[t],`important`)})},Ni=null,Pi=function(e,t){var n=e.scrollHeight;return t.sizingStyle.boxSizing===`border-box`?n+t.borderSize:n-t.paddingSize};function Fi(e,t,n,r){n===void 0&&(n=1),r===void 0&&(r=1/0),Ni||(Ni=document.createElement(`textarea`),Ni.setAttribute(`tabindex`,`-1`),Ni.setAttribute(`aria-hidden`,`true`),Mi(Ni)),Ni.parentNode===null&&document.body.appendChild(Ni);var i=e.paddingSize,a=e.borderSize,o=e.sizingStyle,s=o.boxSizing;Object.keys(o).forEach(function(e){var t=e;Ni.style[t]=o[t]}),Mi(Ni),Ni.value=t;var c=Pi(Ni,e);Ni.value=t,c=Pi(Ni,e),Ni.value=`x`;var l=Ni.scrollHeight-i,u=l*n;s===`border-box`&&(u=u+i+a),c=Math.max(u,c);var d=l*r;return s===`border-box`&&(d=d+i+a),c=Math.min(d,c),[c,l]}var Ii=function(){},Li=function(e,t){return e.reduce(function(e,n){return e[n]=t[n],e},{})},Ri=[`borderBottomWidth`,`borderLeftWidth`,`borderRightWidth`,`borderTopWidth`,`boxSizing`,`fontFamily`,`fontSize`,`fontStyle`,`fontWeight`,`letterSpacing`,`lineHeight`,`paddingBottom`,`paddingLeft`,`paddingRight`,`paddingTop`,`tabSize`,`textIndent`,`textRendering`,`textTransform`,`width`,`wordBreak`,`wordSpacing`,`scrollbarGutter`],zi=!!document.documentElement.currentStyle,Bi=function(e){var t=window.getComputedStyle(e);if(t===null)return null;var n=Li(Ri,t),r=n.boxSizing;if(r===``)return null;zi&&r===`border-box`&&(n.width=parseFloat(n.width)+parseFloat(n.borderRightWidth)+parseFloat(n.borderLeftWidth)+parseFloat(n.paddingRight)+parseFloat(n.paddingLeft)+`px`);var i=parseFloat(n.paddingBottom)+parseFloat(n.paddingTop),a=parseFloat(n.borderBottomWidth)+parseFloat(n.borderTopWidth);return{sizingStyle:n,paddingSize:i,borderSize:a}};function Vi(e,t,n){var r=Oi(n);I.useLayoutEffect(function(){var n=function(e){return r.current(e)};if(e)return e.addEventListener(t,n),function(){return e.removeEventListener(t,n)}},[])}var Hi=function(e,t){Vi(document.body,`reset`,function(n){e.current.form===n.target&&t(n)})},Ui=function(e){Vi(window,`resize`,e)},Wi=function(e){Vi(document.fonts,`loadingdone`,e)},Gi=[`cacheMeasurements`,`maxRows`,`minRows`,`onChange`,`onHeightChange`],Ki=I.forwardRef(function(e,t){var n=e.cacheMeasurements,r=e.maxRows,i=e.minRows,a=e.onChange,o=a===void 0?Ii:a,s=e.onHeightChange,c=s===void 0?Ii:s,l=Ei(e,Gi),u=l.value!==void 0,d=I.useRef(null),f=Ai(d,t),p=I.useRef(0),m=I.useRef(),h=function(){var e=d.current,t=n&&m.current?m.current:Bi(e);if(t){m.current=t;var a=Fi(t,e.value||e.placeholder||`x`,i,r),o=a[0],s=a[1];p.current!==o&&(p.current=o,e.style.setProperty(`height`,o+`px`,`important`),c(o,{rowHeight:s}))}};return I.useLayoutEffect(h),Hi(d,function(){if(!u){var e=d.current.value;requestAnimationFrame(function(){var t=d.current;t&&e!==t.value&&h()})}}),Ui(h),Wi(h),I.createElement(`textarea`,Ti({},l,{onChange:function(e){u||h(),o(e)},ref:f}))}),qi=je(({style:e,minRows:t=3,maxRows:n=8,cacheMeasurements:r=!1,disableAutosize:i=!1,onHeightChange:a,...o},s)=>{let{Component:c,label:l,description:u,startContent:d,endContent:f,hasHelper:p,shouldLabelBeOutside:m,shouldLabelBeInside:h,isInvalid:g,errorMessage:_,getBaseProps:v,getLabelProps:y,getInputProps:b,getInnerWrapperProps:x,getInputWrapperProps:S,getHelperWrapperProps:C,getDescriptionProps:w,getErrorMessageProps:T,isClearable:E,getClearButtonProps:D}=Si({...o,ref:s,isMultiline:!0}),[k,A]=(0,I.useState)(t>1),[j,ee]=(0,I.useState)(!1),te=l?(0,B.jsx)(`label`,{...y(),children:l}):null,M=b(),ne=(e,r)=>{if(t===1&&A(e>=r.rowHeight*2),n>t){let t=e>=n*r.rowHeight;ee(t)}a?.(e,r)},re=i?(0,B.jsx)(`textarea`,{...M,style:Qe(M.style,e??{})}):(0,B.jsx)(Ki,{...M,cacheMeasurements:r,"data-hide-scroll":F(!j),maxRows:n,minRows:t,style:Qe(M.style,e??{}),onHeightChange:ne}),ie=(0,I.useMemo)(()=>E?(0,B.jsx)(`button`,{...D(),children:(0,B.jsx)(O,{})}):null,[E,D]),ae=(0,I.useMemo)(()=>d||f?(0,B.jsxs)(`div`,{...x(),children:[d,re,f]}):(0,B.jsx)(`div`,{...x(),children:re}),[d,M,f,x]),oe=g&&_,se=oe||u;return(0,B.jsxs)(c,{...v(),children:[m?te:null,(0,B.jsxs)(`div`,{...S(),"data-has-multiple-rows":F(k),children:[h?te:null,ae,ie]}),p&&se?(0,B.jsx)(`div`,{...C(),children:oe?(0,B.jsx)(`div`,{...T(),children:_}):(0,B.jsx)(`div`,{...w(),children:u})}):null]})});qi.displayName=`HeroUI.Textarea`;var Ji=qi;function Yi(e,t){let{groupRef:n,triggerRef:r,popoverRef:i,showArrow:a,offset:o=7,crossOffset:s=0,scrollRef:c,shouldFlip:l,boundaryElement:u,isDismissable:d=!0,shouldCloseOnBlur:f=!0,shouldCloseOnScroll:p=!0,placement:m=`top`,containerPadding:h,shouldCloseOnInteractOutside:g,isNonModal:_,isKeyboardDismissDisabled:v,updatePositionDeps:y=[],...b}=e,x=_??!0,S=b.trigger===`SubmenuTrigger`,{overlayProps:C,underlayProps:T}=nt({isOpen:t.isOpen,onClose:t.close,shouldCloseOnBlur:f,isDismissable:d||S,isKeyboardDismissDisabled:v,shouldCloseOnInteractOutside:g||(e=>!r.current?.contains(e)),disableOutsideEvents:!x},i),{overlayProps:E,arrowProps:D,placement:O,updatePosition:k,triggerAnchorPoint:A}=pe({...b,shouldFlip:l,crossOffset:s,targetRef:r,overlayRef:i,isOpen:t.isOpen,scrollRef:c,boundaryElement:u,containerPadding:h,placement:w(m),offset:a?o+3:o,onClose:x&&!S&&p?t.close:()=>{}});return ue(()=>{y.length&&k()},y),(0,I.useEffect)(()=>{if(t.isOpen&&i.current)return x?kr(n?.current??i.current):Or([n?.current??i.current])},[x,t.isOpen,i,n]),{popoverProps:Qe(C,E),arrowProps:D,underlayProps:T,placement:O,triggerAnchorPoint:A}}var Xi=`top`;function Zi(e){let t=k(),[n,r]=ht(e,Ve.variantKeys),{as:i,ref:a,children:o,state:s,triggerRef:c,scrollRef:l,defaultOpen:d,onOpenChange:p,isOpen:m,isNonModal:h=!0,shouldFlip:g=!0,containerPadding:_=12,shouldBlockScroll:v=!1,isDismissable:y=!0,shouldCloseOnBlur:b,portalContainer:x,updatePositionDeps:S,dialogProps:C,placement:w=Xi,triggerType:T=`dialog`,showArrow:E=!1,offset:D=7,crossOffset:O=0,boundaryElement:A,isKeyboardDismissDisabled:j,shouldCloseOnInteractOutside:ee,shouldCloseOnScroll:te,triggerAnchorPoint:M,motionProps:ne,className:re,classNames:ie,onClose:ae,...oe}=n,se=i||`div`,ce=at(a),le=(0,I.useRef)(null),N=(0,I.useRef)(!1),ue=c||le,de=e.disableAnimation??t?.disableAnimation??!1,fe=u({isOpen:m,defaultOpen:d,onOpenChange:e=>{p?.(e),e||ae?.()}}),pe=s||fe,{popoverProps:me,underlayProps:he,placement:ge}=Yi({triggerRef:ue,isNonModal:h,popoverRef:ce,placement:w,offset:D,scrollRef:l,isDismissable:y,shouldCloseOnBlur:b,boundaryElement:A,crossOffset:O,shouldFlip:g,containerPadding:_,updatePositionDeps:S,isKeyboardDismissDisabled:j,shouldCloseOnScroll:te,shouldCloseOnInteractOutside:ee,triggerAnchorPoint:M},pe),_e=(0,I.useMemo)(()=>ge?f(ge,w)?ge:w:null,[ge,w]),{triggerProps:ve}=En({type:T},pe,ue),{isFocusVisible:P,isFocused:ye,focusProps:be}=We(),xe=(0,I.useMemo)(()=>Ve({...r}),[mt(r)]),Se=Be(ie?.base,re),Ce={"--trigger-anchor-point":M?`${M.x}px ${M.y}px`:void 0};ze({isDisabled:!(v&&pe.isOpen)});let we=(e={})=>({ref:ce,...Qe(me,oe,e),style:Qe(me.style,oe.style,e.style)}),Te=(e={})=>({"data-slot":`base`,"data-open":F(pe.isOpen),"data-focus":F(ye),"data-arrow":F(E),"data-focus-visible":F(P),"data-placement":ge?Bt(ge,w):void 0,...Qe(be,C,e),className:xe.base({class:Be(Se)}),style:{outline:`none`,...Ce}}),Ee=(0,I.useCallback)((e={})=>({"data-slot":`content`,"data-open":F(pe.isOpen),"data-arrow":F(E),"data-placement":ge?Bt(ge,w):void 0,className:xe.content({class:Be(ie?.content,e.className)})}),[xe,pe.isOpen,E,_e,w,ie,ge]),De=(0,I.useCallback)(t=>{var n;let r;return t.pointerType===`touch`&&(e?.backdrop===`blur`||e?.backdrop===`opaque`)?r=setTimeout(()=>{N.current=!0},100):N.current=!0,(n=ve.onPress)==null||n.call(ve,t),()=>{clearTimeout(r)}},[ve?.onPress]),Oe=(0,I.useCallback)((e={},t=null)=>{let{isDisabled:n,...r}=e;return{"data-slot":`trigger`,...Qe({"aria-haspopup":`dialog`},ve,r),onPress:De,isDisabled:n,className:xe.trigger({class:Be(ie?.trigger,e.className),isTriggerDisabled:n}),ref:Ae(t,ue)}},[pe,ve,De,ue]),ke=(0,I.useCallback)((e={})=>({"data-slot":`backdrop`,className:xe.backdrop({class:ie?.backdrop}),onClick:e=>{if(!N.current){e.preventDefault();return}pe.close(),N.current=!1},...he,...e}),[xe,pe.isOpen,ie,he]);return{state:pe,Component:se,children:o,classNames:ie,showArrow:E,triggerRef:ue,placement:_e,isNonModal:h,popoverRef:ce,portalContainer:x,isOpen:pe.isOpen,onClose:pe.close,disableAnimation:de,shouldBlockScroll:v,backdrop:e.backdrop??`transparent`,motionProps:ne,getBackdropProps:ke,getPopoverProps:we,getTriggerProps:Oe,getDialogProps:Te,getContentProps:Ee}}var Qi=()=>ye(()=>import(`./dist-DEkc0cdZ.js`),__vite__mapDeps([0,1,2])).then(e=>e.default),$i=je(({children:e,motionProps:t,placement:n,disableAnimation:r,style:i={},transformOrigin:a={},...o},s)=>{let c=i;return a.originX!==void 0||a.originY!==void 0?c={...c,transformOrigin:a}:n&&(c={...c,...ve(n===`center`?`top`:n)}),r?(0,B.jsx)(`div`,{...o,ref:s,children:e}):(0,B.jsx)(Kt,{features:Qi,children:(0,B.jsx)(Yt.div,{ref:s,animate:`enter`,exit:`exit`,initial:`initial`,style:c,variants:S.scaleSpringOpacity,...Qe(o,t),children:e})})});$i.displayName=`HeroUI.FreeSoloPopoverWrapper`;var ea=je(({children:e,transformOrigin:t,disableDialogFocus:n=!1,...r},i)=>{let{Component:a,state:o,placement:s,backdrop:c,portalContainer:l,disableAnimation:u,motionProps:d,isNonModal:f,getPopoverProps:p,getBackdropProps:m,getDialogProps:h,getContentProps:g}=Zi({...r,ref:i}),_=I.useRef(null),{dialogProps:y,titleProps:b}=v({},_),x=h({...!n&&{ref:_},...y}),C=I.useMemo(()=>c===`transparent`?null:u?(0,B.jsx)(`div`,{...m()}):(0,B.jsx)(Kt,{features:Qi,children:(0,B.jsx)(Yt.div,{animate:`enter`,exit:`exit`,initial:`exit`,variants:S.fade,...m()})}),[c,u,m]);return(0,B.jsxs)(Et,{portalContainer:l,children:[!f&&C,(0,B.jsx)(a,{...p(),children:(0,B.jsxs)($i,{disableAnimation:u,motionProps:d,placement:s,tabIndex:-1,transformOrigin:t,...x,children:[!f&&(0,B.jsx)(Ie,{onDismiss:o.close}),(0,B.jsx)(`div`,{...g(),children:typeof e==`function`?e(b):e}),(0,B.jsx)(Ie,{onDismiss:o.close})]})})]})});ea.displayName=`HeroUI.FreeSoloPopover`;var ta=ea,[na,ra]=At({name:`PopoverContext`,errorMessage:"usePopoverContext: `context` is undefined. Seems you forgot to wrap all popover components within `<Popover />`"}),ia=()=>ye(()=>import(`./dist-DEkc0cdZ.js`),__vite__mapDeps([0,1,2])).then(e=>e.default),aa=e=>{let{as:t,children:n,className:r,...i}=e,{Component:a,placement:o,backdrop:s,motionProps:c,disableAnimation:l,getPopoverProps:u,getDialogProps:d,getBackdropProps:f,getContentProps:p,isNonModal:m,onClose:h}=ra(),g=(0,I.useRef)(null),{dialogProps:_,titleProps:y}=v({},g),b=d({ref:g,..._,...i}),x=n&&(0,B.jsxs)(B.Fragment,{children:[!m&&(0,B.jsx)(Ie,{onDismiss:h}),(0,B.jsx)(t||a||`div`,{...b,children:(0,B.jsx)(`div`,{...p({className:r}),children:typeof n==`function`?n(y):n})}),(0,B.jsx)(Ie,{onDismiss:h})]}),C=(0,I.useMemo)(()=>s===`transparent`?null:l?(0,B.jsx)(`div`,{...f()}):(0,B.jsx)(Kt,{features:ia,children:(0,B.jsx)(Yt.div,{animate:`enter`,exit:`exit`,initial:`exit`,variants:S.fade,...f()})}),[s,l,f]),w=o?ve(o===`center`?`top`:o):void 0,T=(0,B.jsx)(B.Fragment,{children:l?x:(0,B.jsx)(Kt,{features:ia,children:(0,B.jsx)(Yt.div,{animate:`enter`,exit:`exit`,initial:`initial`,style:w,variants:S.scaleSpringOpacity,...c,children:x})})});return(0,B.jsxs)(`div`,{...u(),children:[C,T]})};aa.displayName=`HeroUI.PopoverContent`;var oa=aa,sa=e=>{let{triggerRef:t,getTriggerProps:n}=ra(),{children:r,...i}=e,a=(0,I.useMemo)(()=>typeof r==`string`?(0,B.jsx)(`p`,{children:r}):I.Children.only(r),[r]),o=a.props.ref??a.ref,{onPress:s,isDisabled:c,...l}=(0,I.useMemo)(()=>n(Qe(i,a.props),o),[n,a.props,i,o]),[,u]=Se(r,M),{buttonProps:d}=E({onPress:s,isDisabled:c},t),f=(0,I.useMemo)(()=>u?.[0]!==void 0,[u]);return f||delete l.preventFocusOnPress,(0,I.cloneElement)(a,Qe(l,f?{onPress:s,isDisabled:c}:d))};sa.displayName=`HeroUI.PopoverTrigger`;var ca=sa,la=je((e,t)=>{let{children:n,...r}=e,i=Zi({...r,ref:t}),[a,o]=I.Children.toArray(n),s=(0,B.jsx)(Et,{portalContainer:i.portalContainer,children:o});return(0,B.jsxs)(na,{value:i,children:[a,i.disableAnimation&&i.isOpen?s:(0,B.jsx)(qt,{children:i.isOpen?s:null})]})});la.displayName=`HeroUI.Popover`;var ua=la,da={};da={longPressMessage:`     Alt +    `};var fa={};fa={longPressMessage:`    Alt+  ,    `};var pa={};pa={longPressMessage:`Dlouhm stiskem nebo stisknutm klves Alt + ipka dol otevete nabdku`};var ma={};ma={longPressMessage:`Langt tryk eller tryk p Alt + pil ned for at bne menuen`};var ha={};ha={longPressMessage:`Drcken Sie lange oder drcken Sie Alt + Nach-unten, um das Men zu ffnen`};var ga={};ga={longPressMessage:`    Alt +       `};var _a={};_a={longPressMessage:`Long press or press Alt + ArrowDown to open menu`};var va={};va={longPressMessage:`Mantenga pulsado o pulse Alt + flecha abajo para abrir el men`};var ya={};ya={longPressMessage:`Men avamiseks vajutage pikalt vi vajutage klahve Alt + allanool`};var ba={};ba={longPressMessage:`Avaa valikko painamalla pohjassa tai nppinyhdistelmll Alt + Alanuoli`};var xa={};xa={longPressMessage:`Appuyez de manire prolonge ou appuyez sur Alt\xA0+\xA0Flche vers le bas pour ouvrir le menu.`};var Sa={};Sa={longPressMessage:`     Alt + ArrowDown    `};var Ca={};Ca={longPressMessage:`Dugo pritisnite ili pritisnite Alt + strelicu prema dolje za otvaranje izbornika`};var wa={};wa={longPressMessage:`Nyomja meg hosszan, vagy nyomja meg az Alt + lefele nyl gombot a men megnyitshoz`};var Ta={};Ta={longPressMessage:`Premere a lungo o premere Alt + Freccia gi per aprire il menu`};var Ea={};Ea={longPressMessage:` Alt+`};var Da={};Da={longPressMessage:`  Alt +     `};var Oa={};Oa={longPressMessage:`Nordami atidaryti meniu, nuspaud palaikykite arba paspauskite Alt + ArrowDown.`};var ka={};ka={longPressMessage:`Lai atvrtu izvlni, turiet nospiestu vai nospiediet taustiu kombinciju Alt + lejupvrst bultia`};var Aa={};Aa={longPressMessage:`Langt trykk eller trykk Alt + PilNed for  pne menyen`};var ja={};ja={longPressMessage:`Druk lang op Alt + pijl-omlaag of druk op Alt om het menu te openen`};var Ma={};Ma={longPressMessage:`Nacinij i przytrzymaj lub nacinij klawisze Alt + Strzaka w d, aby otworzy menu`};var Na={};Na={longPressMessage:`Pressione e segure ou pressione Alt + Seta para baixo para abrir o menu`};var Pa={};Pa={longPressMessage:`Prima continuamente ou prima Alt + Seta Para Baixo para abrir o menu`};var Fa={};Fa={longPressMessage:`Apsai lung sau apsai pe Alt + sgeat n jos pentru a deschide meniul`};var Ia={};Ia={longPressMessage:`     Alt +  ,   `};var La={};La={longPressMessage:`Ponuku otvorte dlhm stlaenm alebo stlaenm klvesu Alt + klvesu so pkou nadol`};var Ra={};Ra={longPressMessage:`Za odprtje menija pritisnite in drite gumb ali pritisnite Alt+puica navzdol`};var za={};za={longPressMessage:`Dugo pritisnite ili pritisnite Alt + strelicu prema dole da otvorite meni`};var Ba={};Ba={longPressMessage:`Hll nedtryckt eller tryck p Alt + pil nedt fr att ppna menyn`};var Va={};Va={longPressMessage:`Meny amak iin uzun basn veya Alt + Aa Ok tuuna basn`};var Ha={};Ha={longPressMessage:`      Alt   ,   `};var Ua={};Ua={longPressMessage:` Alt + `};var Wa={};Wa={longPressMessage:` Alt+`};var Ga={};Ga={"ar-AE":da,"bg-BG":fa,"cs-CZ":pa,"da-DK":ma,"de-DE":ha,"el-GR":ga,"en-US":_a,"es-ES":va,"et-EE":ya,"fi-FI":ba,"fr-FR":xa,"he-IL":Sa,"hr-HR":Ca,"hu-HU":wa,"it-IT":Ta,"ja-JP":Ea,"ko-KR":Da,"lt-LT":Oa,"lv-LV":ka,"nb-NO":Aa,"nl-NL":ja,"pl-PL":Ma,"pt-BR":Na,"pt-PT":Pa,"ro-RO":Fa,"ru-RU":Ia,"sk-SK":La,"sl-SI":Ra,"sr-SP":za,"sv-SE":Ba,"tr-TR":Va,"uk-UA":Ha,"zh-CN":Ua,"zh-TW":Wa};function Ka(e){return e&&e.__esModule?e.default:e}function qa(e,t,n){let{type:r=`menu`,isDisabled:i,trigger:a=`press`}=e,o=_e(),{triggerProps:s,overlayProps:c}=En({type:r},t,n),l=e=>{if(!i&&!(a===`longPress`&&!e.altKey)&&n&&n.current)switch(e.key){case`Enter`:case` `:if(a===`longPress`||e.isDefaultPrevented())return;case`ArrowDown`:`continuePropagation`in e||e.stopPropagation(),e.preventDefault(),t.toggle(`first`);break;case`ArrowUp`:`continuePropagation`in e||e.stopPropagation(),e.preventDefault(),t.toggle(`last`);break;default:`continuePropagation`in e&&e.continuePropagation()}},u=j(Ka(Ga),`@react-aria/menu`),{longPressProps:d}=bn({isDisabled:i||a!==`longPress`,accessibilityDescription:u.format(`longPressMessage`),onLongPressStart(){t.close()},onLongPress(){t.open(`first`)}}),f={preventFocusOnPress:!0,onPressStart(e){e.pointerType!==`touch`&&e.pointerType!==`keyboard`&&!i&&(x(e.target),t.open(e.pointerType===`virtual`?`first`:null))},onPress(e){e.pointerType===`touch`&&!i&&(x(e.target),t.toggle())}};return delete s.onPress,{menuTriggerProps:{...s,...a===`press`?f:d,id:o,onKeyDown:l},menuProps:{...c,"aria-labelledby":o,autoFocus:t.focusStrategy||!0,onClose:t.close}}}function Ja(e){let t=u(e),[n,r]=(0,I.useState)(null),[i,a]=(0,I.useState)([]),o=()=>{a([]),t.close()},s=(e,t)=>{a(n=>t>n.length?n:[...n.slice(0,t),e])},c=(e,t)=>{a(n=>n[t]===e?n.slice(0,t):n)};return{focusStrategy:n,...t,open(e=null){r(e),t.open()},toggle(e=null){r(e),t.toggle()},close(){o()},expandedKeysStack:i,openSubmenu:s,closeSubmenu:c}}function Ya(e,t,n){let r=n.initialDeps??[],i;return()=>{var a;let o;n.key&&n.debug?.call(n)&&(o=Date.now());let s=e();if(!(s.length!==r.length||s.some((e,t)=>r[t]!==e)))return i;r=s;let c;if(n.key&&n.debug?.call(n)&&(c=Date.now()),i=t(...s),n.key&&n.debug?.call(n)){let e=Math.round((Date.now()-o)*100)/100,t=Math.round((Date.now()-c)*100)/100,r=t/16,i=(e,t)=>{for(e=String(e);e.length<t;)e=` `+e;return e};console.info(`%c ${i(t,5)} /${i(e,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*r,120))}deg 100% 31%);`,n?.key)}return(a=n?.onChange)==null||a.call(n,i),i}}function Xa(e,t){if(e===void 0)throw Error(`Unexpected undefined${t?`: ${t}`:``}`);return e}var Za=(e,t)=>Math.abs(e-t)<1,Qa=(e,t,n)=>{let r;return function(...i){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,i),n)}},$a=e=>e,eo=e=>{let t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let e=t;e<=n;e++)r.push(e);return r},to=(e,t)=>{let n=e.scrollElement;if(!n)return;let r=e.targetWindow;if(!r)return;let i=e=>{let{width:n,height:r}=e;t({width:Math.round(n),height:Math.round(r)})};if(i(n.getBoundingClientRect()),!r.ResizeObserver)return()=>{};let a=new r.ResizeObserver(e=>{let t=e[0];if(t?.borderBoxSize){let e=t.borderBoxSize[0];if(e){i({width:e.inlineSize,height:e.blockSize});return}}i(n.getBoundingClientRect())});return a.observe(n,{box:`border-box`}),()=>{a.unobserve(n)}},no={passive:!0},ro=typeof window>`u`?!0:`onscrollend`in window,io=(e,t)=>{let n=e.scrollElement;if(!n)return;let r=e.targetWindow;if(!r)return;let i=0,a=e.options.useScrollendEvent&&ro?()=>void 0:Qa(r,()=>{t(i,!1)},e.options.isScrollingResetDelay),o=r=>()=>{let{horizontal:o,isRtl:s}=e.options;i=o?n.scrollLeft*(s&&-1||1):n.scrollTop,a(),t(i,r)},s=o(!0),c=o(!1);return c(),n.addEventListener(`scroll`,s,no),n.addEventListener(`scrollend`,c,no),()=>{n.removeEventListener(`scroll`,s),n.removeEventListener(`scrollend`,c)}},ao=(e,t,n)=>{if(t?.borderBoxSize){let e=t.borderBoxSize[0];if(e)return Math.round(e[n.options.horizontal?`inlineSize`:`blockSize`])}return Math.round(e.getBoundingClientRect()[n.options.horizontal?`width`:`height`])},oo=(e,{adjustments:t=0,behavior:n},r)=>{var i,a;let o=e+t;(a=(i=r.scrollElement)?.scrollTo)==null||a.call(i,{[r.options.horizontal?`left`:`top`]:o,behavior:n})},so=class{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null,t=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(e=>{e.forEach(e=>{this._measureElement(e.target,e)})}));return{disconnect:()=>{var n;(n=t())==null||n.disconnect(),e=null},observe:e=>t()?.observe(e,{box:`border-box`}),unobserve:e=>t()?.unobserve(e)}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([t,n])=>{n===void 0&&delete e[t]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:$a,rangeExtractor:eo,onChange:()=>{},measureElement:ao,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:`data-index`,initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!0,...e}},this.notify=e=>{var t,n;(n=(t=this.options).onChange)==null||n.call(t,this,e)},this.maybeNotify=Ya(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{let e=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==e){if(this.cleanup(),!e){this.maybeNotify();return}this.scrollElement=e,this.scrollElement&&`ownerDocument`in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=this.scrollElement?.window??null,this.elementsCache.forEach(e=>{this.observer.observe(e)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,e=>{this.scrollRect=e,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(e,t)=>{this.scrollAdjustments=0,this.scrollDirection=t?this.getScrollOffset()<e?`forward`:`backward`:null,this.scrollOffset=e,this.isScrolling=t,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?`width`:`height`]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset==`function`?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,t)=>{let n=new Map,r=new Map;for(let i=t-1;i>=0;i--){let t=e[i];if(n.has(t.lane))continue;let a=r.get(t.lane);if(a==null||t.end>a.end?r.set(t.lane,t):t.end<a.end&&n.set(t.lane,!0),n.size===this.options.lanes)break}return r.size===this.options.lanes?Array.from(r.values()).sort((e,t)=>e.end===t.end?e.index-t.index:e.end-t.end)[0]:void 0},this.getMeasurementOptions=Ya(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,t,n,r,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:i}),{key:!1}),this.getMeasurements=Ya(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:t,scrollMargin:n,getItemKey:r,enabled:i},a)=>{if(!i)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}));let o=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];let s=this.measurementsCache.slice(0,o);for(let i=o;i<e;i++){let e=r(i),o=this.options.lanes===1?s[i-1]:this.getFurthestMeasurement(s,i),c=o?o.end+this.options.gap:t+n,l=a.get(e),u=typeof l==`number`?l:this.options.estimateSize(i),d=c+u,f=o?o.lane:i%this.options.lanes;s[i]={index:i,start:c,size:u,end:d,key:e,lane:f}}return this.measurementsCache=s,s},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Ya(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(e,t,n)=>this.range=e.length>0&&t>0?lo({measurements:e,outerSize:t,scrollOffset:n}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=Ya(()=>{let e=null,t=null,n=this.calculateRange();return n&&(e=n.startIndex,t=n.endIndex),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,t]},(e,t,n,r,i)=>r===null||i===null?[]:e({startIndex:r,endIndex:i,overscan:t,count:n}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{let t=this.options.indexAttribute,n=e.getAttribute(t);return n?parseInt(n,10):(console.warn(`Missing attribute name '${t}={index}' on measured element.`),-1)},this._measureElement=(e,t)=>{let n=this.indexFromElement(e),r=this.measurementsCache[n];if(!r)return;let i=r.key,a=this.elementsCache.get(i);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(i,e)),e.isConnected&&this.resizeItem(n,this.options.measureElement(e,t,this))},this.resizeItem=(e,t)=>{let n=this.measurementsCache[e];if(!n)return;let r=this.itemSizeCache.get(n.key)??n.size,i=t-r;i!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange===void 0?n.start<this.getScrollOffset()+this.scrollAdjustments:this.shouldAdjustScrollPositionOnItemSizeChange(n,i,this))&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(n.index),this.itemSizeCache=new Map(this.itemSizeCache.set(n.key,t)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((e,t)=>{e.isConnected||(this.observer.unobserve(e),this.elementsCache.delete(t))});return}this._measureElement(e,void 0)},this.getVirtualItems=Ya(()=>[this.getIndexes(),this.getMeasurements()],(e,t)=>{let n=[];for(let r=0,i=e.length;r<i;r++){let i=e[r],a=t[i];n.push(a)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{let t=this.getMeasurements();if(t.length!==0)return Xa(t[co(0,t.length-1,e=>Xa(t[e]).start,e)])},this.getOffsetForAlignment=(e,t)=>{let n=this.getSize(),r=this.getScrollOffset();t===`auto`&&e>=r+n&&(t=`end`),t===`end`&&(e-=n);let i=this.options.horizontal?`scrollWidth`:`scrollHeight`,a=(this.scrollElement?`document`in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-n;return Math.max(Math.min(a,e),0)},this.getOffsetForIndex=(e,t=`auto`)=>{e=Math.max(0,Math.min(e,this.options.count-1));let n=this.measurementsCache[e];if(!n)return;let r=this.getSize(),i=this.getScrollOffset();if(t===`auto`)if(n.end>=i+r-this.options.scrollPaddingEnd)t=`end`;else if(n.start<=i+this.options.scrollPaddingStart)t=`start`;else return[i,t];let a=n.start-this.options.scrollPaddingStart+(n.size-r)/2;switch(t){case`center`:return[this.getOffsetForAlignment(a,t),t];case`end`:return[this.getOffsetForAlignment(n.end+this.options.scrollPaddingEnd,t),t];default:return[this.getOffsetForAlignment(n.start-this.options.scrollPaddingStart,t),t]}},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:t=`start`,behavior:n}={})=>{this.cancelScrollToIndex(),n===`smooth`&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,t),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:t=`auto`,behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),n===`smooth`&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");let r=this.getOffsetForIndex(e,t);if(!r)return;let[i,a]=r;this._scrollToOffset(i,{adjustments:void 0,behavior:n}),n!==`smooth`&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){let[t]=Xa(this.getOffsetForIndex(e,a));Za(t,this.getScrollOffset())||this.scrollToIndex(e,{align:a,behavior:n})}else this.scrollToIndex(e,{align:a,behavior:n})}))},this.scrollBy=(e,{behavior:t}={})=>{this.cancelScrollToIndex(),t===`smooth`&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:t})},this.getTotalSize=()=>{let e=this.getMeasurements(),t;return t=e.length===0?this.options.paddingStart:this.options.lanes===1?e[e.length-1]?.end??0:Math.max(...e.slice(-this.options.lanes).map(e=>e.end)),Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:t,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:t},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}},co=(e,t,n,r)=>{for(;e<=t;){let i=(e+t)/2|0,a=n(i);if(a<r)e=i+1;else if(a>r)t=i-1;else return i}return e>0?e-1:0};function lo({measurements:e,outerSize:t,scrollOffset:n}){let r=e.length-1,i=co(0,r,t=>e[t].start,n),a=i;for(;a<r&&e[a].end<n+t;)a++;return{startIndex:i,endIndex:a}}var uo=t(Ht()),fo=typeof document<`u`?I.useLayoutEffect:I.useEffect;function po(e){let t=I.useReducer(()=>({}),{})[1],n={...e,onChange:(n,r)=>{var i;r?(0,uo.flushSync)(t):t(),(i=e.onChange)==null||i.call(e,n,r)}},[r]=I.useState(()=>new so(n));return r.setOptions(n),fo(()=>r._didMount(),[]),fo(()=>r._willUpdate()),r}function mo(e){return po({observeElementRect:to,observeElementOffset:io,scrollToFn:oo,...e})}var ho=new WeakMap;function go(e,t,n){return e?(typeof t==`string`&&(t=t.replace(/\s+/g,``)),`${ho.get(e)}-${n}-${t}`):``}function _o(e,t,n){let{key:r,isDisabled:i,shouldSelectOnPressUp:a}=e,{selectionManager:o,selectedKey:s}=t,c=r===s,l=i||t.isDisabled||t.selectionManager.isDisabled(r),{itemProps:u,isPressed:d}=Qn({selectionManager:o,key:r,ref:n,isDisabled:l,shouldSelectOnPressUp:a,linkBehavior:`selection`}),f=go(t,r,`tab`),p=go(t,r,`tabpanel`),{tabIndex:m}=u,h=t.collection.getItem(r),g=D(h?.props,{labelable:!0});delete g.id;let _=rt(h?.props),{focusableProps:v}=qe({isDisabled:l},n);return{tabProps:te(g,v,_,u,{id:f,"aria-selected":c,"aria-disabled":l||void 0,"aria-controls":c?p:void 0,tabIndex:l?void 0:m,role:`tab`}),isSelected:c,isDisabled:l,isPressed:d}}function vo(e,t,n){let r=xn(n)?void 0:0,i=go(t,e.id??t?.selectedKey,`tabpanel`),a=_({...e,id:i,"aria-labelledby":go(t,t?.selectedKey,`tab`)});return{tabPanelProps:te(a,{tabIndex:r,role:`tabpanel`,"aria-describedby":e[`aria-describedby`],"aria-details":e[`aria-details`]})}}var yo=class{getKeyLeftOf(e){return this.flipDirection?this.getNextKey(e):this.getPreviousKey(e)}getKeyRightOf(e){return this.flipDirection?this.getPreviousKey(e):this.getNextKey(e)}isDisabled(e){var t;return this.disabledKeys.has(e)||!!((t=this.collection.getItem(e))!=null&&t.props?.isDisabled)}getFirstKey(){let e=this.collection.getFirstKey();return e!=null&&this.isDisabled(e)&&(e=this.getNextKey(e)),e}getLastKey(){let e=this.collection.getLastKey();return e!=null&&this.isDisabled(e)&&(e=this.getPreviousKey(e)),e}getKeyAbove(e){return this.tabDirection?null:this.getPreviousKey(e)}getKeyBelow(e){return this.tabDirection?null:this.getNextKey(e)}getNextKey(e){let t=e;do t=this.collection.getKeyAfter(t),t??=this.collection.getFirstKey();while(t!=null&&this.isDisabled(t));return t}getPreviousKey(e){let t=e;do t=this.collection.getKeyBefore(t),t??=this.collection.getLastKey();while(t!=null&&this.isDisabled(t));return t}constructor(e,t,n,r=new Set){this.collection=e,this.flipDirection=t===`rtl`&&n===`horizontal`,this.disabledKeys=r,this.tabDirection=n===`horizontal`}};function bo(e,t,n){let{orientation:r=`horizontal`,keyboardActivation:i=`automatic`}=e,{collection:a,selectionManager:o,disabledKeys:s}=t,{direction:c}=bt(),l=(0,I.useMemo)(()=>new yo(a,c,r,s),[a,s,r,c]),{collectionProps:u}=Zn({ref:n,selectionManager:o,keyboardDelegate:l,selectOnFocus:i===`automatic`,disallowEmptySelection:!0,scrollRef:n,linkBehavior:`selection`}),d=_e();ho.set(t,d);let f=_({...e,id:d});return{tabListProps:{...te(u,f),role:`tablist`,"aria-orientation":r,tabIndex:void 0}}}var xo=je((e,t)=>{let{as:n,tabKey:r,destroyInactiveTabPanel:i,state:a,className:o,slots:s,classNames:c,...l}=e,u=n||`div`,d=at(t),{tabPanelProps:f}=vo({...e,id:String(r)},a,d),{focusProps:p,isFocused:m,isFocusVisible:h}=We(),g=a.selectedItem,_=a.collection.getItem(r).props.children,v=Be(c?.panel,o,g?.props?.className),y=r===g?.key;return!_||!y&&i?null:(0,B.jsx)(u,{ref:d,"data-focus":m,"data-focus-visible":h,"data-inert":y?void 0:`true`,inert:dt(!y),...y&&Qe(f,p,l),className:s.panel?.call(s,{class:v}),"data-slot":`panel`,children:_})});xo.displayName=`HeroUI.TabPanel`;var So=xo,Co=je((e,t)=>{let{className:n,as:r,item:i,state:a,classNames:o,isDisabled:s,listRef:c,slots:u,motionProps:d,disableAnimation:f,disableCursorAnimation:p,shouldSelectOnPressUp:m,tabRef:h,...g}=e,{key:_}=i,v=at(t),y=r||(e.href?`a`:`button`),b=typeof y==`string`,{tabProps:x,isSelected:S,isDisabled:C,isPressed:w}=_o({key:_,isDisabled:s,shouldSelectOnPressUp:m},a,v);e.children??delete x[`aria-controls`];let T=s||C,{focusProps:E,isFocused:D,isFocusVisible:O}=We(),{hoverProps:k,isHovered:A}=lt({isDisabled:T}),j=Be(o?.tab,n),[,ee]=bi({rerender:!0}),te=(v?.current)?.closest(`[aria-modal="true"]`)!==null,M=()=>{!v?.current||!c?.current||_i(v.current,{scrollMode:`if-needed`,behavior:`smooth`,block:`end`,inline:`end`,boundary:c?.current})};return(0,B.jsxs)(y,{ref:Ee(v,h),"data-disabled":F(C),"data-focus":F(D),"data-focus-visible":F(O),"data-hover":F(A),"data-hover-unselected":F((A||w)&&!S),"data-pressed":F(w),"data-selected":F(S),"data-slot":`tab`,...Qe(x,T?{}:{...E,...k},we(g,{enabled:b,omitPropNames:new Set([`title`]),omitEventNames:new Set([`onClick`])}),{onClick:l(M,x.onClick)}),className:u.tab?.call(u,{class:j}),title:g?.titleValue,type:y===`button`?`button`:void 0,children:[S&&!f&&!p&&ee&&!te?(0,B.jsx)(Kt,{features:Wt,children:(0,B.jsx)(Yt.span,{className:u.cursor({class:o?.cursor}),"data-slot":`cursor`,layoutDependency:!1,layoutId:`cursor`,transition:{type:`spring`,bounce:.15,duration:.5},...d})}):null,(0,B.jsx)(`div`,{className:u.tabContent({class:o?.tabContent}),"data-slot":`tabContent`,children:i.rendered})]})});Co.displayName=`HeroUI.Tab`;var wo=Co,To=class{*[Symbol.iterator](){yield*this.iterable}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(e){let t=this.keyMap.get(e);return t?t.prevKey??null:null}getKeyAfter(e){let t=this.keyMap.get(e);return t?t.nextKey??null:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(e){return this.keyMap.get(e)??null}at(e){let t=[...this.getKeys()];return this.getItem(t[e])}getChildren(e){return this.keyMap.get(e)?.childNodes||[]}constructor(e){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=e;let t=e=>{if(this.keyMap.set(e.key,e),e.childNodes&&e.type===`section`)for(let n of e.childNodes)t(n)};for(let n of e)t(n);let n=null,r=0,i=0;for(let[e,t]of this.keyMap)n?(n.nextKey=e,t.prevKey=n.key):(this.firstKey=e,t.prevKey=void 0),t.type===`item`&&(t.index=r++),(t.type===`section`||t.type===`item`)&&i++,n=t,n.nextKey=void 0;this._size=i,this.lastKey=n?.key??null}};function Eo(e){let{filter:t,layoutDelegate:n}=e,r=cr(e),i=(0,I.useMemo)(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),a=(0,I.useCallback)(e=>t?new To(t(e)):new To(e),[t]),o=(0,I.useMemo)(()=>({suppressTextValueWarning:e.suppressTextValueWarning}),[e.suppressTextValueWarning]),s=_r(e,a,o),c=(0,I.useMemo)(()=>new Tr(s,r,{layoutDelegate:n}),[s,r,n]);return Do(s,c),{collection:s,disabledKeys:i,selectionManager:c}}function Do(e,t){let n=(0,I.useRef)(null);(0,I.useEffect)(()=>{if(t.focusedKey!=null&&!e.getItem(t.focusedKey)&&n.current){let r=n.current.getItem(t.focusedKey),i=[...n.current.getKeys()].map(e=>{let t=n.current.getItem(e);return t?.type===`item`?t:null}).filter(e=>e!==null),a=[...e.getKeys()].map(t=>{let n=e.getItem(t);return n?.type===`item`?n:null}).filter(e=>e!==null),o=(i?.length??0)-(a?.length??0),s=Math.min(o>1?Math.max((r?.index??0)-o+1,0):r?.index??0,(a?.length??0)-1),c=null,l=!1;for(;s>=0;){if(!t.isDisabled(a[s].key)){c=a[s];break}s<a.length-1&&!l?s++:(l=!0,s>(r?.index??0)&&(s=r?.index??0),s--)}t.setFocusedKey(c?c.key:null)}n.current=e},[e,t])}function Oo(e){let[t,n]=Ft(e.selectedKey,e.defaultSelectedKey??null,e.onSelectionChange),r=(0,I.useMemo)(()=>t==null?[]:[t],[t]),{collection:i,disabledKeys:a,selectionManager:o}=Eo({...e,selectionMode:`single`,disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:r,onSelectionChange:r=>{if(r===`all`)return;let i=r.values().next().value??null;i===t&&e.onSelectionChange&&e.onSelectionChange(i),n(i)}}),s=t==null?null:i.getItem(t);return{collection:i,disabledKeys:a,selectionManager:o,selectedKey:t,setSelectedKey:n,selectedItem:s}}function ko(e){let t=Oo({...e,onSelectionChange:e.onSelectionChange?t=>{var n;t!=null&&((n=e.onSelectionChange)==null||n.call(e,t))}:void 0,suppressTextValueWarning:!0,defaultSelectedKey:e.defaultSelectedKey??Ao(e.collection,e.disabledKeys?new Set(e.disabledKeys):new Set)??void 0}),{selectionManager:n,collection:r,selectedKey:i}=t,a=(0,I.useRef)(i);return(0,I.useEffect)(()=>{let o=i;e.selectedKey==null&&(n.isEmpty||o==null||!r.getItem(o))&&(o=Ao(r,t.disabledKeys),o!=null&&n.setSelectedKeys([o])),(o!=null&&n.focusedKey==null||!n.isFocused&&o!==a.current)&&n.setFocusedKey(o),a.current=o}),{...t,isDisabled:e.isDisabled||!1}}function Ao(e,t){let n=null;if(e){var r,i;for(n=e.getFirstKey();n!=null&&(t.has(n)||(r=e.getItem(n))!=null&&r.props?.isDisabled)&&n!==e.getLastKey();)n=e.getKeyAfter(n);n!=null&&(t.has(n)||(i=e.getItem(n))!=null&&i.props?.isDisabled)&&n===e.getLastKey()&&(n=e.getFirstKey())}return n}function jo(e){let t=k(),[n,r]=ht(e,kn.variantKeys),{ref:i,as:a,className:o,classNames:s,children:c,disableCursorAnimation:l,motionProps:u,isVertical:d=!1,shouldSelectOnPressUp:f=!0,destroyInactiveTabPanel:p=!0,...m}=n,h=a||`div`,g=typeof h==`string`,_=at(i),v=e?.disableAnimation??t?.disableAnimation??!1,y=ko({children:c,...m}),{tabListProps:b}=bo(m,y,_),x=(0,I.useMemo)(()=>kn({...r,disableAnimation:v,...d?{placement:`start`}:{}}),[mt(r),v,d]),S=Be(s?.base,o),C=(0,I.useMemo)(()=>({state:y,slots:x,classNames:s,motionProps:u,disableAnimation:v,listRef:_,shouldSelectOnPressUp:f,disableCursorAnimation:l,isDisabled:e?.isDisabled}),[y,x,_,u,v,l,f,e?.isDisabled,s]),w=(0,I.useCallback)(e=>({"data-slot":`base`,className:x.base({class:Be(S,e?.className)}),...Qe(we(m,{enabled:g}),e)}),[S,m,x]),T=r.placement??(d?`start`:`top`),E=(0,I.useCallback)(e=>({"data-slot":`tabWrapper`,className:x.tabWrapper({class:Be(s?.tabWrapper,e?.className)}),"data-placement":T,"data-vertical":d||T===`start`||T===`end`?`vertical`:`horizontal`}),[s,x,T,d]),D=(0,I.useCallback)(e=>({ref:_,"data-slot":`tabList`,className:x.tabList({class:Be(s?.tabList,e?.className)}),...Qe(b,e)}),[_,b,s,x]);return{Component:h,domRef:_,state:y,values:C,destroyInactiveTabPanel:p,getBaseProps:w,getTabListProps:D,getWrapperProps:E}}var Mo=je(function(e,t){let{Component:n,values:r,state:i,domRef:a,destroyInactiveTabPanel:o,getBaseProps:s,getTabListProps:c,getWrapperProps:l}=jo({...e,ref:t}),u=(0,I.useId)(),d=(a?.current)?.closest(`[aria-modal="true"]`)!==null,f=!e.disableAnimation&&!e.disableCursorAnimation&&!d,p={state:i,listRef:r.listRef,slots:r.slots,classNames:r.classNames,isDisabled:r.isDisabled,motionProps:r.motionProps,disableAnimation:r.disableAnimation,shouldSelectOnPressUp:r.shouldSelectOnPressUp,disableCursorAnimation:r.disableCursorAnimation},m=[...i.collection].map(e=>(0,B.jsx)(wo,{item:e,...p,...e.props},e.key)),h=(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)(`div`,{...s(),children:(0,B.jsx)(n,{...c(),children:f?(0,B.jsx)(Jt,{id:u,children:m}):m})}),[...i.collection].map(e=>(0,B.jsx)(So,{classNames:r.classNames,destroyInactiveTabPanel:o,slots:r.slots,state:r.state,tabKey:e.key},e.key))]});return`placement`in e||`isVertical`in e?(0,B.jsx)(`div`,{...l(),children:h}):h}),No=fr;function Po(e){let{collection:t,disabledKeys:n,selectionManager:r,selectionManager:{setSelectedKeys:i,selectedKeys:a,selectionMode:o}}=Eo(e),s=(0,I.useMemo)(()=>!e.isLoading&&a.size!==0?Array.from(a).filter(Boolean).filter(e=>!t.getItem(e)):[],[a,t]),c=a.size===0?null:Array.from(a).map(e=>t.getItem(e)).filter(Boolean);return s.length&&console.warn(`Select: Keys "${s.join(`, `)}" passed to "selectedKeys" are not present in the collection.`),{collection:t,disabledKeys:n,selectionManager:r,selectionMode:o,selectedKeys:a,setSelectedKeys:i.bind(r),selectedItems:c}}function Fo({validate:e,validationBehavior:t,...n}){let[r,i]=(0,I.useState)(!1),[a,o]=(0,I.useState)(null),s=Ja(n),c=Po({...n,onSelectionChange:e=>{n.onSelectionChange!=null&&(e===`all`?n.onSelectionChange(new Set(c.collection.getKeys())):n.onSelectionChange(e)),n.selectionMode===`single`&&s.close()}}),l=Gr({...n,validationBehavior:t,validate:t=>{if(!e)return;let r=Array.from(t);return e(n.selectionMode===`single`?r[0]:r)},value:c.selectedKeys}),u=c.collection.size===0&&n.hideEmptyContent;return{...l,...c,...s,focusStrategy:a,close(){s.close()},open(e=null){u||(o(e),s.open())},toggle(e=null){u||(o(e),s.toggle())},isFocused:r,setFocused:i}}function Io(e,t,n){let{disallowEmptySelection:r,isDisabled:i}=e,a=vn({usage:`search`,sensitivity:`base`}),o=(0,I.useMemo)(()=>new nr(t.collection,t.disabledKeys,null,a),[t.collection,t.disabledKeys,a]),{menuTriggerProps:s,menuProps:c}=qa({isDisabled:i,type:`listbox`},t,n),l=e=>{if(t.selectionMode===`single`)switch(e.key){case`ArrowLeft`:{e.preventDefault();let n=t.selectedKeys.size>0?o.getKeyAbove(t.selectedKeys.values().next().value):o.getFirstKey();n&&t.setSelectedKeys([n]);break}case`ArrowRight`:{e.preventDefault();let n=t.selectedKeys.size>0?o.getKeyBelow(t.selectedKeys.values().next().value):o.getFirstKey();n&&t.setSelectedKeys([n]);break}}},{typeSelectProps:u}=Jn({keyboardDelegate:o,selectionManager:t.selectionManager,onTypeSelect(e){t.setSelectedKeys([e])}}),{isInvalid:d,validationErrors:f,validationDetails:p}=t.displayValidation,{labelProps:m,fieldProps:h,descriptionProps:g,errorMessageProps:_}=ni({...e,labelElementType:`span`,isInvalid:d,errorMessage:e.errorMessage||f});u.onKeyDown=u.onKeyDownCapture,delete u.onKeyDownCapture,s.onPressStart=e=>{e.pointerType!==`touch`&&e.pointerType!==`keyboard`&&!i&&t.toggle(e.pointerType===`virtual`?`first`:null)};let v=D(e,{labelable:!0}),y=te(u,s,h),b=_e();return{labelProps:{...m,onClick:()=>{var t;e.isDisabled||((t=n.current)==null||t.focus(),zt(`keyboard`))}},triggerProps:te(v,{...y,onKeyDown:P(y.onKeyDown,l,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[b,y[`aria-labelledby`],y[`aria-label`]&&!y[`aria-labelledby`]?y.id:null].join(` `),onFocus(n){t.isFocused||(e.onFocus&&e.onFocus(n),t.setFocused(!0))},onBlur(n){t.isOpen||(e.onBlur&&e.onBlur(n),t.setFocused(!1))}}),valueProps:{id:b},menuProps:{...c,disallowEmptySelection:r,autoFocus:t.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,onBlur:n=>{n.currentTarget.contains(n.relatedTarget)||(e.onBlur&&e.onBlur(n),t.setFocused(!1))},onFocus:c?.onFocus,"aria-labelledby":[h[`aria-labelledby`],y[`aria-label`]&&!h[`aria-labelledby`]?y.id:null].filter(Boolean).join(` `)},descriptionProps:g,errorMessageProps:_,isInvalid:d,validationErrors:f,validationDetails:p}}var Lo=new WeakMap;function Ro(e){let t=k(),{validationBehavior:n}=ai(si)||{},[r,i]=ht(e,An.variantKeys),a=e.disableAnimation??t?.disableAnimation??!1,{ref:o,as:s,label:c,name:l,isLoading:u,selectorIcon:d,isOpen:f,defaultOpen:p,onOpenChange:m,startContent:h,endContent:g,description:_,renderValue:v,onSelectionChange:y,placeholder:b,isVirtualized:x,itemHeight:S=36,maxListboxHeight:C=256,children:w,disallowEmptySelection:T=!1,selectionMode:D=`single`,spinnerRef:O,scrollRef:A,popoverProps:j={},scrollShadowProps:ee={},listboxProps:te={},spinnerProps:M={},validationState:ne,onChange:re,onClose:ie,className:ae,classNames:oe,validationBehavior:se=n??t?.validationBehavior??`native`,hideEmptyContent:ce=!1,onClear:le,...N}=r,de=at(A),fe={popoverProps:Qe({placement:`bottom`,triggerScaleOnOpen:!1,offset:5,disableAnimation:a},j),scrollShadowProps:Qe({ref:de,isEnabled:e.showScrollIndicators??!0,hideScrollBar:!0,offset:15},ee),listboxProps:Qe({disableAnimation:a},te)},pe=s||`button`,me=typeof pe==`string`,he=at(o),ge=(0,I.useRef)(null),_e=(0,I.useRef)(null),ve=(0,I.useRef)(null),P=Fo({...r,isOpen:f,selectionMode:D,disallowEmptySelection:T,validationBehavior:se,children:w,isRequired:e.isRequired,isDisabled:e.isDisabled,isInvalid:e.isInvalid,defaultOpen:p,hideEmptyContent:ce,onOpenChange:e=>{m?.(e),e||ie?.()},onSelectionChange:e=>{y?.(e),re&&typeof re==`function`&&re({target:{...he.current&&{...he.current,name:he.current.name},value:Array.from(e).join(`,`)}}),P.commitValidation()}});P={...P,...e.isDisabled&&{disabledKeys:new Set([...P.collection.getKeys()])}},ue(()=>{he.current?.value&&P.setSelectedKeys(new Set([...P.selectedKeys,he.current.value]))},[he.current]);let{labelProps:ye,triggerProps:be,valueProps:xe,menuProps:Se,descriptionProps:Ce,errorMessageProps:Te,isInvalid:Ee,validationErrors:De,validationDetails:Oe}=Io({...r,disallowEmptySelection:T,isDisabled:e.isDisabled},P,ge),ke=(0,I.useCallback)(()=>{var e;P.setSelectedKeys(new Set([])),le?.(),(e=ge.current)==null||e.focus()},[le,P]),{pressProps:Ae}=Lt({isDisabled:!!e?.isDisabled,onPress:ke}),je=e.isInvalid||ne===`invalid`||Ee,{isPressed:Me,buttonProps:Ne}=E(be,ge),{focusProps:Pe,isFocused:Fe,isFocusVisible:Ie}=We(),{focusProps:Le,isFocusVisible:Re}=We(),{isHovered:Ve,hoverProps:He}=lt({isDisabled:e.isDisabled}),Ue=Dn({labelPlacement:e.labelPlacement,label:c}),Ge=!!b,Ke=Ue===`outside-left`||Ue===`outside`,qe=Ue===`inside`,Je=Ue===`outside-left`,Ye=e.isClearable,Xe=P.isOpen||Ge||!!P.selectedItems?.length||!!h||!!g||!!e.isMultiline,Ze=!!P.selectedItems?.length,$e=!!c,et=$e&&(Je||Ke&&Ge),tt=Be(oe?.base,ae),nt=(0,I.useMemo)(()=>An({...i,isInvalid:je,isClearable:Ye,labelPlacement:Ue,disableAnimation:a}),[mt(i),je,Ue,a]);ze({isDisabled:!P.isOpen});let rt=typeof r.errorMessage==`function`?r.errorMessage({isInvalid:je,validationErrors:De,validationDetails:Oe}):r.errorMessage||De?.join(` `),it=!!_||!!rt,ot=!!g;(0,I.useEffect)(()=>{if(P.isOpen&&ve.current&&ge.current){let e=ge.current.getBoundingClientRect(),t=ve.current;t.style.width=e.width+`px`}},[P.isOpen]);let st=(0,I.useCallback)((e={})=>({"data-slot":`base`,"data-filled":F(Xe),"data-has-value":F(Ze),"data-has-label":F($e),"data-has-helper":F(it),"data-has-end-content":F(ot),"data-invalid":F(je),"data-has-label-outside":F(et),className:nt.base({class:Be(tt,e.className)}),...e}),[nt,it,Ze,$e,et,Xe,tt]),ct=(0,I.useCallback)((t={})=>({ref:ge,"data-slot":`trigger`,"data-open":F(P.isOpen),"data-disabled":F(e?.isDisabled),"data-focus":F(Fe),"data-pressed":F(Me),"data-focus-visible":F(Ie),"data-hover":F(Ve),className:nt.trigger({class:oe?.trigger}),...Qe(Ne,Pe,He,we(N,{enabled:me}),we(t))}),[nt,ge,P.isOpen,oe?.trigger,e?.isDisabled,Fe,Me,Ie,Ve,Ne,Pe,He,N,me]),ut=(0,I.useCallback)((t={})=>({state:P,triggerRef:ge,selectRef:he,selectionMode:D,label:e?.label,name:e?.name,isRequired:e?.isRequired,autoComplete:e?.autoComplete,isDisabled:e?.isDisabled,form:e?.form,onChange:re,...t}),[P,D,e?.label,e?.autoComplete,e?.name,e?.isDisabled,ge]),dt=(0,I.useCallback)((e={})=>({"data-slot":`label`,className:nt.label({class:Be(oe?.label,e.className)}),...ye,...e}),[nt,oe?.label,ye]),ft=(0,I.useCallback)((e={})=>({"data-slot":`value`,className:nt.value({class:Be(oe?.value,e.className)}),...xe,...e}),[nt,oe?.value,xe]),pt=(0,I.useCallback)((e={})=>({"data-slot":`listboxWrapper`,className:nt.listboxWrapper({class:Be(oe?.listboxWrapper,e?.className)}),style:{maxHeight:C??256,...e.style},...Qe(fe.scrollShadowProps,e)}),[nt.listboxWrapper,oe?.listboxWrapper,fe.scrollShadowProps,C]),gt=(e={})=>{let t=x??P.collection.size>50;return{state:P,ref:_e,isVirtualized:t,virtualization:t?{maxListboxHeight:C,itemHeight:S}:void 0,"data-slot":`listbox`,className:nt.listbox({class:Be(oe?.listbox,e?.className)}),scrollShadowProps:fe.scrollShadowProps,...Qe(fe.listboxProps,e,Se)}},_t=(0,I.useCallback)((e={})=>{let t=Qe(fe.popoverProps,e);return{state:P,triggerRef:ge,ref:ve,"data-slot":`popover`,scrollRef:_e,triggerType:`listbox`,classNames:{content:nt.popoverContent({class:Be(oe?.popoverContent,e.className)})},...t,offset:P.selectedItems&&P.selectedItems.length>0?P.selectedItems.length*1e-8+(fe.popoverProps?.offset||0):fe.popoverProps?.offset}},[nt,oe?.popoverContent,fe.popoverProps,ge,P,P.selectedItems]),vt=(0,I.useCallback)(()=>({"data-slot":`selectorIcon`,"aria-hidden":F(!0),"data-open":F(P.isOpen),className:nt.selectorIcon({class:oe?.selectorIcon})}),[nt,oe?.selectorIcon,P.isOpen]),yt=(0,I.useCallback)((e={})=>({...e,"data-slot":`innerWrapper`,className:nt.innerWrapper({class:Be(oe?.innerWrapper,e?.className)})}),[nt,oe?.innerWrapper]),bt=(0,I.useCallback)((e={})=>({...e,"data-slot":`helperWrapper`,className:nt.helperWrapper({class:Be(oe?.helperWrapper,e?.className)})}),[nt,oe?.helperWrapper]),xt=(0,I.useCallback)((e={})=>({...e,...Ce,"data-slot":`description`,className:nt.description({class:Be(oe?.description,e?.className)})}),[nt,oe?.description]),St=(0,I.useCallback)((e={})=>({...e,"data-slot":`mainWrapper`,className:nt.mainWrapper({class:Be(oe?.mainWrapper,e?.className)})}),[nt,oe?.mainWrapper]),Ct=(0,I.useCallback)((e={})=>({...e,"data-slot":`end-wrapper`,className:nt.endWrapper({class:Be(oe?.endWrapper,e?.className)})}),[nt,oe?.endWrapper]),wt=(0,I.useCallback)((e={})=>({...e,"data-slot":`end-content`,className:nt.endContent({class:Be(oe?.endContent,e?.className)})}),[nt,oe?.endContent]),Tt=(0,I.useCallback)((e={})=>({...e,...Te,"data-slot":`error-message`,className:nt.errorMessage({class:Be(oe?.errorMessage,e?.className)})}),[nt,Te,oe?.errorMessage]),Et=(0,I.useCallback)((e={})=>({"aria-hidden":F(!0),"data-slot":`spinner`,color:`current`,size:`sm`,...M,...e,ref:O,className:nt.spinner({class:Be(oe?.spinner,e?.className)})}),[nt,O,M,oe?.spinner]),Dt=(0,I.useCallback)((e={})=>({...e,type:`button`,tabIndex:-1,"aria-label":`clear selection`,"data-slot":`clear-button`,"data-focus-visible":F(Re),className:nt.clearButton({class:Be(oe?.clearButton,e?.className)}),...Qe(Ae,Le)}),[nt,Re,Ae,Le,oe?.clearButton]);return Lo.set(P,{isDisabled:e?.isDisabled,isRequired:e?.isRequired,name:e?.name,isInvalid:je,validationBehavior:se}),{Component:pe,domRef:he,state:P,label:c,name:l,triggerRef:ge,isLoading:u,placeholder:b,startContent:h,endContent:g,description:_,selectorIcon:d,hasHelper:it,labelPlacement:Ue,hasPlaceholder:Ge,renderValue:v,selectionMode:D,disableAnimation:a,isOutsideLeft:Je,shouldLabelBeOutside:Ke,shouldLabelBeInside:qe,isInvalid:je,errorMessage:rt,isClearable:Ye,getClearButtonProps:Dt,getBaseProps:st,getTriggerProps:ct,getLabelProps:dt,getValueProps:ft,getListboxProps:gt,getPopoverProps:_t,getSpinnerProps:Et,getMainWrapperProps:St,getListboxWrapperProps:pt,getHiddenSelectProps:ut,getInnerWrapperProps:yt,getHelperWrapperProps:bt,getDescriptionProps:xt,getErrorMessageProps:Tt,getSelectorIconProps:vt,getEndWrapperProps:Ct,getEndContentProps:wt}}var zo=typeof document<`u`?I.useLayoutEffect:()=>{};function Bo(e){let t=(0,I.useRef)(null);return zo(()=>{t.current=e},[e]),(0,I.useCallback)((...e)=>{let n=t.current;return n?.(...e)},[])}function Vo(e,t,n){let r=(0,I.useRef)(t),i=Bo(()=>{n&&n(r.current)});(0,I.useEffect)(()=>{let t=e?.current?.form;return t?.addEventListener(`reset`,i),()=>{t?.removeEventListener(`reset`,i)}},[e,i])}function Ho(e,t,n){let r=Lo.get(t)||{},{autoComplete:i,name:a=r.name,isDisabled:o=r.isDisabled,selectionMode:s,onChange:c,form:l}=e,{validationBehavior:u,isRequired:d,isInvalid:f}=r,{visuallyHiddenProps:p}=jt();return Vo(e.selectRef,t.selectedKeys,t.setSelectedKeys),Zr({validationBehavior:u,focus:()=>n.current?.focus()},t,e.selectRef),{containerProps:{...p,"aria-hidden":!0,"data-a11y-ignore":`aria-hidden-focus`},inputProps:{style:{display:`none`}},selectProps:{form:l,autoComplete:i,disabled:o,"aria-invalid":f||void 0,"aria-required":d&&u===`aria`||void 0,required:d&&u===`native`,name:a,tabIndex:-1,value:s===`multiple`?[...t.selectedKeys].map(e=>String(e)):[...t.selectedKeys][0]??``,multiple:s===`multiple`,onChange:e=>{t.setSelectedKeys(e.target.value),c?.(e)}}}}function Uo(e){let{state:t,triggerRef:n,selectRef:r,label:i,name:a,isDisabled:o,form:s}=e,{containerProps:c,selectProps:l}=Ho({...e,selectRef:r},t,n);return t.collection.size<=300?(0,B.jsx)(`div`,{...c,"data-testid":`hidden-select-container`,children:(0,B.jsxs)(`label`,{children:[i,(0,B.jsxs)(`select`,{...l,ref:r,children:[(0,B.jsx)(`option`,{}),[...t.collection.getKeys()].map(e=>{let n=t.collection.getItem(e);if(n?.type===`item`)return(0,B.jsx)(`option`,{value:n.key,children:n.textValue},n.key)})]})]})}):a?(0,B.jsx)(`input`,{autoComplete:l.autoComplete,disabled:o,form:s,name:a,type:`hidden`,value:[...t.selectedKeys].join(`,`)??``}):null}var Wo=fr,Go=new WeakMap;function Ko(e){return typeof e==`string`?e.replace(/\s*/g,``):``+e}function qo(e,t){let n=Go.get(e);if(!n)throw Error(`Unknown list`);return`${n.id}-option-${Ko(t)}`}function Jo(e,t,n){let r=D(e,{labelable:!0}),i=e.selectionBehavior||`toggle`,a=e.linkBehavior||(i===`replace`?`action`:`override`);i===`toggle`&&a===`action`&&(a=`override`);let{listProps:o}=rr({...e,ref:n,selectionManager:t.selectionManager,collection:t.collection,disabledKeys:t.disabledKeys,linkBehavior:a}),{focusWithinProps:s}=Xe({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),c=_e(e.id);Go.set(t,{id:c,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:a});let{labelProps:l,fieldProps:u}=ti({...e,id:c,labelElementType:`span`});return{labelProps:l,listBoxProps:te(r,s,t.selectionManager.selectionMode===`multiple`?{"aria-multiselectable":`true`}:{},{role:`listbox`,...te(u,o)})}}function Yo(e,t,n){let{key:r}=e,i=Go.get(t),a=e.isDisabled??t.selectionManager.isDisabled(r),o=e.isSelected??t.selectionManager.isSelected(r),s=e.shouldSelectOnPressUp??i?.shouldSelectOnPressUp,c=e.shouldFocusOnHover??i?.shouldFocusOnHover,l=e.shouldUseVirtualFocus??i?.shouldUseVirtualFocus,u=e.isVirtualized??i?.isVirtualized,d=T(),f=T(),p={role:`option`,"aria-disabled":a||void 0,"aria-selected":t.selectionManager.selectionMode===`none`?void 0:o};ie()&&ne()||(p[`aria-label`]=e[`aria-label`],p[`aria-labelledby`]=d,p[`aria-describedby`]=f);let m=t.collection.getItem(r);if(u){let e=Number(m?.index);p[`aria-posinset`]=Number.isNaN(e)?void 0:e+1,p[`aria-setsize`]=wr(t.collection)}let h=i?.onAction?()=>i?.onAction?.call(i,r):void 0,g=qo(t,r),{itemProps:_,isPressed:v,isFocused:y,hasAction:b,allowsSelection:x}=Qn({selectionManager:t.selectionManager,key:r,ref:n,shouldSelectOnPressUp:s,allowsDifferentPressOrigin:s&&c,isVirtualized:u,shouldUseVirtualFocus:l,isDisabled:a,onAction:h||m!=null&&m.props?.onAction?P(m?.props?.onAction,h):void 0,linkBehavior:i?.linkBehavior,id:g}),{hoverProps:S}=lt({isDisabled:a||!c,onHoverStart(){Ne()||(t.selectionManager.setFocused(!0),t.selectionManager.setFocusedKey(r))}}),C=D(m?.props);delete C.id;let w=rt(m?.props);return{optionProps:{...p,...te(C,_,S,w),id:g},labelProps:{id:d},descriptionProps:{id:f},isFocused:y,isFocusVisible:y&&t.selectionManager.isFocused&&Ne(),isSelected:o,isDisabled:a,isPressed:v,allowsSelection:x,hasAction:b}}function Xo(e){let{heading:t,"aria-label":n}=e,r=_e();return{itemProps:{role:`presentation`},headingProps:t?{id:r,role:`presentation`}:{},groupProps:{role:`group`,"aria-label":n,"aria-labelledby":t?r:void 0}}}function Zo(e){let t=k(),{ref:n,as:r,state:i,variant:a,color:o,onAction:s,children:c,onSelectionChange:l,disableAnimation:u=t?.disableAnimation??!1,itemClasses:d,className:f,topContent:p,bottomContent:m,emptyContent:h=`No items.`,hideSelectedIcon:g=!1,hideEmptyContent:_=!1,shouldHighlightOnFocus:v=!1,classNames:y,...b}=e,x=r||`ul`,S=typeof x==`string`,C=at(n),w=Eo({...e,children:c,onSelectionChange:l}),T=i||w,{listBoxProps:E}=Jo({...e,onAction:s},T,C),D=(0,I.useMemo)(()=>Mn(),[]),O=Be(y?.base,f);return{Component:x,state:T,variant:a,color:o,slots:D,classNames:y,topContent:p,bottomContent:m,emptyContent:h,hideEmptyContent:_,shouldHighlightOnFocus:v,hideSelectedIcon:g,disableAnimation:u,className:f,itemClasses:d,getBaseProps:(e={})=>({ref:C,"data-slot":`base`,className:D.base({class:O}),...we(b,{enabled:S}),...e}),getListProps:(e={})=>({"data-slot":`list`,className:D.list({class:y?.list}),...E,...e}),getEmptyContentProps:(e={})=>({"data-slot":`empty-content`,children:h,className:D.emptyContent({class:y?.emptyContent}),...e})}}function Qo(e){let{isSelected:t,disableAnimation:n,...r}=e;return(0,B.jsx)(`svg`,{"aria-hidden":`true`,"data-selected":t,role:`presentation`,viewBox:`0 0 17 18`,...r,children:(0,B.jsx)(`polyline`,{fill:`none`,points:`1 9 7 14 15 4`,stroke:`currentColor`,strokeDasharray:22,strokeDashoffset:t?44:66,strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:1.5,style:n?{}:{transition:`stroke-dashoffset 200ms ease`}})})}function $o(e){let t=k(),[n,r]=ht(e,Nn.variantKeys),{as:i,item:a,state:o,description:s,startContent:c,endContent:l,isVirtualized:u,selectedIcon:d,className:f,classNames:p,autoFocus:m,onPress:h,onPressUp:g,onPressStart:_,onPressEnd:v,onPressChange:y,onClick:b,shouldHighlightOnFocus:x,hideSelectedIcon:S=!1,isReadOnly:C=!1,...w}=n,T=e.disableAnimation??t?.disableAnimation??!1,E=(0,I.useRef)(null),D=i||(e.href?`a`:`li`),O=typeof D==`string`,{rendered:A,key:j}=a,ee=o.disabledKeys.has(j)||e.isDisabled,te=o.selectionManager.selectionMode!==`none`,M=me(),{pressProps:ne,isPressed:re}=Lt({ref:E,isDisabled:ee,onClick:b,onPress:h,onPressUp:g,onPressStart:_,onPressEnd:v,onPressChange:y}),{isHovered:ie,hoverProps:ae}=lt({isDisabled:ee}),{isFocusVisible:oe,focusProps:se}=We({autoFocus:m}),{isFocused:ce,isSelected:le,optionProps:N,labelProps:ue,descriptionProps:de}=Yo({key:j,isDisabled:ee,"aria-label":n[`aria-label`],isVirtualized:u},o,E),fe=N,pe=(0,I.useMemo)(()=>Nn({...r,isDisabled:ee,disableAnimation:T,hasTitleTextChild:typeof A==`string`,hasDescriptionTextChild:typeof s==`string`}),[mt(r),ee,T,A,s]),he=Be(p?.base,f);C&&(fe=Tt(fe));let ge=x&&ce||(M?ie||re:ie||ce&&!oe),_e=(e={})=>({ref:E,...Qe(fe,C?{}:Qe(se,ne),ae,we(w,{enabled:O}),e),"data-selectable":F(te),"data-focus":F(ce),"data-hover":F(ge),"data-disabled":F(ee),"data-selected":F(le),"data-pressed":F(re),"data-focus-visible":F(oe),className:pe.base({class:Be(he,e.className)})}),ve=(e={})=>({...Qe(ue,e),"data-label":F(!0),className:pe.title({class:p?.title})}),P=(e={})=>({...Qe(de,e),className:pe.description({class:p?.description})}),ye=(e={})=>({...Qe(e),className:pe.wrapper({class:p?.wrapper})}),be=(0,I.useCallback)((e={})=>({"aria-hidden":F(!0),"data-disabled":F(ee),className:pe.selectedIcon({class:p?.selectedIcon}),...e}),[ee,pe,p]);return{Component:D,domRef:E,slots:pe,classNames:p,isSelectable:te,isSelected:le,isDisabled:ee,rendered:A,description:s,startContent:c,endContent:l,selectedIcon:d,hideSelectedIcon:S,disableAnimation:T,getItemProps:_e,getLabelProps:ve,getWrapperProps:ye,getDescriptionProps:P,getSelectedIconProps:be}}var es=e=>{let{Component:t,rendered:n,description:r,isSelectable:i,isSelected:a,isDisabled:o,selectedIcon:s,startContent:c,endContent:l,hideSelectedIcon:u,disableAnimation:d,getItemProps:f,getLabelProps:p,getWrapperProps:m,getDescriptionProps:h,getSelectedIconProps:g}=$o(e),_=(0,I.useMemo)(()=>{let e=(0,B.jsx)(Qo,{disableAnimation:d,isSelected:a});return typeof s==`function`?s({icon:e,isSelected:a,isDisabled:o}):s||e},[s,a,o,d]);return(0,B.jsxs)(t,{...f(),children:[c,r?(0,B.jsxs)(`div`,{...m(),children:[(0,B.jsx)(`span`,{...p(),children:n}),(0,B.jsx)(`span`,{...h(),children:r})]}):(0,B.jsx)(`span`,{...p(),children:n}),i&&!u&&(0,B.jsx)(`span`,{...g(),children:_}),l]})};es.displayName=`HeroUI.ListboxItem`;var ts=es,ns=je(({item:e,state:t,as:n,variant:r,color:i,disableAnimation:a,className:o,classNames:s,hideSelectedIcon:c,showDivider:l=!1,dividerProps:u={},itemClasses:d,title:f,items:p,...m},h)=>{let g=n||`li`,_=(0,I.useMemo)(()=>Pn(),[]),v=Be(s?.base,o),y=Be(s?.divider,u?.className),{itemProps:b,headingProps:x,groupProps:S}=Xo({heading:e.rendered,"aria-label":e[`aria-label`]});return(0,B.jsxs)(g,{"data-slot":`base`,...Qe(b,m),className:_.base({class:v}),children:[e.rendered&&(0,B.jsx)(`span`,{...x,className:_.heading({class:s?.heading}),"data-slot":`heading`,children:e.rendered}),(0,B.jsxs)(`ul`,{...S,className:_.group({class:s?.group}),"data-has-title":!!e.rendered,"data-slot":`group`,children:[[...e.childNodes].map(e=>{let{key:n,props:o}=e,s=(0,B.jsx)(ts,{classNames:d,color:i,disableAnimation:a,hideSelectedIcon:c,item:e,state:t,variant:r,...o},n);return e.wrapper&&(s=e.wrapper(s)),s}),l&&(0,B.jsx)(ge,{as:`li`,className:_.divider({class:y}),...u})]})]},e.key)});ns.displayName=`HeroUI.ListboxSection`;var rs=ns;function os(e={}){let{domRef:t,isEnabled:n=!0,overflowCheck:r=`vertical`,visibility:i=`auto`,offset:a=0,onVisibilityChange:o,updateDeps:s=[]}=e,c=(0,I.useRef)(i);(0,I.useEffect)(()=>{let e=t?.current;if(!e||!n)return;let s=(t,n,r,a,s)=>{if(i===`auto`){let t=`${a}${N(s)}Scroll`;n&&r?(e.dataset[t]=`true`,e.removeAttribute(`data-${a}-scroll`),e.removeAttribute(`data-${s}-scroll`)):(e.dataset[`${a}Scroll`]=n.toString(),e.dataset[`${s}Scroll`]=r.toString(),e.removeAttribute(`data-${a}-${s}-scroll`))}else{let e=n&&r?`both`:n?a:r?s:`none`;e!==c.current&&(o?.(e),c.current=e)}},l=()=>{let t=[{type:`vertical`,prefix:`top`,suffix:`bottom`},{type:`horizontal`,prefix:`left`,suffix:`right`}],n=e.querySelector(`ul[data-slot="list"]`),i=+(n?.getAttribute(`data-virtual-scroll-height`)??e.scrollHeight),o=+(n?.getAttribute(`data-virtual-scroll-top`)??e.scrollTop);for(let{type:n,prefix:c,suffix:l}of t)if(r===n||r===`both`){let t=n===`vertical`?o>a:e.scrollLeft>a,r=n===`vertical`?o+e.clientHeight+a<i:e.scrollLeft+e.clientWidth+a<e.scrollWidth;s(n,t,r,c,l)}},u=()=>{[`top`,`bottom`,`top-bottom`,`left`,`right`,`left-right`].forEach(t=>{e.removeAttribute(`data-${t}-scroll`)})};return l(),e.addEventListener(`scroll`,l,!0),i!==`auto`&&(u(),i===`both`?(e.dataset.topBottomScroll=String(r===`vertical`),e.dataset.leftRightScroll=String(r===`horizontal`)):(e.dataset.topBottomScroll=`false`,e.dataset.leftRightScroll=`false`,[`top`,`bottom`,`left`,`right`].forEach(t=>{e.dataset[`${t}Scroll`]=String(i===t)}))),()=>{e.removeEventListener(`scroll`,l,!0),u()}},[...s,n,i,r,o,t])}function ss(e){let[t,n]=ht(e,c.variantKeys),{ref:r,as:i,children:a,className:o,style:s,size:l=40,offset:u=0,visibility:d=`auto`,isEnabled:f=!0,onVisibilityChange:p,...m}=t,h=i||`div`,g=at(r);os({domRef:g,offset:u,visibility:d,isEnabled:f,onVisibilityChange:p,updateDeps:[a],overflowCheck:e.orientation??`vertical`});let _=(0,I.useMemo)(()=>c({...n,className:o}),[mt(n),o]);return{Component:h,styles:_,domRef:g,children:a,getBaseProps:(t={})=>({ref:g,className:_,"data-orientation":e.orientation??`vertical`,style:{"--scroll-shadow-size":`${l}px`,...s,...t.style},...m,...t})}}var cs=(e,t)=>{let n=[];for(let r of e)r.type===`section`?n.push(([...r.childNodes].length+1)*t):n.push(t);return n},ls=e=>{if(!e||e.scrollTop===void 0||e.clientHeight===void 0||e.scrollHeight===void 0)return{isTop:!1,isBottom:!1,isMiddle:!1};let t=e.scrollTop===0,n=Math.ceil(e.scrollTop+e.clientHeight)>=e.scrollHeight;return{isTop:t,isBottom:n,isMiddle:!t&&!n}},us=e=>{let{Component:t,state:n,color:r,variant:i,itemClasses:a,getBaseProps:o,topContent:s,bottomContent:c,hideEmptyContent:l,hideSelectedIcon:u,shouldHighlightOnFocus:d,disableAnimation:f,getEmptyContentProps:p,getListProps:m,scrollShadowProps:h}=e,{virtualization:g}=e;if(!g||!St(g)&&!g.maxListboxHeight&&!g.itemHeight)throw Error(`You are using a virtualized listbox. VirtualizedListbox requires 'virtualization' props with 'maxListboxHeight' and 'itemHeight' properties. This error might have originated from autocomplete components that use VirtualizedListbox. Please provide these props to use the virtualized listbox.`);let{maxListboxHeight:_,itemHeight:v}=g,y=Math.min(_,v*n.collection.size),b=(0,I.useRef)(null),x=(0,I.useMemo)(()=>cs([...n.collection],v),[n.collection,v]),S=mo({count:[...n.collection].length,getScrollElement:()=>b.current,estimateSize:e=>x[e]}),C=S.getVirtualItems(),w=S.getTotalSize(),{getBaseProps:T}=ss({...h}),E=e=>{let t=[...n.collection][e.index];if(!t)return null;let o={color:r,item:t,state:n,variant:i,disableAnimation:f,hideSelectedIcon:u,...t.props},s={position:`absolute`,top:0,left:0,width:`100%`,height:`${e.size}px`,transform:`translateY(${e.start}px)`};if(t.type===`section`)return(0,B.jsx)(rs,{...o,itemClasses:a,style:{...s,...o.style}},t.key);let c=(0,B.jsx)(ts,{...o,classNames:Qe(a,t.props?.classNames),shouldHighlightOnFocus:d,style:{...s,...o.style}},t.key);return t.wrapper&&(c=t.wrapper(c)),c},[D,O]=(0,I.useState)({isTop:!1,isBottom:!0,isMiddle:!1}),k=(0,B.jsxs)(t,{...m(),"data-virtual-scroll-height":w,"data-virtual-scroll-top":b?.current?.scrollTop,children:[!n.collection.size&&!l&&(0,B.jsx)(`li`,{children:(0,B.jsx)(`div`,{...p()})}),(0,B.jsx)(`div`,{...we(T()),ref:b,style:{height:_,overflow:`auto`},onScroll:e=>{O(ls(e.target))},children:y>0&&v>0&&(0,B.jsx)(`div`,{style:{height:`${w}px`,width:`100%`,position:`relative`},children:C.map(e=>E(e))})})]});return(0,B.jsxs)(`div`,{...o(),children:[s,k,c]})},ds=je(function(e,t){let{isVirtualized:n,...r}=e,i=Zo({...r,ref:t}),{Component:a,state:o,color:s,variant:c,itemClasses:l,getBaseProps:u,topContent:d,bottomContent:f,hideEmptyContent:p,hideSelectedIcon:m,shouldHighlightOnFocus:h,disableAnimation:g,getEmptyContentProps:_,getListProps:v}=i;if(n)return(0,B.jsx)(us,{...e,...i});let y=(0,B.jsxs)(a,{...v(),children:[!o.collection.size&&!p&&(0,B.jsx)(`li`,{children:(0,B.jsx)(`div`,{..._()})}),[...o.collection].map(e=>{let t={color:s,item:e,state:o,variant:c,disableAnimation:g,hideSelectedIcon:m,...e.props};if(e.type===`section`)return(0,B.jsx)(rs,{...t,itemClasses:l},e.key);let n=(0,B.jsx)(ts,{...t,classNames:Qe(l,e.props?.classNames),shouldHighlightOnFocus:h},e.key);return e.wrapper&&(n=e.wrapper(n)),n})]});return(0,B.jsxs)(`div`,{...u(),children:[d,y,f]})}),fs=je(function(e,t){let{Component:n,state:r,label:i,hasHelper:a,isLoading:o,triggerRef:s,selectorIcon:c=(0,B.jsx)(ar,{}),description:l,errorMessage:u,isInvalid:d,startContent:f,endContent:p,placeholder:m,renderValue:h,shouldLabelBeOutside:g,disableAnimation:_,getBaseProps:v,getLabelProps:y,getTriggerProps:b,getValueProps:x,getListboxProps:S,getPopoverProps:C,getSpinnerProps:w,getMainWrapperProps:T,getInnerWrapperProps:E,getHiddenSelectProps:D,getHelperWrapperProps:k,getListboxWrapperProps:A,getDescriptionProps:j,getErrorMessageProps:ee,getSelectorIconProps:te,isClearable:M,getClearButtonProps:ne,getEndWrapperProps:ie,getEndContentProps:ae}=Ro({...e,ref:t}),oe=i?(0,B.jsx)(`label`,{...y(),children:i}):null,se=(0,I.cloneElement)(c,te()),ce=(0,I.useMemo)(()=>M&&r.selectedItems?.length?(0,B.jsx)(`span`,{...ne(),children:(0,B.jsx)(O,{})}):null,[M,ne,r.selectedItems?.length]),le=(0,I.useMemo)(()=>ce?(0,B.jsxs)(`div`,{...ie(),children:[ce,p&&(0,B.jsx)(`span`,{...ae(),children:p})]}):p&&(0,B.jsx)(`span`,{...ae(),children:p}),[ce,p,ie,ae]),N=(0,I.useMemo)(()=>{let e=d&&u;return!a||!(e||l)?null:(0,B.jsx)(`div`,{...k(),children:e?(0,B.jsx)(`div`,{...ee(),children:u}):(0,B.jsx)(`div`,{...j(),children:l})})},[a,d,u,l,k,ee,j]),ue=(0,I.useMemo)(()=>{if(!r.selectedItems?.length)return m;if(h&&typeof h==`function`){let e=[...r.selectedItems].map(e=>({key:e.key,data:e.value,type:e.type,props:e.props,textValue:e.textValue,rendered:e.rendered,"aria-label":e[`aria-label`]}));return h(e)}return r.selectedItems.map(e=>e.textValue).join(`, `)},[r.selectedItems,h,m]),de=(0,I.useMemo)(()=>o?(0,B.jsx)(re,{...w()}):se,[o,se,w]),fe=(0,I.useMemo)(()=>r.isOpen?(0,B.jsx)(ta,{...C(),children:(0,B.jsx)(Pt,{...A(),children:(0,B.jsx)(ds,{...S()})})}):null,[r.isOpen,C,r,s,A,S]);return(0,B.jsxs)(`div`,{...v(),children:[(0,B.jsx)(Uo,{...D()}),g?oe:null,(0,B.jsxs)(`div`,{...T(),children:[(0,B.jsxs)(n,{...b(),children:[g?null:oe,(0,B.jsxs)(`div`,{...E(),children:[f,(0,B.jsx)(`span`,{...x(),children:ue}),p&&r.selectedItems&&(0,B.jsx)(ot,{elementType:`span`,children:`,`}),le]}),de]}),N]}),_?fe:(0,B.jsx)(qt,{children:fe})]})});function ps(e){let[t,n]=ht(e,Ln.variantKeys),{as:r,title:i,children:a,description:o,onClose:s,isClosable:c,ref:l,icon:u,startContent:d,endContent:f,isVisible:p,isDefaultVisible:m,onVisibleChange:h,closeButtonProps:g={size:`sm`},className:_,classNames:v,...y}=t,[b,x]=Ft(p,m??!0,h),S=typeof(r||`div`)==`string`,C=at(l),w=(0,I.useCallback)(()=>{x(!1),s?.()},[x,s]),T=Be(v?.base,_),E=(0,I.useMemo)(()=>Ln({hasContent:!St(o)||!St(a),...n}),[o,mt(n)]),D=(0,I.useCallback)(()=>({"data-visible":F(b),"data-closeable":F(c),"data-has-title":F(!St(i)),"data-has-description":F(!St(o)),...Qe(we(y,{enabled:S}),we(t)),className:E.base({class:T})}),[E,T]),O=(0,I.useCallback)(()=>({className:E.mainWrapper({class:v?.mainWrapper})}),[E,v?.mainWrapper]),k=(0,I.useCallback)(()=>({className:E.description({class:v?.description})}),[E,v?.description]),A=(0,I.useCallback)(()=>({className:E.title({class:v?.title})}),[E,v?.title]),j=(0,I.useCallback)(()=>({...g,className:E.closeButton({class:v?.closeButton})}),[E,v?.closeButton]),ee=(0,I.useCallback)(()=>({className:E.alertIcon({class:v?.alertIcon})}),[E,v?.alertIcon]),te=(0,I.useCallback)(()=>({className:E.iconWrapper({class:v?.iconWrapper})}),[E,v?.iconWrapper]);return{title:i,icon:u,children:a,description:o,isClosable:c,domRef:C,endContent:f,startContent:d,getBaseProps:D,getMainWrapperProps:O,getDescriptionProps:k,getTitleProps:A,color:n.color,getCloseButtonProps:j,handleClose:w,isVisible:b,onClose:s,getAlertIconProps:ee,getIconWrapperProps:te}}var ms={primary:ir,secondary:ir,success:xe,warning:Ce,danger:A},hs=je((e,t)=>{let{title:n,icon:r,children:i,description:a,endContent:o,startContent:s,isClosable:c,domRef:l,handleClose:u,getBaseProps:d,getMainWrapperProps:f,getDescriptionProps:p,getTitleProps:m,getCloseButtonProps:h,color:g,isVisible:_,onClose:v,getAlertIconProps:y,getIconWrapperProps:b}=ps({...e,ref:t});if(!_)return null;let x=r&&(0,I.isValidElement)(r)?(0,I.cloneElement)(r,y()):null,S=ms[g]||ms.primary;return(0,B.jsxs)(`div`,{ref:l,role:`alert`,...d(),children:[s,(0,B.jsx)(`div`,{...b(),children:x||(0,B.jsx)(S,{...y()})}),(0,B.jsxs)(`div`,{...f(),children:[!St(n)&&(0,B.jsx)(`div`,{...m(),children:n}),!St(a)&&(0,B.jsx)(`div`,{...p(),children:a}),i]}),o,(c||v)&&(0,B.jsx)(M,{isIconOnly:!0,"aria-label":`Close`,radius:`full`,variant:`light`,onPress:u,...h(),children:(0,B.jsx)(yt,{height:20,width:20})})]})});hs.displayName=`HeroUI.Alert`;var gs=hs;const _s=({children:e,easyCreate:t=!1,onFolderSelect:n,className:r=t&&`rounded-lg border-2 border-dashed border-gray-300 hover:border-gray-400 text-center drag:bg-blue-50 drag:dark:bg-blue-900/20 drag:border-blue-500`,...i})=>{let[a,o]=(0,I.useState)(!1),s=(0,I.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!0),e.currentTarget.setAttribute(`data-drag-over`,`true`)},[]),c=(0,I.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),o(!1),e.currentTarget.removeAttribute(`data-drag-over`)},[]),l=(0,I.useCallback)(async e=>{e.preventDefault(),e.stopPropagation(),o(!1),e.currentTarget.removeAttribute(`data-drag-over`);let t=e.dataTransfer.items;for(let e of t)if(e.kind===`file`){let t=await e.getAsFileSystemHandle?.();if(t?.kind===`directory`){n(t);return}}},[n]);return(0,B.jsxs)(`div`,{className:`transition-colors ${r||``}`.trim(),onDragLeave:c,onDragOver:s,onDrop:l,...i,children:[t&&(0,B.jsxs)(`div`,{className:`flex flex-col items-center justify-center gap-4 h-full select-none`,children:[(0,B.jsx)(`div`,{className:`text-6xl`,children:``}),(0,B.jsx)(`div`,{className:`text-lg font-medium`,children:a?``:``}),(0,B.jsx)(`div`,{className:`text-sm text-gray-500 dark:text-gray-400`,children:``})]}),e]})};function vs(){let{histories:e,loadHistories:t,addHistory:n,getDirHandle:r}=pt();(0,I.useEffect)(()=>{t()},[]);let i=e=>{if(!e)return;let t=async(r,i=``)=>{let a=!1;for await(let[e,n]of r.entries())if(n.kind===`directory`){let r=`${i}/${e}`;r.endsWith(`/data/dialog/dialogs`)?(await wt.getState().setDialogsFolder(n,r),a=!0):r.includes(`/assess/dialogs`)&&(await wt.getState().setAssessFolder(n,r),a=!0),await t(n,r)}a&&await n(e.name,e)};t(e,e.name).catch(t=>It.error(``,e,t))},a=async e=>await e.queryPermission?.({mode:`readwrite`})===`granted`||await e.requestPermission?.({mode:`readwrite`})===`granted`?!0:(It.warn(``),!1);return(0,B.jsx)(_s,{className:`w-full h-full drag:bg-blue-100 drag:dark:bg-blue-900/20`,id:`drop-folder`,onFolderSelect:i,children:(0,B.jsx)(`div`,{className:`w-full h-full flex flex-col items-center justify-center`,children:(0,B.jsxs)(`div`,{className:`w-6xl min-h-120 max-w-full text-default-500 px-10 py-5`,children:[(0,B.jsxs)(`div`,{className:`text-2xl font-bold mb-10`,children:[` `,Me.name]}),(0,B.jsxs)(`div`,{className:`md:flex md:flex-row md:justify-between w-full`,children:[(0,B.jsxs)(`div`,{className:`md:w-1/2`,children:[(0,B.jsxs)(`div`,{className:`text-lg font-medium mb-4`,children:[(0,B.jsx)(`div`,{className:`mb-4`,children:``}),(0,B.jsx)(`div`,{children:(0,B.jsxs)(M,{color:`primary`,size:`sm`,variant:`light`,onPress:()=>{window.showDirectoryPicker?window.showDirectoryPicker().then(e=>{i(e)}).catch(e=>{It.warn(`Failed to open directory picker:`,e)}):It.warn(`Directory picker API not supported`)},children:[(0,B.jsx)(it,{size:18}),` ...`]})}),(0,B.jsxs)(`div`,{className:`text-sm m-2 pl-2`,style:{lineHeight:`2`},children:[(0,B.jsxs)(`p`,{children:[``,(0,B.jsx)(`span`,{children:(0,B.jsx)(`span`,{className:`text-primary-500`,children:wt(e=>e.dialogsFolderPath||``)})})]}),(0,B.jsxs)(`p`,{children:[``,(0,B.jsx)(`span`,{children:(0,B.jsx)(`span`,{className:`text-primary-500`,children:wt(e=>e.assessFolderPath||``)})})]})]})]}),(0,B.jsxs)(`div`,{className:`text-lg font-medium mb-4`,children:[(0,B.jsx)(`div`,{className:`mb-4`,children:``}),e.map(e=>(0,B.jsx)(`div`,{children:(0,B.jsxs)(M,{color:`primary`,size:`sm`,variant:`light`,onPress:()=>{r(e).then(e=>{e&&a(e).then(t=>t&&i(e??null))})},children:[(0,B.jsx)(it,{size:18}),` `,e]})},e))]})]}),(0,B.jsxs)(`div`,{className:`md:w-1/2 hidden md:block`,children:[(0,B.jsx)(`div`,{className:`text-lg font-medium mb-4`,children:``}),(0,B.jsxs)(`ul`,{className:`text-md list-decimal pl-5 space-y-2`,children:[(0,B.jsx)(`li`,{children:``}),(0,B.jsx)(`li`,{children:` KubeJs  kubejs `}),(0,B.jsx)(`li`,{children:` Global Packs  global_packs `}),(0,B.jsx)(`li`,{children:` data  assess `}),(0,B.jsxs)(`li`,{children:[(0,B.jsx)(`p`,{children:``}),(0,B.jsxs)(`ul`,{className:`text-sm list-disc pt-2 pl-5 space-y-2`,children:[(0,B.jsx)(`li`,{children:`data\\dialog\\dialogs`}),(0,B.jsx)(`li`,{children:`assess\\dialogs\\lang`}),(0,B.jsx)(`li`,{children:`assess\\dialogs\\textures\\backgrounds`}),(0,B.jsx)(`li`,{children:`assess\\dialogs\\textures\\dialog_background`}),(0,B.jsx)(`li`,{children:`assess\\dialogs\\textures\\portraits`}),(0,B.jsx)(`li`,{children:`assess\\dialogs\\textures\\textures\\gui\\sprites`})]})]})]})]})]})]})})})}function ys(e){"@babel/helpers - typeof";return ys=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e},ys(e)}function bs(e,t){if(ys(e)!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(ys(r)!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function xs(e){var t=bs(e,`string`);return ys(t)==`symbol`?t:t+``}function V(e,t,n){return(t=xs(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ss(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Cs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?Ss(Object(n),!0).forEach(function(t){V(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ss(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function H(e,t){if(!(e instanceof t))throw TypeError(`Cannot call a class as a function`)}function ws(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,xs(r.key),r)}}function U(e,t,n){return t&&ws(e.prototype,t),n&&ws(e,n),Object.defineProperty(e,`prototype`,{writable:!1}),e}function Ts(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Es(e){if(Array.isArray(e))return Ts(e)}function Ds(e){if(typeof Symbol<`u`&&e[Symbol.iterator]!=null||e[`@@iterator`]!=null)return Array.from(e)}function Os(e,t){if(e){if(typeof e==`string`)return Ts(e,t);var n={}.toString.call(e).slice(8,-1);return n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`?Array.from(e):n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ts(e,t):void 0}}function ks(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function As(e){return Es(e)||Ds(e)||Os(e)||ks()}function js(e){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},js(e)}function Ms(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ms=function(){return!!e})()}function Ns(e){if(e===void 0)throw ReferenceError(`this hasn't been initialised - super() hasn't been called`);return e}function Ps(e,t){if(t&&(ys(t)==`object`||typeof t==`function`))return t;if(t!==void 0)throw TypeError(`Derived constructors may only return object or undefined`);return Ns(e)}function Fs(e,t,n){return t=js(t),Ps(e,Ms()?Reflect.construct(t,n||[],js(e).constructor):t.apply(e,n))}function Is(e,t){return Is=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Is(e,t)}function Ls(e,t){if(typeof t!=`function`&&t!==null)throw TypeError(`Super expression must either be null or a function`);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,`prototype`,{writable:!1}),t&&Is(e,t)}function Rs(e){if(Array.isArray(e))return e}function zs(e,t){var n=e==null?null:typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(n!=null){var r,i,a,o,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}function Bs(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vs(e,t){return Rs(e)||zs(e,t)||Os(e,t)||Bs()}var Hs=t(r(((exports,t)=>{var n=Object.prototype.hasOwnProperty,r=`~`;function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,i,o){if(typeof n!=`function`)throw TypeError(`The listener must be a function`);var s=new a(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function s(e,t){--e._eventsCount===0?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)n.call(t,i)&&e.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},c.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=Array(a);i<a;i++)o[i]=n[i].fn;return o},c.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var c=this._events[s],l=arguments.length,u,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(d=1,u=Array(l-1);d<l;d++)u[d-1]=arguments[d];c.fn.apply(c.context,u)}else{var f=c.length,p;for(d=0;d<f;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),l){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,n);break;case 4:c[d].fn.call(c[d].context,t,n,i);break;default:if(!u)for(p=1,u=Array(l-1);p<l;p++)u[p-1]=arguments[p];c[d].fn.apply(c[d].context,u)}}return!0},c.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn===t&&(!i||o.once)&&(!n||o.context===n)&&s(this,a);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||i&&!o[c].once||n&&o[c].context!==n)&&l.push(o[c]);l.length?this._events[a]=l.length===1?l[0]:l:s(this,a)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t!==void 0&&(t.exports=c)}))(),1).default,Us=typeof Float32Array<`u`?Float32Array:Array;Math.PI/180,180/Math.PI;function Ws(){var e=new Us(9);return Us!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Gs(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function Ks(e,t,n,r,i,a,o,s,c){var l=new Us(9);return l[0]=e,l[1]=t,l[2]=n,l[3]=r,l[4]=i,l[5]=a,l[6]=o,l[7]=s,l[8]=c,l}var qs=n({add:()=>Rc,adjoint:()=>nc,clone:()=>Ys,copy:()=>Xs,create:()=>Js,decompose:()=>Sc,determinant:()=>rc,equals:()=>Uc,exactEquals:()=>Hc,frob:()=>Lc,fromQuat:()=>Tc,fromQuat2:()=>vc,fromRotation:()=>pc,fromRotationTranslation:()=>_c,fromRotationTranslationScale:()=>Cc,fromRotationTranslationScaleOrigin:()=>wc,fromScaling:()=>fc,fromTranslation:()=>dc,fromValues:()=>Zs,fromXRotation:()=>mc,fromYRotation:()=>hc,fromZRotation:()=>gc,frustum:()=>Ec,getRotation:()=>xc,getScaling:()=>bc,getTranslation:()=>yc,identity:()=>$s,invert:()=>tc,lookAt:()=>Pc,mul:()=>Wc,multiply:()=>ic,multiplyScalar:()=>Bc,multiplyScalarAndAdd:()=>Vc,ortho:()=>Mc,orthoNO:()=>jc,orthoZO:()=>Nc,perspective:()=>Oc,perspectiveFromFieldOfView:()=>Ac,perspectiveNO:()=>Dc,perspectiveZO:()=>kc,rotate:()=>sc,rotateX:()=>cc,rotateY:()=>lc,rotateZ:()=>uc,scale:()=>oc,set:()=>Qs,str:()=>Ic,sub:()=>Gc,subtract:()=>zc,targetTo:()=>Fc,translate:()=>ac,transpose:()=>ec});function Js(){var e=new Us(16);return Us!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ys(e){var t=new Us(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Xs(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Zs(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h){var g=new Us(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=r,g[4]=i,g[5]=a,g[6]=o,g[7]=s,g[8]=c,g[9]=l,g[10]=u,g[11]=d,g[12]=f,g[13]=p,g[14]=m,g[15]=h,g}function Qs(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=s,e[7]=c,e[8]=l,e[9]=u,e[10]=d,e[11]=f,e[12]=p,e[13]=m,e[14]=h,e[15]=g,e}function $s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ec(e,t){if(e===t){var n=t[1],r=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function tc(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],h=t[13],g=t[14],_=t[15],v=n*s-r*o,y=n*c-i*o,b=n*l-a*o,x=r*c-i*s,S=r*l-a*s,C=i*l-a*c,w=u*h-d*m,T=u*g-f*m,E=u*_-p*m,D=d*g-f*h,O=d*_-p*h,k=f*_-p*g,A=v*k-y*O+b*D+x*E-S*T+C*w;return A?(A=1/A,e[0]=(s*k-c*O+l*D)*A,e[1]=(i*O-r*k-a*D)*A,e[2]=(h*C-g*S+_*x)*A,e[3]=(f*S-d*C-p*x)*A,e[4]=(c*E-o*k-l*T)*A,e[5]=(n*k-i*E+a*T)*A,e[6]=(g*b-m*C-_*y)*A,e[7]=(u*C-f*b+p*y)*A,e[8]=(o*O-s*E+l*w)*A,e[9]=(r*E-n*O-a*w)*A,e[10]=(m*S-h*b+_*v)*A,e[11]=(d*b-u*S-p*v)*A,e[12]=(s*T-o*D-c*w)*A,e[13]=(n*D-r*T+i*w)*A,e[14]=(h*y-m*x-g*v)*A,e[15]=(u*x-d*y+f*v)*A,e):null}function nc(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],h=t[13],g=t[14],_=t[15],v=n*s-r*o,y=n*c-i*o,b=n*l-a*o,x=r*c-i*s,S=r*l-a*s,C=i*l-a*c,w=u*h-d*m,T=u*g-f*m,E=u*_-p*m,D=d*g-f*h,O=d*_-p*h,k=f*_-p*g;return e[0]=s*k-c*O+l*D,e[1]=i*O-r*k-a*D,e[2]=h*C-g*S+_*x,e[3]=f*S-d*C-p*x,e[4]=c*E-o*k-l*T,e[5]=n*k-i*E+a*T,e[6]=g*b-m*C-_*y,e[7]=u*C-f*b+p*y,e[8]=o*O-s*E+l*w,e[9]=r*E-n*O-a*w,e[10]=m*S-h*b+_*v,e[11]=d*b-u*S-p*v,e[12]=s*T-o*D-c*w,e[13]=n*D-r*T+i*w,e[14]=h*y-m*x-g*v,e[15]=u*x-d*y+f*v,e}function rc(e){var t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],c=e[7],l=e[8],u=e[9],d=e[10],f=e[11],p=e[12],m=e[13],h=e[14],g=e[15],_=t*o-n*a,v=t*s-r*a,y=n*s-r*o,b=l*m-u*p,x=l*h-d*p,S=u*h-d*m,C=t*S-n*x+r*b,w=a*S-o*x+s*b,T=l*y-u*v+d*_,E=p*y-m*v+h*_;return c*C-i*w+g*T-f*E}function ic(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=t[8],f=t[9],p=t[10],m=t[11],h=t[12],g=t[13],_=t[14],v=t[15],y=n[0],b=n[1],x=n[2],S=n[3];return e[0]=y*r+b*s+x*d+S*h,e[1]=y*i+b*c+x*f+S*g,e[2]=y*a+b*l+x*p+S*_,e[3]=y*o+b*u+x*m+S*v,y=n[4],b=n[5],x=n[6],S=n[7],e[4]=y*r+b*s+x*d+S*h,e[5]=y*i+b*c+x*f+S*g,e[6]=y*a+b*l+x*p+S*_,e[7]=y*o+b*u+x*m+S*v,y=n[8],b=n[9],x=n[10],S=n[11],e[8]=y*r+b*s+x*d+S*h,e[9]=y*i+b*c+x*f+S*g,e[10]=y*a+b*l+x*p+S*_,e[11]=y*o+b*u+x*m+S*v,y=n[12],b=n[13],x=n[14],S=n[15],e[12]=y*r+b*s+x*d+S*h,e[13]=y*i+b*c+x*f+S*g,e[14]=y*a+b*l+x*p+S*_,e[15]=y*o+b*u+x*m+S*v,e}function ac(e,t,n){var r=n[0],i=n[1],a=n[2],o,s,c,l,u,d,f,p,m,h,g,_;return t===e?(e[12]=t[0]*r+t[4]*i+t[8]*a+t[12],e[13]=t[1]*r+t[5]*i+t[9]*a+t[13],e[14]=t[2]*r+t[6]*i+t[10]*a+t[14],e[15]=t[3]*r+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],c=t[2],l=t[3],u=t[4],d=t[5],f=t[6],p=t[7],m=t[8],h=t[9],g=t[10],_=t[11],e[0]=o,e[1]=s,e[2]=c,e[3]=l,e[4]=u,e[5]=d,e[6]=f,e[7]=p,e[8]=m,e[9]=h,e[10]=g,e[11]=_,e[12]=o*r+u*i+m*a+t[12],e[13]=s*r+d*i+h*a+t[13],e[14]=c*r+f*i+g*a+t[14],e[15]=l*r+p*i+_*a+t[15]),e}function oc(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function sc(e,t,n,r){var i=r[0],a=r[1],o=r[2],s=Math.sqrt(i*i+a*a+o*o),c,l,u,d,f,p,m,h,g,_,v,y,b,x,S,C,w,T,E,D,O,k,A,j;return s<1e-6?null:(s=1/s,i*=s,a*=s,o*=s,c=Math.sin(n),l=Math.cos(n),u=1-l,d=t[0],f=t[1],p=t[2],m=t[3],h=t[4],g=t[5],_=t[6],v=t[7],y=t[8],b=t[9],x=t[10],S=t[11],C=i*i*u+l,w=a*i*u+o*c,T=o*i*u-a*c,E=i*a*u-o*c,D=a*a*u+l,O=o*a*u+i*c,k=i*o*u+a*c,A=a*o*u-i*c,j=o*o*u+l,e[0]=d*C+h*w+y*T,e[1]=f*C+g*w+b*T,e[2]=p*C+_*w+x*T,e[3]=m*C+v*w+S*T,e[4]=d*E+h*D+y*O,e[5]=f*E+g*D+b*O,e[6]=p*E+_*D+x*O,e[7]=m*E+v*D+S*O,e[8]=d*k+h*A+y*j,e[9]=f*k+g*A+b*j,e[10]=p*k+_*A+x*j,e[11]=m*k+v*A+S*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function cc(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],c=t[7],l=t[8],u=t[9],d=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*r,e[5]=o*i+u*r,e[6]=s*i+d*r,e[7]=c*i+f*r,e[8]=l*i-a*r,e[9]=u*i-o*r,e[10]=d*i-s*r,e[11]=f*i-c*r,e}function lc(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],c=t[3],l=t[8],u=t[9],d=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*r,e[1]=o*i-u*r,e[2]=s*i-d*r,e[3]=c*i-f*r,e[8]=a*r+l*i,e[9]=o*r+u*i,e[10]=s*r+d*i,e[11]=c*r+f*i,e}function uc(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],c=t[3],l=t[4],u=t[5],d=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*r,e[1]=o*i+u*r,e[2]=s*i+d*r,e[3]=c*i+f*r,e[4]=l*i-a*r,e[5]=u*i-o*r,e[6]=d*i-s*r,e[7]=f*i-c*r,e}function dc(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function fc(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pc(e,t,n){var r=n[0],i=n[1],a=n[2],o=Math.sqrt(r*r+i*i+a*a),s,c,l;return o<1e-6?null:(o=1/o,r*=o,i*=o,a*=o,s=Math.sin(t),c=Math.cos(t),l=1-c,e[0]=r*r*l+c,e[1]=i*r*l+a*s,e[2]=a*r*l-i*s,e[3]=0,e[4]=r*i*l-a*s,e[5]=i*i*l+c,e[6]=a*i*l+r*s,e[7]=0,e[8]=r*a*l+i*s,e[9]=i*a*l-r*s,e[10]=a*a*l+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function mc(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function hc(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gc(e,t){var n=Math.sin(t),r=Math.cos(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _c(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,c=i+i,l=a+a,u=r*s,d=r*c,f=r*l,p=i*c,m=i*l,h=a*l,g=o*s,_=o*c,v=o*l;return e[0]=1-(p+h),e[1]=d+v,e[2]=f-_,e[3]=0,e[4]=d-v,e[5]=1-(u+h),e[6]=m+g,e[7]=0,e[8]=f+_,e[9]=m-g,e[10]=1-(u+p),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function vc(e,t){var n=new Us(3),r=-t[0],i=-t[1],a=-t[2],o=t[3],s=t[4],c=t[5],l=t[6],u=t[7],d=r*r+i*i+a*a+o*o;return d>0?(n[0]=(s*o+u*r+c*a-l*i)*2/d,n[1]=(c*o+u*i+l*r-s*a)*2/d,n[2]=(l*o+u*a+s*i-c*r)*2/d):(n[0]=(s*o+u*r+c*a-l*i)*2,n[1]=(c*o+u*i+l*r-s*a)*2,n[2]=(l*o+u*a+s*i-c*r)*2),_c(e,t,n),e}function yc(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function bc(e,t){var n=t[0],r=t[1],i=t[2],a=t[4],o=t[5],s=t[6],c=t[8],l=t[9],u=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(a*a+o*o+s*s),e[2]=Math.sqrt(c*c+l*l+u*u),e}function xc(e,t){var n=new Us(3);bc(n,t);var r=1/n[0],i=1/n[1],a=1/n[2],o=t[0]*r,s=t[1]*i,c=t[2]*a,l=t[4]*r,u=t[5]*i,d=t[6]*a,f=t[8]*r,p=t[9]*i,m=t[10]*a,h=o+u+m,g=0;return h>0?(g=Math.sqrt(h+1)*2,e[3]=.25*g,e[0]=(d-p)/g,e[1]=(f-c)/g,e[2]=(s-l)/g):o>u&&o>m?(g=Math.sqrt(1+o-u-m)*2,e[3]=(d-p)/g,e[0]=.25*g,e[1]=(s+l)/g,e[2]=(f+c)/g):u>m?(g=Math.sqrt(1+u-o-m)*2,e[3]=(f-c)/g,e[0]=(s+l)/g,e[1]=.25*g,e[2]=(d+p)/g):(g=Math.sqrt(1+m-o-u)*2,e[3]=(s-l)/g,e[0]=(f+c)/g,e[1]=(d+p)/g,e[2]=.25*g),e}function Sc(e,t,n,r){t[0]=r[12],t[1]=r[13],t[2]=r[14];var i=r[0],a=r[1],o=r[2],s=r[4],c=r[5],l=r[6],u=r[8],d=r[9],f=r[10];n[0]=Math.sqrt(i*i+a*a+o*o),n[1]=Math.sqrt(s*s+c*c+l*l),n[2]=Math.sqrt(u*u+d*d+f*f);var p=1/n[0],m=1/n[1],h=1/n[2],g=i*p,_=a*m,v=o*h,y=s*p,b=c*m,x=l*h,S=u*p,C=d*m,w=f*h,T=g+b+w,E=0;return T>0?(E=Math.sqrt(T+1)*2,e[3]=.25*E,e[0]=(x-C)/E,e[1]=(S-v)/E,e[2]=(_-y)/E):g>b&&g>w?(E=Math.sqrt(1+g-b-w)*2,e[3]=(x-C)/E,e[0]=.25*E,e[1]=(_+y)/E,e[2]=(S+v)/E):b>w?(E=Math.sqrt(1+b-g-w)*2,e[3]=(S-v)/E,e[0]=(_+y)/E,e[1]=.25*E,e[2]=(x+C)/E):(E=Math.sqrt(1+w-g-b)*2,e[3]=(_-y)/E,e[0]=(S+v)/E,e[1]=(x+C)/E,e[2]=.25*E),e}function Cc(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],c=i+i,l=a+a,u=o+o,d=i*c,f=i*l,p=i*u,m=a*l,h=a*u,g=o*u,_=s*c,v=s*l,y=s*u,b=r[0],x=r[1],S=r[2];return e[0]=(1-(m+g))*b,e[1]=(f+y)*b,e[2]=(p-v)*b,e[3]=0,e[4]=(f-y)*x,e[5]=(1-(d+g))*x,e[6]=(h+_)*x,e[7]=0,e[8]=(p+v)*S,e[9]=(h-_)*S,e[10]=(1-(d+m))*S,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function wc(e,t,n,r,i){var a=t[0],o=t[1],s=t[2],c=t[3],l=a+a,u=o+o,d=s+s,f=a*l,p=a*u,m=a*d,h=o*u,g=o*d,_=s*d,v=c*l,y=c*u,b=c*d,x=r[0],S=r[1],C=r[2],w=i[0],T=i[1],E=i[2],D=(1-(h+_))*x,O=(p+b)*x,k=(m-y)*x,A=(p-b)*S,j=(1-(f+_))*S,ee=(g+v)*S,te=(m+y)*C,M=(g-v)*C,ne=(1-(f+h))*C;return e[0]=D,e[1]=O,e[2]=k,e[3]=0,e[4]=A,e[5]=j,e[6]=ee,e[7]=0,e[8]=te,e[9]=M,e[10]=ne,e[11]=0,e[12]=n[0]+w-(D*w+A*T+te*E),e[13]=n[1]+T-(O*w+j*T+M*E),e[14]=n[2]+E-(k*w+ee*T+ne*E),e[15]=1,e}function Tc(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n+n,s=r+r,c=i+i,l=n*o,u=r*o,d=r*s,f=i*o,p=i*s,m=i*c,h=a*o,g=a*s,_=a*c;return e[0]=1-d-m,e[1]=u+_,e[2]=f-g,e[3]=0,e[4]=u-_,e[5]=1-l-m,e[6]=p+h,e[7]=0,e[8]=f+g,e[9]=p-h,e[10]=1-l-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ec(e,t,n,r,i,a,o){var s=1/(n-t),c=1/(i-r),l=1/(a-o);return e[0]=a*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*c,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(i+r)*c,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function Dc(e,t,n,r,i){var a=1/Math.tan(t/2);if(e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){var o=1/(r-i);e[10]=(i+r)*o,e[14]=2*i*r*o}else e[10]=-1,e[14]=-2*r;return e}var Oc=Dc;function kc(e,t,n,r,i){var a=1/Math.tan(t/2);if(e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){var o=1/(r-i);e[10]=i*o,e[14]=i*r*o}else e[10]=-1,e[14]=-r;return e}function Ac(e,t,n,r){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),c=2/(o+s),l=2/(i+a);return e[0]=c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-((o-s)*c*.5),e[9]=(i-a)*l*.5,e[10]=r/(n-r),e[11]=-1,e[12]=0,e[13]=0,e[14]=r*n/(n-r),e[15]=0,e}function jc(e,t,n,r,i,a,o){var s=1/(t-n),c=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=(o+a)*l,e[15]=1,e}var Mc=jc;function Nc(e,t,n,r,i,a,o){var s=1/(t-n),c=1/(r-i),l=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=l,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*c,e[14]=a*l,e[15]=1,e}function Pc(e,t,n,r){var i,a,o,s,c,l,u,d,f,p,m=t[0],h=t[1],g=t[2],_=r[0],v=r[1],y=r[2],b=n[0],x=n[1],S=n[2];return Math.abs(m-b)<1e-6&&Math.abs(h-x)<1e-6&&Math.abs(g-S)<1e-6?$s(e):(u=m-b,d=h-x,f=g-S,p=1/Math.sqrt(u*u+d*d+f*f),u*=p,d*=p,f*=p,i=v*f-y*d,a=y*u-_*f,o=_*d-v*u,p=Math.sqrt(i*i+a*a+o*o),p?(p=1/p,i*=p,a*=p,o*=p):(i=0,a=0,o=0),s=d*o-f*a,c=f*i-u*o,l=u*a-d*i,p=Math.sqrt(s*s+c*c+l*l),p?(p=1/p,s*=p,c*=p,l*=p):(s=0,c=0,l=0),e[0]=i,e[1]=s,e[2]=u,e[3]=0,e[4]=a,e[5]=c,e[6]=d,e[7]=0,e[8]=o,e[9]=l,e[10]=f,e[11]=0,e[12]=-(i*m+a*h+o*g),e[13]=-(s*m+c*h+l*g),e[14]=-(u*m+d*h+f*g),e[15]=1,e)}function Fc(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=r[0],c=r[1],l=r[2],u=i-n[0],d=a-n[1],f=o-n[2],p=u*u+d*d+f*f;p>0&&(p=1/Math.sqrt(p),u*=p,d*=p,f*=p);var m=c*f-l*d,h=l*u-s*f,g=s*d-c*u;return p=m*m+h*h+g*g,p>0&&(p=1/Math.sqrt(p),m*=p,h*=p,g*=p),e[0]=m,e[1]=h,e[2]=g,e[3]=0,e[4]=d*g-f*h,e[5]=f*m-u*g,e[6]=u*h-d*m,e[7]=0,e[8]=u,e[9]=d,e[10]=f,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function Ic(e){return`mat4(`+e[0]+`, `+e[1]+`, `+e[2]+`, `+e[3]+`, `+e[4]+`, `+e[5]+`, `+e[6]+`, `+e[7]+`, `+e[8]+`, `+e[9]+`, `+e[10]+`, `+e[11]+`, `+e[12]+`, `+e[13]+`, `+e[14]+`, `+e[15]+`)`}function Lc(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8]+e[9]*e[9]+e[10]*e[10]+e[11]*e[11]+e[12]*e[12]+e[13]*e[13]+e[14]*e[14]+e[15]*e[15])}function Rc(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function zc(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function Bc(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function Vc(e,t,n,r){return e[0]=t[0]+n[0]*r,e[1]=t[1]+n[1]*r,e[2]=t[2]+n[2]*r,e[3]=t[3]+n[3]*r,e[4]=t[4]+n[4]*r,e[5]=t[5]+n[5]*r,e[6]=t[6]+n[6]*r,e[7]=t[7]+n[7]*r,e[8]=t[8]+n[8]*r,e[9]=t[9]+n[9]*r,e[10]=t[10]+n[10]*r,e[11]=t[11]+n[11]*r,e[12]=t[12]+n[12]*r,e[13]=t[13]+n[13]*r,e[14]=t[14]+n[14]*r,e[15]=t[15]+n[15]*r,e}function Hc(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Uc(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8],d=e[9],f=e[10],p=e[11],m=e[12],h=e[13],g=e[14],_=e[15],v=t[0],y=t[1],b=t[2],x=t[3],S=t[4],C=t[5],w=t[6],T=t[7],E=t[8],D=t[9],O=t[10],k=t[11],A=t[12],j=t[13],ee=t[14],te=t[15];return Math.abs(n-v)<=1e-6*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-y)<=1e-6*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-b)<=1e-6*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-x)<=1e-6*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-S)<=1e-6*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(s-C)<=1e-6*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(c-w)<=1e-6*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(l-T)<=1e-6*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(u-E)<=1e-6*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(d-D)<=1e-6*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(f-O)<=1e-6*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(p-k)<=1e-6*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(m-A)<=1e-6*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(h-j)<=1e-6*Math.max(1,Math.abs(h),Math.abs(j))&&Math.abs(g-ee)<=1e-6*Math.max(1,Math.abs(g),Math.abs(ee))&&Math.abs(_-te)<=1e-6*Math.max(1,Math.abs(_),Math.abs(te))}var Wc=ic,Gc=zc;function Kc(){var e=new Us(3);return Us!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function qc(e){var t=new Us(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Jc(e){var t=e[0],n=e[1],r=e[2];return Math.sqrt(t*t+n*n+r*r)}function Yc(e,t,n){var r=new Us(3);return r[0]=e,r[1]=t,r[2]=n,r}function Xc(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Zc(e,t,n,r){return e[0]=t,e[1]=n,e[2]=r,e}function Qc(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}function $c(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}function el(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}function tl(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}function nl(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}function rl(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function il(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}function al(e,t){var n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function ol(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function sl(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],c=n[2];return e[0]=i*c-a*s,e[1]=a*o-r*c,e[2]=r*s-i*o,e}function cl(e,t,n,r){var i=t[0],a=t[1],o=t[2];return e[0]=i+r*(n[0]-i),e[1]=a+r*(n[1]-a),e[2]=o+r*(n[2]-o),e}function ll(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[3]*r+n[7]*i+n[11]*a+n[15];return o||=1,e[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/o,e[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/o,e[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/o,e}function ul(e,t,n){var r=t[0],i=t[1],a=t[2];return e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8],e}function dl(e,t,n){var r=n[0],i=n[1],a=n[2],o=n[3],s=t[0],c=t[1],l=t[2],u=i*l-a*c,d=a*s-r*l,f=r*c-i*s;return u+=u,d+=d,f+=f,e[0]=s+o*u+i*f-a*d,e[1]=c+o*d+a*u-r*f,e[2]=l+o*f+r*d-i*u,e}function fl(e,t){var n=e[0],r=e[1],i=e[2],a=t[0],o=t[1],s=t[2];return Math.abs(n-a)<=1e-6*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-s)<=1e-6*Math.max(1,Math.abs(i),Math.abs(s))}var pl=$c,ml=il,hl=Jc;(function(){var e=Kc();return function(t,n,r,i,a,o){var s,c;for(n||=3,r||=0,c=i?Math.min(i*n+r,t.length):t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}})();function gl(){var e=new Us(4);return Us!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function _l(e,t,n,r){var i=new Us(4);return i[0]=e,i[1]=t,i[2]=n,i[3]=r,i}function vl(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function yl(e,t,n,r,i){return e[0]=t,e[1]=n,e[2]=r,e[3]=i,e}function bl(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=n*o,e[1]=r*o,e[2]=i*o,e[3]=a*o,e}function xl(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}(function(){var e=gl();return function(t,n,r,i,a,o){var s,c;for(n||=4,r||=0,c=i?Math.min(i*n+r,t.length):t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}})();function Sl(){var e=new Us(4);return Us!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Cl(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function wl(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=n[0],c=n[1],l=n[2],u=n[3];return e[0]=r*u+o*s+i*l-a*c,e[1]=i*u+o*c+a*s-r*l,e[2]=a*u+o*l+r*c-i*s,e[3]=o*u-r*s-i*c-a*l,e}function Tl(e,t,n,r){var i=t[0],a=t[1],o=t[2],s=t[3],c=n[0],l=n[1],u=n[2],d=n[3],f,p=i*c+a*l+o*u+s*d,m,h,g;return p<0&&(p=-p,c=-c,l=-l,u=-u,d=-d),1-p>1e-6?(f=Math.acos(p),m=Math.sin(f),h=Math.sin((1-r)*f)/m,g=Math.sin(r*f)/m):(h=1-r,g=r),e[0]=h*i+g*c,e[1]=h*a+g*l,e[2]=h*o+g*u,e[3]=h*s+g*d,e}function El(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-i*s,e[3]=a*s,e}function Dl(e,t){var n=t[0]+t[4]+t[8],r;if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;r=Math.sqrt(t[i*3+i]-t[a*3+a]-t[o*3+o]+1),e[i]=.5*r,r=.5/r,e[3]=(t[a*3+o]-t[o*3+a])*r,e[a]=(t[a*3+i]+t[i*3+a])*r,e[o]=(t[o*3+i]+t[i*3+o])*r}return e}function Ol(e,t,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:`zyx`,a=Math.PI/360;t*=a,r*=a,n*=a;var o=Math.sin(t),s=Math.cos(t),c=Math.sin(n),l=Math.cos(n),u=Math.sin(r),d=Math.cos(r);switch(i){case`xyz`:e[0]=o*l*d+s*c*u,e[1]=s*c*d-o*l*u,e[2]=s*l*u+o*c*d,e[3]=s*l*d-o*c*u;break;case`xzy`:e[0]=o*l*d-s*c*u,e[1]=s*c*d-o*l*u,e[2]=s*l*u+o*c*d,e[3]=s*l*d+o*c*u;break;case`yxz`:e[0]=o*l*d+s*c*u,e[1]=s*c*d-o*l*u,e[2]=s*l*u-o*c*d,e[3]=s*l*d+o*c*u;break;case`yzx`:e[0]=o*l*d+s*c*u,e[1]=s*c*d+o*l*u,e[2]=s*l*u-o*c*d,e[3]=s*l*d-o*c*u;break;case`zxy`:e[0]=o*l*d-s*c*u,e[1]=s*c*d+o*l*u,e[2]=s*l*u+o*c*d,e[3]=s*l*d-o*c*u;break;case`zyx`:e[0]=o*l*d-s*c*u,e[1]=s*c*d+o*l*u,e[2]=s*l*u-o*c*d,e[3]=s*l*d+o*c*u;break;default:throw Error(`Unknown angle order `+i)}return e}var kl=_l,Al=vl,jl=yl,Ml=wl,Nl=bl;(function(){var e=Kc(),t=Yc(1,0,0),n=Yc(0,1,0);return function(r,i,a){var o=ol(i,a);return o<-.999999?(sl(e,t,i),hl(e)<1e-6&&sl(e,n,i),al(e,e),Cl(r,e,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(sl(e,i,a),r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=1+o,Nl(r,r))}})(),function(){var e=Sl(),t=Sl();return function(n,r,i,a,o,s){return Tl(e,r,o,s),Tl(t,i,a,s),Tl(n,e,t,2*s*(1-s)),n}}(),function(){var e=Ws();return function(t,n,r,i){return e[0]=r[0],e[3]=r[1],e[6]=r[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-n[0],e[5]=-n[1],e[8]=-n[2],Nl(t,Dl(t,e))}}();function Pl(){var e=new Us(2);return Us!=Float32Array&&(e[0]=0,e[1]=0),e}function Fl(e,t){return e[0]=t[0],e[1]=t[1],e}function Il(e,t,n){return e[0]=t,e[1]=n,e}function Ll(e,t){var n=t[0],r=t[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Rl(e,t){return e[0]*t[0]+e[1]*t[1]}function zl(e,t){return e[0]===t[0]&&e[1]===t[1]}(function(){var e=Pl();return function(t,n,r,i,a,o){var s,c;for(n||=2,r||=0,c=i?Math.min(i*n+r,t.length):t.length,s=r;s<c;s+=n)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}})();var Bl=function(e){return e!==null&&typeof e!=`function`&&isFinite(e.length)},Vl=function(e,t){return Bl(e)?e.indexOf(t)>-1:!1},Hl=function(e,t){if(!Bl(e))return e;for(var n=[],r=0;r<e.length;r++){var i=e[r];t(i,r)&&n.push(i)}return n},Ul=function(e,t){return t===void 0&&(t=[]),Hl(e,function(e){return!Vl(t,e)})};function W(e){return typeof e==`function`}function Wl(e){return e==null}function Gl(e){return Array.isArray(e)}var Kl=(function(e){var t=typeof e;return e!==null&&t===`object`||t===`function`});function ql(e,t){if(e){var n;if(Gl(e))for(var r=0,i=e.length;r<i&&(n=t(e[r],r),n!==!1);r++);else if(Kl(e)){for(var a in e)if(e.hasOwnProperty(a)&&(n=t(e[a],a),n===!1))break}}}var Jl=ql,Yl=function(e){return typeof e==`object`&&!!e},Xl={}.toString,Zl=function(e,t){return Xl.call(e)===`[object `+t+`]`},Ql=function(e){if(!Yl(e)||!Zl(e,`Object`))return!1;if(Object.getPrototypeOf(e)===null)return!0;for(var t=e;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},$l=function(e){if(!Gl(e))return[];for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t};function eu(e){if(!Array.isArray(e))return-1/0;var t=e.length;if(!t)return-1/0;for(var n=e[0],r=1;r<t;r++)n=Math.max(n,e[r]);return n}var tu=(function(e){if(Gl(e))return e.reduce(function(e,t){return Math.min(e,t)},e[0])}),nu=function(e,t,n){if(!Gl(e)&&!Ql(e))return e;var r=n;return Jl(e,function(e,n){r=t(r,e,n)}),r};function ru(e){return typeof e==`string`}function iu(e,t){t===void 0&&(t=new Map);var n=[];if(Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];t.has(a)||(n.push(a),t.set(a,!0))}return n}var au=Object.prototype.hasOwnProperty;function ou(e,t){if(!t||!Gl(e))return{};for(var n={},r=W(t)?t:function(e){return e[t]},i,a=0;a<e.length;a++){var o=e[a];i=r(o),au.call(n,i)?n[i].push(o):n[i]=[o]}return n}var su=ou,cu=function(e,t,n){return e<t?t:e>n?n:e};function G(e){return typeof e==`number`}var lu=1e-5;function uu(e,t,n){return n===void 0&&(n=lu),e===t||Math.abs(e-t)<n}var du=(function(e,t){if(Gl(e)){for(var n,r=-1/0,i=0;i<e.length;i++){var a=e[i],o=W(t)?t(a):a[t];o>r&&(n=a,r=o)}return n}}),fu=(function(e,t){if(Gl(e)){for(var n,r=1/0,i=0;i<e.length;i++){var a=e[i],o=W(t)?t(a):a[t];o<r&&(n=a,r=o)}return n}}),pu=function(e,t){return(e%t+t)%t},mu=(function(e){return Wl(e)?``:e.toString()}),hu=function(e){var t=mu(e);return t.charAt(0).toLowerCase()+t.substring(1)};function gu(e,t){return!e||!t?e:e.replace(/\\?\{([^{}]+)\}/g,function(e,n){return e.charAt(0)===`\\`?e.slice(1):t[n]===void 0?``:t[n]})}var _u=gu,vu=function(e){var t=mu(e);return t.charAt(0).toUpperCase()+t.substring(1)},yu={}.toString,bu=function(e){return yu.call(e).replace(/^\[object /,``).replace(/]$/,``)},xu=function(e){return Zl(e,`Boolean`)};function Su(e){return e instanceof Date}function Cu(e){return e===null}var wu=Object.prototype,Tu=function(e){var t=e&&e.constructor,n=typeof t==`function`&&t.prototype||wu;return e===n},Eu=function(e){return e===void 0};function Du(e){return e instanceof Element||e instanceof Document}function Ou(e,t){for(var n in t)t.hasOwnProperty(n)&&n!==`constructor`&&t[n]!==void 0&&(e[n]=t[n])}function ku(e,t,n,r){return t&&Ou(e,t),n&&Ou(e,n),r&&Ou(e,r),e}var Au=function(e){if(typeof e!=`object`||!e)return e;var t;if(Gl(e)){t=[];for(var n=0,r=e.length;n<r;n++)typeof e[n]==`object`&&e[n]!=null?t[n]=Au(e[n]):t[n]=e[n]}else for(var i in t={},e)typeof e[i]==`object`&&e[i]!=null?t[i]=Au(e[i]):t[i]=e[i];return t},ju=Au;function Mu(e,t,n){var r;return function(){var i=this,a=arguments,o=function(){r=null,n||e.apply(i,a)},s=n&&!r;clearTimeout(r),r=setTimeout(o,t),s&&e.apply(i,a)}}var Nu=Mu;function Pu(e){var t,n,r,i=e||1;function a(e,a){++t>i&&(r=n,o(1),++t),n[e]=a}function o(e){t=0,n=Object.create(null),e||(r=Object.create(null))}return o(),{clear:o,has:function(e){return n[e]!==void 0||r[e]!==void 0},get:function(e){var t=n[e];if(t!==void 0)return t;if((t=r[e])!==void 0)return a(e,t),t},set:function(e,t){n[e]===void 0?a(e,t):n[e]=t}}}var Fu=new Map;function Iu(e,t,n){return n===void 0&&(n=128),function(){var r=[...arguments],i=t?t.apply(this,r):r[0];Fu.has(e)||Fu.set(e,Pu(n));var a=Fu.get(e);if(a.has(i))return a.get(i);var o=e.apply(this,r);return a.set(i,o),o}}var Lu=5;function Ru(e,t){if(Object.hasOwn)return Object.hasOwn(e,t);if(e==null)throw TypeError(`Cannot convert undefined or null to object`);return Object.prototype.hasOwnProperty.call(Object(e),t)}function zu(e,t,n,r){for(var i in n||=0,r||=Lu,t)if(Ru(t,i)){var a=t[i];a!==null&&Ql(a)?(Ql(e[i])||(e[i]={}),n<r?zu(e[i],a,n+1,r):e[i]=t[i]):Gl(a)?(e[i]=[],e[i]=e[i].concat(a)):a!==void 0&&(e[i]=a)}}var Bu=function(e){for(var t=[...arguments].slice(1),n=0;n<t.length;n+=1)zu(e,t[n]);return e},Vu=Object.prototype.hasOwnProperty;function Hu(e){if(Wl(e))return!0;if(Bl(e))return!e.length;var t=bu(e);if(t===`Map`||t===`Set`)return!e.size;if(Tu(e))return!Object.keys(e).length;for(var n in e)if(Vu.call(e,n))return!1;return!0}var Uu=Hu,Wu=function(e,t){if(e===t)return!0;if(!e||!t||ru(e)||ru(t))return!1;if(Bl(e)||Bl(t)){if(e.length!==t.length)return!1;for(var n=!0,r=0;r<e.length&&(n=Wu(e[r],t[r]),n);r++);return n}if(Yl(e)||Yl(t)){var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var n=!0,r=0;r<i.length&&(n=Wu(e[i[r]],t[i[r]]),n);r++);return n}return!1},Gu=Wu,Ku=(function(e,t,n){for(var r=0,i=ru(t)?t.split(`.`):t;e&&r<i.length;)e=e[i[r++]];return e===void 0||r<i.length?n:e}),qu=(function(e,t,n){var r=e,i=ru(t)?t.split(`.`):t;return i.forEach(function(e,t){t<i.length-1?(Kl(r[e])||(r[e]=G(i[t+1])?[]:{}),r=r[e]):r[e]=n}),e}),Ju=Object.prototype.hasOwnProperty,Yu=(function(e,t){if(e===null||!Ql(e))return{};var n={};return Jl(t,function(t){Ju.call(e,t)&&(n[t]=e[t])}),n}),Xu=(function(e,t){return nu(e,function(e,n,r){return t.includes(r)||(e[r]=n),e},{})}),Zu=(function(e,t,n){var r,i,a,o,s=0;n||={};var c=function(){s=n.leading===!1?0:Date.now(),r=null,o=e.apply(i,a),r||(i=a=null)},l=function(){var l=Date.now();!s&&n.leading===!1&&(s=l);var u=t-(l-s);return i=this,a=arguments,u<=0||u>t?(r&&=(clearTimeout(r),null),s=l,o=e.apply(i,a),r||(i=a=null)):!r&&n.trailing!==!1&&(r=setTimeout(c,u)),o};return l.cancel=function(){clearTimeout(r),s=0,r=i=a=null},l}),Qu={},$u=(function(e){return e||=`g`,Qu[e]?Qu[e]+=1:Qu[e]=1,e+Qu[e]}),ed=(function(){}),td=(function(e){return e}),nd={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function rd(e,t,n){if(e[n].length>7){e[n].shift();for(var r=e[n],i=n;r.length;)t[n]=`A`,e.splice(i+=1,0,[`C`].concat(r.splice(0,6)));e.splice(n,1)}}var id={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function ad(e){return Array.isArray(e)&&e.every(function(e){var t=e[0].toLowerCase();return id[t]===e.length-1&&`achlmqstvz`.includes(t)})}function od(e){return ad(e)&&e.every(function(e){var t=e[0];return t===t.toUpperCase()})}function sd(e){return od(e)&&e.every(function(e){var t=e[0];return`ACLMQZ`.includes(t)})}function cd(e){for(var t=e.pathValue[e.segmentStart],n=t.toLowerCase(),r=e.data;r.length>=id[n]&&(n===`m`&&r.length>2?(e.segments.push([t].concat(r.splice(0,2))),n=`l`,t=t===`m`?`l`:`L`):e.segments.push([t].concat(r.splice(0,id[n]))),id[n]););}function ld(e){var t=e.index,n=e.pathValue,r=n.charCodeAt(t);if(r===48){e.param=0,e.index+=1;return}if(r===49){e.param=1,e.index+=1;return}e.err=`[path-util]: invalid Arc flag "${n[t]}", expecting 0 or 1 at index ${t}`}function ud(e){return e>=48&&e<=57||e===43||e===45||e===46}function dd(e){return e>=48&&e<=57}function fd(e){var t=e.max,n=e.pathValue,r=e.index,i=r,a=!1,o=!1,s=!1,c=!1,l;if(i>=t){e.err=`[path-util]: Invalid path value at index ${i}, "pathValue" is missing param`;return}if(l=n.charCodeAt(i),(l===43||l===45)&&(i+=1,l=n.charCodeAt(i)),!dd(l)&&l!==46){e.err=`[path-util]: Invalid path value at index ${i}, "${n[i]}" is not a number`;return}if(l!==46){if(a=l===48,i+=1,l=n.charCodeAt(i),a&&i<t&&l&&dd(l)){e.err=`[path-util]: Invalid path value at index ${r}, "${n[r]}" illegal number`;return}for(;i<t&&dd(n.charCodeAt(i));)i+=1,o=!0;l=n.charCodeAt(i)}if(l===46){for(c=!0,i+=1;dd(n.charCodeAt(i));)i+=1,s=!0;l=n.charCodeAt(i)}if(l===101||l===69){if(c&&!o&&!s){e.err=`[path-util]: Invalid path value at index ${i}, "${n[i]}" invalid float exponent`;return}if(i+=1,l=n.charCodeAt(i),(l===43||l===45)&&(i+=1),i<t&&dd(n.charCodeAt(i)))for(;i<t&&dd(n.charCodeAt(i));)i+=1;else{e.err=`[path-util]: Invalid path value at index ${i}, "${n[i]}" invalid integer exponent`;return}}e.index=i,e.param=+e.pathValue.slice(r,i)}function pd(e){return e===10||e===13||e===8232||e===8233||e===32||e===9||e===11||e===12||e===160||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(e)}function md(e){for(var t=e.pathValue,n=e.max;e.index<n&&pd(t.charCodeAt(e.index));)e.index+=1}function hd(e){switch(e|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function gd(e){return(e|32)==97}function _d(e){var t=e.max,n=e.pathValue,r=e.index,i=n.charCodeAt(r),a=id[n[r].toLowerCase()];if(e.segmentStart=r,!hd(i)){e.err=`[path-util]: Invalid path value "${n[r]}" is not a path command`;return}if(e.index+=1,md(e),e.data=[],!a){cd(e);return}for(;;){for(var o=a;o>0;--o){if(gd(i)&&(o===3||o===4)?ld(e):fd(e),e.err.length)return;e.data.push(e.param),md(e),e.index<t&&n.charCodeAt(e.index)===44&&(e.index+=1,md(e))}if(e.index>=e.max||!ud(n.charCodeAt(e.index)))break}cd(e)}var vd=function(){function e(e){this.pathValue=e,this.segments=[],this.max=e.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=``}return e}();function yd(e){if(ad(e))return[].concat(e);var t=new vd(e);for(md(t);t.index<t.max&&!t.err.length;)_d(t);return t.err?t.err:t.segments}function bd(e){if(od(e))return[].concat(e);var t=yd(e),n=0,r=0,i=0,a=0;return t.map(function(e){var t=e.slice(1).map(Number),o=e[0],s=o.toUpperCase();if(o===`M`)return n=t[0],r=t[1],i=n,a=r,[`M`,n,r];var c;if(o!==s)switch(s){case`A`:c=[s,t[0],t[1],t[2],t[3],t[4],t[5]+n,t[6]+r];break;case`V`:c=[s,t[0]+r];break;case`H`:c=[s,t[0]+n];break;default:var l=t.map(function(e,t){return e+(t%2?r:n)});c=[s].concat(l)}else c=[s].concat(t);var u=c.length;switch(s){case`Z`:n=i,r=a;break;case`H`:n=c[1];break;case`V`:r=c[1];break;default:n=c[u-2],r=c[u-1],s===`M`&&(i=n,a=r)}return c})}function xd(e,t){var n=e[0],r=t.x1,i=t.y1,a=t.x2,o=t.y2,s=e.slice(1).map(Number),c=e;if(`TQ`.includes(n)||(t.qx=null,t.qy=null),n===`H`)c=[`L`,e[1],i];else if(n===`V`)c=[`L`,r,e[1]];else if(n===`S`){var l=r*2-a,u=i*2-o;t.x1=l,t.y1=u,c=[`C`,l,u].concat(s)}else if(n===`T`){var d=r*2-t.qx,f=i*2-t.qy;t.qx=d,t.qy=f,c=[`Q`,d,f].concat(s)}else if(n===`Q`){var p=s[0],m=s[1];t.qx=p,t.qy=m}return c}function Sd(e){if(sd(e))return[].concat(e);for(var t=bd(e),n=L({},nd),r=0;r<t.length;r+=1){t[r]=xd(t[r],n);var i=t[r],a=i.length;n.x1=+i[a-2],n.y1=+i[a-1],n.x2=+i[a-4]||n.x1,n.y2=+i[a-3]||n.y1}return t}function Cd(e){return sd(e)&&e.every(function(e){var t=e[0];return`MC`.includes(t)})}function wd(e,t,n){var r=e*Math.cos(n)-t*Math.sin(n),i=e*Math.sin(n)+t*Math.cos(n);return{x:r,y:i}}function Td(e,t,n,r,i,a,o,s,c,l){var u=e,d=t,f=n,p=r,m=s,h=c,g=Math.PI*120/180,_=Math.PI/180*(+i||0),v=[],y,b,x,S,C;if(l)b=l[0],x=l[1],S=l[2],C=l[3];else{y=wd(u,d,-_),u=y.x,d=y.y,y=wd(m,h,-_),m=y.x,h=y.y;var w=(u-m)/2,T=(d-h)/2,E=w*w/(f*f)+T*T/(p*p);E>1&&(E=Math.sqrt(E),f*=E,p*=E);var D=f*f,O=p*p,k=(a===o?-1:1)*Math.sqrt(Math.abs((D*O-D*T*T-O*w*w)/(D*T*T+O*w*w)));S=k*f*T/p+(u+m)/2,C=k*-p*w/f+(d+h)/2,b=Math.asin(((d-C)/p*10**9>>0)/10**9),x=Math.asin(((h-C)/p*10**9>>0)/10**9),b=u<S?Math.PI-b:b,x=m<S?Math.PI-x:x,b<0&&(b=Math.PI*2+b),x<0&&(x=Math.PI*2+x),o&&b>x&&(b-=Math.PI*2),!o&&x>b&&(x-=Math.PI*2)}var A=x-b;if(Math.abs(A)>g){var j=x,ee=m,te=h;x=b+g*(o&&x>b?1:-1),m=S+f*Math.cos(x),h=C+p*Math.sin(x),v=Td(m,h,f,p,i,0,o,ee,te,[x,j,S,C])}A=x-b;var M=Math.cos(b),ne=Math.sin(b),re=Math.cos(x),ie=Math.sin(x),ae=Math.tan(A/4),oe=4/3*f*ae,se=4/3*p*ae,ce=[u,d],le=[u+oe*ne,d-se*M],N=[m+oe*ie,h-se*re],ue=[m,h];if(le[0]=2*ce[0]-le[0],le[1]=2*ce[1]-le[1],l)return le.concat(N,ue,v);v=le.concat(N,ue,v);for(var de=[],fe=0,pe=v.length;fe<pe;fe+=1)de[fe]=fe%2?wd(v[fe-1],v[fe],_).y:wd(v[fe],v[fe+1],_).x;return de}function Ed(e,t,n,r,i,a){var o=1/3,s=2/3;return[o*e+s*n,o*t+s*r,o*i+s*n,o*a+s*r,i,a]}function Dd(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return[r+(a-r)*n,i+(o-i)*n]}var Od=function(e,t,n,r){var i=Dd([e,t],[n,r],.5);return z(z([],i,!0),[n,r,n,r],!1)};function kd(e,t){var n=e[0],r=e.slice(1).map(Number),i=r[0],a=r[1],o,s=t.x1,c=t.y1,l=t.x,u=t.y;switch(`TQ`.includes(n)||(t.qx=null,t.qy=null),n){case`M`:return t.x=i,t.y=a,e;case`A`:return o=[s,c].concat(r),[`C`].concat(Td(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]));case`Q`:return t.qx=i,t.qy=a,o=[s,c].concat(r),[`C`].concat(Ed(o[0],o[1],o[2],o[3],o[4],o[5]));case`L`:return[`C`].concat(Od(s,c,i,a));case`Z`:return s===l&&c===u?[`C`,s,c,l,u,l,u]:[`C`].concat(Od(s,c,l,u));default:}return e}function Ad(e,t){if(t===void 0&&(t=!1),Cd(e)){var n=[].concat(e);return t?[n,[]]:n}for(var r=Sd(e),i=L({},nd),a=[],o=``,s=r.length,c,l,u=[],d=0;d<s;d+=1)r[d]&&(o=r[d][0]),a[d]=o,r[d]=kd(r[d],i),rd(r,a,d),s=r.length,o===`Z`&&u.push(d),c=r[d],l=c.length,i.x1=+c[l-2],i.y1=+c[l-1],i.x2=+c[l-4]||i.x1,i.y2=+c[l-3]||i.y1;return t?[r,u]:r}function jd(e){return e.map(function(e){return Array.isArray(e)?[].concat(e):e})}function Md(e){var t=e.slice(1).map(function(t,n,r){return n?r[n-1].slice(-2).concat(t.slice(1)):e[0].slice(1).concat(t.slice(1))}).map(function(e){return e.map(function(t,n){return e[e.length-n-2*(1-n%2)]})}).reverse();return[[`M`].concat(t[0].slice(0,2))].concat(t.map(function(e){return[`C`].concat(e.slice(2))}))}function Nd(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}function Pd(e,t,n,r,i){var a=Nd([e,t],[n,r]),o={x:0,y:0};if(typeof i==`number`)if(i<=0)o={x:e,y:t};else if(i>=a)o={x:n,y:r};else{var s=Dd([e,t],[n,r],i/a),c=s[0],l=s[1];o={x:c,y:l}}return{length:a,point:o,min:{x:Math.min(e,n),y:Math.min(t,r)},max:{x:Math.max(e,n),y:Math.max(t,r)}}}function Fd(e,t){var n=e.x,r=e.y,i=t.x,a=t.y,o=n*i+r*a,s=Math.sqrt((n**2+r**2)*(i**2+a**2));return(n*a-r*i<0?-1:1)*Math.acos(o/s)}function Id(e,t,n,r,i,a,o,s,c,l){var u=Math.abs,d=Math.sin,f=Math.cos,p=Math.sqrt,m=Math.PI,h=u(n),g=u(r),_=(i%360+360)%360*(m/180);if(e===s&&t===c)return{x:e,y:t};if(h===0||g===0)return Pd(e,t,s,c,l).point;var v=(e-s)/2,y=(t-c)/2,b={x:f(_)*v+d(_)*y,y:-d(_)*v+f(_)*y},x=b.x**2/h**2+b.y**2/g**2;x>1&&(h*=p(x),g*=p(x));var S=h**2*g**2-h**2*b.y**2-g**2*b.x**2,C=h**2*b.y**2+g**2*b.x**2,w=S/C;w=w<0?0:w;var T=(a===o?-1:1)*p(w),E={x:T*(h*b.y/g),y:T*(-(g*b.x)/h)},D={x:f(_)*E.x-d(_)*E.y+(e+s)/2,y:d(_)*E.x+f(_)*E.y+(t+c)/2},O={x:(b.x-E.x)/h,y:(b.y-E.y)/g},k=Fd({x:1,y:0},O),A={x:(-b.x-E.x)/h,y:(-b.y-E.y)/g},j=Fd(O,A);!o&&j>0?j-=2*m:o&&j<0&&(j+=2*m),j%=2*m;var ee=k+j*l,te=h*f(ee),M=g*d(ee);return{x:f(_)*te-d(_)*M+D.x,y:d(_)*te+f(_)*M+D.y}}function Ld(e,t,n,r,i,a,o,s,c,l,u){var d,f=u.bbox,p=f===void 0?!0:f,m=u.length,h=m===void 0?!0:m,g=u.sampleSize,_=g===void 0?30:g,v=typeof l==`number`,y=e,b=t,x=0,S=[y,b,x],C=[y,b],w=0,T={x:0,y:0},E=[{x:y,y:b}];v&&l<=0&&(T={x:y,y:b});for(var D=0;D<=_;D+=1){if(w=D/_,d=Id(e,t,n,r,i,a,o,s,c,w),y=d.x,b=d.y,p&&E.push({x:y,y:b}),h&&(x+=Nd(C,[y,b])),C=[y,b],v&&x>=l&&l>S[2]){var O=(x-l)/(x-S[2]);T={x:C[0]*(1-O)+S[0]*O,y:C[1]*(1-O)+S[1]*O}}S=[y,b,x]}return v&&l>=x&&(T={x:s,y:c}),{length:x,point:T,min:{x:Math.min.apply(null,E.map(function(e){return e.x})),y:Math.min.apply(null,E.map(function(e){return e.y}))},max:{x:Math.max.apply(null,E.map(function(e){return e.x})),y:Math.max.apply(null,E.map(function(e){return e.y}))}}}function Rd(e,t,n,r,i,a,o,s,c){var l=1-c;return{x:l**3*e+3*l**2*c*n+3*l*c**2*i+c**3*o,y:l**3*t+3*l**2*c*r+3*l*c**2*a+c**3*s}}function zd(e,t,n,r,i,a,o,s,c,l){var u,d=l.bbox,f=d===void 0?!0:d,p=l.length,m=p===void 0?!0:p,h=l.sampleSize,g=h===void 0?10:h,_=typeof c==`number`,v=e,y=t,b=0,x=[v,y,b],S=[v,y],C=0,w={x:0,y:0},T=[{x:v,y}];_&&c<=0&&(w={x:v,y});for(var E=0;E<=g;E+=1){if(C=E/g,u=Rd(e,t,n,r,i,a,o,s,C),v=u.x,y=u.y,f&&T.push({x:v,y}),m&&(b+=Nd(S,[v,y])),S=[v,y],_&&b>=c&&c>x[2]){var D=(b-c)/(b-x[2]);w={x:S[0]*(1-D)+x[0]*D,y:S[1]*(1-D)+x[1]*D}}x=[v,y,b]}return _&&c>=b&&(w={x:o,y:s}),{length:b,point:w,min:{x:Math.min.apply(null,T.map(function(e){return e.x})),y:Math.min.apply(null,T.map(function(e){return e.y}))},max:{x:Math.max.apply(null,T.map(function(e){return e.x})),y:Math.max.apply(null,T.map(function(e){return e.y}))}}}function Bd(e,t,n,r,i,a,o){var s=1-o;return{x:s**2*e+2*s*o*n+o**2*i,y:s**2*t+2*s*o*r+o**2*a}}function Vd(e,t,n,r,i,a,o,s){var c,l=s.bbox,u=l===void 0?!0:l,d=s.length,f=d===void 0?!0:d,p=s.sampleSize,m=p===void 0?10:p,h=typeof o==`number`,g=e,_=t,v=0,y=[g,_,v],b=[g,_],x=0,S={x:0,y:0},C=[{x:g,y:_}];h&&o<=0&&(S={x:g,y:_});for(var w=0;w<=m;w+=1){if(x=w/m,c=Bd(e,t,n,r,i,a,x),g=c.x,_=c.y,u&&C.push({x:g,y:_}),f&&(v+=Nd(b,[g,_])),b=[g,_],h&&v>=o&&o>y[2]){var T=(v-o)/(v-y[2]);S={x:b[0]*(1-T)+y[0]*T,y:b[1]*(1-T)+y[1]*T}}y=[g,_,v]}return h&&o>=v&&(S={x:i,y:a}),{length:v,point:S,min:{x:Math.min.apply(null,C.map(function(e){return e.x})),y:Math.min.apply(null,C.map(function(e){return e.y}))},max:{x:Math.max.apply(null,C.map(function(e){return e.x})),y:Math.max.apply(null,C.map(function(e){return e.y}))}}}function Hd(e,t,n){for(var r,i,a,o,s,c,l=Sd(e),u=typeof t==`number`,d,f=[],p,m=0,h=0,g=0,_=0,v,y=[],b=[],x=0,S={x:0,y:0},C=S,w=S,T=S,E=0,D=0,O=l.length;D<O;D+=1)v=l[D],p=v[0],d=p===`M`,f=d?f:[m,h].concat(v.slice(1)),d?(g=v[1],_=v[2],S={x:g,y:_},C=S,x=0,u&&t<.001&&(T=S)):p===`L`?(r=Pd(f[0],f[1],f[2],f[3],(t||0)-E),x=r.length,S=r.min,C=r.max,w=r.point):p===`A`?(i=Ld(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],(t||0)-E,n||{}),x=i.length,S=i.min,C=i.max,w=i.point):p===`C`?(a=zd(f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],(t||0)-E,n||{}),x=a.length,S=a.min,C=a.max,w=a.point):p===`Q`?(o=Vd(f[0],f[1],f[2],f[3],f[4],f[5],(t||0)-E,n||{}),x=o.length,S=o.min,C=o.max,w=o.point):p===`Z`&&(f=[m,h,g,_],s=Pd(f[0],f[1],f[2],f[3],(t||0)-E),x=s.length,S=s.min,C=s.max,w=s.point),u&&E<t&&E+x>=t&&(T=w),b.push(C),y.push(S),E+=x,c=p===`Z`?[g,_]:v.slice(-2),m=c[0],h=c[1];return u&&t>=E&&(T={x:m,y:h}),{length:E,point:T,min:{x:Math.min.apply(null,y.map(function(e){return e.x})),y:Math.min.apply(null,y.map(function(e){return e.y}))},max:{x:Math.max.apply(null,b.map(function(e){return e.x})),y:Math.max.apply(null,b.map(function(e){return e.y}))}}}function Ud(e,t){return Hd(e,void 0,L(L({},t),{bbox:!1,length:!0})).length}function Wd(e){var t=e.length,n=t-1;return e.map(function(r,i){return e.map(function(r,a){var o=i+a,s;return a===0||e[o]&&e[o][0]===`M`?(s=e[o],[`M`].concat(s.slice(-2))):(o>=t&&(o-=n),e[o])})})}function Gd(e,t){var n=e.length-1,r=[],i=0,a=0,o=Wd(e);return o.forEach(function(i,o){e.slice(1).forEach(function(r,i){a+=Nd(e[(o+i)%n].slice(-2),t[i%n].slice(-2))}),r[o]=a,a=0}),i=r.indexOf(Math.min.apply(null,r)),o[i]}function Kd(e,t,n,r,i,a,o,s){return 3*((s-t)*(n+i)-(o-e)*(r+a)+r*(e-i)-n*(t-a)+s*(i+e/3)-o*(a+t/3))/20}function qd(e){var t=0,n=0,r=0;return Ad(e).map(function(e){var i;switch(e[0]){case`M`:return t=e[1],n=e[2],0;default:var a=e.slice(1),o=a[0],s=a[1],c=a[2],l=a[3],u=a[4],d=a[5];return r=Kd(t,n,o,s,c,l,u,d),i=e.slice(-2),t=i[0],n=i[1],r}}).reduce(function(e,t){return e+t},0)}function Jd(e){return qd(e)>=0}function Yd(e,t,n){return Hd(e,t,L(L({},n),{bbox:!1,length:!0})).point}var Xd=50;function Zd(e,t){t===void 0&&(t=.5);var n=e.slice(0,2),r=e.slice(2,4),i=e.slice(4,6),a=e.slice(6,8),o=Dd(n,r,t),s=Dd(r,i,t),c=Dd(i,a,t),l=Dd(o,s,t),u=Dd(s,c,t),d=Dd(l,u,t);return[[`C`].concat(o,l,d),[`C`].concat(u,c,a)]}function Qd(e){return e.map(function(e,t,n){var r=t&&n[t-1].slice(-2).concat(e.slice(1)),i=t?zd(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],{bbox:!1}).length:0,a=t?i?Zd(r):[e,e]:[e];return{s:e,ss:a,l:i}})}function $d(e,t,n,r){if(r===void 0&&(r=0),r>Xd)return console.warn(`Maximum recursion depth reached in equalizeSegments`),[e,t];var i=Qd(e),a=Qd(t),o=i.length,s=a.length,c=i.filter(function(e){return e.l}).length,l=a.filter(function(e){return e.l}).length,u=i.filter(function(e){return e.l}).reduce(function(e,t){var n=t.l;return e+n},0)/c||0,d=a.filter(function(e){return e.l}).reduce(function(e,t){var n=t.l;return e+n},0)/l||0,f=n||Math.max(o,s),p=[u,d],m=[f-o,f-s],h=0,g=[i,a].map(function(e,t){return e.l===f?e.map(function(e){return e.s}):e.map(function(e,n){return h=n&&m[t]&&e.l>=p[t],m[t]-=h?1:0,h?e.ss:[e.s]}).flat()});return g[0].length===g[1].length?g:$d(g[0],g[1],f,r+1)}function ef(e){var t=document.createElement(`div`);t.innerHTML=e;var n=t.childNodes[0];return n&&t.contains(n)&&t.removeChild(n),n}function tf(e,t){for(;!{}.hasOwnProperty.call(e,t)&&(e=js(e))!==null;);return e}function nf(){return nf=typeof Reflect<`u`&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=tf(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},nf.apply(null,arguments)}function rf(e,t,n,r){var i=nf(js(1&r?e.prototype:e),t,n);return 2&r&&typeof i==`function`?function(e){return i.apply(n,e)}:i}function af(e,t,n,r){var i=e-n,a=t-r;return Math.sqrt(i*i+a*a)}function sf(e,t){var n=Math.min.apply(Math,As(e)),r=Math.min.apply(Math,As(t)),i=Math.max.apply(Math,As(e)),a=Math.max.apply(Math,As(t));return{x:n,y:r,width:i-n,height:a-r}}function cf(e,t,n){return Math.atan(-t/e*Math.tan(n))}function lf(e,t,n){return Math.atan(t/(e*Math.tan(n)))}function uf(e,t,n,r,i,a){return n*Math.cos(i)*Math.cos(a)-r*Math.sin(i)*Math.sin(a)+e}function df(e,t,n,r,i,a){return n*Math.sin(i)*Math.cos(a)+r*Math.cos(i)*Math.sin(a)+t}function ff(e,t,n,r,i,a,o){for(var s=cf(n,r,i),c=1/0,l=-1/0,u=[a,o],d=-Math.PI*2;d<=Math.PI*2;d+=Math.PI){var f=s+d;a<o?a<f&&f<o&&u.push(f):o<f&&f<a&&u.push(f)}for(var p=0;p<u.length;p++){var m=uf(e,t,n,r,i,u[p]);m<c&&(c=m),m>l&&(l=m)}for(var h=lf(n,r,i),g=1/0,_=-1/0,v=[a,o],y=-Math.PI*2;y<=Math.PI*2;y+=Math.PI){var b=h+y;a<o?a<b&&b<o&&v.push(b):o<b&&b<a&&v.push(b)}for(var x=0;x<v.length;x++){var S=df(e,t,n,r,i,v[x]);S<g&&(g=S),S>_&&(_=S)}return{x:c,y:g,width:l-c,height:_-g}}var pf=1e-4;function mf(e,t,n,r,i,a){var o=-1,s=1/0,c=[n,r],l=20;a&&a>200&&(l=a/10);for(var u=1/l,d=u/10,f=0;f<=l;f++){var p=f*u,m=[i.apply(void 0,As(e.concat([p]))),i.apply(void 0,As(t.concat([p])))],h=af(c[0],c[1],m[0],m[1]);h<s&&(o=p,s=h)}if(o===0)return{x:e[0],y:t[0]};if(o===1){var g=e.length;return{x:e[g-1],y:t[g-1]}}s=1/0;for(var _=0;_<32&&!(d<pf);_++){var v=o-d,y=o+d,b=[i.apply(void 0,As(e.concat([v]))),i.apply(void 0,As(t.concat([v])))],x=af(c[0],c[1],b[0],b[1]);if(v>=0&&x<s)o=v,s=x;else{var S=[i.apply(void 0,As(e.concat([y]))),i.apply(void 0,As(t.concat([y])))],C=af(c[0],c[1],S[0],S[1]);y<=1&&C<s?(o=y,s=C):d*=.5}}return{x:i.apply(void 0,As(e.concat([o]))),y:i.apply(void 0,As(t.concat([o])))}}function hf(e,t,n,r){return af(e,t,n,r)}function gf(e,t,n,r,i){return{x:(1-i)*e+i*n,y:(1-i)*t+i*r}}function _f(e,t,n,r,i,a){var o=[n-e,r-t];if(zl(o,[0,0]))return Math.sqrt((i-e)*(i-e)+(a-t)*(a-t));var s=[-o[1],o[0]];Ll(s,s);var c=[i-e,a-t];return Math.abs(Rl(c,s))}function vf(e,t,n,r,i){var a=1-i;return a*a*a*e+3*t*i*a*a+3*n*i*i*a+r*i*i*i}function yf(e,t,n,r){var i=-3*e+9*t-9*n+3*r,a=6*e-12*t+6*n,o=3*t-3*e,s=[],c,l,u;if(uu(i,0))uu(a,0)||(c=-o/a,c>=0&&c<=1&&s.push(c));else{var d=a*a-4*i*o;uu(d,0)?s.push(-a/(2*i)):d>0&&(u=Math.sqrt(d),c=(-a+u)/(2*i),l=(-a-u)/(2*i),c>=0&&c<=1&&s.push(c),l>=0&&l<=1&&s.push(l))}return s}function bf(e,t,n,r,i,a,o,s){for(var c=[e,o],l=[t,s],u=yf(e,n,i,o),d=yf(t,r,a,s),f=0;f<u.length;f++)c.push(vf(e,n,i,o,u[f]));for(var p=0;p<d.length;p++)l.push(vf(t,r,a,s,d[p]));return sf(c,l)}function xf(e,t,n,r,i,a,o,s,c,l,u){return mf([e,n,i,o],[t,r,a,s],c,l,vf,u)}function Sf(e,t,n,r,i,a,o,s,c,l,u){var d=xf(e,t,n,r,i,a,o,s,c,l,u);return af(d.x,d.y,c,l)}function Cf(e){if(e.length<2)return 0;for(var t=0,n=0;n<e.length-1;n++){var r=e[n],i=e[n+1];t+=af(r[0],r[1],i[0],i[1])}return t}function wf(e){return Cf(e)}function Tf(e,t,n,r){var i=1-r;return i*i*e+2*r*i*t+r*r*n}function Ef(e,t,n){var r=e+n-2*t;if(uu(r,0))return[.5];var i=(e-t)/r;return i<=1&&i>=0?[i]:[]}function Df(e,t,n,r,i,a){var o=Ef(e,n,i)[0],s=Ef(t,r,a)[0],c=[e,i],l=[t,a];return o!==void 0&&c.push(Tf(e,n,i,o)),s!==void 0&&l.push(Tf(t,r,a,s)),sf(c,l)}function Of(e,t,n,r,i,a,o,s){return mf([e,n,i],[t,r,a],o,s,Tf)}function kf(e,t,n,r,i,a,o,s){var c=Of(e,t,n,r,i,a,o,s);return af(c.x,c.y,o,s)}function Af(e,t){this.v=e,this.k=t}function jf(e,t,n,r){var i=Object.defineProperty;try{i({},``,{})}catch{i=0}jf=function(e,t,n,r){function a(t,n){jf(e,t,function(e){return this._invoke(t,n,e)})}t?i?i(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a(`next`,0),a(`throw`,1),a(`return`,2))},jf(e,t,n,r)}function Mf(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,t,n=typeof Symbol==`function`?Symbol:{},r=n.iterator||`@@iterator`,i=n.toStringTag||`@@toStringTag`;function a(n,r,i,a){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return jf(l,`_invoke`,function(n,r,i){var a,s,c,l=0,u=i||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,s=0,c=e,f.n=n,o}};function p(n,r){for(s=n,c=r,t=0;!d&&l&&!i&&t<u.length;t++){var i,a=u[t],p=f.p,m=a[2];n>3?(i=m===r)&&(c=a[(s=a[4])?5:(s=3,3)],a[4]=a[5]=e):a[0]<=p&&((i=n<2&&p<a[1])?(s=0,f.v=r,f.n=a[1]):p<m&&(i=n<3||a[0]>r||r>m)&&(a[4]=n,a[5]=r,f.n=m,s=0))}if(i||n>1)return o;throw d=!0,r}return function(i,u,m){if(l>1)throw TypeError(`Generator is already running`);for(d&&u===1&&p(u,m),s=u,c=m;(t=s<2?e:c)||!d;){a||(s?s<3?(s>1&&(f.n=-1),p(s,c)):f.n=c:f.v=c);try{if(l=2,a){if(s||(i=`next`),t=a[i]){if(!(t=t.call(a,c)))throw TypeError(`iterator result is not an object`);if(!t.done)return t;c=t.value,s<2&&(s=0)}else s===1&&(t=a.return)&&t.call(a),s<2&&(c=TypeError(`The iterator does not provide a '`+i+`' method`),s=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==o)break}catch(t){a=e,s=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,i,a),!0),l}var o={};function s(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(jf(t={},r,function(){return this}),t),d=l.prototype=s.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,jf(e,i,`GeneratorFunction`)),e.prototype=Object.create(d),e}return c.prototype=l,jf(d,`constructor`,l),jf(l,`constructor`,c),c.displayName=`GeneratorFunction`,jf(l,i,`GeneratorFunction`),jf(d),jf(d,i,`Generator`),jf(d,r,function(){return this}),jf(d,`toString`,function(){return`[object Generator]`}),(Mf=function(){return{w:a,m:f}})()}function Nf(e,t){function n(r,i,a,o){try{var s=e[r](i),c=s.value;return c instanceof Af?t.resolve(c.v).then(function(e){n(`next`,e,a,o)},function(e){n(`throw`,e,a,o)}):t.resolve(c).then(function(e){s.value=e,a(s)},function(e){return n(`throw`,e,a,o)})}catch(e){o(e)}}var r;this.next||(jf(Nf.prototype),jf(Nf.prototype,typeof Symbol==`function`&&Symbol.asyncIterator||`@asyncIterator`,function(){return this})),jf(this,`_invoke`,function(e,i,a){function o(){return new t(function(t,r){n(e,a,t,r)})}return r=r?r.then(o,o):o()},!0)}function Pf(e,t,n,r,i){return new Nf(Mf().w(e,t,n,r),i||Promise)}function Ff(e,t,n,r,i){var a=Pf(e,t,n,r,i);return a.next().then(function(e){return e.done?e.value:a.next()})}function If(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Lf(e){if(e!=null){var t=e[typeof Symbol==`function`&&Symbol.iterator||`@@iterator`],n=0;if(t)return t.call(e);if(typeof e.next==`function`)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw TypeError(ys(e)+` is not iterable`)}function Rf(){var e=Mf(),t=e.m(Rf),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t=typeof e==`function`&&e.constructor;return!!t&&(t===n||(t.displayName||t.name)===`GeneratorFunction`)}var i={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,i[e],t)},delegateYield:function(e,i,a){return t.resultName=i,n(r.d,Lf(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,i){r.p=t.prev,r.n=t.next;try{return e(n,i)}finally{t.next=r.n}}),t.resultName&&=(t[t.resultName]=r.v,void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Rf=function(){return{wrap:function(t,n,r,i){return e.w(a(t),n,r,i&&i.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Af(e,t)},AsyncIterator:Nf,async:function(e,t,n,i,o){return(r(t)?Pf:Ff)(a(e),t,n,i,o)},keys:If,values:Lf}})()}function zf(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){n(e);return}s.done?t(c):Promise.resolve(c).then(r,i)}function Bf(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var a=e.apply(t,n);function o(e){zf(a,r,i,o,s,`next`,e)}function s(e){zf(a,r,i,o,s,`throw`,e)}o(void 0)})}}function Vf(e,t){var n=typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(!n){if(Array.isArray(e)||(n=Os(e))||t&&e&&typeof e.length==`number`){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||n.return==null||n.return()}finally{if(s)throw a}}}}function Hf(e,t){if(e==null)return{};var n,r,i=Ei(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Uf=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},Wf={exports:{}};(function(e,t){(function(t,n){e.exports=n()})(Uf,function(){function e(e,n,i,a,o){t(e,n,i||0,a||e.length-1,o||r)}function t(e,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,c=r-i+1,l=Math.log(s),u=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*u*(s-u)/s)*(c-s/2<0?-1:1),f=Math.max(i,Math.floor(r-c*u/s+d)),p=Math.min(a,Math.floor(r+(s-c)*u/s+d));t(e,r,f,p,o)}var m=e[r],h=i,g=a;for(n(e,i,r),o(e[a],m)>0&&n(e,i,a);h<g;){for(n(e,h,g),h++,g--;o(e[h],m)<0;)h++;for(;o(e[g],m)>0;)g--}o(e[i],m)===0?n(e,i,g):(g++,n(e,g,a)),g<=r&&(i=g+1),r<=g&&(a=g-1)}}function n(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function r(e,t){return e<t?-1:e>t?1:0}var i=function(e){e===void 0&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(e){var t=this.data,n=[];if(!g(e,t))return n;for(var r=this.toBBox,i=[];t;){for(var a=0;a<t.children.length;a++){var o=t.children[a],s=t.leaf?r(o):o;g(e,s)&&(t.leaf?n.push(o):h(e,s)?this._all(o,n):i.push(o))}t=i.pop()}return n},i.prototype.collides=function(e){var t=this.data;if(!g(e,t))return!1;for(var n=[];t;){for(var r=0;r<t.children.length;r++){var i=t.children[r],a=t.leaf?this.toBBox(i):i;if(g(e,a)){if(t.leaf||h(e,a))return!0;n.push(i)}}t=n.pop()}return!1},i.prototype.load=function(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this},i.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},i.prototype.clear=function(){return this.data=_([]),this},i.prototype.remove=function(e,t){if(!e)return this;for(var n=this.data,r=this.toBBox(e),i=[],o=[],s,c,l;n||i.length;){if(n||(n=i.pop(),c=i[i.length-1],s=o.pop(),l=!0),n.leaf){var u=a(e,n.children,t);if(u!==-1)return n.children.splice(u,1),i.push(n),this._condense(i),this}!l&&!n.leaf&&h(n,r)?(i.push(n),o.push(s),s=0,c=n,n=n.children[0]):c?(s++,n=c.children[s],l=!1):n=null}return this},i.prototype.toBBox=function(e){return e},i.prototype.compareMinX=function(e,t){return e.minX-t.minX},i.prototype.compareMinY=function(e,t){return e.minY-t.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(e){return this.data=e,this},i.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},i.prototype._build=function(e,t,n,r){var i=n-t+1,a=this._maxEntries,s;if(i<=a)return s=_(e.slice(t,n+1)),o(s,this.toBBox),s;r||(r=Math.ceil(Math.log(i)/Math.log(a)),a=Math.ceil(i/a**(r-1))),s=_([]),s.leaf=!1,s.height=r;var c=Math.ceil(i/a),l=c*Math.ceil(Math.sqrt(a));v(e,t,n,l,this.compareMinX);for(var u=t;u<=n;u+=l){var d=Math.min(u+l-1,n);v(e,u,d,c,this.compareMinY);for(var f=u;f<=d;f+=c){var p=Math.min(f+c-1,d);s.children.push(this._build(e,f,p,r-1))}}return o(s,this.toBBox),s},i.prototype._chooseSubtree=function(e,t,n,r){for(;r.push(t),!(t.leaf||r.length-1===n);){for(var i=1/0,a=1/0,o=void 0,s=0;s<t.children.length;s++){var c=t.children[s],l=d(c),u=p(e,c)-l;u<a?(a=u,i=l<i?l:i,o=c):u===a&&l<i&&(i=l,o=c)}t=o||t.children[0]}return t},i.prototype._insert=function(e,t,n){var r=n?e:this.toBBox(e),i=[],a=this._chooseSubtree(r,this.data,t,i);for(a.children.push(e),c(a,r);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(r,i,t)},i.prototype._split=function(e,t){var n=e[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=_(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},i.prototype._splitRoot=function(e,t){this.data=_([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(e,t,n){for(var r,i=1/0,a=1/0,o=t;o<=n-t;o++){var c=s(e,0,o,this.toBBox),l=s(e,o,n,this.toBBox),u=m(c,l),f=d(c)+d(l);u<i?(i=u,r=o,a=f<a?f:a):u===i&&f<a&&(a=f,r=o)}return r||n-t},i.prototype._chooseSplitAxis=function(e,t,n){var r=e.leaf?this.compareMinX:l,i=e.leaf?this.compareMinY:u,a=this._allDistMargin(e,t,n,r),o=this._allDistMargin(e,t,n,i);a<o&&e.children.sort(r)},i.prototype._allDistMargin=function(e,t,n,r){e.children.sort(r);for(var i=this.toBBox,a=s(e,0,t,i),o=s(e,n-t,n,i),l=f(a)+f(o),u=t;u<n-t;u++){var d=e.children[u];c(a,e.leaf?i(d):d),l+=f(a)}for(var p=n-t-1;p>=t;p--){var m=e.children[p];c(o,e.leaf?i(m):m),l+=f(o)}return l},i.prototype._adjustParentBBoxes=function(e,t,n){for(var r=n;r>=0;r--)c(t[r],e)},i.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)e[t].children.length===0?t>0?(n=e[t-1].children,n.splice(n.indexOf(e[t]),1)):this.clear():o(e[t],this.toBBox)};function a(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function o(e,t){s(e,0,e.children.length,t,e)}function s(e,t,n,r,i){i||=_(null),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a=t;a<n;a++){var o=e.children[a];c(i,e.leaf?r(o):o)}return i}function c(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function l(e,t){return e.minX-t.minX}function u(e,t){return e.minY-t.minY}function d(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function p(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function m(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,a-r)}function h(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function _(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,n,r,i,a){for(var o=[n,r];o.length;)if(r=o.pop(),n=o.pop(),!(r-n<=i)){var s=n+Math.ceil((r-n)/i/2)*i;e(t,s,n,r,a),o.push(n,s,s,r)}}return i})})(Wf);var Gf=Wf.exports,K=function(e){return e.GROUP=`g`,e.FRAGMENT=`fragment`,e.CIRCLE=`circle`,e.ELLIPSE=`ellipse`,e.IMAGE=`image`,e.RECT=`rect`,e.LINE=`line`,e.POLYLINE=`polyline`,e.POLYGON=`polygon`,e.TEXT=`text`,e.PATH=`path`,e.HTML=`html`,e.MESH=`mesh`,e}({}),Kf=function(e){return e[e.ZERO=0]=`ZERO`,e[e.NEGATIVE_ONE=1]=`NEGATIVE_ONE`,e}({}),qf=function(){function e(){H(this,e),this.plugins=[]}return U(e,[{key:`addRenderingPlugin`,value:function(e){this.plugins.push(e),this.context.renderingPlugins.push(e)}},{key:`removeAllRenderingPlugins`,value:function(){var e=this;this.plugins.forEach(function(t){var n=e.context.renderingPlugins.indexOf(t);n>=0&&e.context.renderingPlugins.splice(n,1)})}}])}(),Jf=function(){function e(t){H(this,e),this.clipSpaceNearZ=Kf.NEGATIVE_ONE,this.plugins=[],this.config=Cs({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0,enableRenderingOptimization:!1},t)}return U(e,[{key:`registerPlugin`,value:function(e){this.plugins.findIndex(function(t){return t===e})===-1&&this.plugins.push(e)}},{key:`unregisterPlugin`,value:function(e){var t=this.plugins.findIndex(function(t){return t===e});t>-1&&this.plugins.splice(t,1)}},{key:`getPlugins`,value:function(){return this.plugins}},{key:`getPlugin`,value:function(e){return this.plugins.find(function(t){return t.name===e})}},{key:`getConfig`,value:function(){return this.config}},{key:`setConfig`,value:function(e){Object.assign(this.config,e)}}])}(),Yf=Qc,Xf=Xc,Zf=nl,Qf=tl,$f=rl,ep=pl,tp=function(){function e(){H(this,e),this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return U(e,[{key:`update`,value:function(e,t){Xf(this.center,e),Xf(this.halfExtents,t),ep(this.min,this.center,this.halfExtents),Yf(this.max,this.center,this.halfExtents)}},{key:`setMinMax`,value:function(e,t){Yf(this.center,t,e),$f(this.center,this.center,.5),ep(this.halfExtents,t,e),$f(this.halfExtents,this.halfExtents,.5),Xf(this.min,e),Xf(this.max,t)}},{key:`getMin`,value:function(){return this.min}},{key:`getMax`,value:function(){return this.max}},{key:`add`,value:function(t){if(!e.isEmpty(t)){if(e.isEmpty(this)){this.setMinMax(t.getMin(),t.getMax());return}var n=this.center,r=n[0],i=n[1],a=n[2],o=this.halfExtents,s=o[0],c=o[1],l=o[2],u=r-s,d=r+s,f=i-c,p=i+c,m=a-l,h=a+l,g=t.center,_=g[0],v=g[1],y=g[2],b=t.halfExtents,x=b[0],S=b[1],C=b[2],w=_-x,T=_+x,E=v-S,D=v+S,O=y-C,k=y+C;w<u&&(u=w),T>d&&(d=T),E<f&&(f=E),D>p&&(p=D),O<m&&(m=O),k>h&&(h=k),n[0]=(u+d)*.5,n[1]=(f+p)*.5,n[2]=(m+h)*.5,o[0]=(d-u)*.5,o[1]=(p-f)*.5,o[2]=(h-m)*.5,this.min[0]=u,this.min[1]=f,this.min[2]=m,this.max[0]=d,this.max[1]=p,this.max[2]=h}}},{key:`setFromTransformedAABB`,value:function(e,t){var n=this.center,r=this.halfExtents,i=e.center,a=e.halfExtents,o=t[0],s=t[4],c=t[8],l=t[1],u=t[5],d=t[9],f=t[2],p=t[6],m=t[10],h=Math.abs(o),g=Math.abs(s),_=Math.abs(c),v=Math.abs(l),y=Math.abs(u),b=Math.abs(d),x=Math.abs(f),S=Math.abs(p),C=Math.abs(m);n[0]=t[12]+o*i[0]+s*i[1]+c*i[2],n[1]=t[13]+l*i[0]+u*i[1]+d*i[2],n[2]=t[14]+f*i[0]+p*i[1]+m*i[2],r[0]=h*a[0]+g*a[1]+_*a[2],r[1]=v*a[0]+y*a[1]+b*a[2],r[2]=x*a[0]+S*a[1]+C*a[2],ep(this.min,n,r),Yf(this.max,n,r)}},{key:`intersects`,value:function(e){var t=this.getMax(),n=this.getMin(),r=e.getMax(),i=e.getMin();return n[0]<=r[0]&&t[0]>=i[0]&&n[1]<=r[1]&&t[1]>=i[1]&&n[2]<=r[2]&&t[2]>=i[2]}},{key:`intersection`,value:function(t){if(!this.intersects(t))return null;var n=new e,r=Zf([0,0,0],this.getMin(),t.getMin()),i=Qf([0,0,0],this.getMax(),t.getMax());return n.setMinMax(r,i),n}},{key:`getNegativeFarPoint`,value:function(e){return e.pnVertexFlag===273?Xf([0,0,0],this.min):e.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:e.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]}},{key:`getPositiveFarPoint`,value:function(e){return e.pnVertexFlag===273?Xf([0,0,0],this.max):e.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:e.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:e.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:e.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:e.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:e.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]}}],[{key:`isEmpty`,value:function(e){return!e||e.halfExtents[0]===0&&e.halfExtents[1]===0&&e.halfExtents[2]===0}}])}(),np=function(){function e(t,n){H(this,e),this.distance=t||0,this.normal=n||Yc(0,1,0),this.updatePNVertexFlag()}return U(e,[{key:`updatePNVertexFlag`,value:function(){this.pnVertexFlag=(Number(this.normal[0]>=0)<<8)+(Number(this.normal[1]>=0)<<4)+Number(this.normal[2]>=0)}},{key:`distanceToPoint`,value:function(e){return ol(e,this.normal)-this.distance}},{key:`normalize`,value:function(){var e=1/hl(this.normal);rl(this.normal,this.normal,e),this.distance*=e}},{key:`intersectsLine`,value:function(e,t,n){var r=this.distanceToPoint(e),i=this.distanceToPoint(t),a=r/(r-i),o=a>=0&&a<=1;return o&&n&&cl(n,e,t,a),o}}])}(),rp=function(e){return e[e.OUTSIDE=4294967295]=`OUTSIDE`,e[e.INSIDE=0]=`INSIDE`,e[e.INDETERMINATE=2147483647]=`INDETERMINATE`,e}({}),ip=function(){function e(t){if(H(this,e),this.planes=[],t)this.planes=t;else for(var n=0;n<6;n++)this.planes.push(new np)}return U(e,[{key:`extractFromVPMatrix`,value:function(e){var t=Vs(e,16),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],c=t[6],l=t[7],u=t[8],d=t[9],f=t[10],p=t[11],m=t[12],h=t[13],g=t[14],_=t[15];Zc(this.planes[0].normal,a-n,l-o,p-u),this.planes[0].distance=_-m,Zc(this.planes[1].normal,a+n,l+o,p+u),this.planes[1].distance=_+m,Zc(this.planes[2].normal,a+r,l+s,p+d),this.planes[2].distance=_+h,Zc(this.planes[3].normal,a-r,l-s,p-d),this.planes[3].distance=_-h,Zc(this.planes[4].normal,a-i,l-c,p-f),this.planes[4].distance=_-g,Zc(this.planes[5].normal,a+i,l+c,p+f),this.planes[5].distance=_+g,this.planes.forEach(function(e){e.normalize(),e.updatePNVertexFlag()})}}])}(),ap=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;H(this,e),this.x=0,this.y=0,this.x=t,this.y=n}return U(e,[{key:`clone`,value:function(){return new e(this.x,this.y)}},{key:`copyFrom`,value:function(e){this.x=e.x,this.y=e.y}}])}(),op=function(){function e(t,n,r,i){H(this,e),this.x=t,this.y=n,this.width=r,this.height=i,this.left=t,this.right=t+r,this.top=n,this.bottom=n+i}return U(e,[{key:`toJSON`,value:function(){}}],[{key:`fromRect`,value:function(t){return new e(t.x,t.y,t.width,t.height)}},{key:`applyTransform`,value:function(t,n){var r=_l(t.x,t.y,0,1),i=_l(t.x+t.width,t.y,0,1),a=_l(t.x,t.y+t.height,0,1),o=_l(t.x+t.width,t.y+t.height,0,1),s=gl(),c=gl(),l=gl(),u=gl();xl(s,r,n),xl(c,i,n),xl(l,a,n),xl(u,o,n);var d=Math.min(s[0],c[0],l[0],u[0]),f=Math.min(s[1],c[1],l[1],u[1]),p=Math.max(s[0],c[0],l[0],u[0]),m=Math.max(s[1],c[1],l[1],u[1]);return e.fromRect({x:d,y:f,width:p-d,height:m-f})}}])}(),sp=`Method not implemented.`,cp=`Use document.documentElement instead.`,lp=`Cannot append a destroyed element.`;function up(e){return e===void 0?0:e>360||e<-360?e%360:e}var dp=Kc();function fp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return Array.isArray(e)&&e.length===3?r?qc(e):Xc(dp,e):G(e)?r?Yc(e,t,n):Zc(dp,e,t,n):r?Yc(e[0],e[1]||t,e[2]||n):Zc(dp,e[0],e[1]||t,e[2]||n)}var pp=Math.PI/180;function mp(e){return e*pp}var hp=180/Math.PI;function gp(e){return e*hp}function _p(e){return 360*e}var vp=Math.PI/2;function yp(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n,s=r*r,c=i*i,l=a*a,u=o+s+c+l,d=n*a-r*i;return d>.499995*u?(e[0]=vp,e[1]=2*Math.atan2(r,n),e[2]=0):d<-.499995*u?(e[0]=-vp,e[1]=2*Math.atan2(r,n),e[2]=0):(e[0]=Math.asin(2*(n*i-a*r)),e[1]=Math.atan2(2*(n*a+r*i),1-2*(c+l)),e[2]=Math.atan2(2*(n*r+i*a),1-2*(s+c))),e}function bp(e,t){var n,r,i=bc(Kc(),t),a=Vs(i,3),o=a[0],s=a[1],c=a[2],l=Math.asin(-t[2]/o);return l<vp?l>-vp?(n=Math.atan2(t[6]/s,t[10]/c),r=Math.atan2(t[1]/o,t[0]/o)):(r=0,n=-Math.atan2(t[4]/s,t[5]/s)):(r=0,n=Math.atan2(t[4]/s,t[5]/s)),e[0]=n,e[1]=l,e[2]=r,e}function xp(e,t){return t.length===16?bp(e,t):yp(e,t)}function Sp(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e);return Ks(r*a,i*o,0,-r*o,i*a,0,t,n,1)}function Cp(e,t,n,r,i,a,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1,c=2*a,l=n-t,u=r-i,d=c/l,f=c/u,p=(n+t)/l,m=(r+i)/u,h,g,_=o-a,v=o*a;return s?(h=-o/_,g=-v/_):(h=-(o+a)/_,g=-2*v/_),e[0]=d,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=p,e[9]=m,e[10]=h,e[11]=-1,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}function wp(e){var t=e[0],n=e[1],r=e[3],i=e[4],a=Math.sqrt(t*t+n*n),o=Math.sqrt(r*r+i*i);if(t*i-n*r<0&&(t<i?a=-a:o=-o),a){var s=1/a;t*=s,n*=s}if(o){var c=1/o;r*=c,i*=c}var l=gp(Math.atan2(n,t));return[e[6],e[7],a,o,l]}var Tp=Js(),Ep=Js(),Dp=gl(),Op=[Kc(),Kc(),Kc()],kp=Kc();function Ap(e,t,n,r,i,a){if(!jp(Tp,e)||(Xs(Ep,Tp),Ep[3]=0,Ep[7]=0,Ep[11]=0,Ep[15]=1,Math.abs(rc(Ep))<1e-8))return!1;var o=Tp[3],s=Tp[7],c=Tp[11],l=Tp[12],u=Tp[13],d=Tp[14],f=Tp[15];if(o!==0||s!==0||c!==0){if(Dp[0]=o,Dp[1]=s,Dp[2]=c,Dp[3]=f,!tc(Ep,Ep))return!1;ec(Ep,Ep),xl(i,Dp,Ep)}else i[0]=i[1]=i[2]=0,i[3]=1;if(t[0]=l,t[1]=u,t[2]=d,Mp(Op,Tp),n[0]=Jc(Op[0]),al(Op[0],Op[0]),r[0]=ol(Op[0],Op[1]),Np(Op[1],Op[1],Op[0],1,-r[0]),n[1]=Jc(Op[1]),al(Op[1],Op[1]),r[0]/=n[1],r[1]=ol(Op[0],Op[2]),Np(Op[2],Op[2],Op[0],1,-r[1]),r[2]=ol(Op[1],Op[2]),Np(Op[2],Op[2],Op[1],1,-r[2]),n[2]=Jc(Op[2]),al(Op[2],Op[2]),r[1]/=n[2],r[2]/=n[2],sl(kp,Op[1],Op[2]),ol(Op[0],kp)<0)for(var p=0;p<3;p++)n[p]*=-1,Op[p][0]*=-1,Op[p][1]*=-1,Op[p][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Op[0][0]-Op[1][1]-Op[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Op[0][0]+Op[1][1]-Op[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Op[0][0]-Op[1][1]+Op[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Op[0][0]+Op[1][1]+Op[2][2],0)),Op[2][1]>Op[1][2]&&(a[0]=-a[0]),Op[0][2]>Op[2][0]&&(a[1]=-a[1]),Op[1][0]>Op[0][1]&&(a[2]=-a[2]),!0}function jp(e,t){var n=t[15];if(n===0)return!1;for(var r=1/n,i=0;i<16;i++)e[i]=t[i]*r;return!0}function Mp(e,t){e[0][0]=t[0],e[0][1]=t[1],e[0][2]=t[2],e[1][0]=t[4],e[1][1]=t[5],e[1][2]=t[6],e[2][0]=t[8],e[2][1]=t[9],e[2][2]=t[10]}function Np(e,t,n,r,i){e[0]=t[0]*r+n[0]*i,e[1]=t[1]*r+n[1]*i,e[2]=t[2]*r+n[2]*i}var Pp=function(e){return e[e.ORBITING=0]=`ORBITING`,e[e.EXPLORING=1]=`EXPLORING`,e[e.TRACKING=2]=`TRACKING`,e}({}),Fp=function(e){return e[e.DEFAULT=0]=`DEFAULT`,e[e.ROTATIONAL=1]=`ROTATIONAL`,e[e.TRANSLATIONAL=2]=`TRANSLATIONAL`,e[e.CINEMATIC=3]=`CINEMATIC`,e}({}),Ip=function(e){return e[e.ORTHOGRAPHIC=0]=`ORTHOGRAPHIC`,e[e.PERSPECTIVE=1]=`PERSPECTIVE`,e}({}),Lp={UPDATED:`updated`},Rp=2e-4,zp=function(){function e(){H(this,e),this.clipSpaceNearZ=Kf.NEGATIVE_ONE,this.eventEmitter=new Hs,this.matrix=Js(),this.right=Yc(1,0,0),this.up=Yc(0,1,0),this.forward=Yc(0,0,1),this.position=Yc(0,0,1),this.focalPoint=Yc(0,0,0),this.distanceVector=Yc(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Js(),this.projectionMatrixInverse=Js(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Pp.EXPLORING,this.trackingMode=Fp.DEFAULT,this.projectionMode=Ip.PERSPECTIVE,this.frustum=new ip,this.orthoMatrix=Js()}return U(e,[{key:`isOrtho`,value:function(){return this.projectionMode===Ip.ORTHOGRAPHIC}},{key:`getProjectionMode`,value:function(){return this.projectionMode}},{key:`getPerspective`,value:function(){return this.jitteredProjectionMatrix||this.projectionMatrix}},{key:`getPerspectiveInverse`,value:function(){return this.projectionMatrixInverse}},{key:`getFrustum`,value:function(){return this.frustum}},{key:`getPosition`,value:function(){return this.position}},{key:`getFocalPoint`,value:function(){return this.focalPoint}},{key:`getDollyingStep`,value:function(){return this.dollyingStep}},{key:`getNear`,value:function(){return this.near}},{key:`getFar`,value:function(){return this.far}},{key:`getZoom`,value:function(){return this.zoom}},{key:`getOrthoMatrix`,value:function(){return this.orthoMatrix}},{key:`getView`,value:function(){return this.view}},{key:`setEnableUpdate`,value:function(e){this.enableUpdate=e}},{key:`setType`,value:function(e,t){return this.type=e,this.type===Pp.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Pp.TRACKING&&t!==void 0&&this.setTrackingMode(t),this}},{key:`setProjectionMode`,value:function(e){return this.projectionMode=e,this}},{key:`setTrackingMode`,value:function(e){if(this.type!==Pp.TRACKING)throw Error(`Impossible to set a tracking mode if the camera is not of tracking type`);return this.trackingMode=e,this}},{key:`setWorldRotation`,value:function(e){return this.rotateWorld=e,this._getAngles(),this}},{key:`getViewTransform`,value:function(){return tc(Js(),this.matrix)}},{key:`getWorldTransform`,value:function(){return this.matrix}},{key:`jitterProjectionMatrix`,value:function(e,t){var n=dc(Js(),[e,t,0]);this.jitteredProjectionMatrix=ic(Js(),n,this.projectionMatrix)}},{key:`clearJitterProjectionMatrix`,value:function(){this.jitteredProjectionMatrix=void 0}},{key:`setMatrix`,value:function(e){return this.matrix=e,this._update(),this}},{key:`setProjectionMatrix`,value:function(e){this.projectionMatrix=e}},{key:`setFov`,value:function(e){return this.setPerspective(this.near,this.far,e,this.aspect),this}},{key:`setAspect`,value:function(e){return this.setPerspective(this.near,this.far,this.fov,e),this}},{key:`setNear`,value:function(e){return this.projectionMode===Ip.PERSPECTIVE?this.setPerspective(e,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,e,this.far),this}},{key:`setFar`,value:function(e){return this.projectionMode===Ip.PERSPECTIVE?this.setPerspective(this.near,e,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,e),this}},{key:`setViewOffset`,value:function(e,t,n,r,i,a){return this.aspect=e/t,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.projectionMode===Ip.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:`clearViewOffset`,value:function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===Ip.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this}},{key:`setZoom`,value:function(e){return this.zoom=e,this.projectionMode===Ip.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===Ip.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this}},{key:`setZoomByViewportPoint`,value:function(e,t){var n=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),r=n.x,i=n.y,a=this.roll;this.rotate(0,0,-a),this.setPosition(r,i),this.setFocalPoint(r,i),this.setZoom(e),this.rotate(0,0,a);var o=this.canvas.viewport2Canvas({x:t[0],y:t[1]}),s=o.x,c=o.y,l=Yc(s-r,c-i,0),u=ol(l,this.right)/Jc(this.right),d=ol(l,this.up)/Jc(this.up),f=this.getPosition(),p=Vs(f,2),m=p[0],h=p[1],g=this.getFocalPoint(),_=Vs(g,2),v=_[0],y=_[1];return this.setPosition(m-u,h-d),this.setFocalPoint(v-u,y-d),this}},{key:`setPerspective`,value:function(e,t,n,r){var i;this.projectionMode=Ip.PERSPECTIVE,this.fov=n,this.near=e,this.far=t,this.aspect=r;var a=this.near*Math.tan(mp(.5*this.fov))/this.zoom,o=2*a,s=this.aspect*o,c=-.5*s;if((i=this.view)!=null&&i.enabled){var l=this.view.fullWidth,u=this.view.fullHeight;c+=this.view.offsetX*s/l,a-=this.view.offsetY*o/u,s*=this.view.width/l,o*=this.view.height/u}return Cp(this.projectionMatrix,c,c+s,a-o,a,e,this.far,this.clipSpaceNearZ===Kf.ZERO),tc(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this}},{key:`setOrthographic`,value:function(e,t,n,r,i,a){var o;this.projectionMode=Ip.ORTHOGRAPHIC,this.rright=t,this.left=e,this.top=n,this.bottom=r,this.near=i,this.far=a;var s=(this.rright-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),l=(this.rright+this.left)/2,u=(this.top+this.bottom)/2,d=l-s,f=l+s,p=u+c,m=u-c;if((o=this.view)!=null&&o.enabled){var h=(this.rright-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;d+=h*this.view.offsetX,f=d+h*this.view.width,p-=g*this.view.offsetY,m=p-g*this.view.height}return this.clipSpaceNearZ===Kf.NEGATIVE_ONE?Mc(this.projectionMatrix,d,f,p,m,i,a):Nc(this.projectionMatrix,d,f,p,m,i,a),tc(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this}},{key:`setPosition`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.position[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.position[2],r=fp(e,t,n);return this._setPosition(r),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this}},{key:`setFocalPoint`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.focalPoint[1],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.focalPoint[2],r=Yc(0,1,0);if(this.focalPoint=fp(e,t,n),this.trackingMode===Fp.CINEMATIC){var i=$c(Kc(),this.focalPoint,this.position);e=i[0],t=i[1],n=i[2];var a=Jc(i),o=gp(Math.asin(t/a)),s=90+gp(Math.atan2(n,e)),c=Js();lc(c,c,mp(s)),cc(c,c,mp(o)),r=ll(Kc(),[0,1,0],c)}return tc(this.matrix,Pc(Js(),this.position,this.focalPoint,r)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this}},{key:`getDistance`,value:function(){return this.distance}},{key:`getDistanceVector`,value:function(){return this.distanceVector}},{key:`setDistance`,value:function(e){if(this.distance===e||e<0)return this;this.distance=e,this.distance<Rp&&(this.distance=Rp),this.dollyingStep=this.distance/100;var t=Kc();e=this.distance;var n=this.forward,r=this.focalPoint;return t[0]=e*n[0]+r[0],t[1]=e*n[1]+r[1],t[2]=e*n[2]+r[2],this._setPosition(t),this.triggerUpdate(),this}},{key:`setMaxDistance`,value:function(e){return this.maxDistance=e,this}},{key:`setMinDistance`,value:function(e){return this.minDistance=e,this}},{key:`setAzimuth`,value:function(e){return this.azimuth=up(e),this.computeMatrix(),this._getAxes(),this.type===Pp.ORBITING||this.type===Pp.EXPLORING?this._getPosition():this.type===Pp.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:`getAzimuth`,value:function(){return this.azimuth}},{key:`setElevation`,value:function(e){return this.elevation=up(e),this.computeMatrix(),this._getAxes(),this.type===Pp.ORBITING||this.type===Pp.EXPLORING?this._getPosition():this.type===Pp.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:`getElevation`,value:function(){return this.elevation}},{key:`setRoll`,value:function(e){return this.roll=up(e),this.computeMatrix(),this._getAxes(),this.type===Pp.ORBITING||this.type===Pp.EXPLORING?this._getPosition():this.type===Pp.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this}},{key:`getRoll`,value:function(){return this.roll}},{key:`_update`,value:function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()}},{key:`computeMatrix`,value:function(){var e=Cl(Sl(),[0,0,1],mp(this.roll));$s(this.matrix);var t=Cl(Sl(),[1,0,0],mp((this.rotateWorld&&this.type!==Pp.TRACKING||this.type===Pp.TRACKING?1:-1)*this.elevation)),n=Cl(Sl(),[0,1,0],mp((this.rotateWorld&&this.type!==Pp.TRACKING||this.type===Pp.TRACKING?1:-1)*this.azimuth)),r=wl(Sl(),n,t);r=wl(Sl(),r,e);var i=Tc(Js(),r);this.type===Pp.ORBITING||this.type===Pp.EXPLORING?(ac(this.matrix,this.matrix,this.focalPoint),ic(this.matrix,this.matrix,i),ac(this.matrix,this.matrix,[0,0,this.distance])):this.type===Pp.TRACKING&&(ac(this.matrix,this.matrix,this.position),ic(this.matrix,this.matrix,i))}},{key:`_setPosition`,value:function(e,t,n){this.position=fp(e,t,n);var r=this.matrix;r[12]=this.position[0],r[13]=this.position[1],r[14]=this.position[2],r[15]=1,this._getOrthoMatrix()}},{key:`_getAxes`,value:function(){Xc(this.right,fp(xl(gl(),[1,0,0,0],this.matrix))),Xc(this.up,fp(xl(gl(),[0,1,0,0],this.matrix))),Xc(this.forward,fp(xl(gl(),[0,0,1,0],this.matrix))),al(this.right,this.right),al(this.up,this.up),al(this.forward,this.forward)}},{key:`_getAngles`,value:function(){var e=this.distanceVector[0],t=this.distanceVector[1],n=this.distanceVector[2],r=Jc(this.distanceVector);if(r===0){this.elevation=0,this.azimuth=0;return}this.type===Pp.TRACKING||this.rotateWorld?(this.elevation=gp(Math.asin(t/r)),this.azimuth=gp(Math.atan2(-e,-n))):(this.elevation=-gp(Math.asin(t/r)),this.azimuth=-gp(Math.atan2(-e,-n)))}},{key:`_getPosition`,value:function(){Xc(this.position,fp(xl(gl(),[0,0,0,1],this.matrix))),this._getDistance()}},{key:`_getFocalPoint`,value:function(){ul(this.distanceVector,[0,0,-this.distance],Gs(Ws(),this.matrix)),Qc(this.focalPoint,this.position,this.distanceVector),this._getDistance()}},{key:`_getDistance`,value:function(){this.distanceVector=$c(Kc(),this.focalPoint,this.position),this.distance=Jc(this.distanceVector),this.dollyingStep=this.distance/100}},{key:`_getOrthoMatrix`,value:function(){if(this.projectionMode===Ip.ORTHOGRAPHIC){var e=this.position,t=Cl(Sl(),[0,0,1],-this.roll*Math.PI/180);wc(this.orthoMatrix,t,Yc((this.rright-this.left)/2-e[0],(this.top-this.bottom)/2-e[1],0),Yc(this.zoom,this.zoom,1),e)}}},{key:`triggerUpdate`,value:function(){if(this.enableUpdate){var e=this.getViewTransform(),t=ic(Js(),this.getPerspective(),e);this.getFrustum().extractFromVPMatrix(t),this.eventEmitter.emit(Lp.UPDATED)}}},{key:`rotate`,value:function(e,t,n){throw Error(sp)}},{key:`pan`,value:function(e,t){throw Error(sp)}},{key:`dolly`,value:function(e){throw Error(sp)}},{key:`createLandmark`,value:function(e,t){throw Error(sp)}},{key:`gotoLandmark`,value:function(e,t){throw Error(sp)}},{key:`cancelLandmarkAnimation`,value:function(){throw Error(sp)}}])}(),Bp=function(e){return e[e.Standard=0]=`Standard`,e}({}),Vp=function(e){return e[e.ADDED=0]=`ADDED`,e[e.REMOVED=1]=`REMOVED`,e[e.Z_INDEX_CHANGED=2]=`Z_INDEX_CHANGED`,e}({}),Hp=Kc(),Up=Js(),Wp=Sl();function Gp(e){if(e.localDirtyFlag){if(e.localSkew[0]!==0||e.localSkew[1]!==0){wc(e.localTransform,e.localRotation,e.localPosition,Yc(1,1,1),e.origin),(e.localSkew[0]!==0||e.localSkew[1]!==0)&&($s(Up),Up[4]=Math.tan(e.localSkew[0]),Up[1]=Math.tan(e.localSkew[1]),ic(e.localTransform,e.localTransform,Up));var t=wc(Up,jl(Wp,0,0,0,1),Zc(Hp,1,1,1),e.localScale,e.origin);ic(e.localTransform,e.localTransform,t)}else{var n=e.localTransform,r=e.localPosition,i=e.localRotation,a=e.localScale,o=e.origin,s=r[0]!==0||r[1]!==0||r[2]!==0,c=i[3]!==1||i[0]!==0||i[1]!==0||i[2]!==0,l=a[0]!==1||a[1]!==1||a[2]!==1,u=o[0]!==0||o[1]!==0||o[2]!==0;!c&&!l&&!u?s?dc(n,r):$s(n):wc(n,i,r,a,o)}e.localDirtyFlag=!1}}function Kp(e,t){e.dirtyFlag&&=(t?ic(e.worldTransform,t.worldTransform,e.localTransform):Xs(e.worldTransform,e.localTransform),!1)}var qp={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new op(0,0,0,0)},q=function(e){return e.COORDINATE=`<coordinate>`,e.COLOR=`<color>`,e.PAINT=`<paint>`,e.NUMBER=`<number>`,e.ANGLE=`<angle>`,e.OPACITY_VALUE=`<opacity-value>`,e.SHADOW_BLUR=`<shadow-blur>`,e.LENGTH=`<length>`,e.PERCENTAGE=`<percentage>`,e.LENGTH_PERCENTAGE=`<length> | <percentage>`,e.LENGTH_PERCENTAGE_12=`[<length> | <percentage>]{1,2}`,e.LENGTH_PERCENTAGE_14=`[<length> | <percentage>]{1,4}`,e.LIST_OF_POINTS=`<list-of-points>`,e.PATH=`<path>`,e.FILTER=`<filter>`,e.Z_INDEX=`<z-index>`,e.OFFSET_DISTANCE=`<offset-distance>`,e.DEFINED_PATH=`<defined-path>`,e.MARKER=`<marker>`,e.TRANSFORM=`<transform>`,e.TRANSFORM_ORIGIN=`<transform-origin>`,e.TEXT=`<text>`,e.TEXT_TRANSFORM=`<text-transform>`,e}({});function Jp(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Yp(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Xp(){}var Zp=.7,Qp=1/Zp,$p=`\\s*([+-]?\\d+)\\s*`,em=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,tm=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,nm=/^#([0-9a-f]{3,8})$/,rm=RegExp(`^rgb\\(${$p},${$p},${$p}\\)$`),im=RegExp(`^rgb\\(${tm},${tm},${tm}\\)$`),am=RegExp(`^rgba\\(${$p},${$p},${$p},${em}\\)$`),om=RegExp(`^rgba\\(${tm},${tm},${tm},${em}\\)$`),sm=RegExp(`^hsl\\(${em},${tm},${tm}\\)$`),cm=RegExp(`^hsla\\(${em},${tm},${tm},${em}\\)$`),lm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Jp(Xp,mm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:um,formatHex:um,formatHex8:dm,formatHsl:fm,formatRgb:pm,toString:pm});function um(){return this.rgb().formatHex()}function dm(){return this.rgb().formatHex8()}function fm(){return Dm(this).formatHsl()}function pm(){return this.rgb().formatRgb()}function mm(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=nm.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?hm(t):n===3?new ym(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?gm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?gm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=rm.exec(e))?new ym(t[1],t[2],t[3],1):(t=im.exec(e))?new ym(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=am.exec(e))?gm(t[1],t[2],t[3],t[4]):(t=om.exec(e))?gm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=sm.exec(e))?Em(t[1],t[2]/100,t[3]/100,1):(t=cm.exec(e))?Em(t[1],t[2]/100,t[3]/100,t[4]):lm.hasOwnProperty(e)?hm(lm[e]):e===`transparent`?new ym(NaN,NaN,NaN,0):null}function hm(e){return new ym(e>>16&255,e>>8&255,e&255,1)}function gm(e,t,n,r){return r<=0&&(e=t=n=NaN),new ym(e,t,n,r)}function _m(e){return e instanceof Xp||(e=mm(e)),e?(e=e.rgb(),new ym(e.r,e.g,e.b,e.opacity)):new ym}function vm(e,t,n,r){return arguments.length===1?_m(e):new ym(e,t,n,r??1)}function ym(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Jp(ym,vm,Yp(Xp,{brighter(e){return e=e==null?Qp:Qp**+e,new ym(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zp:Zp**+e,new ym(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ym(wm(this.r),wm(this.g),wm(this.b),Cm(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bm,formatHex:bm,formatHex8:xm,formatRgb:Sm,toString:Sm}));function bm(){return`#${Tm(this.r)}${Tm(this.g)}${Tm(this.b)}`}function xm(){return`#${Tm(this.r)}${Tm(this.g)}${Tm(this.b)}${Tm((isNaN(this.opacity)?1:this.opacity)*255)}`}function Sm(){let e=Cm(this.opacity);return`${e===1?`rgb(`:`rgba(`}${wm(this.r)}, ${wm(this.g)}, ${wm(this.b)}${e===1?`)`:`, ${e})`}`}function Cm(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function wm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Tm(e){return e=wm(e),(e<16?`0`:``)+e.toString(16)}function Em(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new km(e,t,n,r)}function Dm(e){if(e instanceof km)return new km(e.h,e.s,e.l,e.opacity);if(e instanceof Xp||(e=mm(e)),!e)return new km;if(e instanceof km)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new km(o,s,c,e.opacity)}function Om(e,t,n,r){return arguments.length===1?Dm(e):new km(e,t,n,r??1)}function km(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Jp(km,Om,Yp(Xp,{brighter(e){return e=e==null?Qp:Qp**+e,new km(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zp:Zp**+e,new km(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ym(Mm(e>=240?e-240:e+120,i,r),Mm(e,i,r),Mm(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new km(Am(this.h),jm(this.s),jm(this.l),Cm(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Cm(this.opacity);return`${e===1?`hsl(`:`hsla(`}${Am(this.h)}, ${jm(this.s)*100}%, ${jm(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function Am(e){return e=(e||0)%360,e<0?e+360:e}function jm(e){return Math.max(0,Math.min(1,e||0))}function Mm(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function Nm(e,t){if(typeof e!=`function`||t!=null&&typeof t!=`function`)throw TypeError(`Expected a function`);var n=function(){var r=[...arguments],i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(Nm.Cache||Map),Nm.cacheList.push(n.cache),n}Nm.Cache=Map,Nm.cacheList=[],Nm.clearCache=function(){Nm.cacheList.forEach(function(e){return e.clear()})};var J=function(e){return e[e.kUnknown=0]=`kUnknown`,e[e.kNumber=1]=`kNumber`,e[e.kPercentage=2]=`kPercentage`,e[e.kEms=3]=`kEms`,e[e.kPixels=4]=`kPixels`,e[e.kRems=5]=`kRems`,e[e.kDegrees=6]=`kDegrees`,e[e.kRadians=7]=`kRadians`,e[e.kGradians=8]=`kGradians`,e[e.kTurns=9]=`kTurns`,e[e.kMilliseconds=10]=`kMilliseconds`,e[e.kSeconds=11]=`kSeconds`,e[e.kInteger=12]=`kInteger`,e}({}),Pm=function(e){return e[e.kUNumber=0]=`kUNumber`,e[e.kUPercent=1]=`kUPercent`,e[e.kULength=2]=`kULength`,e[e.kUAngle=3]=`kUAngle`,e[e.kUTime=4]=`kUTime`,e[e.kUOther=5]=`kUOther`,e}({}),Fm=function(e){return e[e.kYes=0]=`kYes`,e[e.kNo=1]=`kNo`,e}({}),Im=function(e){return e[e.kYes=0]=`kYes`,e[e.kNo=1]=`kNo`,e}({}),Lm=[{name:`em`,unit_type:J.kEms},{name:`px`,unit_type:J.kPixels},{name:`deg`,unit_type:J.kDegrees},{name:`rad`,unit_type:J.kRadians},{name:`grad`,unit_type:J.kGradians},{name:`ms`,unit_type:J.kMilliseconds},{name:`s`,unit_type:J.kSeconds},{name:`rem`,unit_type:J.kRems},{name:`turn`,unit_type:J.kTurns}],Rm=function(e){return e[e.kUnknownType=0]=`kUnknownType`,e[e.kUnparsedType=1]=`kUnparsedType`,e[e.kKeywordType=2]=`kKeywordType`,e[e.kUnitType=3]=`kUnitType`,e[e.kSumType=4]=`kSumType`,e[e.kProductType=5]=`kProductType`,e[e.kNegateType=6]=`kNegateType`,e[e.kInvertType=7]=`kInvertType`,e[e.kMinType=8]=`kMinType`,e[e.kMaxType=9]=`kMaxType`,e[e.kClampType=10]=`kClampType`,e[e.kTransformType=11]=`kTransformType`,e[e.kPositionType=12]=`kPositionType`,e[e.kURLImageType=13]=`kURLImageType`,e[e.kColorType=14]=`kColorType`,e[e.kUnsupportedColorType=15]=`kUnsupportedColorType`,e}({}),zm=function(e){return Lm.find(function(t){return t.name===e}).unit_type},Bm=function(e){return e?e===`number`?J.kNumber:e===`percent`||e===`%`?J.kPercentage:zm(e):J.kUnknown},Vm=function(e){switch(e){case J.kNumber:case J.kInteger:return Pm.kUNumber;case J.kPercentage:return Pm.kUPercent;case J.kPixels:return Pm.kULength;case J.kMilliseconds:case J.kSeconds:return Pm.kUTime;case J.kDegrees:case J.kRadians:case J.kGradians:case J.kTurns:return Pm.kUAngle;default:return Pm.kUOther}},Hm=function(e){switch(e){case Pm.kUNumber:return J.kNumber;case Pm.kULength:return J.kPixels;case Pm.kUPercent:return J.kPercentage;case Pm.kUTime:return J.kSeconds;case Pm.kUAngle:return J.kDegrees;default:return J.kUnknown}},Um=function(e){var t=1;switch(e){case J.kPixels:case J.kDegrees:case J.kSeconds:break;case J.kMilliseconds:t=.001;break;case J.kRadians:t=180/Math.PI;break;case J.kGradians:t=.9;break;case J.kTurns:t=360;break}return t},Wm=function(e){switch(e){case J.kNumber:case J.kInteger:return``;case J.kPercentage:return`%`;case J.kEms:return`em`;case J.kRems:return`rem`;case J.kPixels:return`px`;case J.kDegrees:return`deg`;case J.kRadians:return`rad`;case J.kGradians:return`grad`;case J.kMilliseconds:return`ms`;case J.kSeconds:return`s`;case J.kTurns:return`turn`}return``},Gm=function(){function e(){H(this,e)}return U(e,[{key:`toString`,value:function(){return this.buildCSSText(Fm.kNo,Im.kNo,``)}},{key:`isNumericValue`,value:function(){return this.getType()>=Rm.kUnitType&&this.getType()<=Rm.kClampType}}],[{key:`isAngle`,value:function(e){return e===J.kDegrees||e===J.kRadians||e===J.kGradians||e===J.kTurns}},{key:`isLength`,value:function(e){return e>=J.kEms&&e<J.kDegrees}},{key:`isRelativeUnit`,value:function(e){return e===J.kPercentage||e===J.kEms||e===J.kRems}},{key:`isTime`,value:function(e){return e===J.kSeconds||e===J.kMilliseconds}}])}(),Km=function(e){function t(e){var n;return H(this,t),n=Fs(this,t),n.colorSpace=e,n}return Ls(t,e),U(t,[{key:`getType`,value:function(){return Rm.kColorType}},{key:`to`,value:function(e){return this}}])}(Gm),qm=function(e){return e[e.Constant=0]=`Constant`,e[e.LinearGradient=1]=`LinearGradient`,e[e.RadialGradient=2]=`RadialGradient`,e}({}),Jm=function(e){function t(e,n){var r;return H(this,t),r=Fs(this,t),r.type=e,r.value=n,r}return Ls(t,e),U(t,[{key:`clone`,value:function(){return new t(this.type,this.value)}},{key:`buildCSSText`,value:function(e,t,n){return n}},{key:`getType`,value:function(){return Rm.kColorType}}])}(Gm),Ym=function(e){function t(e){var n;return H(this,t),n=Fs(this,t),n.value=e,n}return Ls(t,e),U(t,[{key:`clone`,value:function(){return new t(this.value)}},{key:`getType`,value:function(){return Rm.kKeywordType}},{key:`buildCSSText`,value:function(e,t,n){return n+this.value}}])}(Gm),Xm=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:``,n=``;return n=Number.isFinite(e)?`NaN`:e>0?`infinity`:`-infinity`,n+=t},Zm=function(e){return Hm(Vm(e))},Qm=function(e){function t(e){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J.kNumber;return H(this,t),n=Fs(this,t),n.unit=typeof r==`string`?Bm(r):r,n.value=e,n}return Ls(t,e),U(t,[{key:`clone`,value:function(){return new t(this.value,this.unit)}},{key:`equals`,value:function(e){var t=e;return this.value===t.value&&this.unit===t.unit}},{key:`getType`,value:function(){return Rm.kUnitType}},{key:`convertTo`,value:function(e){if(this.unit===e)return new t(this.value,this.unit);var n=Zm(this.unit);if(n!==Zm(e)||n===J.kUnknown)return null;var r=Um(this.unit)/Um(e);return new t(this.value*r,e)}},{key:`buildCSSText`,value:function(e,t,n){var r;switch(this.unit){case J.kUnknown:break;case J.kInteger:r=Number(this.value).toFixed(0);break;case J.kNumber:case J.kPercentage:case J.kEms:case J.kRems:case J.kPixels:case J.kDegrees:case J.kRadians:case J.kGradians:case J.kMilliseconds:case J.kSeconds:case J.kTurns:var i=-999999,a=999999,o=this.value,s=Wm(this.unit);if(o<i||o>a){var c=Wm(this.unit);r=!Number.isFinite(o)||Number.isNaN(o)?Xm(o,c):o+(c||``)}else r=`${o}${s}`}return n+=r,n}}])}(Gm),$m=new Qm(0,`px`);new Qm(1,`px`);var eh=new Qm(0,`deg`),th=function(e){function t(e,n,r){var i,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;return H(this,t),i=Fs(this,t,[`rgb`]),i.r=e,i.g=n,i.b=r,i.alpha=a,i.isNone=o,i}return Ls(t,e),U(t,[{key:`clone`,value:function(){return new t(this.r,this.g,this.b,this.alpha)}},{key:`buildCSSText`,value:function(e,t,n){return`${n}rgba(${this.r},${this.g},${this.b},${this.alpha})`}}])}(Km),nh=new Ym(`unset`),rh=new Ym(`initial`),ih=new Ym(`inherit`),ah={"":nh,unset:nh,initial:rh,inherit:ih},oh=function(e){return ah[e]||(ah[e]=new Ym(e)),ah[e]},sh=new th(0,0,0,0,!0),ch=new th(0,0,0,0),lh=Nm(function(e,t,n,r){return new th(e,t,n,r)},function(e,t,n,r){return`rgba(${e},${t},${n},${r})`}),uh=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:J.kNumber;return new Qm(e,t)};new Qm(50,`%`);function dh(e){var t=e.type,n=e.value;return t===`hex`?`#${n}`:t===`literal`?n:t===`rgb`?`rgb(${n.join(`,`)})`:`rgba(${n.join(`,`)})`}var fh=function(){var e={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t=``;function n(e){throw Error(`${t}: ${e}`)}function r(){var e=i();return t.length>0&&n(`Invalid input not EOF`),e}function i(){return y(a)}function a(){return o(`linear-gradient`,e.linearGradient,c)||o(`repeating-linear-gradient`,e.repeatingLinearGradient,c)||o(`radial-gradient`,e.radialGradient,d)||o(`repeating-radial-gradient`,e.repeatingRadialGradient,d)||o(`conic-gradient`,e.conicGradient,d)}function o(t,r,i){return s(r,function(r){var a=i();return a&&(j(e.comma)||n(`Missing comma before color stops`)),{type:t,orientation:a,colorStops:y(b)}})}function s(t,r){var i=j(t);if(i){j(e.startCall)||n(`Missing (`);var a=r(i);return j(e.endCall)||n(`Missing )`),a}}function c(){return l()||u()}function l(){return A(`directional`,e.sideOrCorner,1)}function u(){return A(`angular`,e.angleValue,1)}function d(){var n,r=f(),i;return r&&(n=[],n.push(r),i=t,j(e.comma)&&(r=f(),r?n.push(r):t=i)),n}function f(){var e=p()||m();if(e)e.at=g();else{var t=h();if(t){e=t;var n=g();n&&(e.at=n)}else{var r=_();r&&(e={type:`default-radial`,at:r})}}return e}function p(){var e=A(`shape`,/^(circle)/i,0);return e&&(e.style=k()||h()),e}function m(){var e=A(`shape`,/^(ellipse)/i,0);return e&&(e.style=D()||h()),e}function h(){return A(`extent-keyword`,e.extentKeywords,1)}function g(){if(A(`position`,/^at/,0)){var e=_();return e||n(`Missing positioning value`),e}}function _(){var e=v();if(e.x||e.y)return{type:`position`,value:e}}function v(){return{x:D(),y:D()}}function y(t){var r=t(),i=[];if(r)for(i.push(r);j(e.comma);)r=t(),r?i.push(r):n(`One extra comma`);return i}function b(){var e=x();return e||n(`Expected color definition`),e.length=D(),e}function x(){return C()||T()||w()||S()}function S(){return A(`literal`,e.literalColor,0)}function C(){return A(`hex`,e.hexColor,1)}function w(){return s(e.rgbColor,function(){return{type:`rgb`,value:y(E)}})}function T(){return s(e.rgbaColor,function(){return{type:`rgba`,value:y(E)}})}function E(){return j(e.number)[1]}function D(){return A(`%`,e.percentageValue,1)||O()||k()}function O(){return A(`position-keyword`,e.positionKeywords,1)}function k(){return A(`px`,e.pixelValue,1)||A(`em`,e.emValue,1)}function A(e,t,n){var r=j(t);if(r)return{type:e,value:r[n]}}function j(e){var n=/^[\n\r\t\s]+/.exec(t);n&&ee(n[0].length);var r=e.exec(t);return r&&ee(r[0].length),r}function ee(e){t=t.substring(e)}return function(e){return t=e,r()}}();function ph(e,t,n,r){var i=mp(r.value),a=0,o=0,s=a+t/2,c=o+n/2,l=Math.abs(t*Math.cos(i))+Math.abs(n*Math.sin(i)),u=e[0]+s-Math.cos(i)*l/2,d=e[1]+c-Math.sin(i)*l/2,f=e[0]+s+Math.cos(i)*l/2,p=e[1]+c+Math.sin(i)*l/2;return{x1:u,y1:d,x2:f,y2:p}}function mh(e,t,n,r,i,a){var o=r.value,s=i.value;r.unit===J.kPercentage&&(o=r.value/100*t),i.unit===J.kPercentage&&(s=i.value/100*n);var c=Math.max(Nd([0,0],[o,s]),Nd([0,n],[o,s]),Nd([t,n],[o,s]),Nd([t,0],[o,s]));return a&&(a instanceof Qm?c=a.value:a instanceof Ym&&(a.value===`closest-side`?c=Math.min(o,t-o,s,n-s):a.value===`farthest-side`?c=Math.max(o,t-o,s,n-s):a.value===`closest-corner`&&(c=Math.min(Nd([0,0],[o,s]),Nd([0,n],[o,s]),Nd([t,n],[o,s]),Nd([t,0],[o,s]))))),{x:o+e[0],y:s+e[1],r:c}}var hh=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,gh=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,_h=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,vh=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function yh(e){var t=e.length;e[t-1].length=e[t-1].length??{type:`%`,value:`100`},t>1&&(e[0].length=e[0].length??{type:`%`,value:`0`});for(var n=0,r=Number(e[0].length.value),i=1;i<t;i++){var a=e[i].length?.value;if(!Wl(a)&&!Wl(r)){for(var o=1;o<i-n;o++)e[n+o].length={type:`%`,value:`${r+(Number(a)-r)*o/(i-n)}`};n=i,r=Number(a)}}}var bh={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},xh=Nm(function(e){var t=e.type===`angular`?Number(e.value):bh[e.value]||0;return uh(t,`deg`)}),Sh=Nm(function(e){var t=50,n=50,r=`%`,i=`%`;if(e?.type===`position`){var a=e.value,o=a.x,s=a.y;o?.type===`position-keyword`&&(o.value===`left`?t=0:o.value===`center`?t=50:o.value===`right`?t=100:o.value===`top`?n=0:o.value===`bottom`&&(n=100)),s?.type===`position-keyword`&&(s.value===`left`?t=0:s.value===`center`?n=50:s.value===`right`?t=100:s.value===`top`?n=0:s.value===`bottom`&&(n=100)),(o?.type===`px`||o?.type===`%`||o?.type===`em`)&&(r=o?.type,t=Number(o.value)),(s?.type===`px`||s?.type===`%`||s?.type===`em`)&&(i=s?.type,n=Number(s.value))}return{cx:uh(t,r),cy:uh(n,i)}}),Ch=Nm(function(e){if(e.indexOf(`linear`)>-1||e.indexOf(`radial`)>-1)return fh(e).map(function(e){var t=e.type,n=e.orientation,r=e.colorStops;yh(r);var i=r.map(function(e){return{offset:uh(Number(e.length.value),`%`),color:dh(e)}});if(t===`linear-gradient`)return new Jm(qm.LinearGradient,{angle:n?xh(n):eh,steps:i});if(t===`radial-gradient`&&(n||=[{type:`shape`,value:`circle`}],n[0].type===`shape`&&n[0].value===`circle`)){var a=Sh(n[0].at),o=a.cx,s=a.cy,c;if(n[0].style){var l=n[0].style,u=l.type,d=l.value;c=u===`extent-keyword`?oh(d):uh(d,u)}return new Jm(qm.RadialGradient,{cx:o,cy:s,size:c,steps:i})}});var t=e[0];if(e[1]===`(`||e[2]===`(`){if(t===`l`){var n=hh.exec(e);if(n){var r=n[2].match(vh)?.map(function(e){return e.split(`:`)})||[];return[new Jm(qm.LinearGradient,{angle:uh(parseFloat(n[1]),`deg`),steps:r.map(function(e){var t=Vs(e,2),n=t[0],r=t[1];return{offset:uh(Number(n)*100,`%`),color:r}})})]}}else if(t===`r`){var i=wh(e);if(i)if(ru(i))e=i;else return[new Jm(qm.RadialGradient,i)]}else if(t===`p`)return Th(e)}});function wh(e){var t=gh.exec(e);if(t){var n=t[4].match(vh)?.map(function(e){return e.split(`:`)})||[];return{cx:uh(50,`%`),cy:uh(50,`%`),steps:n.map(function(e){var t=Vs(e,2),n=t[0],r=t[1];return{offset:uh(Number(n)*100,`%`),color:r}})}}return null}function Th(e){var t=_h.exec(e);if(t){var n=t[1],r=t[2];switch(n){case`a`:n=`repeat`;break;case`x`:n=`repeat-x`;break;case`y`:n=`repeat-y`;break;case`n`:n=`no-repeat`;break;default:n=`no-repeat`}return{image:r,repetition:n}}return null}function Eh(e){return e&&!!e.image}function Dh(e){return e&&!Wl(e.r)&&!Wl(e.g)&&!Wl(e.b)}var Oh=Nm(function(e){if(Eh(e))return Cs({repetition:`repeat`},e);if(Wl(e)&&(e=``),e===`transparent`)return ch;if(e===`currentColor`)e=`black`;else if(e===`none`)return sh;var t=Ch(e);if(t)return t;var n=mm(e),r=[0,0,0,0];return n!==null&&(r[0]=n.r||0,r[1]=n.g||0,r[2]=n.b||0,r[3]=n.opacity),lh.apply(void 0,r)});function kh(e,t){if(!(!Dh(e)||!Dh(t)))return[[Number(e.r),Number(e.g),Number(e.b),Number(e.alpha)],[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],function(e){var t=e.slice();if(t[3])for(var n=0;n<3;n++)t[n]=Math.round(cu(t[n],0,255));return t[3]=cu(t[3],0,1),`rgba(${t.join(`,`)})`}]}function Ah(e,t){if(Wl(t))return uh(0,`px`);if(t=`${t}`.trim().toLowerCase(),isFinite(Number(t))){if(`px`.search(e)>=0)return uh(Number(t),`px`);if(`deg`.search(e)>=0)return uh(Number(t),`deg`)}var n=[];t=t.replace(e,function(e){return n.push(e),`U${e}`});var r=`U(${e.source})`;return n.map(function(e){return uh(Number(t.replace(RegExp(`U${e}`,`g`),``).replace(new RegExp(r,`g`),`*0`)),e)})[0]}var jh=function(e){return Ah(RegExp(`px`,`g`),e)},Mh=Nm(jh);Nm(function(e){return Ah(RegExp(`%`,`g`),e)});var Nh=function(e){return G(e)||isFinite(Number(e))?uh(Number(e)||0,`px`):Ah(RegExp(`px|%|em|rem`,`g`),e)},Ph=Nm(Nh),Fh=function(e){return Ah(RegExp(`deg|rad|grad|turn`,`g`),e)},Ih=Nm(Fh);function Lh(e,t,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,a=``,o=e.value||0,s=t.value||0,c=Zm(e.unit),l=e.convertTo(c),u=t.convertTo(c);return l&&u?(o=l.value,s=u.value,a=Wm(e.unit)):(Qm.isLength(e.unit)||Qm.isLength(t.unit))&&(o=Bh(e,i,n),s=Bh(t,i,n),a=`px`),[o,s,function(e){return r&&(e=Math.max(e,0)),e+a}]}function Rh(e){var t=0;return e.unit===J.kDegrees?t=e.value:e.unit===J.kRadians?t=gp(Number(e.value)):e.unit===J.kTurns?t=_p(Number(e.value)):e.value&&(t=e.value),t}function zh(e,t){var n;return Array.isArray(e)?n=e.map(function(e){return Number(e)}):ru(e)?n=e.split(` `).map(function(e){return Number(e)}):G(e)&&(n=[e]),t===2?n.length===1?[n[0],n[0]]:[n[0],n[1]]:t===4?n.length===1?[n[0],n[0],n[0],n[0]]:n.length===2?[n[0],n[1],n[0],n[1]]:n.length===3?[n[0],n[1],n[2],n[1]]:[n[0],n[1],n[2],n[3]]:t===`even`&&n.length%2==1?[].concat(As(n),As(n)):n}function Bh(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(e.unit===J.kPixels)return Number(e.value);if(e.unit===J.kPercentage&&n){var i=n.nodeName===K.GROUP?n.getLocalBounds():n.getGeometryBounds();return(r?i.min[t]:0)+e.value/100*i.halfExtents[t]*2}return 0}var Vh=function(e){return Ah(/deg|rad|grad|turn|px|%/g,e)},Hh=[`blur`,`brightness`,`drop-shadow`,`contrast`,`grayscale`,`sepia`,`saturate`,`hue-rotate`,`invert`];function Uh(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:``;if(e=e.toLowerCase().trim(),e===`none`)return[];for(var t=/\s*([\w-]+)\(([^)]*)\)/g,n=[],r,i=0;r=t.exec(e);){if(r.index!==i)return[];if(i=r.index+r[0].length,Hh.indexOf(r[1])>-1&&n.push({name:r[1],params:r[2].split(` `).map(function(e){return Vh(e)||Oh(e)})}),t.lastIndex===e.length)return n}return[]}function Wh(e){return e.toString()}var Gh=function(e){return typeof e==`number`?uh(e):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(e)?uh(Number(e)):uh(0)},Kh=Nm(Gh);Nm(function(e){return ru(e)?e.split(` `).map(Kh):e.map(Kh)});function qh(e,t){return[e,t,Wh]}function Jh(e,t){return function(n,r){return[n,r,function(n){return Wh(cu(n,e,t))}]}}function Yh(e,t){if(e.length===t.length)return[e,t,function(e){return e}]}function Xh(e){return e.parsedStyle.d.totalLength===0&&(e.parsedStyle.d.totalLength=Ud(e.parsedStyle.d.absolutePath)),e.parsedStyle.d.totalLength}function Zh(e){return e.parsedStyle.points.totalLength===0&&(e.parsedStyle.points.totalLength=wf(e.parsedStyle.points.points)),e.parsedStyle.points.totalLength}function Qh(e){for(var t=0;t<e.length;t++){var n=e[t-1],r=e[t];if(r[0]===`M`&&n){var i=n[0],a=[r[1],r[2]],o=void 0;i===`L`||i===`M`?o=[n[1],n[2]]:(i===`C`||i===`A`||i===`Q`)&&(o=[n[n.length-2],n[n.length-1]]),o&&tg(a,o)&&(e.splice(t,1),t--)}}}function $h(e){for(var t=!1,n=e.length,r=0;r<n;r++){var i=e[r][0];if(i===`C`||i===`A`||i===`Q`){t=!0;break}}return t}function eg(e){for(var t=[],n=[],r=[],i=0;i<e.length;i++){var a=e[i],o=a[0];o===`M`?(r.length&&(n.push(r),r=[]),r.push([a[1],a[2]])):o===`Z`?r.length&&(t.push(r),r=[]):r.push([a[1],a[2]])}return r.length>0&&n.push(r),{polygons:t,polylines:n}}function tg(e,t){return e[0]===t[0]&&e[1]===t[1]}function ng(e,t){for(var n=[],r=[],i=[],a=0;a<e.length;a++){var o=e[a],s=o.currentPoint,c=o.params,l=o.prePoint,u=void 0;switch(o.command){case`Q`:u=Df(l[0],l[1],c[1],c[2],c[3],c[4]);break;case`C`:u=bf(l[0],l[1],c[1],c[2],c[3],c[4],c[5],c[6]);break;case`A`:var d=o.arcParams;u=ff(d.cx,d.cy,d.rx,d.ry,d.xRotation,d.startAngle,d.endAngle);break;default:n.push(s[0]),r.push(s[1]);break}u&&(o.box=u,n.push(u.x,u.x+u.width),r.push(u.y,u.y+u.height)),t&&(o.command===`L`||o.command===`M`)&&o.prePoint&&o.nextPoint&&i.push(o)}n=n.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0}),r=r.filter(function(e){return!Number.isNaN(e)&&e!==1/0&&e!==-1/0});var f=tu(n),p=tu(r),m=eu(n),h=eu(r);if(i.length===0)return{x:f,y:p,width:m-f,height:h-p};for(var g=0;g<i.length;g++){var _=i[g],v=_.currentPoint,y=void 0;v[0]===f?(y=rg(_,t),f-=y.xExtra):v[0]===m&&(y=rg(_,t),m+=y.xExtra),v[1]===p?(y=rg(_,t),p-=y.yExtra):v[1]===h&&(y=rg(_,t),h+=y.yExtra)}return{x:f,y:p,width:m-f,height:h-p}}function rg(e,t){var n=e.prePoint,r=e.currentPoint,i=e.nextPoint,a=(r[0]-n[0])**2+(r[1]-n[1])**2,o=(r[0]-i[0])**2+(r[1]-i[1])**2,s=(n[0]-i[0])**2+(n[1]-i[1])**2,c=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!c||Math.sin(c)===0||uu(c,0))return{xExtra:0,yExtra:0};var l=Math.abs(Math.atan2(i[1]-r[1],i[0]-r[0])),u=Math.abs(Math.atan2(i[0]-r[0],i[1]-r[1]));return l=l>Math.PI/2?Math.PI-l:l,u=u>Math.PI/2?Math.PI-u:u,{xExtra:Math.cos(c/2-l)*(t/2*(1/Math.sin(c/2)))-t/2||0,yExtra:Math.cos(u-c/2)*(t/2*(1/Math.sin(c/2)))-t/2||0}}function ig(e,t){return[t[0]+(t[0]-e[0]),t[1]+(t[1]-e[1])]}var ag=function(e,t){var n=e.x*t.x+e.y*t.y,r=Math.sqrt((e.x**2+e.y**2)*(t.x**2+t.y**2));return(e.x*t.y-e.y*t.x<0?-1:1)*Math.acos(n/r)},og=function(e,t,n,r,i,a,o,s){t=Math.abs(t),n=Math.abs(n),r=pu(r,360);var c=mp(r);if(e.x===o.x&&e.y===o.y)return{x:e.x,y:e.y,ellipticalArcAngle:0};if(t===0||n===0)return{x:0,y:0,ellipticalArcAngle:0};var l=(e.x-o.x)/2,u=(e.y-o.y)/2,d={x:Math.cos(c)*l+Math.sin(c)*u,y:-Math.sin(c)*l+Math.cos(c)*u},f=d.x**2/t**2+d.y**2/n**2;f>1&&(t*=Math.sqrt(f),n*=Math.sqrt(f));var p=t**2*n**2-t**2*d.y**2-n**2*d.x**2,m=t**2*d.y**2+n**2*d.x**2,h=p/m;h=h<0?0:h;var g=(i===a?-1:1)*Math.sqrt(h),_={x:g*(t*d.y/n),y:g*(-(n*d.x)/t)},v={x:Math.cos(c)*_.x-Math.sin(c)*_.y+(e.x+o.x)/2,y:Math.sin(c)*_.x+Math.cos(c)*_.y+(e.y+o.y)/2},y={x:(d.x-_.x)/t,y:(d.y-_.y)/n},b=ag({x:1,y:0},y),x={x:(-d.x-_.x)/t,y:(-d.y-_.y)/n},S=ag(y,x);!a&&S>0?S-=2*Math.PI:a&&S<0&&(S+=2*Math.PI),S%=2*Math.PI;var C=b+S*s,w=t*Math.cos(C),T=n*Math.sin(C);return{x:Math.cos(c)*w-Math.sin(c)*T+v.x,y:Math.sin(c)*w+Math.cos(c)*T+v.y,ellipticalArcStartAngle:b,ellipticalArcEndAngle:b+S,ellipticalArcAngle:C,ellipticalArcCenter:v,resultantRx:t,resultantRy:n}};function sg(e){for(var t=[],n=null,r=null,i=null,a=0,o=e.length,s=0;s<o;s++){var c=e[s];r=e[s+1];var l=c[0],u={command:l,prePoint:n,params:c,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(l){case`M`:i=[c[1],c[2]],a=s;break;case`A`:u.arcParams=fg(n,c);break}if(l===`Z`)n=i,r=e[a+1];else{var d=c.length;n=[c[d-2],c[d-1]]}r&&r[0]===`Z`&&(r=e[a],t[a]&&(t[a].prePoint=n)),u.currentPoint=n,t[a]&&tg(n,t[a].currentPoint)&&(t[a].prePoint=u.prePoint),u.nextPoint=r?[r[r.length-2],r[r.length-1]]:null;var f=u.prePoint;if([`L`,`H`,`V`].includes(l))u.startTangent=[f[0]-n[0],f[1]-n[1]],u.endTangent=[n[0]-f[0],n[1]-f[1]];else if(l===`Q`){var p=[c[1],c[2]];u.startTangent=[f[0]-p[0],f[1]-p[1]],u.endTangent=[n[0]-p[0],n[1]-p[1]]}else if(l===`T`){var m=t[s-1],h=ig(m.currentPoint,f);m.command===`Q`?(u.command=`Q`,u.startTangent=[f[0]-h[0],f[1]-h[1]],u.endTangent=[n[0]-h[0],n[1]-h[1]]):(u.command=`TL`,u.startTangent=[f[0]-n[0],f[1]-n[1]],u.endTangent=[n[0]-f[0],n[1]-f[1]])}else if(l===`C`){var g=[c[1],c[2]],_=[c[3],c[4]];u.startTangent=[f[0]-g[0],f[1]-g[1]],u.endTangent=[n[0]-_[0],n[1]-_[1]],u.startTangent[0]===0&&u.startTangent[1]===0&&(u.startTangent=[g[0]-_[0],g[1]-_[1]]),u.endTangent[0]===0&&u.endTangent[1]===0&&(u.endTangent=[_[0]-g[0],_[1]-g[1]])}else if(l===`S`){var v=t[s-1],y=ig(v.currentPoint,f),b=[c[1],c[2]];v.command===`C`?(u.command=`C`,u.startTangent=[f[0]-y[0],f[1]-y[1]],u.endTangent=[n[0]-b[0],n[1]-b[1]]):(u.command=`SQ`,u.startTangent=[f[0]-b[0],f[1]-b[1]],u.endTangent=[n[0]-b[0],n[1]-b[1]])}else if(l===`A`){var x=cg(u,0),S=x.x,C=x.y,w=cg(u,1,!1),T=w.x,E=w.y;u.startTangent=[S,C],u.endTangent=[T,E]}t.push(u)}return t}function cg(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=e.arcParams,i=r.rx,a=i===void 0?0:i,o=r.ry,s=o===void 0?0:o,c=r.xRotation,l=r.arcFlag,u=r.sweepFlag,d=og({x:e.prePoint[0],y:e.prePoint[1]},a,s,c,!!l,!!u,{x:e.currentPoint[0],y:e.currentPoint[1]},t),f=og({x:e.prePoint[0],y:e.prePoint[1]},a,s,c,!!l,!!u,{x:e.currentPoint[0],y:e.currentPoint[1]},n?t+.005:t-.005),p=f.x-d.x,m=f.y-d.y,h=Math.sqrt(p*p+m*m);return{x:-p/h,y:-m/h}}function lg(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ug(e,t){return lg(e)*lg(t)?(e[0]*t[0]+e[1]*t[1])/(lg(e)*lg(t)):1}function dg(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(ug(e,t))}function fg(e,t){var n=t[1],r=t[2],i=pu(mp(t[3]),Math.PI*2),a=t[4],o=t[5],s=e[0],c=e[1],l=t[6],u=t[7],d=Math.cos(i)*(s-l)/2+Math.sin(i)*(c-u)/2,f=-1*Math.sin(i)*(s-l)/2+Math.cos(i)*(c-u)/2,p=d*d/(n*n)+f*f/(r*r);p>1&&(n*=Math.sqrt(p),r*=Math.sqrt(p));var m=n*n*(f*f)+r*r*(d*d),h=m?Math.sqrt((n*n*(r*r)-m)/m):1;a===o&&(h*=-1),isNaN(h)&&(h=0);var g=r?h*n*f/r:0,_=n?h*-r*d/n:0,v=(s+l)/2+Math.cos(i)*g-Math.sin(i)*_,y=(c+u)/2+Math.sin(i)*g+Math.cos(i)*_,b=[(d-g)/n,(f-_)/r],x=[(-1*d-g)/n,(-1*f-_)/r],S=dg([1,0],b),C=dg(b,x);return ug(b,x)<=-1&&(C=Math.PI),ug(b,x)>=1&&(C=0),o===0&&C>0&&(C-=2*Math.PI),o===1&&C<0&&(C+=2*Math.PI),{cx:v,cy:y,rx:tg(e,[l,u])?0:n,ry:tg(e,[l,u])?0:r,startAngle:S,endAngle:S+C,xRotation:i,arcFlag:a,sweepFlag:o}}var pg=function(e){if(e===``||Array.isArray(e)&&e.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var t;try{t=Sd(e)}catch{t=Sd(``),console.error(`[g]: Invalid SVG Path definition: ${e}`)}Qh(t);var n=$h(t),r=eg(t),i=r.polygons,a=r.polylines,o=sg(t),s=ng(o,0),c=s.x,l=s.y,u=s.width,d=s.height;return{absolutePath:t,hasArc:n,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(c)?c:0,y:Number.isFinite(l)?l:0,width:Number.isFinite(u)?u:0,height:Number.isFinite(d)?d:0}}},mg=Nm(pg);function hg(e){return ru(e)?mg(e):pg(e)}function gg(e,t,n){var r=e.curve,i=t.curve;(!r||r.length===0)&&(r=Ad(e.absolutePath,!1),e.curve=r),(!i||i.length===0)&&(i=Ad(t.absolutePath,!1),t.curve=i);var a=[r,i];r.length!==i.length&&(a=$d(r,i));var o=Jd(a[0])===Jd(a[1])?jd(a[0]):Md(a[0]);return[o,Gd(a[1],o),function(e){return e}]}function _g(e,t){return{points:ru(e)?e.split(` `).map(function(e){var t=e.split(`,`),n=Vs(t,2),r=n[0],i=n[1];return[Number(r),Number(i)]}):e,totalLength:0,segments:[]}}function vg(e,t){return[e.points,t.points,function(e){return e}]}var yg=null,bg=/\s*(\w+)\(([^)]*)\)/g;function xg(e){return function(t){var n=0;return e.map(function(e){return e===yg?t[n++]:e})}}function Sg(e){return e}var Cg={matrix:[`NNNNNN`,[yg,yg,0,0,yg,yg,0,0,0,0,1,0,yg,yg,0,1],Sg],matrix3d:[`NNNNNNNNNNNNNNNN`,Sg],rotate:[`A`],rotateX:[`A`],rotateY:[`A`],rotateZ:[`A`],rotate3d:[`NNNA`],perspective:[`L`],scale:[`Nn`,xg([yg,yg,new Qm(1)]),Sg],scaleX:[`N`,xg([yg,new Qm(1),new Qm(1)]),xg([yg,new Qm(1)])],scaleY:[`N`,xg([new Qm(1),yg,new Qm(1)]),xg([new Qm(1),yg])],scaleZ:[`N`,xg([new Qm(1),new Qm(1),yg])],scale3d:[`NNN`,Sg],skew:[`Aa`,null,Sg],skewX:[`A`,null,xg([yg,eh])],skewY:[`A`,null,xg([eh,yg])],translate:[`Tt`,xg([yg,yg,$m]),Sg],translateX:[`T`,xg([yg,$m,$m]),xg([yg,$m])],translateY:[`T`,xg([$m,yg,$m]),xg([$m,yg])],translateZ:[`L`,xg([$m,$m,yg])],translate3d:[`TTL`,Sg]};function wg(e){for(var t=[],n=e.length,r=0;r<n;r++){var i=e[r],a=i[0],o=i.slice(1);if(a===`translate`||a===`skew`?o.length===1&&o.push(0):a===`scale`&&o.length===1&&o.push(o[0]),!Cg[a])return[];var s=o.map(function(e){return uh(e)});t.push({t:a,d:s})}return t}function Tg(e){if(Array.isArray(e))return wg(e);if(e=(e||`none`).trim(),e===`none`)return[];var t=[],n,r=0;for(bg.lastIndex=0;n=bg.exec(e);){if(n.index!==r)return[];r=n.index+n[0].length;var i=n[1],a=Cg[i];if(!a)return[];var o=n[2].split(`,`),s=a[0];if(s.length<o.length)return[];for(var c=[],l=0;l<s.length;l++){var u=o[l],d=s[l],f=void 0;if(f=u?{A:function(e){return e.trim()===`0`?eh:Ih(e)},N:Kh,T:Ph,L:Mh}[d.toUpperCase()](u):{a:eh,n:c[0],t:$m}[d],f===void 0)return[];c.push(f)}if(t.push({t:i,d:c}),bg.lastIndex===e.length)return t}return[]}function Eg(e){if(Array.isArray(e))return wg(e);if(e=(e||`none`).trim(),e===`none`)return[];var t=[],n,r=0;for(bg.lastIndex=0;n=bg.exec(e);){if(n.index!==r)return[];r=n.index+n[0].length;var i=n[1],a=Cg[i];if(!a)return[];var o=n[2].split(`,`),s=a[0];if(s.length<o.length)return[];for(var c=[],l=0;l<s.length;l++){var u=o[l],d=s[l],f=void 0;if(f=u?{A:function(e){return e.trim()===`0`?eh:Fh(e)},N:Gh,T:Nh,L:jh}[d.toUpperCase()](u):{a:eh,n:c[0],t:$m}[d],f===void 0)return[];c.push(f)}if(t.push({t:i,d:c}),bg.lastIndex===e.length)return t}return[]}function Dg(e){var t,n,r,i;switch(e.t){case`rotateX`:return i=mp(Rh(e.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case`rotateY`:return i=mp(Rh(e.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case`rotate`:case`rotateZ`:return i=mp(Rh(e.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case`rotate3d`:t=e.d[0].value,n=e.d[1].value,r=e.d[2].value,i=mp(Rh(e.d[3]));var a=t*t+n*n+r*r;if(a===0)t=1,n=0,r=0;else if(a!==1){var o=Math.sqrt(a);t/=o,n/=o,r/=o}var s=Math.sin(i/2),c=s*Math.cos(i/2),l=s*s;return[1-2*(n*n+r*r)*l,2*(t*n*l+r*c),2*(t*r*l-n*c),0,2*(t*n*l-r*c),1-2*(t*t+r*r)*l,2*(n*r*l+t*c),0,2*(t*r*l+n*c),2*(n*r*l-t*c),1-2*(t*t+n*n)*l,0,0,0,0,1];case`scale`:return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,1,0,0,0,0,1];case`scaleX`:return[e.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case`scaleY`:return[1,0,0,0,0,e.d[0].value,0,0,0,0,1,0,0,0,0,1];case`scaleZ`:return[1,0,0,0,0,1,0,0,0,0,e.d[0].value,0,0,0,0,1];case`scale3d`:return[e.d[0].value,0,0,0,0,e.d[1].value,0,0,0,0,e.d[2].value,0,0,0,0,1];case`skew`:var u=mp(Rh(e.d[0])),d=mp(Rh(e.d[1]));return[1,Math.tan(d),0,0,Math.tan(u),1,0,0,0,0,1,0,0,0,0,1];case`skewX`:return i=mp(Rh(e.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case`skewY`:return i=mp(Rh(e.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case`translate`:return t=Bh(e.d[0],0,null)||0,n=Bh(e.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,0,1];case`translateX`:return t=Bh(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,0,0,1];case`translateY`:return n=Bh(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,n,0,1];case`translateZ`:return r=Bh(e.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,r,1];case`translate3d`:return t=Bh(e.d[0],0,null)||0,n=Bh(e.d[1],0,null)||0,r=Bh(e.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,r,1];case`perspective`:var f=Bh(e.d[0],0,null)||0;return[1,0,0,0,0,1,0,0,0,0,1,f?-1/f:0,0,0,0,1];case`matrix`:return[e.d[0].value,e.d[1].value,0,0,e.d[2].value,e.d[3].value,0,0,0,0,1,0,e.d[4].value,e.d[5].value,0,1];case`matrix3d`:return e.d.map(function(e){return e.value})}}function Og(e,t){return[e[0]*t[0]+e[4]*t[1]+e[8]*t[2]+e[12]*t[3],e[1]*t[0]+e[5]*t[1]+e[9]*t[2]+e[13]*t[3],e[2]*t[0]+e[6]*t[1]+e[10]*t[2]+e[14]*t[3],e[3]*t[0]+e[7]*t[1]+e[11]*t[2]+e[15]*t[3],e[0]*t[4]+e[4]*t[5]+e[8]*t[6]+e[12]*t[7],e[1]*t[4]+e[5]*t[5]+e[9]*t[6]+e[13]*t[7],e[2]*t[4]+e[6]*t[5]+e[10]*t[6]+e[14]*t[7],e[3]*t[4]+e[7]*t[5]+e[11]*t[6]+e[15]*t[7],e[0]*t[8]+e[4]*t[9]+e[8]*t[10]+e[12]*t[11],e[1]*t[8]+e[5]*t[9]+e[9]*t[10]+e[13]*t[11],e[2]*t[8]+e[6]*t[9]+e[10]*t[10]+e[14]*t[11],e[3]*t[8]+e[7]*t[9]+e[11]*t[10]+e[15]*t[11],e[0]*t[12]+e[4]*t[13]+e[8]*t[14]+e[12]*t[15],e[1]*t[12]+e[5]*t[13]+e[9]*t[14]+e[13]*t[15],e[2]*t[12]+e[6]*t[13]+e[10]*t[14]+e[14]*t[15],e[3]*t[12]+e[7]*t[13]+e[11]*t[14]+e[15]*t[15]]}function kg(e){return e.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:e.map(Dg).reduce(Og)}function Ag(e){var t=[0,0,0],n=[1,1,1],r=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return Ap(kg(e),t,n,r,i,a),[[t,n,r,a,i]]}var jg=function(){function e(e,t){for(var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],r=0;r<4;r++)for(var i=0;i<4;i++)for(var a=0;a<4;a++)n[r][i]+=t[r][a]*e[a][i];return n}function t(e){return e[0][2]===0&&e[0][3]===0&&e[1][2]===0&&e[1][3]===0&&e[2][0]===0&&e[2][1]===0&&e[2][2]===1&&e[2][3]===0&&e[3][2]===0&&e[3][3]===1}function n(n,r,i,a,o){for(var s=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],c=0;c<4;c++)s[c][3]=o[c];for(var l=0;l<3;l++)for(var u=0;u<3;u++)s[3][l]+=n[u]*s[u][l];var d=a[0],f=a[1],p=a[2],m=a[3],h=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];h[0][0]=1-2*(f*f+p*p),h[0][1]=2*(d*f-p*m),h[0][2]=2*(d*p+f*m),h[1][0]=2*(d*f+p*m),h[1][1]=1-2*(d*d+p*p),h[1][2]=2*(f*p-d*m),h[2][0]=2*(d*p-f*m),h[2][1]=2*(f*p+d*m),h[2][2]=1-2*(d*d+f*f),s=e(s,h);var g=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];i[2]&&(g[2][1]=i[2],s=e(s,g)),i[1]&&(g[2][1]=0,g[2][0]=i[0],s=e(s,g)),i[0]&&(g[2][0]=0,g[1][0]=i[0],s=e(s,g));for(var _=0;_<3;_++)for(var v=0;v<3;v++)s[_][v]*=r[_];return t(s)?[s[0][0],s[0][1],s[1][0],s[1][1],s[3][0],s[3][1]]:s[0].concat(s[1],s[2],s[3])}return n}();function Mg(e){return e.toFixed(6).replace(`.000000`,``)}function Ng(e,t){var n,r;return e.decompositionPair!==t&&(e.decompositionPair=t,n=Ag(e)),t.decompositionPair!==e&&(t.decompositionPair=e,r=Ag(t)),n[0]===null||r[0]===null?[[!1],[!0],function(n){return n?t[0].d:e[0].d}]:(n[0].push(0),r[0].push(1),[n,r,function(e){var t=Fg(n[0][3],r[0][3],e[5]);return jg(e[0],e[1],e[2],t,e[4]).map(Mg).join(`,`)}])}function Pg(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function Fg(e,t,n){var r=Pg(e,t);r=cu(r,-1,1);var i=[];if(r===1)i=e;else for(var a=Math.acos(r),o=Math.sin(n*a)*1/Math.sqrt(1-r*r),s=0;s<4;s++)i.push(e[s]*(Math.cos(n*a)-r*o)+t[s]*o);return i}function Ig(e){return e.replace(/[XY]/,``)}function Lg(e){return e.replace(/(X|Y|Z|3d)?$/,`3d`)}var Rg=function(e,t){return e===`perspective`&&t===`perspective`||(e===`matrix`||e===`matrix3d`)&&(t===`matrix`||t===`matrix3d`)};function zg(e,t,n){var r=!1;if(!e.length||!t.length){e.length||(r=!0,e=t,t=[]);for(var i=function(){var n=e[a],r=n.t,i=n.d,o=r.substring(0,5)===`scale`?1:0;t.push({t:r,d:i.map(function(e){return typeof e==`number`?uh(o):uh(o,e.unit)})})},a=0;a<e.length;a++)i()}var o=[],s=[],c=[];if(e.length!==t.length){var l=Ng(e,t);o=[l[0]],s=[l[1]],c=[[`matrix`,[l[2]]]]}else for(var u=0;u<e.length;u++){var d=e[u].t,f=t[u].t,p=e[u].d,m=t[u].d,h=Cg[d],g=Cg[f],_=void 0;if(Rg(d,f)){var v=Ng([e[u]],[t[u]]);o.push(v[0]),s.push(v[1]),c.push([`matrix`,[v[2]]]);continue}else if(d===f)_=d;else if(h[2]&&g[2]&&Ig(d)===Ig(f))_=Ig(d),p=h[2](p),m=g[2](m);else if(h[1]&&g[1]&&Lg(d)===Lg(f))_=Lg(d),p=h[1](p),m=g[1](m);else{var y=Ng(e,t);o=[y[0]],s=[y[1]],c=[[`matrix`,[y[2]]]];break}for(var b=[],x=[],S=[],C=0;C<p.length;C++){var w=Lh(p[C],m[C],n,!1,C);b[C]=w[0],x[C]=w[1],S.push(w[2])}o.push(b),s.push(x),c.push([_,S])}if(r){var T=o;o=s,s=T}return[o,s,function(e){return e.map(function(e,t){var n=e.map(function(e,n){return c[t][1][n](e)}).join(`,`);return c[t][0]===`matrix`&&n.split(`,`).length===16&&(c[t][0]=`matrix3d`),c[t][0]===`matrix3d`&&n.split(`,`).length===6&&(c[t][0]=`matrix`),`${c[t][0]}(${n})`}).join(` `)}]}var Bg=Nm(function(e){if(ru(e)){if(e===`text-anchor`)return[uh(0,`px`),uh(0,`px`)];var t=e.split(` `);return t.length===1&&(t[0]===`top`||t[0]===`bottom`?(t[1]=t[0],t[0]=`center`):t[1]=`center`),t.length===2?[Ph(Vg(t[0])),Ph(Vg(t[1]))]:null}return[uh(e[0]||0,`px`),uh(e[1]||0,`px`)]});function Vg(e){return e===`center`?`50%`:e===`left`||e===`top`?`0%`:e===`right`||e===`bottom`?`100%`:e}var Hg=[{n:`display`,k:[`none`]},{n:`opacity`,int:!0,inh:!0,d:`1`,syntax:q.OPACITY_VALUE},{n:`fillOpacity`,int:!0,inh:!0,d:`1`,syntax:q.OPACITY_VALUE},{n:`strokeOpacity`,int:!0,inh:!0,d:`1`,syntax:q.OPACITY_VALUE},{n:`fill`,int:!0,k:[`none`],d:`none`,syntax:q.PAINT},{n:`fillRule`,k:[`nonzero`,`evenodd`],d:`nonzero`},{n:`stroke`,int:!0,k:[`none`],d:`none`,syntax:q.PAINT,l:!0},{n:`shadowType`,k:[`inner`,`outer`,`both`],d:`outer`,l:!0},{n:`shadowColor`,int:!0,syntax:q.COLOR},{n:`shadowOffsetX`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`shadowOffsetY`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`shadowBlur`,int:!0,l:!0,d:`0`,syntax:q.SHADOW_BLUR},{n:`lineWidth`,int:!0,inh:!0,d:`1`,l:!0,a:[`strokeWidth`],syntax:q.LENGTH_PERCENTAGE},{n:`increasedLineWidthForHitTesting`,inh:!0,d:`0`,l:!0,syntax:q.LENGTH_PERCENTAGE},{n:`lineJoin`,inh:!0,l:!0,a:[`strokeLinejoin`],k:[`miter`,`bevel`,`round`],d:`miter`},{n:`lineCap`,inh:!0,l:!0,a:[`strokeLinecap`],k:[`butt`,`round`,`square`],d:`butt`},{n:`lineDash`,int:!0,inh:!0,k:[`none`],a:[`strokeDasharray`],syntax:q.LENGTH_PERCENTAGE_12},{n:`lineDashOffset`,int:!0,inh:!0,d:`0`,a:[`strokeDashoffset`],syntax:q.LENGTH_PERCENTAGE},{n:`offsetPath`,syntax:q.DEFINED_PATH},{n:`offsetDistance`,int:!0,syntax:q.OFFSET_DISTANCE},{n:`dx`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`dy`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`zIndex`,ind:!0,int:!0,d:`0`,k:[`auto`],syntax:q.Z_INDEX},{n:`visibility`,k:[`visible`,`hidden`],ind:!0,inh:!0,int:!0,d:`visible`},{n:`pointerEvents`,inh:!0,k:[`none`,`auto`,`stroke`,`fill`,`painted`,`visible`,`visiblestroke`,`visiblefill`,`visiblepainted`,`all`],d:`auto`},{n:`filter`,ind:!0,l:!0,k:[`none`],d:`none`,syntax:q.FILTER},{n:`clipPath`,syntax:q.DEFINED_PATH},{n:`textPath`,syntax:q.DEFINED_PATH},{n:`textPathSide`,k:[`left`,`right`],d:`left`},{n:`textPathStartOffset`,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`transform`,p:100,int:!0,k:[`none`],d:`none`,syntax:q.TRANSFORM},{n:`transformOrigin`,p:100,d:`0 0`,l:!0,syntax:q.TRANSFORM_ORIGIN},{n:`cx`,int:!0,l:!0,d:`0`,syntax:q.COORDINATE},{n:`cy`,int:!0,l:!0,d:`0`,syntax:q.COORDINATE},{n:`cz`,int:!0,l:!0,d:`0`,syntax:q.COORDINATE},{n:`r`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`rx`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`ry`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`x`,int:!0,l:!0,d:`0`,syntax:q.COORDINATE},{n:`y`,int:!0,l:!0,d:`0`,syntax:q.COORDINATE},{n:`z`,int:!0,l:!0,d:`0`,syntax:q.COORDINATE},{n:`width`,int:!0,l:!0,k:[`auto`,`fit-content`,`min-content`,`max-content`],d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`height`,int:!0,l:!0,k:[`auto`,`fit-content`,`min-content`,`max-content`],d:`0`,syntax:q.LENGTH_PERCENTAGE},{n:`radius`,int:!0,l:!0,d:`0`,syntax:q.LENGTH_PERCENTAGE_14},{n:`x1`,int:!0,l:!0,syntax:q.COORDINATE},{n:`y1`,int:!0,l:!0,syntax:q.COORDINATE},{n:`z1`,int:!0,l:!0,syntax:q.COORDINATE},{n:`x2`,int:!0,l:!0,syntax:q.COORDINATE},{n:`y2`,int:!0,l:!0,syntax:q.COORDINATE},{n:`z2`,int:!0,l:!0,syntax:q.COORDINATE},{n:`d`,int:!0,l:!0,d:``,syntax:q.PATH,p:50},{n:`points`,int:!0,l:!0,syntax:q.LIST_OF_POINTS,p:50},{n:`text`,l:!0,d:``,syntax:q.TEXT,p:50},{n:`textTransform`,l:!0,inh:!0,k:[`capitalize`,`uppercase`,`lowercase`,`none`],d:`none`,syntax:q.TEXT_TRANSFORM,p:51},{n:`font`,l:!0},{n:`fontSize`,int:!0,inh:!0,d:`16px`,l:!0,syntax:q.LENGTH_PERCENTAGE},{n:`fontFamily`,l:!0,inh:!0,d:`sans-serif`},{n:`fontStyle`,l:!0,inh:!0,k:[`normal`,`italic`,`oblique`],d:`normal`},{n:`fontWeight`,l:!0,inh:!0,k:[`normal`,`bold`,`bolder`,`lighter`],d:`normal`},{n:`fontVariant`,l:!0,inh:!0,k:[`normal`,`small-caps`],d:`normal`},{n:`lineHeight`,l:!0,syntax:q.LENGTH,int:!0,d:`0`},{n:`letterSpacing`,l:!0,syntax:q.LENGTH,int:!0,d:`0`},{n:`miterLimit`,l:!0,syntax:q.NUMBER,d:function(e){return e===K.PATH||e===K.POLYGON||e===K.POLYLINE?`4`:`10`}},{n:`wordWrap`,l:!0},{n:`wordWrapWidth`,l:!0},{n:`maxLines`,l:!0},{n:`textOverflow`,l:!0,d:`clip`},{n:`leading`,l:!0},{n:`textBaseline`,l:!0,inh:!0,k:[`top`,`hanging`,`middle`,`alphabetic`,`ideographic`,`bottom`],d:`alphabetic`},{n:`textAlign`,l:!0,inh:!0,k:[`start`,`center`,`middle`,`end`,`left`,`right`],d:`start`},{n:`markerStart`,syntax:q.MARKER},{n:`markerEnd`,syntax:q.MARKER},{n:`markerMid`,syntax:q.MARKER},{n:`markerStartOffset`,syntax:q.LENGTH,l:!0,int:!0,d:`0`},{n:`markerEndOffset`,syntax:q.LENGTH,l:!0,int:!0,d:`0`}],Ug=new Set(Hg.filter(function(e){return!!e.l}).map(function(e){return e.n})),Wg={},Gg=function(){function e(t){var n=this;H(this,e),this.runtime=t,Hg.forEach(function(e){n.registerMetadata(e)})}return U(e,[{key:`registerMetadata`,value:function(e){[e.n].concat(As(e.a||[])).forEach(function(t){Wg[t]=e})}},{key:`getPropertySyntax`,value:function(e){return this.runtime.CSSPropertySyntaxFactory[e]}},{key:`processProperties`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0};Object.assign(e.attributes,t);var r=e.parsedStyle.clipPath,i=e.parsedStyle.offsetPath;Kg(e,t);var a=!!n.forceUpdateGeometry;if(!a){for(var o in t)if(Ug.has(o)){a=!0;break}}var s=qg(e);s.has(`fill`)&&t.fill&&(e.parsedStyle.fill=Oh(t.fill)),s.has(`stroke`)&&t.stroke&&(e.parsedStyle.stroke=Oh(t.stroke)),s.has(`shadowColor`)&&t.shadowColor&&(e.parsedStyle.shadowColor=Oh(t.shadowColor)),s.has(`filter`)&&t.filter&&(e.parsedStyle.filter=Uh(t.filter)),s.has(`radius`)&&!Wl(t.radius)&&(e.parsedStyle.radius=zh(t.radius,4)),s.has(`lineDash`)&&!Wl(t.lineDash)&&(e.parsedStyle.lineDash=zh(t.lineDash,`even`)),s.has(`points`)&&t.points&&(e.parsedStyle.points=_g(t.points)),s.has(`d`)&&t.d===``&&(e.parsedStyle.d=Cs({},qp)),s.has(`d`)&&t.d&&(e.parsedStyle.d=hg(t.d)),s.has(`textTransform`)&&t.textTransform&&this.runtime.CSSPropertySyntaxFactory[q.TEXT_TRANSFORM].calculator(null,null,{value:t.textTransform},e,null),s.has(`clipPath`)&&!Eu(t.clipPath)&&this.runtime.CSSPropertySyntaxFactory[q.DEFINED_PATH].calculator(`clipPath`,r,t.clipPath,e,this.runtime),s.has(`offsetPath`)&&t.offsetPath&&this.runtime.CSSPropertySyntaxFactory[q.DEFINED_PATH].calculator(`offsetPath`,i,t.offsetPath,e,this.runtime),s.has(`transform`)&&t.transform&&(e.parsedStyle.transform=Tg(t.transform)),s.has(`transformOrigin`)&&t.transformOrigin&&(e.parsedStyle.transformOrigin=Bg(t.transformOrigin)),s.has(`markerStart`)&&t.markerStart&&(e.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory[q.MARKER].calculator(null,t.markerStart,t.markerStart,null,null)),s.has(`markerEnd`)&&t.markerEnd&&(e.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory[q.MARKER].calculator(null,t.markerEnd,t.markerEnd,null,null)),s.has(`markerMid`)&&t.markerMid&&(e.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory[q.MARKER].calculator(``,t.markerMid,t.markerMid,null,null)),s.has(`zIndex`)&&!Wl(t.zIndex)&&this.runtime.CSSPropertySyntaxFactory[q.Z_INDEX].postProcessor(e),s.has(`offsetDistance`)&&!Wl(t.offsetDistance)&&this.runtime.CSSPropertySyntaxFactory[q.OFFSET_DISTANCE].postProcessor(e),s.has(`transform`)&&t.transform&&this.runtime.CSSPropertySyntaxFactory[q.TRANSFORM].postProcessor(e),s.has(`transformOrigin`)&&t.transformOrigin&&this.runtime.CSSPropertySyntaxFactory[q.TRANSFORM_ORIGIN].postProcessor(e),a&&(e.geometry.dirty=!0,e.dirty(!0,!0),n.forceUpdateGeometry||this.runtime.sceneGraphService.dirtyToRoot(e))}},{key:`updateGeometry`,value:function(e){var t=e.nodeName,n=this.runtime.geometryUpdaterFactory[t];if(n){var r=e.geometry;r.contentBounds||=new tp,r.renderBounds||=new tp;var i=e.parsedStyle,a=n.update(i,e),o=a.cx,s=o===void 0?0:o,c=a.cy,l=c===void 0?0:c,u=a.cz,d=u===void 0?0:u,f=a.hwidth,p=f===void 0?0:f,m=a.hheight,h=m===void 0?0:m,g=a.hdepth,_=g===void 0?0:g,v=[Math.abs(p),Math.abs(h),_],y=i.stroke,b=i.lineWidth,x=b===void 0?1:b,S=i.increasedLineWidthForHitTesting,C=S===void 0?0:S,w=i.shadowType,T=w===void 0?`outer`:w,E=i.shadowColor,D=i.filter,O=D===void 0?[]:D,k=i.transformOrigin,A=[s,l,d];r.contentBounds.update(A,v);var j=t===K.POLYLINE||t===K.POLYGON||t===K.PATH?Math.SQRT2:.5;if(y&&!y.isNone){var ee=((x||0)+(C||0))*j;v[0]+=ee,v[1]+=ee}if(r.renderBounds.update(A,v),E&&T&&T!==`inner`){var te=r.renderBounds,M=te.min,ne=te.max,re=i.shadowBlur,ie=i.shadowOffsetX,ae=i.shadowOffsetY,oe=re||0,se=ie||0,ce=ae||0,le=M[0]-oe+se,N=ne[0]+oe+se,ue=M[1]-oe+ce,de=ne[1]+oe+ce;M[0]=Math.min(M[0],le),ne[0]=Math.max(ne[0],N),M[1]=Math.min(M[1],ue),ne[1]=Math.max(ne[1],de),r.renderBounds.setMinMax(M,ne)}O.forEach(function(e){var t=e.name,n=e.params;if(t===`blur`){var i=n[0].value;r.renderBounds.update(r.renderBounds.center,Qc(r.renderBounds.halfExtents,r.renderBounds.halfExtents,[i,i,0]))}else if(t===`drop-shadow`){var a=n[0].value,o=n[1].value,s=n[2].value,c=r.renderBounds,l=c.min,u=c.max,d=l[0]-s+a,f=u[0]+s+a,p=l[1]-s+o,m=u[1]+s+o;l[0]=Math.min(l[0],d),u[0]=Math.max(u[0],f),l[1]=Math.min(l[1],p),u[1]=Math.max(u[1],m),r.renderBounds.setMinMax(l,u)}}),e.geometry.dirty=!1;var fe=p<0,pe=h<0,me=(fe?-1:1)*(k?Bh(k[0],0,e,!0):0),he=(pe?-1:1)*(k?Bh(k[1],1,e,!0):0);(me||he)&&e.setOrigin(me,he)}}},{key:`updateSizeAttenuation`,value:function(e,t){e.style.isSizeAttenuation?(e.style.rawLineWidth||(e.style.rawLineWidth=e.style.lineWidth),e.style.lineWidth=(e.style.rawLineWidth||1)/t,e.nodeName===K.CIRCLE&&(e.style.rawR||(e.style.rawR=e.style.r),e.style.r=(e.style.rawR||1)/t)):(e.style.rawLineWidth&&(e.style.lineWidth=e.style.rawLineWidth,delete e.style.rawLineWidth),e.nodeName===K.CIRCLE&&e.style.rawR&&(e.style.r=e.style.rawR,delete e.style.rawR))}}])}();function Kg(e,t){var n=qg(e);for(var r in t)n.has(r)&&(e.parsedStyle[r]=t[r])}function qg(e){return e.constructor.PARSED_STYLE_LIST}var Jg=function(){function e(){H(this,e),this.mixer=qh}return U(e,[{key:`calculator`,value:function(e,t,n,r){return Rh(n)}}])}(),Yg=function(){function e(){H(this,e)}return U(e,[{key:`calculator`,value:function(e,t,n,r,i){return n instanceof Ym&&(n=null),i.sceneGraphService.updateDisplayObjectDependency(e,t,n,r),e===`clipPath`&&r.forEach(function(e){e.childNodes.length===0&&i.sceneGraphService.dirtyToRoot(e)}),n}}])}(),Xg=function(){function e(){H(this,e),this.parser=Oh,this.mixer=kh}return U(e,[{key:`calculator`,value:function(e,t,n,r){return n instanceof Ym?n.value===`none`?sh:ch:n}}])}(),Zg=function(){function e(){H(this,e)}return U(e,[{key:`calculator`,value:function(e,t,n){return n instanceof Ym?[]:n}}])}();function Qg(e){var t=e.parsedStyle,n=t.fontSize;return Wl(n)?null:n}var $g=function(){function e(){H(this,e),this.mixer=qh}return U(e,[{key:`calculator`,value:function(e,t,n,r,i){if(G(n))return n;if(Qm.isRelativeUnit(n.unit)){if(n.unit===J.kPercentage)return 0;if(n.unit===J.kEms){if(r.parentNode){var a=Qg(r.parentNode);if(a)return a*=n.value,a}return 0}if(n.unit===J.kRems){var o;if(r!=null&&(o=r.ownerDocument)!=null&&o.documentElement){var s=Qg(r.ownerDocument.documentElement);if(s)return s*=n.value,s}return 0}}else return n.value}}])}(),e_=function(){function e(){H(this,e),this.mixer=Yh}return U(e,[{key:`calculator`,value:function(e,t,n){return n.map(function(e){return e.value})}}])}(),t_=function(){function e(){H(this,e),this.mixer=Yh}return U(e,[{key:`calculator`,value:function(e,t,n){return n.map(function(e){return e.value})}}])}(),n_=function(){function e(){H(this,e)}return U(e,[{key:`calculator`,value:function(e,t,n,r){n instanceof Ym&&(n=null);var i=n?.cloneNode(!0);return i&&(i.style.isMarker=!0),i}}])}(),r_=function(){function e(){H(this,e),this.mixer=qh}return U(e,[{key:`calculator`,value:function(e,t,n){return n.value}}])}(),i_=function(){function e(){H(this,e),this.mixer=Jh(0,1)}return U(e,[{key:`calculator`,value:function(e,t,n){return n.value}},{key:`postProcessor`,value:function(e){var t=e.parsedStyle,n=t.offsetPath,r=t.offsetDistance;if(n){var i=n.nodeName;if(i===K.LINE||i===K.PATH||i===K.POLYLINE){var a=n.getPoint(r);a&&e.setLocalPosition(a.x,a.y)}}}}])}(),a_=function(){function e(){H(this,e),this.mixer=Jh(0,1)}return U(e,[{key:`calculator`,value:function(e,t,n){return n.value}}])}(),o_=function(){function e(){H(this,e),this.parser=hg,this.mixer=gg}return U(e,[{key:`calculator`,value:function(e,t,n){return n instanceof Ym&&n.value===`unset`?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new op(0,0,0,0)}:n}}])}(),s_=U(function e(){H(this,e),this.mixer=vg}),c_=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.mixer=Jh(0,1/0),e}return Ls(t,e),U(t)}($g),l_=function(){function e(){H(this,e)}return U(e,[{key:`calculator`,value:function(e,t,n,r){return n instanceof Ym?n.value===`unset`?``:n.value:`${n}`}},{key:`postProcessor`,value:function(e){e.nodeValue=`${e.parsedStyle.text}`||``}}])}(),u_=function(){function e(){H(this,e)}return U(e,[{key:`calculator`,value:function(e,t,n,r){var i=r.getAttribute(`text`);if(i){var a=i;n.value===`capitalize`?a=i.charAt(0).toUpperCase()+i.slice(1):n.value===`lowercase`?a=i.toLowerCase():n.value===`uppercase`&&(a=i.toUpperCase()),r.parsedStyle.text=a}return n.value}}])}(),d_=new WeakMap;function f_(e,t,n){if(e){var r=typeof e==`string`?document.getElementById(e):e;d_.has(r)&&d_.get(r).destroy(n),d_.set(r,t)}}var p_=typeof window<`u`&&window.document!==void 0;function m_(e){return!!e.getAttribute}function h_(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;g_(e[i],t)<0?n=i+1:r=i}return n}function g_(e,t){var n=Number(e.parsedStyle.zIndex||0),r=Number(t.parsedStyle.zIndex||0);if(n===r){var i=e.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(e)-a.indexOf(t)}}return n-r}function __(e){var t=e;do{if(t.parsedStyle?.clipPath)return t;t=t.parentElement}while(t!==null);return null}var v_=`px`;function y_(e,t,n){p_&&e.style&&(e.style.width=t+v_,e.style.height=n+v_)}function b_(e,t){if(p_)return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}function x_(e){var t=b_(e,`width`);return t===`auto`?e.offsetWidth:parseFloat(t)}function S_(e){var t=b_(e,`height`);return t===`auto`?e.offsetHeight:parseFloat(t)}var C_=1,w_={touchstart:`pointerdown`,touchend:`pointerup`,touchendoutside:`pointerupoutside`,touchmove:`pointermove`,touchcancel:`pointercancel`},T_=typeof performance==`object`&&performance.now?performance:Date;function E_(e){return e.nodeName===K.FRAGMENT?!0:e.getRootNode().nodeName===K.FRAGMENT}function D_(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:`auto`,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=!1,i=!1,a=!!t&&!t.isNone,o=!!n&&!n.isNone;return e===`visiblepainted`||e===`painted`||e===`auto`?(r=a,i=o):e===`visiblefill`||e===`fill`?r=!0:e===`visiblestroke`||e===`stroke`?i=!0:(e===`visible`||e===`all`)&&(r=!0,i=!0),[r,i]}var O_=1,k_=function(){return O_++},A_=typeof self==`object`&&self.self===self?self:typeof global==`object`&&global.global===global?global:{},j_=Date.now(),M_=function(){return A_.performance&&typeof A_.performance.now==`function`?A_.performance.now():Date.now()-j_},N_={},P_=Date.now(),F_=function(e){if(typeof e!=`function`)throw TypeError(`${e} is not a function`);var t=Date.now(),n=t-P_,r=n>16?0:16-n,i=k_();return N_[i]=e,Object.keys(N_).length>1||setTimeout(function(){P_=t;var e=N_;N_={},Object.keys(e).forEach(function(t){return e[t](M_())})},r),i},I_=function(e){delete N_[e]},L_=[``,`webkit`,`moz`,`ms`,`o`],R_=function(e){return typeof e==`string`?e===``?A_.requestAnimationFrame:A_[`${e}RequestAnimationFrame`]:F_},z_=function(e){return typeof e==`string`?e===``?A_.cancelAnimationFrame:A_[`${e}CancelAnimationFrame`]||A_[`${e}CancelRequestAnimationFrame`]:I_},B_=function(e,t){for(var n=0;e[n]!==void 0;){if(t(e[n]))return e[n];n+=1}}(L_,function(e){return!!R_(e)}),V_=R_(B_),H_=z_(B_);A_.requestAnimationFrame=V_,A_.cancelAnimationFrame=H_;var U_=function(){function e(){H(this,e),this.callbacks=[]}return U(e,[{key:`getCallbacksNum`,value:function(){return this.callbacks.length}},{key:`tapPromise`,value:function(e,t){this.callbacks.push(t)}},{key:`promise`,value:function(){var e=[...arguments];return Promise.all(this.callbacks.map(function(t){return t.apply(void 0,e)}))}}])}(),W_=function(){function e(){H(this,e),this.callbacks=[]}return U(e,[{key:`tapPromise`,value:function(e,t){this.callbacks.push(t)}},{key:`promise`,value:function(){var e=Bf(Rf().mark(function e(){var t,n,r,i,a=arguments;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.callbacks.length){e.next=6;break}return e.next=1,(t=this.callbacks)[0].apply(t,a);case 1:n=e.sent,r=0;case 2:if(!(r<this.callbacks.length-1)){e.next=5;break}return i=this.callbacks[r],e.next=3,i(n);case 3:n=e.sent;case 4:r++,e.next=2;break;case 5:return e.abrupt(`return`,n);case 6:return e.abrupt(`return`,null);case 7:case`end`:return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),G_=function(){function e(){H(this,e),this.callbacks=[]}return U(e,[{key:`tap`,value:function(e,t){this.callbacks.push(t)}},{key:`call`,value:function(){var e=arguments;this.callbacks.forEach(function(t){t.apply(void 0,e)})}}])}(),K_=function(){function e(){H(this,e),this.callbacks=[]}return U(e,[{key:`tap`,value:function(e,t){this.callbacks.push(t)}},{key:`call`,value:function(){if(this.callbacks.length){for(var e=arguments,t=this.callbacks[0].apply(void 0,e),n=0;n<this.callbacks.length-1;n++){var r=this.callbacks[n];t=r(t)}return t}return null}}])}(),q_=[`serif`,`sans-serif`,`monospace`,`cursive`,`fantasy`,`system-ui`],J_=/([\"\'])[^\'\"]+\1/;function Y_(e){var t=e.fontSize,n=t===void 0?16:t,r=e.fontFamily,i=r===void 0?`sans-serif`:r,a=e.fontStyle,o=a===void 0?`normal`:a,s=e.fontVariant,c=s===void 0?`normal`:s,l=e.fontWeight;return{fontSize:n,fontFamily:i,fontStyle:o,fontVariant:c,fontWeight:l===void 0?`normal`:l}}var X_=Nm(function(e){for(var t=Y_(e),n=t.fontSize,r=t.fontFamily,i=t.fontStyle,a=t.fontVariant,o=t.fontWeight,s=G(n)&&`${n}px`||`16px`,c=r.split(`,`),l=c.length-1;l>=0;l--){var u=c[l].trim();!J_.test(u)&&q_.indexOf(u)<0&&(u=`"${u}"`),c[l]=u}return`${i} ${a} ${o} ${s} ${c.join(`,`)}`},function(e){var t=Y_(e),n=t.fontSize,r=t.fontFamily,i=t.fontStyle,a=t.fontVariant,o=t.fontWeight;return`${i}_${a}_${o}_${n}_${r}`}),Z_=1e-6,Q_=function(e){return Math.max(e,Z_)};function $_(e,t,n){return $s(e),e[4]=Math.tan(t),e[1]=Math.tan(n),e}var ev=Js(),tv=Js(),nv={scale:function(e){fc(ev,[e[0].value,e[1].value,1].map(function(e){return Q_(e)}))},scaleX:function(e){fc(ev,[e[0].value,1,1].map(function(e){return Q_(e)}))},scaleY:function(e){fc(ev,[1,e[0].value,1].map(function(e){return Q_(e)}))},scaleZ:function(e){fc(ev,[1,1,e[0].value].map(function(e){return Q_(e)}))},scale3d:function(e){fc(ev,[e[0].value,e[1].value,e[2].value].map(function(e){return Q_(e)}))},translate:function(e){dc(ev,[e[0].value,e[1].value,0])},translateX:function(e){dc(ev,[e[0].value,0,0])},translateY:function(e){dc(ev,[0,e[0].value,0])},translateZ:function(e){dc(ev,[0,0,e[0].value])},translate3d:function(e){dc(ev,[e[0].value,e[1].value,e[2].value])},rotate:function(e){gc(ev,mp(Rh(e[0])))},rotateX:function(e){mc(ev,mp(Rh(e[0])))},rotateY:function(e){hc(ev,mp(Rh(e[0])))},rotateZ:function(e){gc(ev,mp(Rh(e[0])))},rotate3d:function(e){pc(ev,mp(Rh(e[3])),[e[0].value,e[1].value,e[2].value])},skew:function(e){$_(ev,mp(e[0].value),mp(e[1].value))},skewX:function(e){$_(ev,mp(e[0].value),0)},skewY:function(e){$_(ev,0,mp(e[0].value))},matrix:function(e){Qs(ev,e[0].value,e[1].value,0,0,e[2].value,e[3].value,0,0,0,0,1,0,e[4].value,e[5].value,0,1)},matrix3d:function(e){Qs.apply(qs,[ev].concat(As(e.map(function(e){return e.value}))))}},rv=Yc(1,1,1),iv=Kc(),av={translate:function(e,t){Y.sceneGraphService.setLocalScale(e,rv,!1),Y.sceneGraphService.setLocalEulerAngles(e,iv,void 0,void 0,!1),Y.sceneGraphService.setLocalPosition(e,[t[0].value,t[1].value,0],!1),Y.sceneGraphService.dirtyLocalTransform(e,e.transformable)}};function ov(e,t){if(e.length){if(e.length===1&&av[e[0].t]){av[e[0].t](t,e[0].d);return}for(var n=$s(tv),r=0;r<e.length;r++){var i=e[r],a=i.t,o=i.d,s=nv[a];s&&(s(o),Wc(n,n,ev))}t.setLocalTransform(n)}else t.resetLocalTransform();return t.getLocalTransform()}var sv=function(){function e(){H(this,e),this.parser=Eg,this.mixer=zg}return U(e,[{key:`calculator`,value:function(e,t,n,r){return n instanceof Ym?[]:n}},{key:`postProcessor`,value:function(e){ov(e.parsedStyle.transform,e)}}])}(),cv=function(){function e(){H(this,e)}return U(e,[{key:`postProcessor`,value:function(e){var t=e.parsedStyle.transformOrigin;t[0].unit===J.kPixels&&t[1].unit===J.kPixels?e.setOrigin(t[0].value,t[1].value):e.getGeometryBounds()}}])}(),lv=function(){function e(){H(this,e)}return U(e,[{key:`calculator`,value:function(e,t,n,r){return n.value}},{key:`postProcessor`,value:function(e){if(e.parentNode){var t=e.parentNode,n=t.renderable,r=t.sortable;n&&t.dirty(),r&&(r.dirty=!0,r.dirtyReason=Vp.Z_INDEX_CHANGED)}}}])}(),uv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e,t){var n=e.cx,r=n===void 0?0:n,i=e.cy,a=i===void 0?0:i,o=e.r,s=o===void 0?0:o;return{cx:r,cy:a,hwidth:s,hheight:s}}}])}(),dv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e,t){var n=e.cx,r=n===void 0?0:n,i=e.cy,a=i===void 0?0:i,o=e.rx,s=o===void 0?0:o,c=e.ry;return{cx:r,cy:a,hwidth:s,hheight:c===void 0?0:c}}}])}(),fv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e){var t=e.x1,n=e.y1,r=e.x2,i=e.y2,a=Math.min(t,r),o=Math.max(t,r),s=Math.min(n,i),c=Math.max(n,i),l=o-a,u=c-s,d=l/2,f=u/2;return{cx:a+d,cy:s+f,hwidth:d,hheight:f}}}])}(),pv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e){var t=e.d.rect,n=t.x,r=t.y,i=t.width,a=t.height,o=i/2,s=a/2;return{cx:n+o,cy:r+s,hwidth:o,hheight:s}}}])}(),mv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e){if(e.points&&Gl(e.points.points)){var t=e.points.points,n=Math.min.apply(Math,As(t.map(function(e){return e[0]}))),r=Math.max.apply(Math,As(t.map(function(e){return e[0]}))),i=Math.min.apply(Math,As(t.map(function(e){return e[1]}))),a=Math.max.apply(Math,As(t.map(function(e){return e[1]}))),o=r-n,s=a-i,c=o/2,l=s/2;return{cx:n+c,cy:i+l,hwidth:c,hheight:l}}return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),hv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e,t){var n=e.x,r=n===void 0?0:n,i=e.y,a=i===void 0?0:i,o=e.src,s=e.width,c=s===void 0?0:s,l=e.height,u=l===void 0?0:l,d=c,f=u;return o&&!ru(o)&&(d||(d=o.width,e.width=d),f||(f=o.height,e.height=f)),{cx:r+d/2,cy:a+f/2,hwidth:d/2,hheight:f/2}}}])}(),gv=function(){function e(t){H(this,e),this.globalRuntime=t}return U(e,[{key:`isReadyToMeasure`,value:function(e,t){return e.text}},{key:`update`,value:function(e,t){var n,r=e.text,i=e.textAlign,a=i===void 0?`start`:i,o=e.lineWidth,s=o===void 0?1:o,c=e.textBaseline,l=c===void 0?`alphabetic`:c,u=e.dx,d=u===void 0?0:u,f=e.dy,p=f===void 0?0:f,m=e.x,h=m===void 0?0:m,g=e.y,_=g===void 0?0:g;if(!this.isReadyToMeasure(e,t))return e.metrics={font:``,width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{hwidth:0,hheight:0,cx:0,cy:0};var v=(t==null||(n=t.ownerDocument)==null||(n=n.defaultView)==null?void 0:n.getConfig())||{},y=v.offscreenCanvas,b=this.globalRuntime.textService.measureText(r,e,y);e.metrics=b;var x=b.width,S=b.height,C=x/2,w=S/2,T=h+C;a===`center`||a===`middle`?T+=s/2-C:(a===`right`||a===`end`)&&(T+=s-C*2);var E=_-w;return l===`middle`?E+=w:l===`top`||l===`hanging`?E+=w*2:l===`alphabetic`||(l===`bottom`||l===`ideographic`)&&(E+=0),d&&(T+=d),p&&(E+=p),{cx:T,cy:E,hwidth:C,hheight:w}}}])}(),_v=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e,t){return{cx:0,cy:0,hwidth:0,hheight:0}}}])}(),vv=function(){function e(){H(this,e)}return U(e,[{key:`update`,value:function(e,t){var n=e.x,r=n===void 0?0:n,i=e.y,a=i===void 0?0:i,o=e.width,s=o===void 0?0:o,c=e.height,l=c===void 0?0:c;return{cx:r+s/2,cy:a+l/2,hwidth:s/2,hheight:l/2}}}])}(),yv=function(){function e(t){H(this,e),this.eventPhase=e.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new ap,this.page=new ap,this.canvas=new ap,this.viewport=new ap,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}return U(e,[{key:`name`,get:function(){return this.type}},{key:`layerX`,get:function(){return this.layer.x}},{key:`layerY`,get:function(){return this.layer.y}},{key:`pageX`,get:function(){return this.page.x}},{key:`pageY`,get:function(){return this.page.y}},{key:`x`,get:function(){return this.canvas.x}},{key:`y`,get:function(){return this.canvas.y}},{key:`canvasX`,get:function(){return this.canvas.x}},{key:`canvasY`,get:function(){return this.canvas.y}},{key:`viewportX`,get:function(){return this.viewport.x}},{key:`viewportY`,get:function(){return this.viewport.y}},{key:`composedPath`,value:function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}},{key:`propagationPath`,get:function(){return this.composedPath()}},{key:`preventDefault`,value:function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}},{key:`stopImmediatePropagation`,value:function(){this.propagationImmediatelyStopped=!0}},{key:`stopPropagation`,value:function(){this.propagationStopped=!0}},{key:`initEvent`,value:function(){}},{key:`initUIEvent`,value:function(){}},{key:`clone`,value:function(){throw Error(sp)}}])}(),bv=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.client=new ap,e.movement=new ap,e.offset=new ap,e.global=new ap,e.screen=new ap,e}return Ls(t,e),U(t,[{key:`clientX`,get:function(){return this.client.x}},{key:`clientY`,get:function(){return this.client.y}},{key:`movementX`,get:function(){return this.movement.x}},{key:`movementY`,get:function(){return this.movement.y}},{key:`offsetX`,get:function(){return this.offset.x}},{key:`offsetY`,get:function(){return this.offset.y}},{key:`globalX`,get:function(){return this.global.x}},{key:`globalY`,get:function(){return this.global.y}},{key:`screenX`,get:function(){return this.screen.x}},{key:`screenY`,get:function(){return this.screen.y}},{key:`getModifierState`,value:function(e){return`getModifierState`in this.nativeEvent&&this.nativeEvent.getModifierState(e)}},{key:`initMouseEvent`,value:function(){throw Error(sp)}}])}(yv),xv=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.width=0,e.height=0,e.isPrimary=!1,e}return Ls(t,e),U(t,[{key:`getCoalescedEvents`,value:function(){return this.type===`pointermove`||this.type===`mousemove`||this.type===`touchmove`?[this]:[]}},{key:`getPredictedEvents`,value:function(){throw Error(`getPredictedEvents is not supported!`)}},{key:`clone`,value:function(){return this.manager.clonePointerEvent(this)}}])}(bv),Sv=function(e){function t(){return H(this,t),Fs(this,t,arguments)}return Ls(t,e),U(t,[{key:`clone`,value:function(){return this.manager.cloneWheelEvent(this)}}])}(bv),Cv=function(e){function t(e,n){var r;return H(this,t),r=Fs(this,t,[null]),r.type=e,r.detail=n,Object.assign(r,n),r}return Ls(t,e),U(t)}(yv),wv=function(){function e(){H(this,e),this.emitter=new Hs}return U(e,[{key:`on`,value:function(e,t,n){return this.addEventListener(e,t,n),this}},{key:`addEventListener`,value:function(e,t,n){var r=!1,i=!1;if(xu(n))r=n;else if(n){var a=n.capture;r=a===void 0?!1:a;var o=n.once;i=o===void 0?!1:o}r&&(e+=`capture`),t=W(t)?t:t.handleEvent;var s=W(t)?void 0:t;return i?this.emitter.once(e,t,s):this.emitter.on(e,t,s),this}},{key:`off`,value:function(e,t,n){return e?this.removeEventListener(e,t,n):this.removeAllEventListeners(),this}},{key:`removeAllEventListeners`,value:function(){var e;(e=this.emitter)==null||e.removeAllListeners()}},{key:`removeEventListener`,value:function(e,t,n){if(!this.emitter)return this;(xu(n)?n:n?.capture)&&(e+=`capture`),t=W(t)?t:t?.handleEvent;var r=W(t)?void 0:t;return this.emitter.off(e,t,r),this}},{key:`emit`,value:function(e,t){this.dispatchEvent(new Cv(e,t))}},{key:`dispatchEventToSelf`,value:function(e){e.target||=this,e.currentTarget=this,this.emitter.emit(e.type,e)}},{key:`dispatchEvent`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(arguments.length>2&&arguments[2])return this.dispatchEventToSelf(e),!0;var n=this.document?this:this.defaultView?this.defaultView:this.ownerDocument?.defaultView;if(n){if(e.manager=n.getEventService(),!e.manager)return!1;e.defaultPrevented=!1,e.path?e.path.length=0:e.page=[],t||(e.target=this),e.manager.dispatchEvent(e,e.type,t)}else this.dispatchEventToSelf(e);return!e.defaultPrevented}}])}(),Tv=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI=``,e.childNodes=[],e.nodeType=0,e.nodeName=``,e.nodeValue=null,e.parentNode=null,e.destroyed=!1,e}return Ls(t,e),U(t,[{key:`textContent`,get:function(){var e=``;this.nodeName===K.TEXT&&(e+=this.style.text);var t=Vf(this.childNodes),n;try{for(t.s();!(n=t.n()).done;){var r=n.value;r.nodeName===K.TEXT?e+=r.nodeValue:e+=r.textContent}}catch(e){t.e(e)}finally{t.f()}return e},set:function(e){var t=this;this.childNodes.slice().forEach(function(e){t.removeChild(e)}),this.nodeName===K.TEXT&&(this.style.text=`${e}`)}},{key:`getRootNode`,value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this}},{key:`hasChildNodes`,value:function(){return this.childNodes.length>0}},{key:`isDefaultNamespace`,value:function(e){throw Error(sp)}},{key:`lookupNamespaceURI`,value:function(e){throw Error(sp)}},{key:`lookupPrefix`,value:function(e){throw Error(sp)}},{key:`normalize`,value:function(){throw Error(sp)}},{key:`isEqualNode`,value:function(e){return this===e}},{key:`isSameNode`,value:function(e){return this.isEqualNode(e)}},{key:`parent`,get:function(){return this.parentNode}},{key:`parentElement`,get:function(){return null}},{key:`nextSibling`,get:function(){return null}},{key:`previousSibling`,get:function(){return null}},{key:`firstChild`,get:function(){return this.childNodes.length>0?this.childNodes[0]:null}},{key:`lastChild`,get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null}},{key:`compareDocumentPosition`,value:function(e){if(e===this)return 0;for(var n=e,r=this,i=[n],a=[r];(o=n.parentNode)??r.parentNode;){var o;n=n.parentNode?(i.push(n.parentNode),n.parentNode):n,r=r.parentNode?(a.push(r.parentNode),r.parentNode):r}if(n!==r)return t.DOCUMENT_POSITION_DISCONNECTED|t.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|t.DOCUMENT_POSITION_PRECEDING;var s=i.length>a.length?i:a,c=s===i?a:i;if(s[s.length-c.length]===c[0])return s===i?t.DOCUMENT_POSITION_CONTAINED_BY|t.DOCUMENT_POSITION_FOLLOWING:t.DOCUMENT_POSITION_CONTAINS|t.DOCUMENT_POSITION_PRECEDING;for(var l=s.length-c.length,u=c.length-1;u>=0;u--){var d=c[u],f=s[l+u];if(f!==d){var p=d.parentNode.childNodes;return p.indexOf(d)<p.indexOf(f)?c===i?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING:s===i?t.DOCUMENT_POSITION_PRECEDING:t.DOCUMENT_POSITION_FOLLOWING}}return t.DOCUMENT_POSITION_FOLLOWING}},{key:`contain`,value:function(e){return this.contains(e)}},{key:`contains`,value:function(e){for(var t=e;t&&this!==t;)t=t.parentNode;return!!t}},{key:`getAncestor`,value:function(e){for(var t=this;e>0&&t;)t=t.parentNode,e--;return t}},{key:`forEach`,value:function(e){for(var t=[this];t.length>0;){var n=t.pop();if(e(n)===!1)break;for(var r=n.childNodes.length-1;r>=0;r--)t.push(n.childNodes[r])}}}],[{key:`isNode`,value:function(e){return!!e.childNodes}}])}(wv);Tv.DOCUMENT_POSITION_DISCONNECTED=1,Tv.DOCUMENT_POSITION_PRECEDING=2,Tv.DOCUMENT_POSITION_FOLLOWING=4,Tv.DOCUMENT_POSITION_CONTAINS=8,Tv.DOCUMENT_POSITION_CONTAINED_BY=16,Tv.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32;var Ev=2048,Dv=function(){function e(t,n){var r=this;H(this,e),this.nativeHTMLMap=new WeakMap,this.cursor=`default`,this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Js(),this.tmpVec3=Kc(),this.onPointerDown=function(e){var t=r.createPointerEvent(e);if(r.dispatchEvent(t,`pointerdown`),t.pointerType===`touch`)r.dispatchEvent(t,`touchstart`);else if(t.pointerType===`mouse`||t.pointerType===`pen`){var n=t.button===2;r.dispatchEvent(t,n?`rightdown`:`mousedown`)}var i=r.trackingData(e.pointerId);i.pressTargetsByButton[e.button]=t.composedPath(),r.freeEvent(t)},this.onPointerUp=function(e){var t=T_.now(),n=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);if(r.dispatchEvent(n,`pointerup`),n.pointerType===`touch`)r.dispatchEvent(n,`touchend`);else if(n.pointerType===`mouse`||n.pointerType===`pen`){var i=n.button===2;r.dispatchEvent(n,i?`rightup`:`mouseup`)}var a=r.trackingData(e.pointerId),o=r.findMountedTarget(a.pressTargetsByButton[e.button]),s=o;if(o&&!n.composedPath().includes(o)){for(var c=o;c&&!n.composedPath().includes(c);){if(n.currentTarget=c,r.notifyTarget(n,`pointerupoutside`),n.pointerType===`touch`)r.notifyTarget(n,`touchendoutside`);else if(n.pointerType===`mouse`||n.pointerType===`pen`){var l=n.button===2;r.notifyTarget(n,l?`rightupoutside`:`mouseupoutside`)}Tv.isNode(c)&&(c=c.parentNode)}delete a.pressTargetsByButton[e.button],s=c}if(s){var u,d=r.clonePointerEvent(n,`click`);d.target=s,d.path=[],a.clicksByButton[e.button]||(a.clicksByButton[e.button]={clickCount:0,target:d.target,timeStamp:t});var f=r.context.renderingContext.root.ownerDocument.defaultView,p=a.clicksByButton[e.button];p.target===d.target&&t-p.timeStamp<f.getConfig().dblClickSpeed?++p.clickCount:p.clickCount=1,p.target=d.target,p.timeStamp=t,d.detail=p.clickCount,(u=n.detail)!=null&&u.preventClick||(!r.context.config.useNativeClickEvent&&(d.pointerType===`mouse`||d.pointerType===`touch`)&&r.dispatchEvent(d,`click`),r.dispatchEvent(d,`pointertap`)),r.freeEvent(d)}r.freeEvent(n)},this.onPointerMove=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0),n=t.pointerType===`mouse`||t.pointerType===`pen`,i=r.trackingData(e.pointerId),a=r.findMountedTarget(i.overTargets);if(i.overTargets&&a!==t.target){var o=e.type===`mousemove`?`mouseout`:`pointerout`,s=r.createPointerEvent(e,o,a||void 0);if(r.dispatchEvent(s,`pointerout`),n&&r.dispatchEvent(s,`mouseout`),!t.composedPath().includes(a)){var c=r.createPointerEvent(e,`pointerleave`,a||void 0);for(c.eventPhase=c.AT_TARGET;c.target&&!t.composedPath().includes(c.target);)c.currentTarget=c.target,r.notifyTarget(c),n&&r.notifyTarget(c,`mouseleave`),Tv.isNode(c.target)&&(c.target=c.target.parentNode);r.freeEvent(c)}r.freeEvent(s)}if(a!==t.target){var l=e.type===`mousemove`?`mouseover`:`pointerover`,u=r.clonePointerEvent(t,l);r.dispatchEvent(u,`pointerover`),n&&r.dispatchEvent(u,`mouseover`);for(var d=a&&Tv.isNode(a)&&a.parentNode;d&&d!==(Tv.isNode(r.rootTarget)&&r.rootTarget.parentNode)&&d!==t.target;)d=d.parentNode;if(!d||d===(Tv.isNode(r.rootTarget)&&r.rootTarget.parentNode)){var f=r.clonePointerEvent(t,`pointerenter`);for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==a&&f.target!==(Tv.isNode(r.rootTarget)&&r.rootTarget.parentNode);)f.currentTarget=f.target,r.notifyTarget(f),n&&r.notifyTarget(f,`mouseenter`),Tv.isNode(f.target)&&(f.target=f.target.parentNode);r.freeEvent(f)}r.freeEvent(u)}r.dispatchEvent(t,`pointermove`),t.pointerType===`touch`&&r.dispatchEvent(t,`touchmove`),n&&(r.dispatchEvent(t,`mousemove`),r.cursor=r.getCursor(t.target)),i.overTargets=t.composedPath(),r.freeEvent(t)},this.onPointerOut=function(e){var t=r.trackingData(e.pointerId);if(t.overTargets){var n=e.pointerType===`mouse`||e.pointerType===`pen`,i=r.findMountedTarget(t.overTargets),a=r.createPointerEvent(e,`pointerout`,i||void 0);r.dispatchEvent(a),n&&r.dispatchEvent(a,`mouseout`);var o=r.createPointerEvent(e,`pointerleave`,i||void 0);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==(Tv.isNode(r.rootTarget)&&r.rootTarget.parentNode);)o.currentTarget=o.target,r.notifyTarget(o),n&&r.notifyTarget(o,`mouseleave`),Tv.isNode(o.target)&&(o.target=o.target.parentNode);t.overTargets=null,r.freeEvent(a),r.freeEvent(o)}r.cursor=null},this.onPointerOver=function(e){var t=r.trackingData(e.pointerId),n=r.createPointerEvent(e),i=n.pointerType===`mouse`||n.pointerType===`pen`;r.dispatchEvent(n,`pointerover`),i&&r.dispatchEvent(n,`mouseover`),n.pointerType===`mouse`&&(r.cursor=r.getCursor(n.target));var a=r.clonePointerEvent(n,`pointerenter`);for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==(Tv.isNode(r.rootTarget)&&r.rootTarget.parentNode);)a.currentTarget=a.target,r.notifyTarget(a),i&&r.notifyTarget(a,`mouseenter`),Tv.isNode(a.target)&&(a.target=a.target.parentNode);t.overTargets=n.composedPath(),r.freeEvent(n),r.freeEvent(a)},this.onPointerUpOutside=function(e){var t=r.trackingData(e.pointerId),n=r.findMountedTarget(t.pressTargetsByButton[e.button]),i=r.createPointerEvent(e);if(n){for(var a=n;a;)i.currentTarget=a,r.notifyTarget(i,`pointerupoutside`),i.pointerType===`touch`||(i.pointerType===`mouse`||i.pointerType===`pen`)&&r.notifyTarget(i,i.button===2?`rightupoutside`:`mouseupoutside`),Tv.isNode(a)&&(a=a.parentNode);delete t.pressTargetsByButton[e.button]}r.freeEvent(i)},this.onWheel=function(e){var t=r.createWheelEvent(e);r.dispatchEvent(t),r.freeEvent(t)},this.onClick=function(e){if(r.context.config.useNativeClickEvent){var t=r.createPointerEvent(e);r.dispatchEvent(t),r.freeEvent(t)}},this.onPointerCancel=function(e){var t=r.createPointerEvent(e,void 0,void 0,r.context.config.alwaysTriggerPointerEventOnCanvas?r.rootTarget:void 0);r.dispatchEvent(t),r.freeEvent(t)},this.globalRuntime=t,this.context=n}return U(e,[{key:`init`,value:function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping(`pointerdown`,this.onPointerDown),this.addEventMapping(`pointerup`,this.onPointerUp),this.addEventMapping(`pointermove`,this.onPointerMove),this.addEventMapping(`pointerout`,this.onPointerOut),this.addEventMapping(`pointerleave`,this.onPointerOut),this.addEventMapping(`pointercancel`,this.onPointerCancel),this.addEventMapping(`pointerover`,this.onPointerOver),this.addEventMapping(`pointerupoutside`,this.onPointerUpOutside),this.addEventMapping(`wheel`,this.onWheel),this.addEventMapping(`click`,this.onClick)}},{key:`destroy`,value:function(){this.mappingTable={},this.mappingState={},this.eventPool.clear()}},{key:`getScale`,value:function(){var e=this.context.contextService.getBoundingClientRect(),t=1,n=1,r=this.context.contextService.getDomElement();if(r&&e){var i=r.offsetWidth,a=r.offsetHeight;i&&a&&(t=e.width/i,n=e.height/a)}return{scaleX:t,scaleY:n,bbox:e}}},{key:`client2Viewport`,value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new ap((e.x-(i?.left||0))/n,(e.y-(i?.top||0))/r)}},{key:`viewport2Client`,value:function(e){var t=this.getScale(),n=t.scaleX,r=t.scaleY,i=t.bbox;return new ap((e.x+(i?.left||0))*n,(e.y+(i?.top||0))*r)}},{key:`viewport2Canvas`,value:function(e){var t=e.x,n=e.y,r=this.rootTarget.defaultView.getCamera(),i=this.context.config,a=i.width,o=i.height,s=r.getPerspectiveInverse(),c=r.getWorldTransform(),l=ic(this.tmpMatrix,c,s),u=Zc(this.tmpVec3,t/a*2-1,(1-n/o)*2-1,0);return ll(u,u,l),new ap(u[0],u[1])}},{key:`canvas2Viewport`,value:function(e){var t=this.rootTarget.defaultView.getCamera(),n=t.getPerspective(),r=t.getViewTransform(),i=ic(this.tmpMatrix,n,r),a=Zc(this.tmpVec3,e.x,e.y,0);ll(this.tmpVec3,this.tmpVec3,i);var o=this.context.config,s=o.width,c=o.height;return new ap((a[0]+1)/2*s,(1-(a[1]+1)/2)*c)}},{key:`setPickHandler`,value:function(e){this.pickHandler=e}},{key:`addEventMapping`,value:function(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort(function(e,t){return e.priority-t.priority})}},{key:`mapEvent`,value:function(e){if(this.rootTarget){var t=this.mappingTable[e.type];if(t)for(var n=0,r=t.length;n<r;n++)t[n].fn(e);else console.warn(`[EventService]: Event mapping not defined for ${e.type}`)}}},{key:`dispatchEvent`,value:function(e,t,n){n?(e.eventPhase=e.AT_TARGET,e.currentTarget=this.rootTarget.defaultView||null,this.notifyListeners(e,t)):(e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t))}},{key:`propagate`,value:function(e,t){if(e.target){var n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(var r=n.length-1;r>=1;r--)if(e.currentTarget=n[r],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){var i=n.indexOf(e.currentTarget);e.eventPhase=e.BUBBLING_PHASE;for(var a=i+1;a<n.length;a++)if(e.currentTarget=n[a],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}}},{key:`propagationPath`,value:function(e){var t=[e],n=this.rootTarget.defaultView||null;if(n&&n===e)return t.unshift(n.document),t;for(var r=0;r<Ev&&e!==this.rootTarget;r++)Tv.isNode(e)&&e.parentNode&&(t.push(e.parentNode),e=e.parentNode);return n&&t.push(n),t}},{key:`hitTest`,value:function(e){var t=e.viewportX,n=e.viewportY,r=this.context.config,i=r.width,a=r.height,o=r.disableHitTesting;return t<0||n<0||t>i||n>a?null:!o&&this.pickHandler(e)||this.rootTarget||null}},{key:`isNativeEventFromCanvas`,value:function(e,t){var n,r=t?.target;if((n=r)!=null&&n.shadowRoot&&(r=t.composedPath()[0]),r){if(r===e)return!0;if(e&&e.contains)return e.contains(r)}return t!=null&&t.composedPath?t.composedPath().indexOf(e)>-1:!1}},{key:`getExistedHTML`,value:function(e){if(e.nativeEvent.composedPath)for(var t=0,n=e.nativeEvent.composedPath();t<n.length;t++){var r=n[t],i=this.nativeHTMLMap.get(r);if(i)return i}return null}},{key:`pickTarget`,value:function(e){return this.hitTest({clientX:e.clientX,clientY:e.clientY,viewportX:e.viewportX,viewportY:e.viewportY,x:e.canvasX,y:e.canvasY})}},{key:`createPointerEvent`,value:function(e,t,n,r){var i=this.allocateEvent(xv);this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e;var a=this.getExistedHTML(i),o=this.context.contextService.getDomElement();return i.target=n??(a||this.isNativeEventFromCanvas(o,i.nativeEvent)&&this.pickTarget(i)||r),typeof t==`string`&&(i.type=t),i}},{key:`createWheelEvent`,value:function(e){var t=this.allocateEvent(Sv);this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e;var n=this.getExistedHTML(t),r=this.context.contextService.getDomElement();return t.target=n||this.isNativeEventFromCanvas(r,t.nativeEvent)&&this.pickTarget(t),t}},{key:`trackingData`,value:function(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}},{key:`cloneWheelEvent`,value:function(e){var t=this.allocateEvent(Sv);return t.nativeEvent=e.nativeEvent,t.originalEvent=e.originalEvent,this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.target=e.target,t.path=e.composedPath().slice(),t.type=e.type,t}},{key:`clonePointerEvent`,value:function(e,t){var n=this.allocateEvent(xv);return n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice(),n.type=t??n.type,n}},{key:`copyPointerData`,value:function(e,t){t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist}},{key:`copyMouseData`,value:function(e,t){t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.shiftKey=e.shiftKey,t.client.copyFrom(e.client),t.movement.copyFrom(e.movement),t.canvas.copyFrom(e.canvas),t.screen.copyFrom(e.screen),t.global.copyFrom(e.global),t.offset.copyFrom(e.offset)}},{key:`copyWheelData`,value:function(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}},{key:`copyData`,value:function(e,t){t.isTrusted=e.isTrusted,t.timeStamp=T_.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.page.copyFrom(e.page),t.viewport.copyFrom(e.viewport)}},{key:`allocateEvent`,value:function(e){this.eventPool.has(e)||this.eventPool.set(e,[]);var t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=[],t.target=null,t}},{key:`freeEvent`,value:function(e){if(e.manager!==this)throw Error(`It is illegal to free an event not managed by this EventBoundary!`);var t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}},{key:`notifyTarget`,value:function(e,t){t??=e.type;var n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}},{key:`notifyListeners`,value:function(e,t){var n=e.currentTarget.emitter,r=n._events[t];if(r)if(`fn`in r)r.once&&n.removeListener(t,r.fn,void 0,!0),r.fn.call(e.currentTarget||r.context,e);else for(var i=0;i<r.length&&!e.propagationImmediatelyStopped;i++)r[i].once&&n.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(e.currentTarget||r[i].context,e)}},{key:`findMountedTarget`,value:function(e){if(!e)return null;for(var t=e[e.length-1],n=e.length-2;n>=0;n--){var r=e[n];if(r===this.rootTarget||Tv.isNode(r)&&r.parentNode===t)t=e[n];else break}return t}},{key:`getCursor`,value:function(e){for(var t=e;t;){var n=m_(t)&&t.getAttribute(`cursor`);if(n)return n;t=Tv.isNode(t)&&t.parentNode}}}])}(),Ov=function(){function e(){H(this,e)}return U(e,[{key:`getOrCreateCanvas`,value:function(e,t){if(this.canvas)return this.canvas;if(e||Y.offscreenCanvas)this.canvas=e||Y.offscreenCanvas,this.context=this.canvas.getContext(`2d`,Cs({willReadFrequently:!0},t));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext(`2d`,Cs({willReadFrequently:!0},t)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement(`canvas`),this.context=this.canvas.getContext(`2d`))}catch{this.canvas=document.createElement(`canvas`),this.context=this.canvas.getContext(`2d`,Cs({willReadFrequently:!0},t))}return this.canvas.width=10,this.canvas.height=10,this.canvas}},{key:`getOrCreateContext`,value:function(e,t){return this.context||this.getOrCreateCanvas(e,t),this.context}}],[{key:`createCanvas`,value:function(){try{return new window.OffscreenCanvas(0,0)}catch{}try{return document.createElement(`canvas`)}catch{}return null}}])}(),kv=function(e){return e[e.CAMERA_CHANGED=0]=`CAMERA_CHANGED`,e[e.DISPLAY_OBJECT_CHANGED=1]=`DISPLAY_OBJECT_CHANGED`,e[e.NONE=2]=`NONE`,e}({}),Av=function(){function e(t,n){H(this,e),this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new G_,initAsync:new U_,dirtycheck:new K_,cull:new K_,beginFrame:new G_,beforeRender:new G_,render:new G_,afterRender:new G_,endFrame:new G_,destroy:new G_,pick:new W_,pickSync:new K_,pointerDown:new G_,pointerUp:new G_,pointerMove:new G_,pointerOut:new G_,pointerOver:new G_,pointerWheel:new G_,pointerCancel:new G_,click:new G_},this.globalRuntime=t,this.context=n}return U(e,[{key:`init`,value:function(e){var t=this,n=Cs(Cs({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(e){e.apply(n,t.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,e()):this.hooks.initAsync.promise().then(function(){t.inited=!0,e()}).catch(function(e){})}},{key:`getStats`,value:function(){return this.stats}},{key:`disableDirtyRectangleRendering`,value:function(){return!this.context.config.renderer.getConfig().enableDirtyRectangleRendering||this.context.renderingContext.renderReasons.has(kv.CAMERA_CHANGED)}},{key:`render`,value:function(e,t,n){var r=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=i.renderReasons.size===1&&i.renderReasons.has(kv.CAMERA_CHANGED),o=!e.disableRenderHooks||!a;o&&this.renderDisplayObject(i.root,e,i),this.hooks.beginFrame.call(t),o&&i.renderListCurrentFrame.forEach(function(e){r.hooks.beforeRender.call(e),r.hooks.render.call(e),r.hooks.afterRender.call(e)}),this.hooks.endFrame.call(t),i.renderListCurrentFrame=[],i.renderReasons.clear(),n()}}},{key:`renderDisplayObject`,value:function(e,t,n){var r=this,i=t.renderer.getConfig(),a=i.enableDirtyCheck,o=i.enableCulling;function s(e){var t=e.renderable,i=e.sortable,s=a?t.dirty||n.dirtyRectangleRenderingDisabled?e:null:e,c=null;s&&(c=o?r.hooks.cull.call(s,r.context.camera):s,c&&(r.stats.rendered+=1,n.renderListCurrentFrame.push(c))),e.dirty(!1),i.renderOrder=r.zIndexCounter,r.zIndexCounter+=1,r.stats.total+=1,i.dirty&&(r.sort(e,i),i.dirty=!1,i.dirtyChildren=[],i.dirtyReason=void 0)}for(var c=[e];c.length>0;){var l,u=c.pop();s(u);for(var d=((l=u.sortable)==null||(l=l.sorted)==null?void 0:l.length)>0?u.sortable.sorted:u.childNodes,f=d.length-1;f>=0;f--)c.push(d[f])}}},{key:`sort`,value:function(e,t){var n;(t==null||(n=t.sorted)==null?void 0:n.length)>0&&t.dirtyReason!==Vp.Z_INDEX_CHANGED?t.dirtyChildren.forEach(function(n){var r=t.sorted.indexOf(n);if(r>-1&&t.sorted.splice(r,1),e.childNodes.indexOf(n)>-1)if(t.sorted.length===0)t.sorted.push(n);else{var i=h_(t.sorted,n);t.sorted.splice(i,0,n)}}):t.sorted=e.childNodes.slice().sort(g_),t.sorted?.length>0&&e.childNodes.filter(function(e){return e.parsedStyle.zIndex}).length===0&&(t.sorted=[])}},{key:`destroy`,value:function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()}},{key:`dirtify`,value:function(){this.context.renderingContext.renderReasons.add(kv.DISPLAY_OBJECT_CHANGED)}}])}(),jv=/\[\s*(.*)=(.*)\s*\]/,Mv=function(){function e(){H(this,e)}return U(e,[{key:`selectOne`,value:function(e,t){var n=this;if(e.startsWith(`.`))return t.find(function(t){return(t?.classList||[]).indexOf(n.getIdOrClassname(e))>-1});if(e.startsWith(`#`))return t.find(function(t){return t.id===n.getIdOrClassname(e)});if(e.startsWith(`[`)){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.find(function(e){return t!==e&&(i===`name`?e.name===a:n.attributeToString(e,i)===a)}):null}return t.find(function(n){return t!==n&&n.nodeName===e})}},{key:`selectAll`,value:function(e,t){var n=this;if(e.startsWith(`.`))return t.findAll(function(r){return t!==r&&(r?.classList||[]).indexOf(n.getIdOrClassname(e))>-1});if(e.startsWith(`#`))return t.findAll(function(r){return t!==r&&r.id===n.getIdOrClassname(e)});if(e.startsWith(`[`)){var r=this.getAttribute(e),i=r.name,a=r.value;return i?t.findAll(function(e){return t!==e&&(i===`name`?e.name===a:n.attributeToString(e,i)===a)}):[]}return t.findAll(function(n){return t!==n&&n.nodeName===e})}},{key:`is`,value:function(e,t){if(e.startsWith(`.`))return t.className===this.getIdOrClassname(e);if(e.startsWith(`#`))return t.id===this.getIdOrClassname(e);if(e.startsWith(`[`)){var n=this.getAttribute(e),r=n.name,i=n.value;return r===`name`?t.name===i:this.attributeToString(t,r)===i}return t.nodeName===e}},{key:`getIdOrClassname`,value:function(e){return e.substring(1)}},{key:`getAttribute`,value:function(e){var t=e.match(jv),n=``,r=``;return t&&t.length>2&&(n=t[1].replace(/"/g,``),r=t[2].replace(/"/g,``)),{name:n,value:r}}},{key:`attributeToString`,value:function(e,t){if(!e.getAttribute)return``;var n=e.getAttribute(t);return Wl(n)?``:n.toString?n.toString():``}}])}(),Nv=function(e){return e.ATTR_MODIFIED=`DOMAttrModified`,e.INSERTED=`DOMNodeInserted`,e.MOUNTED=`DOMNodeInsertedIntoDocument`,e.REMOVED=`removed`,e.UNMOUNTED=`DOMNodeRemovedFromDocument`,e.REPARENT=`reparent`,e.DESTROY=`destroy`,e.BOUNDS_CHANGED=`bounds-changed`,e.CULLED=`culled`,e}({}),Pv=function(e){function t(e,n,r,i,a,o,s,c){var l;return H(this,t),l=Fs(this,t,[null]),l.relatedNode=n,l.prevValue=r,l.newValue=i,l.attrName=a,l.attrChange=o,l.prevParsedValue=s,l.newParsedValue=c,l.type=e,l}return Ls(t,e),U(t)}(yv);Pv.ADDITION=2,Pv.MODIFICATION=1,Pv.REMOVAL=3;var Fv=new Pv(Nv.REPARENT,null,``,``,``,0,``,``),Iv=Pl(),Lv=Kc(),Rv=Yc(1,1,1),zv=Js(),Bv=Pl(),Vv=Kc(),Hv=Js(),Uv=Sl(),Wv=Kc(),Gv=Sl(),Kv=Kc(),qv=Kc(),Jv=Kc(),Yv=Js(),Xv=Sl(),Zv=Sl(),Qv=Sl(),$v={affectChildren:!0},ey=function(){function e(t){H(this,e),this.pendingEvents=new Map,this.boundsChangedEvent=new Cv(Nv.BOUNDS_CHANGED),this.displayObjectDependencyMap=new WeakMap,this.runtime=t}return U(e,[{key:`matches`,value:function(e,t){return this.runtime.sceneGraphSelector.is(e,t)}},{key:`querySelector`,value:function(e,t){return this.runtime.sceneGraphSelector.selectOne(e,t)}},{key:`querySelectorAll`,value:function(e,t){return this.runtime.sceneGraphSelector.selectAll(e,t)}},{key:`attach`,value:function(e,t,n){var r,i=!1;e.parentNode&&(i=e.parentNode!==t,this.detach(e));var a=e.nodeName===K.FRAGMENT,o=E_(t);e.parentNode=t;var s=a?e.childNodes:[e];G(n)?s.forEach(function(e){t.childNodes.splice(n,0,e),e.parentNode=t}):s.forEach(function(e){t.childNodes.push(e),e.parentNode=t});var c=t,l=c.sortable;if((l!=null&&(r=l.sorted)!=null&&r.length||l.dirty||e.parsedStyle.zIndex)&&(l.dirtyChildren.indexOf(e)===-1&&l.dirtyChildren.push(e),l.dirty=!0,l.dirtyReason=Vp.ADDED),!o){if(a)this.dirtifyFragment(e);else{var u=e.transformable;u&&this.dirtyWorldTransform(e,u)}if(i){var d,f=((d=t.ownerDocument)==null||(d=d.defaultView)==null||(d=d.getConfig())==null||(d=d.future)==null?void 0:d.experimentalCancelEventPropagation)===!0;e.dispatchEvent(Fv,f,f)}}}},{key:`detach`,value:function(e){var t,n;if(e.parentNode){var r=e.transformable,i=e.parentNode,a=i.sortable;(a!=null&&(t=a.sorted)!=null&&t.length||(n=e.style)!=null&&n.zIndex)&&(a.dirtyChildren.indexOf(e)===-1&&a.dirtyChildren.push(e),a.dirty=!0,a.dirtyReason=Vp.REMOVED);var o=e.parentNode.childNodes.indexOf(e);o>-1&&e.parentNode.childNodes.splice(o,1),r&&this.dirtyWorldTransform(e,r),e.parentNode=null}}},{key:`getLocalPosition`,value:function(e){return e.transformable.localPosition}},{key:`getLocalRotation`,value:function(e){return e.transformable.localRotation}},{key:`getLocalScale`,value:function(e){return e.transformable.localScale}},{key:`getLocalSkew`,value:function(e){return e.transformable.localSkew}},{key:`getLocalTransform`,value:function(e){var t=e.transformable;return Gp(t),t.localTransform}},{key:`setLocalPosition`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=e.transformable;qv[0]=t[0],qv[1]=t[1],qv[2]=t[2]??0,!fl(r.localPosition,qv)&&(Xc(r.localPosition,qv),n&&this.dirtyLocalTransform(e,r))}},{key:`translateLocal`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t==`number`&&(t=Yc(t,n,r));var i=e.transformable;fl(t,Lv)||(dl(t,t,i.localRotation),Qc(i.localPosition,i.localPosition,t),this.dirtyLocalTransform(e,i))}},{key:`setLocalRotation`,value:function(e,t,n,r,i){var a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;typeof t==`number`&&(t=jl(Uv,t,n,r,i));var o=e.transformable;Al(o.localRotation,t),a&&this.dirtyLocalTransform(e,o)}},{key:`rotateLocal`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t==`number`&&(t=Yc(t,n,r));var i=e.transformable;Ol(Zv,t[0],t[1],t[2]),Ml(i.localRotation,i.localRotation,Zv),this.dirtyLocalTransform(e,i)}},{key:`setLocalScale`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=e.transformable;Zc(Vv,t[0],t[1],t[2]??r.localScale[2]),!fl(Vv,r.localScale)&&(Xc(r.localScale,Vv),n&&this.dirtyLocalTransform(e,r))}},{key:`scaleLocal`,value:function(e,t){var n=e.transformable;el(n.localScale,n.localScale,Zc(Vv,t[0],t[1],t[2]??1)),this.dirtyLocalTransform(e,n)}},{key:`setLocalSkew`,value:function(e,t,n){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;typeof t==`number`&&(t=Il(Bv,t,n));var i=e.transformable;Fl(i.localSkew,t),r&&this.dirtyLocalTransform(e,i)}},{key:`setLocalEulerAngles`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;typeof t==`number`&&(t=Yc(t,n,r));var a=e.transformable;Ol(a.localRotation,t[0],t[1],t[2]),i&&this.dirtyLocalTransform(e,a)}},{key:`setLocalTransform`,value:function(e,t){var n=yc(Wv,t),r=xc(Gv,t),i=bc(Kv,t);this.setLocalScale(e,i,!1),this.setLocalPosition(e,n,!1),this.setLocalRotation(e,r,void 0,void 0,void 0,!1),this.dirtyLocalTransform(e,e.transformable)}},{key:`resetLocalTransform`,value:function(e){this.setLocalScale(e,Rv,!1),this.setLocalPosition(e,Lv,!1),this.setLocalEulerAngles(e,Lv,void 0,void 0,!1),this.setLocalSkew(e,Iv,void 0,!1),this.dirtyLocalTransform(e,e.transformable)}},{key:`getPosition`,value:function(e){var t=e.transformable;return yc(t.position,this.getWorldTransform(e,t))}},{key:`getRotation`,value:function(e){var t=e.transformable;return xc(t.rotation,this.getWorldTransform(e,t))}},{key:`getScale`,value:function(e){var t=e.transformable;return bc(t.scaling,this.getWorldTransform(e,t))}},{key:`getOrigin`,value:function(e){return e.getGeometryBounds(),e.transformable.origin}},{key:`getWorldTransform`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e.transformable;return!t.localDirtyFlag&&!t.dirtyFlag?t.worldTransform:(e.parentNode&&e.parentNode.transformable&&this.getWorldTransform(e.parentNode),this.internalUpdateTransform(e),t.worldTransform)}},{key:`setPosition`,value:function(e,t){var n=e.transformable;if(Jv[0]=t[0],Jv[1]=t[1],Jv[2]=t[2]??0,!fl(this.getPosition(e),Jv)){if(Xc(n.position,Jv),e.parentNode===null||!e.parentNode.transformable)Xc(n.localPosition,Jv);else{var r=e.parentNode.transformable;Xs(Yv,r.worldTransform),tc(Yv,Yv),ll(n.localPosition,Jv,Yv)}this.dirtyLocalTransform(e,n)}}},{key:`translate`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t==`number`&&(t=Zc(Vv,t,n,r)),!fl(t,Lv)&&(Qc(Vv,this.getPosition(e),t),this.setPosition(e,Vv))}},{key:`setRotation`,value:function(e,t,n,r,i){var a=e.transformable;if(typeof t==`number`&&(t=kl(t,n,r,i)),e.parentNode===null||!e.parentNode.transformable)this.setLocalRotation(e,t);else{var o=this.getRotation(e.parentNode);Al(Uv,o),El(Uv,Uv),wl(a.localRotation,Uv,t),Nl(a.localRotation,a.localRotation),this.dirtyLocalTransform(e,a)}}},{key:`rotate`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t==`number`&&(t=Yc(t,n,r));var i=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.rotateLocal(e,t);else{var a=Uv;Ol(a,t[0],t[1],t[2]);var o=this.getRotation(e),s=this.getRotation(e.parentNode);Al(Qv,s),El(Qv,Qv),wl(a,Qv,a),wl(i.localRotation,a,o),Nl(i.localRotation,i.localRotation),this.dirtyLocalTransform(e,i)}}},{key:`setOrigin`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t==`number`&&(t=[t,n,r]);var i=e.transformable;if(!(t[0]===i.origin[0]&&t[1]===i.origin[1]&&t[2]===i.origin[2])){var a=i.origin;a[0]=t[0],a[1]=t[1],a[2]=t[2]||0,this.dirtyLocalTransform(e,i)}}},{key:`setEulerAngles`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;typeof t==`number`&&(t=Yc(t,n,r));var i=e.transformable;if(e.parentNode===null||!e.parentNode.transformable)this.setLocalEulerAngles(e,t);else{Ol(i.localRotation,t[0],t[1],t[2]);var a=this.getRotation(e.parentNode);Al(Xv,El(Uv,a)),Ml(i.localRotation,i.localRotation,Xv),this.dirtyLocalTransform(e,i)}}},{key:`getTransformedGeometryBounds`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2?arguments[2]:void 0,r=this.getGeometryBounds(e,t);if(!tp.isEmpty(r)){var i=n||new tp;return i.setFromTransformedAABB(r,this.getWorldTransform(e)),i}return null}},{key:`getGeometryBounds`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=e,r=n.geometry;return r.dirty&&Y.styleValueRegistry.updateGeometry(e),(t?r.renderBounds:r.contentBounds||null)||new tp}},{key:`getBounds`,value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e,i=r.renderable;if(!i.boundsDirty&&!n&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&n&&i.renderBounds)return i.renderBounds;var a=n?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(e,n,a);if(e.childNodes.forEach(function(e){var r=t.getBounds(e,n);r&&(o?o.add(r):(o=a||new tp,o.update(r.center,r.halfExtents)))}),o||=new tp,n){var s=__(e);if(s){var c=s.parsedStyle.clipPath.getBounds(n);o?c&&(o=c.intersection(o)):o.update(c.center,c.halfExtents)}}return n?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o}},{key:`getLocalBounds`,value:function(e){if(e.parentNode){var t=zv;e.parentNode.transformable&&(t=tc(Hv,this.getWorldTransform(e.parentNode)));var n=this.getBounds(e);if(!tp.isEmpty(n)){var r=new tp;return r.setFromTransformedAABB(n,t),r}}return this.getBounds(e)}},{key:`getBoundingClientRect`,value:function(e){var t,n,r=this.getGeometryBounds(e);tp.isEmpty(r)||(n=new tp,n.setFromTransformedAABB(r,this.getWorldTransform(e)));var i=(t=e.ownerDocument)==null||(t=t.defaultView)==null?void 0:t.getContextService().getBoundingClientRect();if(n){var a=n.getMin(),o=Vs(a,2),s=o[0],c=o[1],l=n.getMax(),u=Vs(l,2),d=u[0],f=u[1];return new op(s+(i?.left||0),c+(i?.top||0),d-s,f-c)}return new op(i?.left||0,i?.top||0,0,0)}},{key:`internalUpdateTransform`,value:function(e){var t=e.parentNode?.transformable;Gp(e.transformable),Kp(e.transformable,t)}},{key:`internalUpdateElement`,value:function(e,t){var n,r=((n=e.ownerDocument)==null||(n=n.defaultView)==null||(n=n.getConfig())==null||(n=n.future)==null?void 0:n.experimentalAttributeUpdateOptimization)===!0,i=t[t.length-1],a=i?.transformDirty||e.transformable?.localDirtyFlag;if(e.transformable){var o;(o=e.transformable).dirtyFlag||(o.dirtyFlag=a)}if(this.internalUpdateTransform(e),a){var s;(s=e.dirty)==null||s.call(e,!0,!0)}var c=e.renderable?.boundsDirty||e.renderable?.renderBoundsDirty;if((a||c)&&i?.shapeUpdated===!1&&r)for(var l=t.length-1;l>=0;){var u,d,f=t[l];if(f.shapeUpdated)break;(u=(d=f.node).dirty)==null||u.call(d,!0,!0),f.shapeUpdated=!0,--l}return a}},{key:`syncHierarchy`,value:function(e){for(var t=[e],n=e.parentNode?[{node:e.parentNode,transformDirty:e.parentNode.transformable?.localDirtyFlag||e.parentNode.transformable?.dirtyFlag,shapeUpdated:!1}]:[];t.length>0;){for(var r=t.pop(),i=n[n.length-1];n.length>0&&r.parentNode!==i.node;)i=n.pop();var a=this.internalUpdateElement(r,n);if(r.childNodes.length>0){for(var o=r.childNodes.length-1;o>=0;o--)t.push(r.childNodes[o]);n.push({node:r,transformDirty:a,shapeUpdated:!1})}}}},{key:`dirtyLocalTransform`,value:function(e,t){E_(e)||t.localDirtyFlag||(t.localDirtyFlag=!0,t.dirtyFlag||this.dirtyWorldTransform(e,t))}},{key:`dirtyWorldTransform`,value:function(e,t){this.dirtifyWorldInternal(e,t),this.dirtyToRoot(e,!0)}},{key:`dirtifyWorldInternal`,value:function(e,t){var n,r=this,i=((n=e.ownerDocument)==null||(n=n.defaultView)==null||(n=n.getConfig())==null||(n=n.future)==null?void 0:n.experimentalAttributeUpdateOptimization)===!0;t.dirtyFlag||(t.dirtyFlag=!0,e.dirty(!0,!0),i||e.childNodes.forEach(function(e){var t=e.transformable;r.dirtifyWorldInternal(e,t)}))}},{key:`dirtyToRoot`,value:function(e){for(var t,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=e,i=((t=e.ownerDocument)==null||(t=t.defaultView)==null||(t=t.getConfig())==null||(t=t.future)==null?void 0:t.experimentalAttributeUpdateOptimization)===!0;r;){var a,o;if((a=(o=r).dirty)==null||a.call(o,!0,!0),i)break;r=r.parentNode}n&&e.forEach(function(e){var t;(t=e.dirty)==null||t.call(e,!0,!0)}),this.informDependentDisplayObjects(e),this.pendingEvents.set(e,n)}},{key:`dirtifyFragment`,value:function(e){var t,n,r=e.transformable;r&&(r.dirtyFlag=!0,r.localDirtyFlag=!0),(t=(n=e).dirty)==null||t.call(n,!0,!0);for(var i=e.childNodes.length,a=0;a<i;a++)this.dirtifyFragment(e.childNodes[a]);e.nodeName===K.FRAGMENT&&this.pendingEvents.set(e,!1)}},{key:`triggerPendingEvents`,value:function(){var e=this,t=new Set,n,r,i=function(r,i){if(!(!r.isConnected||t.has(r)||r.nodeName===K.FRAGMENT)){if(e.boundsChangedEvent.detail=i,e.boundsChangedEvent.target=r,r.isMutationObserved)r.dispatchEvent(e.boundsChangedEvent);else{if(n===void 0){var a;n=((a=r.ownerDocument.defaultView)==null||(a=a.getConfig())==null||(a=a.future)==null?void 0:a.experimentalCancelEventPropagation)===!0}r.ownerDocument.defaultView.dispatchEvent(e.boundsChangedEvent,!0,n)}t.add(r)}};this.pendingEvents.forEach(function(e,t){if(t.nodeName!==K.FRAGMENT){if(r===void 0){var n;r=((n=t.ownerDocument)==null||(n=n.defaultView)==null||(n=n.getConfig())==null||(n=n.future)==null?void 0:n.experimentalAttributeUpdateOptimization)===!0}$v.affectChildren=e,r?i(t,$v):e?t.forEach(function(e){i(e,$v)}):i(t,$v)}}),t.clear(),this.clearPendingEvents()}},{key:`clearPendingEvents`,value:function(){this.pendingEvents.clear()}},{key:`updateDisplayObjectDependency`,value:function(e,t,n,r){if(t&&t!==n){var i=this.displayObjectDependencyMap.get(t);if(i&&i[e]){var a=i[e].indexOf(r);i[e].splice(a,1)}}if(n){var o=this.displayObjectDependencyMap.get(n);o||=(this.displayObjectDependencyMap.set(n,{}),this.displayObjectDependencyMap.get(n)),o[e]||(o[e]=[]),o[e].push(r)}}},{key:`informDependentDisplayObjects`,value:function(e){var t,n=this,r=this.displayObjectDependencyMap.get(e);if(r){var i=(t=e.ownerDocument)==null||(t=t.defaultView)==null||(t=t.getConfig())==null||(t=t.future)==null?void 0:t.experimentalCancelEventPropagation;Object.keys(r).forEach(function(e){r[e].forEach(function(t){n.dirtyToRoot(t,!0),t.dispatchEvent(new Pv(Nv.ATTR_MODIFIED,t,n,n,e,Pv.MODIFICATION,n,n),i,i),t.isCustomElement&&t.isConnected&&t.attributeChangedCallback&&t.attributeChangedCallback(e,n,n)})})}}}])}(),ty=function(){function e(t){if(H(this,e),t<=0)throw Error(`LRU capacity must be a positive number.`);this.capacity=t,this.cache=new Map}return U(e,[{key:`get`,value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),t}}},{key:`put`,value:function(e,t){if(this.cache.has(e)&&this.cache.delete(e),this.cache.set(e,t),this.cache.size>this.capacity){var n=this.cache.keys().next().value;this.cache.delete(n)}}},{key:`len`,value:function(){return this.cache.size}},{key:`clear`,value:function(){this.cache.clear()}}])}(),ny={MetricsString:`|q`,BaselineSymbol:`M`,BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},ry=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,iy=/[!%),.:;?\]}'""]/,ay=/[$('"]/,oy=/[!),.:;?\]}'""]/,sy=/[([{'"]/,cy=/[)\]'"?!:;,.]/,ly=/[(['"...]/,uy=/[!%),.:;?\]}'"]/,dy=/[$([{'"#]/,fy=RegExp(`${iy.source}|${oy.source}|${cy.source}|${uy.source}`),py=RegExp(`${ay.source}|${sy.source}|${ly.source}|${dy.source}`),my=function(){function e(t){var n=this;H(this,e),this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(e,t){return n.isBreakingSpace(t)?!1:!!(e&&(py.exec(t)||fy.exec(e)))},this.trimByKinsokuShorui=function(e){var t=As(e),n=t[t.length-2];if(!n)return e;var r=n[n.length-1];return t[t.length-2]=n.slice(0,-1),t[t.length-1]=r+t[t.length-1],t},this.runtime=t,this.charWidthCache=new ty(100)}return U(e,[{key:`measureFont`,value:function(e,t){if(this.fontMetricsCache[e])return this.fontMetricsCache[e];var n={ascent:0,descent:0,fontSize:0},r=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(t),i=this.runtime.offscreenCanvasCreator.getOrCreateContext(t,{willReadFrequently:!0});i.font=e;var a=ny.MetricsString+ny.BaselineSymbol,o=Math.ceil(i.measureText(a).width),s=Math.ceil(i.measureText(ny.BaselineSymbol).width),c=ny.HeightMultiplier*s;s=s*ny.BaselineMultiplier|0,r.width=o,r.height=c,i.fillStyle=`#f00`,i.fillRect(0,0,o,c),i.font=e,i.textBaseline=`alphabetic`,i.fillStyle=`#000`,i.fillText(a,0,s);var l=i.getImageData(0,0,o||1,c||1).data,u=l.length,d=o*4,f=0,p=0,m=!1;for(f=0;f<s;++f){for(var h=0;h<d;h+=4)if(l[p+h]!==255){m=!0;break}if(!m)p+=d;else break}for(n.ascent=s-f,p=u-d,m=!1,f=c;f>s;--f){for(var g=0;g<d;g+=4)if(l[p+g]!==255){m=!0;break}if(!m)p-=d;else break}return n.descent=f-s,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[e]=n,n}},{key:`measureText`,value:function(e,t,n){var r=t.fontSize,i=r===void 0?16:r,a=t.wordWrap,o=a===void 0?!1:a,s=t.lineHeight,c=t.lineWidth,l=c===void 0?1:c,u=t.textBaseline,d=u===void 0?`alphabetic`:u,f=t.textAlign,p=f===void 0?`start`:f,m=t.letterSpacing,h=m===void 0?0:m,g=t.textPath;t.textPathSide,t.textPathStartOffset;var _=t.leading,v=_===void 0?0:_,y=X_(t),b=this.measureFont(y,n);b.fontSize===0&&(b.fontSize=i,b.ascent=i);var x=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);x.font=y,t.isOverflowing=!1;var S=(o?this.wordWrap(e,t,n):e).split(/(?:\r\n|\r|\n)/),C=Array(S.length),w=0;if(g){g.getTotalLength();for(var T=0;T<S.length;T++)x.measureText(S[T]).width+(S[T].length-1)*h}else{for(var E=0;E<S.length;E++){var D=x.measureText(S[E]).width+(S[E].length-1)*h;C[E]=D,w=Math.max(w,D)}var O=w+l,k=s||b.fontSize+l,A=Math.max(k,b.fontSize+l)+(S.length-1)*(k+v);k+=v;var j=0;return d===`middle`?j=-A/2:d===`bottom`||d===`alphabetic`||d===`ideographic`?j=-A:(d===`top`||d===`hanging`)&&(j=0),{font:y,width:O,height:A,lines:S,lineWidths:C,lineHeight:k,maxLineWidth:w,fontProperties:b,lineMetrics:C.map(function(e,t){var n=0;return p===`center`||p===`middle`?n-=e/2:(p===`right`||p===`end`)&&(n-=e),new op(n-l/2,j+t*k,e+l,k)})}}}},{key:`wordWrap`,value:function(e,t,n){var r=this,i=Array.from(e);if(i.length===0)return``;var a=this,o=t.wordWrapWidth,s=o===void 0?0:o,c=t.letterSpacing,l=c===void 0?0:c,u=t.maxLines,d=u===void 0?1/0:u,f=t.textOverflow,p=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),m=s+l,h=``;f===`ellipsis`?h=`...`:f&&f!==`clip`&&(h=f);var g=[``],_=0,v=0,y=-1,b=X_(t),x=this.charWidthCache.get(b);x||(x=new ty(500),this.charWidthCache.put(b,x));var S=function(e){return r.getFromCache(e,l,x,p)},C=S(h);function w(e,t,n,r){for(;S(e)<r&&t<i.length-1&&!a.isNewline(i[t+1]);)t+=1,e+=i[t];for(;S(e)>r&&t>=n;)--t,e=e.slice(0,-1);return{lineTxt:e,txtLastCharIndex:t}}function T(e,t){if(!(C<=0||C>m)){if(!g[e]){g[e]=h;return}g[e]=w(g[e],t,y+1,m-C).lineTxt+h}}for(var E=0;E<i.length;E++){var D=i[E],O=i[E-1],k=i[E+1],A=S(D);if(this.isNewline(D)){if(_+1>=d){E<i.length-1&&T(_,E-1),t.isOverflowing=!0;break}y=E-1,_+=1,v=0,g[_]=``;continue}if(A>m){T(_,E-1),t.isOverflowing=!0;break}if(v>0&&v+A>m){var j=w(g[_],E-1,y+1,m);if(j.txtLastCharIndex!==E-1){if(g[_]=j.lineTxt,j.txtLastCharIndex===i.length-1)break;E=j.txtLastCharIndex+1,D=i[E],O=i[E-1],k=i[E+1],A=S(D)}if(_+1>=d){T(_,E-1),t.isOverflowing=!0;break}if(y=E-1,_+=1,v=0,g[_]=``,this.isBreakingSpace(D))continue;this.canBreakInLastChar(D)||(g=this.trimToBreakable(g),v=this.sumTextWidthByCache(g[_]||``,S)),this.shouldBreakByKinsokuShorui(D,k)&&(g=this.trimByKinsokuShorui(g),v+=S(O||``))}v+=A,g[_]+=D}return g.join(`
`)}},{key:`isBreakingSpace`,value:function(e){return typeof e==`string`?ny.BreakingSpaces.indexOf(e.charCodeAt(0))>=0:!1}},{key:`isNewline`,value:function(e){return typeof e==`string`?ny.Newlines.indexOf(e.charCodeAt(0))>=0:!1}},{key:`trimToBreakable`,value:function(e){var t=As(e),n=t[t.length-2],r=this.findBreakableIndex(n);if(r===-1||!n)return t;var i=n.slice(r,r+1),a=this.isBreakingSpace(i),o=r+1,s=r+(a?0:1);return t[t.length-1]+=n.slice(o,n.length),t[t.length-2]=n.slice(0,s),t}},{key:`canBreakInLastChar`,value:function(e){return!(e&&ry.test(e))}},{key:`sumTextWidthByCache`,value:function(e,t){return e.split(``).reduce(function(e,n){return e+t(n)},0)}},{key:`findBreakableIndex`,value:function(e){for(var t=e.length-1;t>=0;t--)if(!ry.test(e[t]))return t;return-1}},{key:`getFromCache`,value:function(e,t,n,r){var i=n.get(e);if(typeof i!=`number`){var a=e.length*t;i=r.measureText(e).width+a,n.put(e,i)}return i}},{key:`clearCache`,value:function(){this.fontMetricsCache={},this.charWidthCache.clear()}}])}(),Y={},hy=function(e){var t=new hv,n=new mv;return e={},V(V(V(V(V(V(V(V(V(V(e,K.FRAGMENT,null),K.CIRCLE,new uv),K.ELLIPSE,new dv),K.RECT,t),K.IMAGE,t),K.GROUP,new _v),K.LINE,new fv),K.TEXT,new gv(Y)),K.POLYLINE,n),K.POLYGON,n),V(V(V(e,K.PATH,new pv),K.HTML,new vv),K.MESH,null)}(),gy=function(e){var t=new Xg,n=new $g;return e={},V(V(V(V(V(V(V(V(V(V(e,q.PERCENTAGE,null),q.NUMBER,new r_),q.ANGLE,new Jg),q.DEFINED_PATH,new Yg),q.PAINT,t),q.COLOR,t),q.FILTER,new Zg),q.LENGTH,n),q.LENGTH_PERCENTAGE,n),q.LENGTH_PERCENTAGE_12,new e_),V(V(V(V(V(V(V(V(V(V(e,q.LENGTH_PERCENTAGE_14,new t_),q.COORDINATE,new $g),q.OFFSET_DISTANCE,new i_),q.OPACITY_VALUE,new a_),q.PATH,new o_),q.LIST_OF_POINTS,new s_),q.SHADOW_BLUR,new c_),q.TEXT,new l_),q.TEXT_TRANSFORM,new u_),q.TRANSFORM,new sv),V(V(V(e,q.TRANSFORM_ORIGIN,new cv),q.Z_INDEX,new lv),q.MARKER,new n_)}();Y.CameraContribution=zp,Y.AnimationTimeline=null,Y.EasingFunction=null,Y.offscreenCanvasCreator=new Ov,Y.sceneGraphSelector=new Mv,Y.sceneGraphService=new ey(Y),Y.textService=new my(Y),Y.geometryUpdaterFactory=hy,Y.CSSPropertySyntaxFactory=gy,Y.styleValueRegistry=new Gg(Y),Y.layoutRegistry=null,Y.globalThis=function(){return typeof globalThis<`u`?globalThis:typeof self<`u`?self:typeof window<`u`?window:typeof global<`u`?global:{}}(),Y.enableStyleSyntax=!0,Y.enableSizeAttenuation=!1;var _y=0,vy=new Pv(Nv.INSERTED,null,``,``,``,0,``,``),yy=new Pv(Nv.REMOVED,null,``,``,``,0,``,``),by=new Cv(Nv.DESTROY),xy=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.entity=_y++,e.transformable={dirtyFlag:!1,localDirtyFlag:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.geometry={contentBounds:void 0,renderBounds:void 0,dirty:!0},e.cullable={strategy:Bp.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.rBushNode={aabb:void 0},e.namespaceURI=`g`,e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.style={},e.computedStyle={},e.parsedStyle={},e.attributes={},e}return Ls(t,e),U(t,[{key:`dirty`,value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.renderable.dirty=e,t&&(this.renderable.boundsDirty=e,this.renderable.renderBoundsDirty=e)}},{key:`className`,get:function(){return this.getAttribute(`class`)||``},set:function(e){this.setAttribute(`class`,e)}},{key:`classList`,get:function(){return this.className.split(` `).filter(function(e){return e!==``})}},{key:`tagName`,get:function(){return this.nodeName}},{key:`children`,get:function(){return this.childNodes}},{key:`childElementCount`,get:function(){return this.childNodes.length}},{key:`firstElementChild`,get:function(){return this.firstChild}},{key:`lastElementChild`,get:function(){return this.lastChild}},{key:`parentElement`,get:function(){return this.parentNode}},{key:`nextSibling`,get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null}return null}},{key:`previousSibling`,get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null}return null}},{key:`cloneNode`,value:function(e){throw Error(sp)}},{key:`appendChild`,value:function(e,t){var n;if(e.destroyed)throw Error(lp);return Y.sceneGraphService.attach(e,this,t),(n=this.ownerDocument)!=null&&n.defaultView&&(!E_(this)&&e.nodeName===K.FRAGMENT?this.ownerDocument.defaultView.mountFragment(e):this.ownerDocument.defaultView.mountChildren(e)),this.isMutationObserved&&(vy.relatedNode=this,e.dispatchEvent(vy)),e}},{key:`insertBefore`,value:function(e,t){if(!t)this.appendChild(e);else{e.parentElement&&e.parentElement.removeChild(e);var n=this.childNodes.indexOf(t);n===-1?this.appendChild(e):this.appendChild(e,n)}return e}},{key:`replaceChild`,value:function(e,t){var n=this.childNodes.indexOf(t);return this.removeChild(t),this.appendChild(e,n),t}},{key:`removeChild`,value:function(e){var t,n,r=((t=this.ownerDocument)==null||(t=t.defaultView)==null||(t=t.getConfig().future)==null?void 0:t.experimentalCancelEventPropagation)===!0;return yy.relatedNode=this,e.dispatchEvent(yy,r,r),(n=e.ownerDocument)!=null&&n.defaultView&&e.ownerDocument.defaultView.unmountChildren(e),Y.sceneGraphService.detach(e),e}},{key:`removeChildren`,value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];this.removeChild(t)}}},{key:`destroyChildren`,value:function(){for(var e=this.childNodes.length-1;e>=0;e--){var t=this.childNodes[e];t.childNodes.length>0&&t.destroyChildren(),t.destroy()}}},{key:`matches`,value:function(e){return Y.sceneGraphService.matches(e,this)}},{key:`getElementById`,value:function(e){return Y.sceneGraphService.querySelector(`#${e}`,this)}},{key:`getElementsByName`,value:function(e){return Y.sceneGraphService.querySelectorAll(`[name="${e}"]`,this)}},{key:`getElementsByClassName`,value:function(e){return Y.sceneGraphService.querySelectorAll(`.${e}`,this)}},{key:`getElementsByTagName`,value:function(e){return Y.sceneGraphService.querySelectorAll(e,this)}},{key:`querySelector`,value:function(e){return Y.sceneGraphService.querySelector(e,this)}},{key:`querySelectorAll`,value:function(e){return Y.sceneGraphService.querySelectorAll(e,this)}},{key:`closest`,value:function(e){var t=this;do{if(Y.sceneGraphService.matches(e,t))return t;t=t.parentElement}while(t!==null);return null}},{key:`find`,value:function(e){var t=this,n=null;return this.forEach(function(r){return r!==t&&e(r)?(n=r,!1):!0}),n}},{key:`findAll`,value:function(e){var t=this,n=[];return this.forEach(function(r){r!==t&&e(r)&&n.push(r)}),n}},{key:`after`,value:function(){var e=this;if(this.parentNode){var t=this.parentNode.childNodes.indexOf(this);[...arguments].forEach(function(n,r){return e.parentNode?.appendChild(n,t+r+1)})}}},{key:`before`,value:function(){if(this.parentNode){var e,t=this.parentNode.childNodes.indexOf(this),n=[...arguments],r=n[0],i=n.slice(1);this.parentNode.appendChild(r,t),(e=r).after.apply(e,As(i))}}},{key:`replaceWith`,value:function(){this.after.apply(this,arguments),this.remove()}},{key:`append`,value:function(){var e=this;[...arguments].forEach(function(t){return e.appendChild(t)})}},{key:`prepend`,value:function(){var e=this;[...arguments].forEach(function(t,n){return e.appendChild(t,n)})}},{key:`replaceChildren`,value:function(){for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,arguments)}},{key:`remove`,value:function(){return this.parentNode?this.parentNode.removeChild(this):this}},{key:`destroy`,value:function(){var e,t=((e=this.ownerDocument)==null||(e=e.defaultView)==null||(e=e.getConfig().future)==null?void 0:e.experimentalCancelEventPropagation)===!0;this.destroyChildren(),this.dispatchEvent(by,t,t),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0}},{key:`getGeometryBounds`,value:function(){return Y.sceneGraphService.getGeometryBounds(this)}},{key:`getRenderBounds`,value:function(){return Y.sceneGraphService.getBounds(this,!0)}},{key:`getBounds`,value:function(){return Y.sceneGraphService.getBounds(this)}},{key:`getLocalBounds`,value:function(){return Y.sceneGraphService.getLocalBounds(this)}},{key:`getBoundingClientRect`,value:function(){return Y.sceneGraphService.getBoundingClientRect(this)}},{key:`getClientRects`,value:function(){return[this.getBoundingClientRect()]}},{key:`computedStyleMap`,value:function(){return new Map(Object.entries(this.computedStyle))}},{key:`getAttributeNames`,value:function(){return Object.keys(this.attributes)}},{key:`getAttribute`,value:function(e){if(typeof e!=`symbol`)return this.attributes[e]}},{key:`hasAttribute`,value:function(e){return this.getAttributeNames().includes(e)}},{key:`hasAttributes`,value:function(){return!!this.getAttributeNames().length}},{key:`removeAttribute`,value:function(e){this.setAttribute(e,null),delete this.attributes[e]}},{key:`setAttribute`,value:function(e,t,n,r){this.attributes[e]=t}},{key:`getAttributeNS`,value:function(e,t){throw Error(sp)}},{key:`getAttributeNode`,value:function(e){throw Error(sp)}},{key:`getAttributeNodeNS`,value:function(e,t){throw Error(sp)}},{key:`hasAttributeNS`,value:function(e,t){throw Error(sp)}},{key:`removeAttributeNS`,value:function(e,t){throw Error(sp)}},{key:`removeAttributeNode`,value:function(e){throw Error(sp)}},{key:`setAttributeNS`,value:function(e,t,n){throw Error(sp)}},{key:`setAttributeNode`,value:function(e){throw Error(sp)}},{key:`setAttributeNodeNS`,value:function(e){throw Error(sp)}},{key:`toggleAttribute`,value:function(e,t){throw Error(sp)}}])}(Tv);function Sy(e){return!!(e!=null&&e.nodeName)}var Cy=Y.globalThis.Proxy?Y.globalThis.Proxy:function(){},wy=new Pv(Nv.ATTR_MODIFIED,null,null,null,null,Pv.MODIFICATION,null,null),Ty=Kc(),Ey=Sl(),Dy=function(e){function t(e){var n;return H(this,t),n=Fs(this,t),n.isCustomElement=!1,n.isMutationObserved=!1,n.activeAnimations=[],n.config=e,n.id=e.id||``,n.name=e.name||``,(e.className||e.class)&&(n.className=e.className||e.class),n.nodeName=e.type||K.GROUP,e.initialParsedStyle&&Object.assign(n.parsedStyle,e.initialParsedStyle),n.initAttributes(e.style),Y.enableStyleSyntax&&(n.style=new Cy({setProperty:function(e,t){n.setAttribute(e,t)},getPropertyValue:function(e){return n.getAttribute(e)},removeProperty:function(e){n.removeAttribute(e)},item:function(){return``}},{get:function(e,t){return e[t]===void 0?n.getAttribute(t):e[t]},set:function(e,t,r){return n.setAttribute(t,r),!0}})),n}return Ls(t,e),U(t,[{key:`destroy`,value:function(){rf(t,`destroy`,this,3)([]),this.getAnimations().forEach(function(e){e.cancel()})}},{key:`cloneNode`,value:function(e,t){var n=Cs({},this.attributes);for(var r in n){var i=n[r];Sy(i)&&r!==`clipPath`&&r!==`offsetPath`&&r!==`textPath`&&(n[r]=i.cloneNode(e)),t&&(n[r]=t(r,i))}var a=new this.constructor(Cs(Cs({},this.config),{},{style:n}));return a.setLocalTransform(this.getLocalTransform()),e&&this.children.forEach(function(t){if(!t.style.isMarker){var n=t.cloneNode(e);a.appendChild(n)}}),a}},{key:`initAttributes`,value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Y.styleValueRegistry.processProperties(this,e,{forceUpdateGeometry:!0}),this.dirty()}},{key:`setAttribute`,value:function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;Eu(n)||(r||n!==this.attributes[e])&&(this.internalSetAttribute(e,n,{memoize:i}),rf(t,`setAttribute`,this,3)([e,n]))}},{key:`internalSetAttribute`,value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=this.attributes[e],i=this.parsedStyle[e];Y.styleValueRegistry.processProperties(this,V({},e,t),n),this.dirty();var a=this.parsedStyle[e];if(this.isConnected)if(wy.relatedNode=this,wy.prevValue=r,wy.newValue=t,wy.attrName=e,wy.prevParsedValue=i,wy.newParsedValue=a,this.isMutationObserved)this.dispatchEvent(wy);else{var o=this.ownerDocument.defaultView.getConfig().future?.experimentalCancelEventPropagation===!0;wy.target=this,this.ownerDocument.defaultView.dispatchEvent(wy,!0,o)}if(this.isCustomElement&&this.isConnected||!this.isCustomElement){var s,c;(s=(c=this).attributeChangedCallback)==null||s.call(c,e,r,t,i,a)}}},{key:`getBBox`,value:function(){var e=this.getBounds(),t=e.getMin(),n=Vs(t,2),r=n[0],i=n[1],a=e.getMax(),o=Vs(a,2),s=o[0],c=o[1];return new op(r,i,s-r,c-i)}},{key:`setOrigin`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Y.sceneGraphService.setOrigin(this,fp(e,t,n,!1)),this}},{key:`getOrigin`,value:function(){return Y.sceneGraphService.getOrigin(this)}},{key:`setPosition`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Y.sceneGraphService.setPosition(this,fp(e,t,n,!1)),this}},{key:`setLocalPosition`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Y.sceneGraphService.setLocalPosition(this,fp(e,t,n,!1)),this}},{key:`translate`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Y.sceneGraphService.translate(this,fp(e,t,n,!1)),this}},{key:`translateLocal`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return Y.sceneGraphService.translateLocal(this,fp(e,t,n,!1)),this}},{key:`getPosition`,value:function(){return Y.sceneGraphService.getPosition(this)}},{key:`getLocalPosition`,value:function(){return Y.sceneGraphService.getLocalPosition(this)}},{key:`scale`,value:function(e,t,n){return this.scaleLocal(e,t,n)}},{key:`scaleLocal`,value:function(e,t,n){return typeof e==`number`&&(t||=e,n||=e,e=fp(e,t,n,!1)),Y.sceneGraphService.scaleLocal(this,e),this}},{key:`setLocalScale`,value:function(e,t,n){return typeof e==`number`&&(t||=e,n||=e,e=fp(e,t,n,!1)),Y.sceneGraphService.setLocalScale(this,e),this}},{key:`getLocalScale`,value:function(){return Y.sceneGraphService.getLocalScale(this)}},{key:`getScale`,value:function(){return Y.sceneGraphService.getScale(this)}},{key:`getEulerAngles`,value:function(){var e=xp(Ty,Y.sceneGraphService.getWorldTransform(this)),t=Vs(e,3),n=t[2];return gp(n)}},{key:`getLocalEulerAngles`,value:function(){var e=xp(Ty,Y.sceneGraphService.getLocalRotation(this)),t=Vs(e,3),n=t[2];return gp(n)}},{key:`setEulerAngles`,value:function(e){return Y.sceneGraphService.setEulerAngles(this,0,0,e),this}},{key:`setLocalEulerAngles`,value:function(e){return Y.sceneGraphService.setLocalEulerAngles(this,0,0,e),this}},{key:`rotateLocal`,value:function(e,t,n){return Wl(t)&&Wl(n)?Y.sceneGraphService.rotateLocal(this,0,0,e):Y.sceneGraphService.rotateLocal(this,e,t,n),this}},{key:`rotate`,value:function(e,t,n){return Wl(t)&&Wl(n)?Y.sceneGraphService.rotate(this,0,0,e):Y.sceneGraphService.rotate(this,e,t,n),this}},{key:`setRotation`,value:function(e,t,n,r){return Y.sceneGraphService.setRotation(this,e,t,n,r),this}},{key:`setLocalRotation`,value:function(e,t,n,r){return Y.sceneGraphService.setLocalRotation(this,e,t,n,r),this}},{key:`setLocalSkew`,value:function(e,t){return Y.sceneGraphService.setLocalSkew(this,e,t),this}},{key:`getRotation`,value:function(){return Y.sceneGraphService.getRotation(this)}},{key:`getLocalRotation`,value:function(){return Y.sceneGraphService.getLocalRotation(this)}},{key:`getLocalSkew`,value:function(){return Y.sceneGraphService.getLocalSkew(this)}},{key:`getLocalTransform`,value:function(){return Y.sceneGraphService.getLocalTransform(this)}},{key:`getWorldTransform`,value:function(){return Y.sceneGraphService.getWorldTransform(this)}},{key:`setLocalTransform`,value:function(e){return Y.sceneGraphService.setLocalTransform(this,e),this}},{key:`resetLocalTransform`,value:function(){Y.sceneGraphService.resetLocalTransform(this)}},{key:`getAnimations`,value:function(){return this.activeAnimations}},{key:`animate`,value:function(e,t){var n=this.ownerDocument?.timeline;return n?n.play(this,e,t):null}},{key:`isVisible`,value:function(){return this.parsedStyle?.visibility!==`hidden`}},{key:`interactive`,get:function(){return this.isInteractive()},set:function(e){this.style.pointerEvents=e?`auto`:`none`}},{key:`isInteractive`,value:function(){return this.parsedStyle?.pointerEvents!==`none`}},{key:`isCulled`,value:function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)}},{key:`toFront`,value:function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,As(this.parentNode.children.map(function(e){return Number(e.style.zIndex)})))+1),this}},{key:`toBack`,value:function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,As(this.parentNode.children.map(function(e){return Number(e.style.zIndex)})))-1),this}},{key:`getConfig`,value:function(){return this.config}},{key:`attr`,value:function(){var e=this,t=[...arguments],n=t[0],r=t[1];return n?Kl(n)?(Object.keys(n).forEach(function(t){e.setAttribute(t,n[t])}),this):t.length===2?(this.setAttribute(n,r),this):this.attributes[n]:this.attributes}},{key:`getMatrix`,value:function(e){var t=e||this.getWorldTransform(),n=yc(Ty,t),r=Vs(n,2),i=r[0],a=r[1],o=bc(Ty,t),s=Vs(o,2),c=s[0],l=s[1],u=xc(Ey,t),d=xp(Ty,u),f=Vs(d,3),p=f[0],m=f[2];return Sp(p||m,i,a,c,l)}},{key:`getLocalMatrix`,value:function(){return this.getMatrix(this.getLocalTransform())}},{key:`setMatrix`,value:function(e){var t=wp(e),n=Vs(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setEulerAngles(s).setPosition(r,i).setLocalScale(a,o)}},{key:`setLocalMatrix`,value:function(e){var t=wp(e),n=Vs(t,5),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4];this.setLocalEulerAngles(s).setLocalPosition(r,i).setLocalScale(a,o)}},{key:`show`,value:function(){this.forEach(function(e){e.style.visibility=`visible`})}},{key:`hide`,value:function(){this.forEach(function(e){e.style.visibility=`hidden`})}},{key:`getCount`,value:function(){return this.childElementCount}},{key:`getParent`,value:function(){return this.parentElement}},{key:`getChildren`,value:function(){return this.children}},{key:`getFirst`,value:function(){return this.firstElementChild}},{key:`getLast`,value:function(){return this.lastElementChild}},{key:`getChildByIndex`,value:function(e){return this.children[e]||null}},{key:`add`,value:function(e,t){return this.appendChild(e,t)}},{key:`set`,value:function(e,t){this.config[e]=t}},{key:`get`,value:function(e){return this.config[e]}},{key:`moveTo`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(e,t,n),this}},{key:`move`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.setPosition(e,t,n),this}},{key:`setZIndex`,value:function(e){return this.style.zIndex=e,this}}])}(xy);Dy.PARSED_STYLE_LIST=new Set(`class.className.clipPath.cursor.display.draggable.droppable.fill.fillOpacity.fillRule.filter.increasedLineWidthForHitTesting.lineCap.lineDash.lineDashOffset.lineJoin.lineWidth.miterLimit.hitArea.offsetDistance.offsetPath.offsetX.offsetY.opacity.pointerEvents.shadowColor.shadowType.shadowBlur.shadowOffsetX.shadowOffsetY.stroke.strokeOpacity.strokeWidth.strokeLinecap.strokeLineJoin.strokeDasharray.strokeDashoffset.transform.transformOrigin.textTransform.visibility.zIndex`.split(`.`));var Oy=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),Fs(this,t,[Cs({type:K.CIRCLE},e)])}return Ls(t,e),U(t)}(Dy);Oy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`cx`,`cy`,`cz`,`r`,`isBillboard`,`isSizeAttenuation`]));var ky=[`style`],Ay=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.style,i=Hf(n,ky);return H(this,t),e=Fs(this,t,[Cs({style:r},i)]),e.isCustomElement=!0,e}return Ls(t,e),U(t)}(Dy);Ay.PARSED_STYLE_LIST=new Set([`class`,`className`,`clipPath`,`cursor`,`draggable`,`droppable`,`opacity`,`pointerEvents`,`transform`,`transformOrigin`,`zIndex`,`visibility`]);var jy=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),Fs(this,t,[Cs({type:K.ELLIPSE},e)])}return Ls(t,e),U(t)}(Dy);jy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`cx`,`cy`,`cz`,`rx`,`ry`,`isBillboard`,`isSizeAttenuation`]));var My=function(e){function t(){return H(this,t),Fs(this,t,[{type:K.FRAGMENT}])}return Ls(t,e),U(t)}(Dy);My.PARSED_STYLE_LIST=new Set([`class`,`className`]);var Ny=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),Fs(this,t,[Cs({type:K.GROUP},e)])}return Ls(t,e),U(t)}(Dy);Ny.PARSED_STYLE_LIST=new Set([`class`,`className`,`clipPath`,`cursor`,`draggable`,`droppable`,`opacity`,`pointerEvents`,`transform`,`transformOrigin`,`zIndex`,`visibility`]);var Py=[`style`],Fy=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.style,i=Hf(n,Py);return H(this,t),e=Fs(this,t,[Cs({type:K.HTML,style:r},i)]),e.cullable.enable=!1,e}return Ls(t,e),U(t,[{key:`getDomElement`,value:function(){return this.parsedStyle.$el}},{key:`getClientRects`,value:function(){return[this.getBoundingClientRect()]}},{key:`getLocalBounds`,value:function(){if(this.parentNode){var e=tc(Js(),this.parentNode.getWorldTransform()),t=this.getBounds();if(!tp.isEmpty(t)){var n=new tp;return n.setFromTransformedAABB(t,e),n}}return this.getBounds()}}])}(Dy);Fy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`x`,`y`,`$el`,`innerHTML`,`width`,`height`]));var Iy=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),Fs(this,t,[Cs({type:K.IMAGE},e)])}return Ls(t,e),U(t)}(Dy);Iy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`x`,`y`,`z`,`src`,`width`,`height`,`isBillboard`,`billboardRotation`,`isSizeAttenuation`,`keepAspectRatio`]));var Ly=[`style`],Ry=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.style,i=Hf(n,Ly);H(this,t),e=Fs(this,t,[Cs({type:K.LINE,style:Cs({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},r)},i)]),e.markerStartAngle=0,e.markerEndAngle=0;var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd;return o&&Sy(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),s&&Sy(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e}return Ls(t,e),U(t,[{key:`attributeChangedCallback`,value:function(e,t,n,r,i){e===`x1`||e===`y1`||e===`x2`||e===`y2`||e===`markerStartOffset`||e===`markerEndOffset`?(this.transformMarker(!0),this.transformMarker(!1)):e===`markerStart`?(r&&Sy(r)&&(this.markerStartAngle=0,r.remove()),i&&Sy(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):e===`markerEnd`&&(r&&Sy(r)&&(this.markerEndAngle=0,r.remove()),i&&Sy(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1)))}},{key:`transformMarker`,value:function(e){var t=this.parsedStyle,n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,o=t.x1,s=t.x2,c=t.y1,l=t.y2,u=e?n:r;if(!(!u||!Sy(u))){var d=0,f,p,m,h,g,_;e?(m=o,h=c,f=s-o,p=l-c,g=i||0,_=this.markerStartAngle):(m=s,h=l,f=o-s,p=c-l,g=a||0,_=this.markerEndAngle),d=Math.atan2(p,f),u.setLocalEulerAngles(d*180/Math.PI+_),u.setLocalPosition(m+Math.cos(d)*g,h+Math.sin(d)*g)}}},{key:`getPoint`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.parsedStyle,r=n.x1,i=n.y1,a=n.x2,o=n.y2,s=gf(r,i,a,o,e),c=s.x,l=s.y,u=ll(Kc(),Yc(c,l,0),t?this.getWorldTransform():this.getLocalTransform());return new ap(u[0],u[1])}},{key:`getPointAtLength`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(e/this.getTotalLength(),t)}},{key:`getTotalLength`,value:function(){var e=this.parsedStyle,t=e.x1,n=e.y1,r=e.x2,i=e.y2;return hf(t,n,r,i)}}])}(Dy);Ry.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`x1`,`y1`,`x2`,`y2`,`z1`,`z2`,`isBillboard`,`isSizeAttenuation`,`markerStart`,`markerEnd`,`markerStartOffset`,`markerEndOffset`]));var zy=[`style`],By=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.style,i=Hf(n,zy);H(this,t),e=Fs(this,t,[Cs({type:K.PATH,style:r,initialParsedStyle:{miterLimit:4,d:Cs({},qp)}},i)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,c=a.markerMid;return o&&Sy(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),c&&Sy(c)&&e.placeMarkerMid(c),s&&Sy(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e}return Ls(t,e),U(t,[{key:`attributeChangedCallback`,value:function(e,t,n,r,i){e===`d`?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):e===`markerStartOffset`||e===`markerEndOffset`?(this.transformMarker(!0),this.transformMarker(!1)):e===`markerStart`?(r&&Sy(r)&&(this.markerStartAngle=0,r.remove()),i&&Sy(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):e===`markerEnd`?(r&&Sy(r)&&(this.markerEndAngle=0,r.remove()),i&&Sy(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):e===`markerMid`&&this.placeMarkerMid(i)}},{key:`transformMarker`,value:function(e){var t=this.parsedStyle,n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,o=e?n:r;if(!(!o||!Sy(o))){var s=0,c,l,u,d,f,p;if(e){var m=this.getStartTangent(),h=Vs(m,2),g=h[0],_=h[1];u=_[0],d=_[1],c=g[0]-_[0],l=g[1]-_[1],f=i||0,p=this.markerStartAngle}else{var v=this.getEndTangent(),y=Vs(v,2),b=y[0],x=y[1];u=x[0],d=x[1],c=b[0]-x[0],l=b[1]-x[1],f=a||0,p=this.markerEndAngle}s=Math.atan2(l,c),o.setLocalEulerAngles(s*180/Math.PI+p),o.setLocalPosition(u+Math.cos(s)*f,d+Math.sin(s)*f)}}},{key:`placeMarkerMid`,value:function(e){var t=this.parsedStyle.d.segments;if(this.markerMidList.forEach(function(e){e.remove()}),e&&Sy(e))for(var n=1;n<t.length-1;n++){var r=Vs(t[n].currentPoint,2),i=r[0],a=r[1],o=n===1?e:e.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a)}}},{key:`getTotalLength`,value:function(){return Xh(this)}},{key:`getPointAtLength`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.parsedStyle.d.absolutePath,r=Yd(n,e),i=r.x,a=r.y,o=ll(Kc(),Yc(i,a,0),t?this.getWorldTransform():this.getLocalTransform());return new ap(o[0],o[1])}},{key:`getPoint`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPointAtLength(e*Xh(this),t)}},{key:`getStartTangent`,value:function(){var e=this.parsedStyle.d.segments,t=[];if(e.length>1){var n=e[0].currentPoint,r=e[1].currentPoint,i=e[1].startTangent;t=[],i?(t.push([n[0]-i[0],n[1]-i[1]]),t.push([n[0],n[1]])):(t.push([r[0],r[1]]),t.push([n[0],n[1]]))}return t}},{key:`getEndTangent`,value:function(){var e=this.parsedStyle.d.segments,t=e.length,n=[];if(t>1){var r=e[t-2].currentPoint,i=e[t-1].currentPoint,a=e[t-1].endTangent;n=[],a?(n.push([i[0]-a[0],i[1]-a[1]]),n.push([i[0],i[1]])):(n.push([r[0],r[1]]),n.push([i[0],i[1]]))}return n}}])}(Dy);By.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`d`,`markerStart`,`markerMid`,`markerEnd`,`markerStartOffset`,`markerEndOffset`,`isBillboard`,`isSizeAttenuation`]));var Vy=[`style`],Hy=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=n.style,i=Hf(n,Vy);H(this,t),e=Fs(this,t,[Cs({type:K.POLYGON,style:r,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},i)]),e.markerStartAngle=0,e.markerEndAngle=0,e.markerMidList=[];var a=e.parsedStyle,o=a.markerStart,s=a.markerEnd,c=a.markerMid;return o&&Sy(o)&&(e.markerStartAngle=o.getLocalEulerAngles(),e.appendChild(o)),c&&Sy(c)&&e.placeMarkerMid(c),s&&Sy(s)&&(e.markerEndAngle=s.getLocalEulerAngles(),e.appendChild(s)),e.transformMarker(!0),e.transformMarker(!1),e}return Ls(t,e),U(t,[{key:`attributeChangedCallback`,value:function(e,t,n,r,i){e===`points`?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):e===`markerStartOffset`||e===`markerEndOffset`?(this.transformMarker(!0),this.transformMarker(!1)):e===`markerStart`?(r&&Sy(r)&&(this.markerStartAngle=0,r.remove()),i&&Sy(i)&&(this.markerStartAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!0))):e===`markerEnd`?(r&&Sy(r)&&(this.markerEndAngle=0,r.remove()),i&&Sy(i)&&(this.markerEndAngle=i.getLocalEulerAngles(),this.appendChild(i),this.transformMarker(!1))):e===`markerMid`&&this.placeMarkerMid(i)}},{key:`transformMarker`,value:function(e){var t=this.parsedStyle,n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,o=t.points||{},s=o.points,c=e?n:r;if(!(!c||!Sy(c)||!s)){var l=0,u,d,f=s[0][0],p=s[0][1],m,h;if(e)u=s[1][0]-s[0][0],d=s[1][1]-s[0][1],m=i||0,h=this.markerStartAngle;else{var g=s.length;this.parsedStyle.isClosed?(u=s[g-1][0]-s[0][0],d=s[g-1][1]-s[0][1]):(f=s[g-1][0],p=s[g-1][1],u=s[g-2][0]-s[g-1][0],d=s[g-2][1]-s[g-1][1]),m=a||0,h=this.markerEndAngle}l=Math.atan2(d,u),c.setLocalEulerAngles(l*180/Math.PI+h),c.setLocalPosition(f+Math.cos(l)*m,p+Math.sin(l)*m)}}},{key:`placeMarkerMid`,value:function(e){var t=this.parsedStyle.points||{},n=t.points;if(this.markerMidList.forEach(function(e){e.remove()}),this.markerMidList=[],e&&Sy(e)&&n)for(var r=1;r<(this.parsedStyle.isClosed?n.length:n.length-1);r++){var i=n[r][0],a=n[r][1],o=r===1?e:e.cloneNode(!0);this.markerMidList.push(o),this.appendChild(o),o.setLocalPosition(i,a)}}}])}(Dy);Hy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`points`,`markerStart`,`markerMid`,`markerEnd`,`markerStartOffset`,`markerEndOffset`,`isClosed`,`isBillboard`,`isSizeAttenuation`]));var Uy=[`style`],Wy=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.style,r=Hf(e,Uy);return H(this,t),Fs(this,t,[Cs({type:K.POLYLINE,style:n,initialParsedStyle:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},r)])}return Ls(t,e),U(t,[{key:`getTotalLength`,value:function(){return Zh(this)}},{key:`getPointAtLength`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.getPoint(e/this.getTotalLength(),t)}},{key:`getPoint`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this.parsedStyle.points.points;if(this.parsedStyle.points.segments.length===0){var r=[],i=0,a,o,s=this.getTotalLength();n.forEach(function(e,t){n[t+1]&&(a=[0,0],a[0]=i/s,o=hf(e[0],e[1],n[t+1][0],n[t+1][1]),i+=o,a[1]=i/s,r.push(a))}),this.parsedStyle.points.segments=r}var c=0,l=0;this.parsedStyle.points.segments.forEach(function(t,n){e>=t[0]&&e<=t[1]&&(c=(e-t[0])/(t[1]-t[0]),l=n)});var u=gf(n[l][0],n[l][1],n[l+1][0],n[l+1][1],c),d=u.x,f=u.y,p=ll(Kc(),Yc(d,f,0),t?this.getWorldTransform():this.getLocalTransform());return new ap(p[0],p[1])}},{key:`getStartTangent`,value:function(){var e=this.parsedStyle.points.points,t=[];return t.push([e[1][0],e[1][1]]),t.push([e[0][0],e[0][1]]),t}},{key:`getEndTangent`,value:function(){var e=this.parsedStyle.points.points,t=e.length-1,n=[];return n.push([e[t-1][0],e[t-1][1]]),n.push([e[t][0],e[t][1]]),n}}])}(Hy);Wy.PARSED_STYLE_LIST=new Set([].concat(As(Hy.PARSED_STYLE_LIST),[`points`,`markerStart`,`markerMid`,`markerEnd`,`markerStartOffset`,`markerEndOffset`,`isBillboard`]));var Gy=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),Fs(this,t,[Cs({type:K.RECT},e)])}return Ls(t,e),U(t)}(Dy);Gy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),[`x`,`y`,`z`,`width`,`height`,`isBillboard`,`isSizeAttenuation`,`radius`]));var Ky=[`style`],qy=function(e){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.style,r=Hf(e,Ky);return H(this,t),Fs(this,t,[Cs({type:K.TEXT,style:Cs({fill:`black`},n)},r)])}return Ls(t,e),U(t,[{key:`getComputedTextLength`,value:function(){return this.getGeometryBounds(),this.parsedStyle.metrics?.maxLineWidth||0}},{key:`getLineBoundingRects`,value:function(){return this.getGeometryBounds(),this.parsedStyle.metrics?.lineMetrics||[]}},{key:`isOverflowing`,value:function(){return this.getGeometryBounds(),!!this.parsedStyle.isOverflowing}}])}(Dy);qy.PARSED_STYLE_LIST=new Set([].concat(As(Dy.PARSED_STYLE_LIST),`x.y.z.isBillboard.billboardRotation.isSizeAttenuation.text.textAlign.textBaseline.fontStyle.fontSize.fontFamily.fontWeight.fontVariant.lineHeight.letterSpacing.leading.wordWrap.wordWrapWidth.maxLines.textOverflow.isOverflowing.textPath.textDecorationLine.textDecorationColor.textDecorationStyle.textPathSide.textPathStartOffset.metrics.dx.dy`.split(`.`)));var Jy=function(){function e(){H(this,e),this.registry={},this.define(K.CIRCLE,Oy),this.define(K.ELLIPSE,jy),this.define(K.RECT,Gy),this.define(K.IMAGE,Iy),this.define(K.LINE,Ry),this.define(K.GROUP,Ny),this.define(K.PATH,By),this.define(K.POLYGON,Hy),this.define(K.POLYLINE,Wy),this.define(K.TEXT,qy),this.define(K.HTML,Fy)}return U(e,[{key:`define`,value:function(e,t){this.registry[e]=t}},{key:`get`,value:function(e){return this.registry[e]}}])}(),Yy=function(e){function t(){var e;H(this,t),e=Fs(this,t),e.defaultView=null,e.ownerDocument=null,e.nodeName=`document`;try{e.timeline=new Y.AnimationTimeline(e)}catch{}var n={};return Hg.forEach(function(e){var t=e.n,r=e.inh,i=e.d;r&&i&&(n[t]=W(i)?i(K.GROUP):i)}),e.documentElement=new Ny({id:`g-root`,style:n}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return Ls(t,e),U(t,[{key:`children`,get:function(){return this.childNodes}},{key:`childElementCount`,get:function(){return this.childNodes.length}},{key:`firstElementChild`,get:function(){return this.firstChild}},{key:`lastElementChild`,get:function(){return this.lastChild}},{key:`createElement`,value:function(e,t){if(e===`svg`)return this.documentElement;var n=this.defaultView.customElements.get(e);n||=(console.warn(`Unsupported tagName: `,e),e===`tspan`?qy:Ny);var r=new n(t);return r.ownerDocument=this,r}},{key:`createElementNS`,value:function(e,t,n){return this.createElement(t,n)}},{key:`cloneNode`,value:function(e){throw Error(sp)}},{key:`destroy`,value:function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}}},{key:`elementsFromBBox`,value:function(e,t,n,r){var i=this.defaultView.context.rBushRoot.search({minX:e,minY:t,maxX:n,maxY:r}),a=[];return i.forEach(function(e){var t=e.displayObject,n=t.parsedStyle.pointerEvents,r=n===void 0?`auto`:n,i=[`auto`,`visiblepainted`,`visiblefill`,`visiblestroke`,`visible`].includes(r);(!i||i&&t.isVisible())&&!t.isCulled()&&t.isInteractive()&&a.push(t)}),a.sort(function(e,t){return t.sortable.renderOrder-e.sortable.renderOrder}),a}},{key:`elementFromPointSync`,value:function(e,t){var n=this.defaultView.canvas2Viewport({x:e,y:t}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return null;var c=this.defaultView.viewport2Client({x:r,y:i}),l=c.x,u=c.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:e,y:t,viewportX:r,viewportY:i,clientX:l,clientY:u},picked:[]}),f=d.picked;return f&&f[0]||this.documentElement}},{key:`elementFromPoint`,value:function(){var e=Bf(Rf().mark(function e(t,n){var r,i,a,o,s,c,l,u,d,f,p;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.defaultView.canvas2Viewport({x:t,y:n}),i=r.x,a=r.y,o=this.defaultView.getConfig(),s=o.width,c=o.height,!(i<0||a<0||i>s||a>c)){e.next=1;break}return e.abrupt(`return`,null);case 1:return l=this.defaultView.viewport2Client({x:i,y:a}),u=l.x,d=l.y,e.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:t,y:n,viewportX:i,viewportY:a,clientX:u,clientY:d},picked:[]});case 2:return f=e.sent,p=f.picked,e.abrupt(`return`,p&&p[0]||this.documentElement);case 3:case`end`:return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:`elementsFromPointSync`,value:function(e,t){var n=this.defaultView.canvas2Viewport({x:e,y:t}),r=n.x,i=n.y,a=this.defaultView.getConfig(),o=a.width,s=a.height;if(r<0||i<0||r>o||i>s)return[];var c=this.defaultView.viewport2Client({x:r,y:i}),l=c.x,u=c.y,d=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:e,y:t,viewportX:r,viewportY:i,clientX:l,clientY:u},picked:[]}),f=d.picked;return f[f.length-1]!==this.documentElement&&f.push(this.documentElement),f}},{key:`elementsFromPoint`,value:function(){var e=Bf(Rf().mark(function e(t,n){var r,i,a,o,s,c,l,u,d,f,p;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.defaultView.canvas2Viewport({x:t,y:n}),i=r.x,a=r.y,o=this.defaultView.getConfig(),s=o.width,c=o.height,!(i<0||a<0||i>s||a>c)){e.next=1;break}return e.abrupt(`return`,[]);case 1:return l=this.defaultView.viewport2Client({x:i,y:a}),u=l.x,d=l.y,e.next=2,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:t,y:n,viewportX:i,viewportY:a,clientX:u,clientY:d},picked:[]});case 2:return f=e.sent,p=f.picked,p[p.length-1]!==this.documentElement&&p.push(this.documentElement),e.abrupt(`return`,p);case 3:case`end`:return e.stop()}},e,this)}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:`appendChild`,value:function(e,t){throw Error(cp)}},{key:`insertBefore`,value:function(e,t){throw Error(cp)}},{key:`removeChild`,value:function(e,t){throw Error(cp)}},{key:`replaceChild`,value:function(e,t,n){throw Error(cp)}},{key:`append`,value:function(){throw Error(cp)}},{key:`prepend`,value:function(){throw Error(cp)}},{key:`getElementById`,value:function(e){return this.documentElement.getElementById(e)}},{key:`getElementsByName`,value:function(e){return this.documentElement.getElementsByName(e)}},{key:`getElementsByTagName`,value:function(e){return this.documentElement.getElementsByTagName(e)}},{key:`getElementsByClassName`,value:function(e){return this.documentElement.getElementsByClassName(e)}},{key:`querySelector`,value:function(e){return this.documentElement.querySelector(e)}},{key:`querySelectorAll`,value:function(e){return this.documentElement.querySelectorAll(e)}},{key:`find`,value:function(e){return this.documentElement.find(e)}},{key:`findAll`,value:function(e){return this.documentElement.findAll(e)}}])}(Tv),Xy=function(){function e(t){H(this,e),this.strategies=t}return U(e,[{key:`apply`,value:function(t){var n=t.config,r=t.camera,i=t.renderingService,a=t.renderingContext,o=this.strategies;i.hooks.cull.tap(e.tag,function(e){if(e){var t=e.cullable;if(o.length===0?t.visible=a.unculledEntities.indexOf(e.entity)>-1:t.visible=o.every(function(t){return t.isVisible(r,e)}),!e.isCulled()&&e.isVisible())return e;var i=n.future?.experimentalCancelEventPropagation===!0;return e.dispatchEvent(new Cv(Nv.CULLED),i,i),null}return e}),i.hooks.afterRender.tap(e.tag,function(e){e.cullable.visibilityPlaneMask=-1})}}])}();Xy.tag=`Culling`;var Zy=function(){function e(){var t=this;H(this,e),this.autoPreventDefault=!1,this.rootPointerEvent=new xv(null),this.rootWheelEvent=new Sv(null),this.onPointerMove=function(e){var n,r=(n=t.context.renderingContext.root)==null||(n=n.ownerDocument)==null?void 0:n.defaultView;if(!(r.supportsTouchEvents&&e.pointerType===`touch`)){var i=t.normalizeToPointerEvent(e,r),a=Vf(i),o;try{for(a.s();!(o=a.n()).done;){var s=o.value,c=t.bootstrapEvent(t.rootPointerEvent,s,r,e);t.context.eventService.mapEvent(c)}}catch(e){a.e(e)}finally{a.f()}t.setCursor(t.context.eventService.cursor)}},this.onClick=function(e){var n,r=(n=t.context.renderingContext.root)==null||(n=n.ownerDocument)==null?void 0:n.defaultView,i=t.normalizeToPointerEvent(e,r),a=Vf(i),o;try{for(a.s();!(o=a.n()).done;){var s=o.value,c=t.bootstrapEvent(t.rootPointerEvent,s,r,e);t.context.eventService.mapEvent(c)}}catch(e){a.e(e)}finally{a.f()}t.setCursor(t.context.eventService.cursor)}}return U(e,[{key:`apply`,value:function(t){var n=this;this.context=t;var r=t.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(e){return n.context.renderingService.hooks.pickSync.call({position:e,picked:[],topmost:!0}).picked[0]||null}),r.hooks.pointerWheel.tap(e.tag,function(e){var t=n.normalizeWheelEvent(e);n.context.eventService.mapEvent(t)}),r.hooks.pointerDown.tap(e.tag,function(e){if(!(i.supportsTouchEvents&&e.pointerType===`touch`)){var t=n.normalizeToPointerEvent(e,i);n.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!(`cancelable`in e))&&e.preventDefault();var r=Vf(t),a;try{for(r.s();!(a=r.n()).done;){var o=a.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s)}}catch(e){r.e(e)}finally{r.f()}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerUp.tap(e.tag,function(e){if(!(i.supportsTouchEvents&&e.pointerType===`touch`)){var t=n.context.contextService.getDomElement(),r=n.context.eventService.isNativeEventFromCanvas(t,e)?``:`outside`,a=n.normalizeToPointerEvent(e,i),o=Vf(a),s;try{for(o.s();!(s=o.n()).done;){var c=s.value,l=n.bootstrapEvent(n.rootPointerEvent,c,i,e);l.type+=r,n.context.eventService.mapEvent(l)}}catch(e){o.e(e)}finally{o.f()}n.setCursor(n.context.eventService.cursor)}}),r.hooks.pointerMove.tap(e.tag,this.onPointerMove),r.hooks.pointerOver.tap(e.tag,this.onPointerMove),r.hooks.pointerOut.tap(e.tag,this.onPointerMove),r.hooks.click.tap(e.tag,this.onClick),r.hooks.pointerCancel.tap(e.tag,function(e){var t=n.normalizeToPointerEvent(e,i),r=Vf(t),a;try{for(r.s();!(a=r.n()).done;){var o=a.value,s=n.bootstrapEvent(n.rootPointerEvent,o,i,e);n.context.eventService.mapEvent(s)}}catch(e){r.e(e)}finally{r.f()}n.setCursor(n.context.eventService.cursor)})}},{key:`bootstrapEvent`,value:function(e,t,n,r){e.view=n,e.originalEvent=null,e.nativeEvent=r,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);var i=this.context.eventService.client2Viewport({x:t.clientX,y:t.clientY}),a=i.x,o=i.y;e.viewport.x=a,e.viewport.y=o;var s=this.context.eventService.viewport2Canvas(e.viewport),c=s.x,l=s.y;return e.canvas.x=c,e.canvas.y=l,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=r.isTrusted,e.type===`pointerleave`&&(e.type=`pointerout`),e.type.startsWith(`mouse`)&&(e.type=e.type.replace(`mouse`,`pointer`)),e.type.startsWith(`touch`)&&(e.type=w_[e.type]||e.type),e}},{key:`normalizeWheelEvent`,value:function(e){var t=this.rootWheelEvent;this.transferMouseData(t,e),t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ;var n=this.context.eventService.client2Viewport({x:e.clientX,y:e.clientY}),r=n.x,i=n.y;t.viewport.x=r,t.viewport.y=i;var a=this.context.eventService.viewport2Canvas(t.viewport),o=a.x,s=a.y;return t.canvas.x=o,t.canvas.y=s,t.global.copyFrom(t.canvas),t.offset.copyFrom(t.canvas),t.nativeEvent=e,t.type=e.type,t}},{key:`transferMouseData`,value:function(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=T_.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}},{key:`setCursor`,value:function(e){this.context.contextService.applyCursorStyle(e||this.context.config.cursor||`default`)}},{key:`normalizeToPointerEvent`,value:function(e,t){var n=[];if(t.isTouchEvent(e))for(var r=0;r<e.changedTouches.length;r++){var i=e.changedTouches[r];Eu(i.button)&&(i.button=0),Eu(i.buttons)&&(i.buttons=1),Eu(i.isPrimary)&&(i.isPrimary=e.touches.length===1&&e.type===`touchstart`),Eu(i.width)&&(i.width=i.radiusX||1),Eu(i.height)&&(i.height=i.radiusY||1),Eu(i.tiltX)&&(i.tiltX=0),Eu(i.tiltY)&&(i.tiltY=0),Eu(i.pointerType)&&(i.pointerType=`touch`),Eu(i.pointerId)&&(i.pointerId=i.identifier||0),Eu(i.pressure)&&(i.pressure=i.force||.5),Eu(i.twist)&&(i.twist=0),Eu(i.tangentialPressure)&&(i.tangentialPressure=0),i.isNormalized=!0,i.type=e.type,n.push(i)}else if(t.isMouseEvent(e)){var a=e;Eu(a.isPrimary)&&(a.isPrimary=!0),Eu(a.width)&&(a.width=1),Eu(a.height)&&(a.height=1),Eu(a.tiltX)&&(a.tiltX=0),Eu(a.tiltY)&&(a.tiltY=0),Eu(a.pointerType)&&(a.pointerType=`mouse`),Eu(a.pointerId)&&(a.pointerId=C_),Eu(a.pressure)&&(a.pressure=.5),Eu(a.twist)&&(a.twist=0),Eu(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,n.push(a)}else n.push(e);return n}}])}();Zy.tag=`Event`;var Qy=[K.CIRCLE,K.ELLIPSE,K.IMAGE,K.RECT,K.LINE,K.POLYLINE,K.POLYGON,K.TEXT,K.PATH,K.HTML],$y=function(){function e(){H(this,e)}return U(e,[{key:`isVisible`,value:function(e,t){var n,r=t.cullable;if(!r.enable)return!0;var i=t.getRenderBounds();if(tp.isEmpty(i))return!1;var a=e.getFrustum(),o=(n=t.parentNode)==null||(n=n.cullable)==null?void 0:n.visibilityPlaneMask;return r.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(t,i,o||rp.INDETERMINATE,a.planes),r.visible=r.visibilityPlaneMask!==rp.OUTSIDE,r.visible}},{key:`computeVisibilityWithPlaneMask`,value:function(e,t,n,r){if(n===rp.OUTSIDE||n===rp.INSIDE)return n;for(var i=rp.INSIDE,a=Qy.indexOf(e.nodeName)>-1,o=0,s=r.length;o<s;++o){var c=1<<o;if((n&c)!==0&&!(a&&(o===4||o===5))){var l=r[o],u=l.normal,d=l.distance;if(ol(u,t.getPositiveFarPoint(r[o]))+d<0)return rp.OUTSIDE;ol(u,t.getNegativeFarPoint(r[o]))+d<0&&(i|=c)}}return i}}])}(),eb=function(){function e(){H(this,e),this.syncTasks=new Map,this.isFirstTimeRendering=!0,this.syncing=!1,this.isFirstTimeRenderingFinished=!1}return U(e,[{key:`apply`,value:function(t){var n=this,r=t.config,i=t.renderingService,a=t.renderingContext,o=t.rBushRoot,s=a.root.ownerDocument.defaultView;this.rBush=o;var c=function(e){i.dirtify()},l=function(e){n.syncTasks.set(e.target,e.detail.affectChildren),i.dirtify()},u=function(e){var t=e.target;Y.enableSizeAttenuation&&Y.styleValueRegistry.updateSizeAttenuation(t,s.getCamera().getZoom())},d=function(e){var t=e.target,r=t.rBushNode;r!=null&&r.aabb&&n.rBush.remove(r.aabb),n.syncTasks.delete(t),Y.sceneGraphService.dirtyToRoot(t),i.dirtify()};i.hooks.init.tap(e.tag,function(){s.addEventListener(Nv.MOUNTED,u),s.addEventListener(Nv.UNMOUNTED,d),s.addEventListener(Nv.ATTR_MODIFIED,c),s.addEventListener(Nv.BOUNDS_CHANGED,l)}),i.hooks.destroy.tap(e.tag,function(){s.removeEventListener(Nv.MOUNTED,u),s.removeEventListener(Nv.UNMOUNTED,d),s.removeEventListener(Nv.ATTR_MODIFIED,c),s.removeEventListener(Nv.BOUNDS_CHANGED,l),n.syncTasks.clear()});var f=Y.globalThis.requestIdleCallback??V_.bind(Y.globalThis),p=r.future?.experimentalRICSyncRTree===!0;i.hooks.endFrame.tap(e.tag,function(){n.isFirstTimeRendering?(n.isFirstTimeRendering=!1,n.syncing=!0,f(function(){n.syncRTree(!0),n.isFirstTimeRenderingFinished=!0})):p&&Y.globalThis.requestIdleCallback&&Y.globalThis.cancelIdleCallback?(Y.globalThis.cancelIdleCallback(n.ricSyncRTreeId),n.ricSyncRTreeId=Y.globalThis.requestIdleCallback(function(){return n.syncRTree()})):n.syncRTree()})}},{key:`syncNode`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.isConnected){var n=e.rBushNode;n.aabb&&this.rBush.remove(n.aabb);var r=e.getRenderBounds();if(r){var i=e.renderable;t&&(i.dirtyRenderBounds||=new tp,i.dirtyRenderBounds.update(r.center,r.halfExtents));var a=r.getMin(),o=Vs(a,2),s=o[0],c=o[1],l=r.getMax(),u=Vs(l,2),d=u[0],f=u[1];n.aabb||={},n.aabb.displayObject=e,n.aabb.minX=s,n.aabb.minY=c,n.aabb.maxX=d,n.aabb.maxY=f}if(n.aabb&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.maxX)&&!isNaN(n.aabb.minX)&&!isNaN(n.aabb.minY))return n.aabb}}},{key:`syncRTree`,value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!(!t&&(this.syncing||this.syncTasks.size===0))){this.syncing=!0;var n=[],r=new Set,i=function(i){if(!r.has(i)&&i.renderable){var a=e.syncNode(i,t);a&&(n.push(a),r.add(i))}};this.syncTasks.forEach(function(e,t){e&&t.forEach(i);for(var n=t;n;)i(n),n=n.parentElement}),this.rBush.load(n),n.length=0,this.syncing=!1}}}])}();eb.tag=`Prepare`;var tb=function(e){return e.READY=`ready`,e.BEFORE_RENDER=`beforerender`,e.RERENDER=`rerender`,e.AFTER_RENDER=`afterrender`,e.BEFORE_DESTROY=`beforedestroy`,e.AFTER_DESTROY=`afterdestroy`,e.RESIZE=`resize`,e.DIRTY_RECTANGLE=`dirtyrectangle`,e.RENDERER_CHANGED=`rendererchanged`,e}({}),nb=500,rb=.1,ib=1e3,ab=new Cv(Nv.MOUNTED),ob=new Cv(Nv.UNMOUNTED),sb=new Cv(tb.BEFORE_RENDER),cb=new Cv(tb.RERENDER),lb=new Cv(tb.AFTER_RENDER),ub=function(e){function t(e){var n;H(this,t),n=Fs(this,t),n.Element=Dy,n.inited=!1,n.context={};var r=e.container,i=e.canvas,a=e.renderer,o=e.width,s=e.height,c=e.background,l=e.cursor,u=e.supportsMutipleCanvasesInOneContainer,d=e.cleanUpOnDestroy,f=d===void 0?!0:d,p=e.offscreenCanvas,m=e.devicePixelRatio,h=e.requestAnimationFrame,g=e.cancelAnimationFrame,_=e.createImage,v=e.supportsTouchEvents,y=e.supportsPointerEvents,b=e.isTouchEvent,x=e.isMouseEvent,S=e.dblClickSpeed,C=o,w=s,T=m||p_&&window.devicePixelRatio||1;return T=T>=1?Math.ceil(T):1,i&&(C=o||x_(i)||i.width/T,w=s||S_(i)||i.height/T),n.customElements=new Jy,n.devicePixelRatio=T,n.requestAnimationFrame=h??V_.bind(Y.globalThis),n.cancelAnimationFrame=g??H_.bind(Y.globalThis),n.createImage=_??function(){return new window.Image},n.supportsTouchEvents=v??`ontouchstart`in Y.globalThis,n.supportsPointerEvents=y??!!Y.globalThis.PointerEvent,n.isTouchEvent=b??function(e){return n.supportsTouchEvents&&e instanceof Y.globalThis.TouchEvent},n.isMouseEvent=x??function(e){return!Y.globalThis.MouseEvent||e instanceof Y.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(e instanceof Y.globalThis.PointerEvent))},p&&(Y.offscreenCanvas=p),n.document=new Yy,n.document.defaultView=n,u||f_(r,n,f),n.initRenderingContext(Cs(Cs({},e),{},{width:C,height:w,background:c??`transparent`,cursor:l??`default`,cleanUpOnDestroy:f,devicePixelRatio:T,requestAnimationFrame:n.requestAnimationFrame,cancelAnimationFrame:n.cancelAnimationFrame,createImage:n.createImage,supportsTouchEvents:n.supportsTouchEvents,supportsPointerEvents:n.supportsPointerEvents,isTouchEvent:n.isTouchEvent,isMouseEvent:n.isMouseEvent,dblClickSpeed:S??200})),n.initDefaultCamera(C,w,a.clipSpaceNearZ),n.initRenderer(a,!0),n}return Ls(t,e),U(t,[{key:`initRenderingContext`,value:function(e){this.context.config=e,this.context.renderingContext={root:this.document.documentElement,unculledEntities:[],renderListCurrentFrame:[],renderReasons:new Set,force:!1,dirty:!1}}},{key:`initDefaultCamera`,value:function(e,t,n){var r=this,i=new Y.CameraContribution;i.clipSpaceNearZ=n,i.setType(Pp.EXPLORING,Fp.DEFAULT).setPosition(e/2,t/2,nb).setFocalPoint(e/2,t/2,0).setOrthographic(e/-2,e/2,t/2,t/-2,rb,ib),i.canvas=this,i.eventEmitter.on(Lp.UPDATED,function(){r.context.renderingContext.renderReasons.add(kv.CAMERA_CHANGED),Y.enableSizeAttenuation&&r.getConfig().renderer.getConfig().enableSizeAttenuation&&r.updateSizeAttenuation()}),this.context.camera=i}},{key:`updateSizeAttenuation`,value:function(){var e=this.getCamera().getZoom();this.document.documentElement.forEach(function(t){Y.styleValueRegistry.updateSizeAttenuation(t,e)})}},{key:`getConfig`,value:function(){return this.context.config}},{key:`getRoot`,value:function(){return this.document.documentElement}},{key:`getCamera`,value:function(){return this.context.camera}},{key:`getContextService`,value:function(){return this.context.contextService}},{key:`getEventService`,value:function(){return this.context.eventService}},{key:`getRenderingService`,value:function(){return this.context.renderingService}},{key:`getRenderingContext`,value:function(){return this.context.renderingContext}},{key:`getStats`,value:function(){return this.getRenderingService().getStats()}},{key:`ready`,get:function(){var e=this;return this.readyPromise||(this.readyPromise=new Promise(function(t){e.resolveReadyPromise=function(){t(e)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise}},{key:`destroy`,value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=arguments.length>1?arguments[1]:void 0;Nm.clearCache();var n=this.getConfig().future?.experimentalCancelEventPropagation===!0;t||this.dispatchEvent(new Cv(tb.BEFORE_DESTROY),n,n),this.frameId&&this.cancelAnimationFrame(this.frameId);var r=this.getRoot();e&&(this.unmountChildren(r),this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),this.context.rBushRoot&&this.context.rBushRoot.clear(),t||this.dispatchEvent(new Cv(tb.AFTER_DESTROY),n,n);var i=function(e){e.currentTarget=null,e.manager=null,e.target=null,e.relatedNode=null};i(ab),i(ob),i(sb),i(cb),i(lb),i(wy),i(vy),i(yy),i(by),Y.textService.clearCache()}},{key:`changeSize`,value:function(e,t){this.resize(e,t)}},{key:`resize`,value:function(e,t){var n=this.context.config;n.width=e,n.height=t,this.getContextService().resize(e,t);var r=this.context.camera,i=r.getProjectionMode();r.setPosition(e/2,t/2,nb).setFocalPoint(e/2,t/2,0),i===Ip.ORTHOGRAPHIC?r.setOrthographic(e/-2,e/2,t/2,t/-2,r.getNear(),r.getFar()):r.setAspect(e/t);var a=n.future?.experimentalCancelEventPropagation===!0;this.dispatchEvent(new Cv(tb.RESIZE,{width:e,height:t}),a,a)}},{key:`appendChild`,value:function(e,t){return this.document.documentElement.appendChild(e,t)}},{key:`insertBefore`,value:function(e,t){return this.document.documentElement.insertBefore(e,t)}},{key:`removeChild`,value:function(e){return this.document.documentElement.removeChild(e)}},{key:`removeChildren`,value:function(){this.document.documentElement.removeChildren()}},{key:`destroyChildren`,value:function(){this.document.documentElement.destroyChildren()}},{key:`render`,value:function(e){var t=this;e&&(sb.detail=e,lb.detail=e);var n=this.getConfig().future?.experimentalCancelEventPropagation===!0;this.dispatchEvent(sb,n,n),this.getRenderingService().render(this.getConfig(),e,function(){t.dispatchEvent(cb,n,n)}),this.dispatchEvent(lb,n,n)}},{key:`run`,value:function(){var e=this,t=function(n,r){e.render(r),e.frameId=e.requestAnimationFrame(t)};t()}},{key:`initRenderer`,value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!e)throw Error(`Renderer is required.`);this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new Gf,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new Zy,new eb,new Xy([new $y])),this.loadRendererContainerModule(e),this.context.contextService=new this.context.ContextService(Cs(Cs({},Y),this.context)),this.context.renderingService=new Av(Y,this.context),this.context.eventService=new Dv(Y,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(e,n,!0)):this.context.contextService.initAsync().then(function(){t.initRenderingService(e,n)}).catch(function(e){console.error(e)})}},{key:`initRenderingService`,value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.context.renderingService.init(function(){t.inited=!0;var i=t.getConfig().future?.experimentalCancelEventPropagation===!0;n?r?t.requestAnimationFrame(function(){t.dispatchEvent(new Cv(tb.READY),i,i)}):t.dispatchEvent(new Cv(tb.READY),i,i):t.dispatchEvent(new Cv(tb.RENDERER_CHANGED),i,i),t.readyPromise&&t.resolveReadyPromise(),n||t.getRoot().forEach(function(e){var t,n;(t=(n=e).dirty)==null||t.call(n,!0,!0)}),t.mountChildren(t.getRoot()),e.getConfig().enableAutoRendering&&t.run()})}},{key:`loadRendererContainerModule`,value:function(e){var t=this;e.getPlugins().forEach(function(e){e.context=t.context,e.init(Y)})}},{key:`setRenderer`,value:function(e){var t=this.getConfig();if(t.renderer!==e){var n=t.renderer;t.renderer=e,this.destroy(!1,!0),As(n?.getPlugins()||[]).reverse().forEach(function(e){e.destroy(Y)}),this.initRenderer(e)}}},{key:`setCursor`,value:function(e){var t=this.getConfig();t.cursor=e,this.getContextService().applyCursorStyle(e)}},{key:`unmountChildren`,value:function(e){var t=this;if(e.childNodes.forEach(function(e){t.unmountChildren(e)}),this.inited){if(e.isMutationObserved)e.dispatchEvent(ob);else{var n=this.getConfig().future?.experimentalCancelEventPropagation===!0;ob.target=e,this.dispatchEvent(ob,!0,n)}e!==this.document.documentElement&&(e.ownerDocument=null),e.isConnected=!1}e.isCustomElement&&e.disconnectedCallback&&e.disconnectedCallback()}},{key:`mountChildren`,value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E_(e);if(this.inited){if(!e.isConnected&&(e.ownerDocument=this.document,e.isConnected=!0,!n))if(e.isMutationObserved)e.dispatchEvent(ab);else{var r=this.getConfig().future?.experimentalCancelEventPropagation===!0;ab.target=e,this.dispatchEvent(ab,!0,r)}}else console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.",`appended child: `,e.nodeName);e.childNodes.forEach(function(e){t.mountChildren(e,n)}),e.isCustomElement&&e.connectedCallback&&e.connectedCallback()}},{key:`mountFragment`,value:function(e){this.mountChildren(e,!1)}},{key:`client2Viewport`,value:function(e){return this.getEventService().client2Viewport(e)}},{key:`viewport2Client`,value:function(e){return this.getEventService().viewport2Client(e)}},{key:`viewport2Canvas`,value:function(e){return this.getEventService().viewport2Canvas(e)}},{key:`canvas2Viewport`,value:function(e){return this.getEventService().canvas2Viewport(e)}},{key:`getPointByClient`,value:function(e,t){return this.client2Viewport({x:e,y:t})}},{key:`getClientByPoint`,value:function(e,t){return this.viewport2Client({x:e,y:t})}}])}(wv);Y.CameraContribution=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.landmarks=[],e}return Ls(t,e),U(t,[{key:`rotate`,value:function(e,t,n){if(this.relElevation=up(t),this.relAzimuth=up(e),this.relRoll=up(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Pp.EXPLORING){var r=Cl(Sl(),[1,0,0],mp((this.rotateWorld?1:-1)*this.relElevation)),i=Cl(Sl(),[0,1,0],mp((this.rotateWorld?1:-1)*this.relAzimuth)),a=Cl(Sl(),[0,0,1],mp(this.relRoll)),o=wl(Sl(),i,r);o=wl(Sl(),o,a);var s=Tc(Js(),o);ac(this.matrix,this.matrix,[0,0,-this.distance]),ic(this.matrix,this.matrix,s),ac(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Pp.ORBITING||this.type===Pp.EXPLORING?this._getPosition():this.type===Pp.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:`pan`,value:function(e,t){var n=fp(e,t,0),r=qc(this.position);return Qc(r,r,rl(Kc(),this.right,n[0])),Qc(r,r,rl(Kc(),this.up,n[1])),this._setPosition(r),this.triggerUpdate(),this}},{key:`dolly`,value:function(e){var t=this.forward,n=qc(this.position),r=e*this.dollyingStep,i=this.distance+e*this.dollyingStep;return r=Math.max(Math.min(i,this.maxDistance),this.minDistance)-this.distance,n[0]+=r*t[0],n[1]+=r*t[1],n[2]+=r*t[2],this._setPosition(n),this.type===Pp.ORBITING||this.type===Pp.EXPLORING?this._getDistance():this.type===Pp.TRACKING&&Qc(this.focalPoint,n,this.distanceVector),this.triggerUpdate(),this}},{key:`cancelLandmarkAnimation`,value:function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:`createLandmark`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.position,r=n===void 0?this.position:n,i=t.focalPoint,a=i===void 0?this.focalPoint:i,o=t.roll,s=t.zoom,c=new Y.CameraContribution;c.setType(this.type,void 0),c.setPosition(r[0],r[1]??this.position[1],r[2]??this.position[2]),c.setFocalPoint(a[0],a[1]??this.focalPoint[1],a[2]??this.focalPoint[2]),c.setRoll(o??this.roll),c.setZoom(s??this.zoom);var l={name:e,matrix:Ys(c.getWorldTransform()),right:qc(c.right),up:qc(c.up),forward:qc(c.forward),position:qc(c.getPosition()),focalPoint:qc(c.getFocalPoint()),distanceVector:qc(c.getDistanceVector()),distance:c.getDistance(),dollyingStep:c.getDollyingStep(),azimuth:c.getAzimuth(),elevation:c.getElevation(),roll:c.getRoll(),relAzimuth:c.relAzimuth,relElevation:c.relElevation,relRoll:c.relRoll,zoom:c.getZoom()};return this.landmarks.push(l),l}},{key:`gotoLandmark`,value:function(e){var t=this,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=ru(e)?this.landmarks.find(function(t){return t.name===e}):e;if(r){var i=G(n)?{duration:n}:n,a=i.easing,o=a===void 0?`linear`:a,s=i.duration,c=s===void 0?100:s,l=i.easingFunction,u=l===void 0?void 0:l,d=i.onfinish,f=d===void 0?void 0:d,p=i.onframe,m=p===void 0?void 0:p,h=.01;this.cancelLandmarkAnimation();var g=r.position,_=r.focalPoint,v=r.zoom,y=r.roll,b=u||Y.EasingFunction(o),x,S=function(){t.setFocalPoint(_),t.setPosition(g),t.setRoll(y),t.setZoom(v),t.computeMatrix(),t.triggerUpdate(),f?.()};if(c===0)return S();var C=function(e){x===void 0&&(x=e);var n=e-x;if(n>=c){S();return}var r=b(n/c),i=Kc(),a=Kc(),o=1,s=0;if(cl(i,t.focalPoint,_,r),cl(a,t.position,g,r),s=t.roll*(1-r)+y*r,o=t.zoom*(1-r)+v*r,t.setFocalPoint(i),t.setPosition(a),t.setRoll(s),t.setZoom(o),ml(i,_)+ml(a,g)<=h&&v===void 0&&y===void 0)return S();t.computeMatrix(),t.triggerUpdate(),n<c&&(m?.(r),t.landmarkAnimationID=t.canvas.requestAnimationFrame(C))};this.canvas.requestAnimationFrame(C)}}}])}(zp);var db=function(e){function t(e,n,r,i){var a;return H(this,t),a=Fs(this,t,[e]),a.currentTime=r,a.timelineTime=i,a.target=n,a.type=`finish`,a.bubbles=!1,a.currentTarget=n,a.defaultPrevented=!1,a.eventPhase=a.AT_TARGET,a.timeStamp=Date.now(),a.currentTime=r,a.timelineTime=i,a}return Ls(t,e),U(t)}(yv),fb=0,pb=function(){function e(t,n){H(this,e),this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=t,t.animation=this,this.timeline=n,this.id=`${fb++}`,this._inEffect=!!this.effect.update(0),this._totalDuration=Number(this.effect?.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState=`idle`,this.updatePromises()}return U(e,[{key:`pending`,get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending}},{key:`playState`,get:function(){return this._idle?`idle`:this._isFinished?`finished`:this._paused?`paused`:`running`}},{key:`ready`,get:function(){var e=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(t,n){e.resolveReadyPromise=function(){t(e)},e.rejectReadyPromise=function(){n(Error())}}),this.pending||this.resolveReadyPromise()),this.readyPromise}},{key:`finished`,get:function(){var e=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(t,n){e.resolveFinishedPromise=function(){t(e)},e.rejectFinishedPromise=function(){n(Error())}}),this.playState===`finished`&&this.resolveFinishedPromise()),this.finishedPromise}},{key:`currentTime`,get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(e){e=Number(e),!isNaN(e)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number(this.timeline?.currentTime)-e/this.playbackRate),this.currentTimePending=!1,this._currentTime!==e&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(e,!0),this.timeline.applyDirtiedAnimation(this)))}},{key:`startTime`,get:function(){return this._startTime},set:function(e){if(e!==null){if(this.updatePromises(),e=Number(e),isNaN(e)||this._paused||this._idle)return;this._startTime=e,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}}},{key:`playbackRate`,get:function(){return this._playbackRate},set:function(e){if(e!==this._playbackRate){this.updatePromises();var t=this.currentTime;this._playbackRate=e,this.startTime=null,this.playState!==`paused`&&this.playState!==`idle`&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),t!==null&&(this.currentTime=t),this.updatePromises()}}},{key:`_isFinished`,get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)}},{key:`totalDuration`,get:function(){return this._totalDuration}},{key:`_needsTick`,get:function(){return this.pending||this.playState===`running`||!this._finishedFlag}},{key:`updatePromises`,value:function(){var e;if((e=this.effect.target)!=null&&e.destroyed)return this.readyPromise=void 0,this.finishedPromise=void 0,!1;var t=this.oldPlayState,n=this.pending?`pending`:this.playState;return this.readyPromise&&n!==t&&(n===`idle`?(this.rejectReadyPromise(),this.readyPromise=void 0):t===`pending`?this.resolveReadyPromise():n===`pending`&&(this.readyPromise=void 0)),this.finishedPromise&&n!==t&&(n===`idle`?(this.rejectFinishedPromise(),this.finishedPromise=void 0):n===`finished`?this.resolveFinishedPromise():t===`finished`&&(this.finishedPromise=void 0)),this.oldPlayState=n,this.readyPromise||this.finishedPromise}},{key:`play`,value:function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()}},{key:`pause`,value:function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&=(this.rewind(),!1),this._startTime=null,this._paused=!0,this.updatePromises()}},{key:`finish`,value:function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())}},{key:`cancel`,value:function(){var e=this;if(this.updatePromises(),this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var t=new db(null,this,this.currentTime,null);setTimeout(function(){e.oncancel(t)})}}},{key:`reverse`,value:function(){this.updatePromises();var e=this.currentTime;this.playbackRate*=-1,this.play(),e!==null&&(this.currentTime=e),this.updatePromises()}},{key:`updatePlaybackRate`,value:function(e){this.playbackRate=e}},{key:`targetAnimations`,value:function(){return(this.effect?.target).getAnimations()}},{key:`markTarget`,value:function(){var e=this.targetAnimations();e.indexOf(this)===-1&&e.push(this)}},{key:`unmarkTarget`,value:function(){var e=this.targetAnimations(),t=e.indexOf(this);t!==-1&&e.splice(t,1)}},{key:`tick`,value:function(e,t){!this._idle&&!this._paused&&(this._startTime===null?t&&(this.startTime=e-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((e-this._startTime)*this.playbackRate)),t&&(this.currentTimePending=!1,this.fireEvents(e))}},{key:`rewind`,value:function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw Error(`Unable to rewind negative playback rate animation with infinite duration`)}},{key:`persist`,value:function(){throw Error(sp)}},{key:`addEventListener`,value:function(e,t,n){throw Error(sp)}},{key:`removeEventListener`,value:function(e,t,n){throw Error(sp)}},{key:`dispatchEvent`,value:function(e){throw Error(sp)}},{key:`commitStyles`,value:function(){throw Error(sp)}},{key:`ensureAlive`,value:function(){if(this.playbackRate<0&&this.currentTime===0){var e;this._inEffect=!!((e=this.effect)!=null&&e.update(-1))}else{var t;this._inEffect=!!((t=this.effect)!=null&&t.update(this.currentTime))}!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))}},{key:`tickCurrentTime`,value:function(e,t){e!==this._currentTime&&(this._currentTime=e,this._isFinished&&!t&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())}},{key:`fireEvents`,value:function(e){var t=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new db(null,this,this.currentTime,e);setTimeout(function(){t.onfinish&&t.onfinish(n)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState===`running`){var r=new db(null,this,this.currentTime,e);this.onframe(r)}this._finishedFlag=!1}}}])}(),mb=4,hb=.001,gb=1e-7,_b=10,vb=11,yb=1/(vb-1),bb=typeof Float32Array==`function`,xb=function(e,t){return 1-3*t+3*e},Sb=function(e,t){return 3*t-6*e},Cb=function(e){return 3*e},wb=function(e,t,n){return((xb(t,n)*e+Sb(t,n))*e+Cb(t))*e},Tb=function(e,t,n){return 3*xb(t,n)*e*e+2*Sb(t,n)*e+Cb(t)},Eb=function(e,t,n,r,i){var a,o,s=0;do o=t+(n-t)/2,a=wb(o,r,i)-e,a>0?n=o:t=o;while(Math.abs(a)>gb&&++s<_b);return o},Db=function(e,t,n,r){for(var i=0;i<mb;++i){var a=Tb(t,n,r);if(a===0)return t;var o=wb(t,n,r)-e;t-=o/a}return t},Ob=function(e,t,n,r){if(!(e>=0&&e<=1&&n>=0&&n<=1))throw Error(`bezier x values must be in [0, 1] range`);if(e===t&&n===r)return function(e){return e};for(var i=bb?new Float32Array(vb):Array(vb),a=0;a<vb;++a)i[a]=wb(a*yb,e,n);var o=function(t){for(var r=0,a=1,o=vb-1;a!==o&&i[a]<=t;++a)r+=yb;--a;var s=(t-i[a])/(i[a+1]-i[a]),c=r+s*yb,l=Tb(c,e,n);return l>=hb?Db(t,c,e,n):l===0?c:Eb(t,r,r+yb,e,n)};return function(e){return e===0||e===1?e:wb(o(e),t,r)}},kb=function(e){return e=e.replace(/([A-Z])/g,function(e){return`-${e.toLowerCase()}`}),e.charAt(0)===`-`?e.substring(1):e},Ab=function(e){return e**2},jb=function(e){return e**3},Mb=function(e){return e**4},Nb=function(e){return e**5},Pb=function(e){return e**6},Fb=function(e){return 1-Math.cos(e*Math.PI/2)},Ib=function(e){return 1-Math.sqrt(1-e*e)},Lb=function(e){return e*e*(3*e-2)},Rb=function(e){for(var t,n=4;e<((t=2**--n)-1)/11;);return 1/4**(3-n)-7.5625*((t*3-2)/22-e)**2},zb=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=Vs(t,2),r=n[0],i=r===void 0?1:r,a=n[1],o=a===void 0?.5:a,s=cu(Number(i),1,10),c=cu(Number(o),.1,2);return e===0||e===1?e:-s*2**(10*(e-1))*Math.sin((e-1-c/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/c)},Bb=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=Vs(t,4),i=r[0],a=i===void 0?1:i,o=r[1],s=o===void 0?100:o,c=r[2],l=c===void 0?10:c,u=r[3],d=u===void 0?0:u;a=cu(a,.1,1e3),s=cu(s,.1,1e3),l=cu(l,.1,1e3),d=cu(d,.1,1e3);var f=Math.sqrt(s/a),p=l/(2*Math.sqrt(s*a)),m=p<1?f*Math.sqrt(1-p*p):0,h=1,g=p<1?(p*f+-d)/m:-d+f,_=n?n*e/1e3:e;return _=p<1?Math.exp(-_*p*f)*(h*Math.cos(m*_)+g*Math.sin(m*_)):(h+g*_)*Math.exp(-_*f),e===0||e===1?e:1-_},Vb=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=Vs(t,2),r=n[0],i=r===void 0?10:r;return(n[1]===`start`?Math.ceil:Math.floor)(cu(e,0,1)*i)/i},Hb=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=Vs(t,4),r=n[0],i=n[1],a=n[2],o=n[3];return Ob(r,i,a,o)(e)},Ub=Ob(.42,0,1,1),Wb=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return 1-e(1-t,n,r)}},Gb=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return t<.5?e(t*2,n,r)/2:1-e(t*-2+2,n,r)/2}},Kb=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;return t<.5?(1-e(1-t*2,n,r))/2:(e(t*2-1,n,r)+1)/2}},qb={steps:Vb,"step-start":function(e){return Vb(e,[1,`start`])},"step-end":function(e){return Vb(e,[1,`end`])},linear:function(e){return e},"cubic-bezier":Hb,ease:function(e){return Hb(e,[.25,.1,.25,1])},in:Ub,out:Wb(Ub),"in-out":Gb(Ub),"out-in":Kb(Ub),"in-quad":Ab,"out-quad":Wb(Ab),"in-out-quad":Gb(Ab),"out-in-quad":Kb(Ab),"in-cubic":jb,"out-cubic":Wb(jb),"in-out-cubic":Gb(jb),"out-in-cubic":Kb(jb),"in-quart":Mb,"out-quart":Wb(Mb),"in-out-quart":Gb(Mb),"out-in-quart":Kb(Mb),"in-quint":Nb,"out-quint":Wb(Nb),"in-out-quint":Gb(Nb),"out-in-quint":Kb(Nb),"in-expo":Pb,"out-expo":Wb(Pb),"in-out-expo":Gb(Pb),"out-in-expo":Kb(Pb),"in-sine":Fb,"out-sine":Wb(Fb),"in-out-sine":Gb(Fb),"out-in-sine":Kb(Fb),"in-circ":Ib,"out-circ":Wb(Ib),"in-out-circ":Gb(Ib),"out-in-circ":Kb(Ib),"in-back":Lb,"out-back":Wb(Lb),"in-out-back":Gb(Lb),"out-in-back":Kb(Lb),"in-bounce":Rb,"out-bounce":Wb(Rb),"in-out-bounce":Gb(Rb),"out-in-bounce":Kb(Rb),"in-elastic":zb,"out-elastic":Wb(zb),"in-out-elastic":Gb(zb),"out-in-elastic":Kb(zb),spring:Bb,"spring-in":Bb,"spring-out":Wb(Bb),"spring-in-out":Gb(Bb),"spring-out-in":Kb(Bb)},Jb=function(e){return kb(e).replace(/^ease-/,``).replace(/(\(|\s).+/,``).toLowerCase().trim()},Yb=function(e){return qb[Jb(e)]||qb.linear},Xb=function(e){return e},Zb=1,Qb=.5,$b=0;function ex(e,t){return function(n){if(n>=1)return 1;var r=1/e;return n+=t*r,n-n%r}}var tx=`\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*`,nx=RegExp(`cubic-bezier\\(${tx},${tx},${tx},${tx}\\)`),rx=/steps\(\s*(\d+)\s*\)/,ix=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function ax(e){var t=nx.exec(e);if(t)return Ob.apply(void 0,As(t.slice(1).map(Number)));var n=rx.exec(e);if(n)return ex(Number(n[1]),$b);var r=ix.exec(e);return r?ex(Number(r[1]),{start:Zb,middle:Qb,end:$b}[r[2]]):Yb(e)}function ox(e){return Math.abs(sx(e)/(e.playbackRate||1))}function sx(e){return e.duration===0||e.iterations===0?0:(e.duration===`auto`?0:Number(e.duration))*(e.iterations??1)}var cx=0,lx=1,ux=2,dx=3;function fx(e,t,n){if(t===null)return cx;var r=n.endTime;return t<Math.min(n.delay,r)?lx:t>=Math.min(n.delay+e+n.endDelay,r)?ux:dx}function px(e,t,n,r,i){switch(r){case lx:return t===`backwards`||t===`both`?0:null;case dx:return n-i;case ux:return t===`forwards`||t===`both`?e:null;case cx:return null}}function mx(e,t,n,r,i){var a=i;return e===0?t!==lx&&(a+=n):a+=r/e,a}function hx(e,t,n,r,i,a){var o=e===1/0?t%1:e%1;return o===0&&n===ux&&r!==0&&(i!==0||a===0)&&(o=1),o}function gx(e,t,n,r){return e===ux&&t===1/0?1/0:n===1?Math.floor(r)-1:Math.floor(r)}function _x(e,t,n){var r=e;if(e!==`normal`&&e!==`reverse`){var i=t;e===`alternate-reverse`&&(i+=1),r=`normal`,i!==1/0&&i%2!=0&&(r=`reverse`)}return r===`normal`?n:1-n}function vx(e,t,n){var r=fx(e,t,n),i=px(e,n.fill,t,r,n.delay);if(i===null)return null;var a=n.duration===`auto`?0:n.duration,o=mx(a,r,n.iterations,i,n.iterationStart),s=hx(o,n.iterationStart,r,n.iterations,i,a),c=gx(r,n.iterations,s,o),l=_x(n.direction,c,s);return n.currentIteration=c,n.progress=l,n.easingFunction(l)}function yx(e,t,n){var r=xx(e,t),i=Sx(r,n);return function(e,t){if(t!==null)i.filter(function(e){return t>=e.applyFrom&&t<e.applyTo}).forEach(function(n){var r=t-n.startOffset,i=n.endOffset-n.startOffset,a=i===0?0:r/i;e.setAttribute(n.property,n.interpolation(a),!1,!1)});else for(var n in r)bx(n)&&e.setAttribute(n,null)}}function bx(e){return e!==`offset`&&e!==`easing`&&e!==`composite`&&e!==`computedOffset`}function xx(e,t){for(var n={},r=0;r<e.length;r++)for(var i in e[r])if(bx(i)){var a={offset:e[r].offset,computedOffset:e[r].computedOffset,easing:e[r].easing,easingFunction:ax(e[r].easing)||t.easingFunction,value:e[r][i]};n[i]=n[i]||[],n[i].push(a)}return n}function Sx(e,t){var n=[];for(var r in e)for(var i=e[r],a=0;a<i.length-1;a++){var o=a,s=a+1,c=i[o].computedOffset,l=i[s].computedOffset,u=c,d=l;a===0&&(u=-1/0,l===0&&(s=o)),a===i.length-2&&(d=1/0,c===1&&(o=s)),n.push({applyFrom:u,applyTo:d,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:r,interpolation:wx(r,i[o].value,i[s].value,t)})}return n.sort(function(e,t){return e.startOffset-t.startOffset}),n}var Cx=function(e,t,n){return function(r){var i=Tx(e,t,r);return G(i)?i:n(i)}};function wx(e,t,n,r){var i=Wg[e];if(i&&i.syntax&&i.int){var a=Y.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=a.parser,s=o?o(t,r):t,c=o?o(n,r):n,l=a.mixer(s,c,r);if(l){var u=Cx.apply(void 0,As(l));return function(e){return e===0?t:e===1?n:u(e)}}}}return Cx(!1,!0,function(e){return e?n:t})}function Tx(e,t,n){if(typeof e==`number`&&typeof t==`number`)return e*(1-n)+t*n;if(typeof e==`boolean`&&typeof t==`boolean`||typeof e==`string`&&typeof t==`string`)return n<.5?e:t;if(Array.isArray(e)&&Array.isArray(t)){for(var r=e.length,i=t.length,a=Math.max(r,i),o=[],s=0;s<a;s++)o.push(Tx(e[s<r?s:r-1],t[s<i?s:i-1],n));return o}throw Error(`Mismatched interpolation arguments ${e}:${t}`)}var Ex=function(){function e(){H(this,e),this.delay=0,this.direction=`normal`,this.duration=`auto`,this._easing=`linear`,this.easingFunction=Xb,this.endDelay=0,this.fill=`auto`,this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return U(e,[{key:`easing`,get:function(){return this._easing},set:function(e){this.easingFunction=ax(e),this._easing=e}}])}();function Dx(e){var t=[];for(var n in e){if(n in[`easing`,`offset`,`composite`])continue;var r=e[n];Array.isArray(r)||(r=[r]);for(var i=r.length,a=0;a<i;a++){if(!t[a]){var o={};`offset`in e&&(o.offset=Number(e.offset)),`easing`in e&&(o.easing=e.easing),`composite`in e&&(o.composite=e.composite),t[a]=o}r[a]!==void 0&&r[a]!==null&&(t[a][n]=r[a])}}return t.sort(function(e,t){return(e.computedOffset||0)-(t.computedOffset||0)}),t}function Ox(e,t){if(e===null)return[];Array.isArray(e)||(e=Dx(e));for(var n=e.map(function(e){var n={};for(var r in t!=null&&t.composite&&(n.composite=`auto`),e){var i=e[r];if(r===`offset`){if(i!==null){if(i=Number(i),!isFinite(i))throw Error(`Keyframe offsets must be numbers.`);if(i<0||i>1)throw Error(`Keyframe offsets must be between 0 and 1.`);n.computedOffset=i}}else if(r===`composite`&&[`replace`,`add`,`accumulate`,`auto`].indexOf(i)===-1)throw Error(`${i} compositing is not supported`);n[r]=i}return n.offset===void 0&&(n.offset=null),n.easing===void 0&&(n.easing=t?.easing||`linear`),n.composite===void 0&&(n.composite=`auto`),n}),r=!0,i=-1/0,a=0;a<n.length;a++){var o=n[a].offset;if(Wl(o))r=!1;else{if(o<i)throw TypeError(`Keyframes are not loosely sorted by offset. Sort or specify offsets.`);i=o}}n=n.filter(function(e){return Number(e.offset)>=0&&Number(e.offset)<=1});function s(){var e=n,t=e.length;n[t-1].computedOffset=Number(n[t-1].offset??1),t>1&&(n[0].computedOffset=Number(n[0].offset??0));for(var r=0,i=Number(n[0].computedOffset),a=1;a<t;a++){var o=n[a].computedOffset;if(!Wl(o)&&!Wl(i)){for(var s=1;s<a-r;s++)n[r+s].computedOffset=i+(Number(o)-i)*s/(a-r);r=a,i=Number(o)}}}return r||s(),n}var kx=`backwards|forwards|both|none`.split(`|`),Ax=`reverse|alternate|alternate-reverse`.split(`|`);function jx(e,t){var n=new Ex;return t&&(n.fill=`both`,n.duration=`auto`),typeof e==`number`&&!isNaN(e)?n.duration=e:e!==void 0&&Object.keys(e).forEach(function(t){if(e[t]!==void 0&&e[t]!==null&&e[t]!==`auto`){if((typeof n[t]==`number`||t===`duration`)&&(typeof e[t]!=`number`||isNaN(e[t]))||t===`fill`&&kx.indexOf(e[t])===-1||t===`direction`&&Ax.indexOf(e[t])===-1)return;n[t]=e[t]}}),n}function Mx(e,t){return e=Nx(e??{duration:`auto`}),jx(e,t)}function Nx(e){return typeof e==`number`&&(e=isNaN(e)?{duration:`auto`}:{duration:e}),e}var Px=function(){function e(t,n,r){var i=this;H(this,e),this.composite=`replace`,this.iterationComposite=`replace`,this.target=t,this.timing=Mx(r,!1),this.timing.effect=this,this.timing.activeDuration=ox(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=Ox(n,this.timing),this.interpolations=yx(this.normalizedKeyframes,this.timing,this.target);var a=Y.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(e,t){return t===`duration`?e.duration===`auto`?0:e.duration:t===`fill`?e.fill===`auto`?`none`:e.fill:t===`localTime`?i.animation&&i.animation.currentTime||null:t===`currentIteration`?!i.animation||i.animation.playState!==`running`?null:e.currentIteration||0:t===`progress`?!i.animation||i.animation.playState!==`running`?null:e.progress||0:e[t]},set:function(){return!0}}):this.timing}return U(e,[{key:`applyInterpolations`,value:function(){this.interpolations(this.target,Number(this.timeFraction))}},{key:`update`,value:function(e){return e===null?!1:(this.timeFraction=vx(this.timing.activeDuration,e,this.timing),this.timeFraction!==null)}},{key:`getKeyframes`,value:function(){return this.normalizedKeyframes}},{key:`setKeyframes`,value:function(e){this.normalizedKeyframes=Ox(e)}},{key:`getComputedTiming`,value:function(){return this.computedTiming}},{key:`getTiming`,value:function(){return this.timing}},{key:`updateTiming`,value:function(e){var t=this;Object.keys(e||{}).forEach(function(n){t.timing[n]=e[n]})}}])}();function Fx(e,t){return Number(e.id)-Number(t.id)}var Ix=function(){function e(t){var n=this;H(this,e),this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(e){n.currentTime=e,n.discardAnimations(),n.animations.length===0?n.timelineTicking=!1:n.requestAnimationFrame(n.webAnimationsNextTick)},this.processRafCallbacks=function(e){var t=n.rafCallbacks;n.rafCallbacks=[],e<Number(n.currentTime)&&(e=Number(n.currentTime)),n.animations.sort(Fx),n.animations=n.tick(e,!0,n.animations)[0],t.forEach(function(t){t[1](e)}),n.applyPendingEffects()},this.document=t}return U(e,[{key:`getAnimations`,value:function(){return this.discardAnimations(),this.animations.slice()}},{key:`isTicking`,value:function(){return this.inTick}},{key:`play`,value:function(e,t,n){var r=new Px(e,t,n),i=new pb(r,this);return this.animations.push(i),this.restartWebAnimationsNextTick(),i.updatePromises(),i.play(),i.updatePromises(),i}},{key:`applyDirtiedAnimation`,value:function(e){var t=this;if(!this.inTick){e.markTarget();var n=e.targetAnimations();n.sort(Fx),this.tick(Number(this.currentTime),!1,n.slice())[1].forEach(function(e){var n=t.animations.indexOf(e);n!==-1&&t.animations.splice(n,1)}),this.applyPendingEffects()}}},{key:`restart`,value:function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame}},{key:`destroy`,value:function(){this.document.defaultView.cancelAnimationFrame(this.frameId)}},{key:`applyPendingEffects`,value:function(){this.pendingEffects.forEach(function(e){e?.applyInterpolations()}),this.pendingEffects=[]}},{key:`updateAnimationsPromises`,value:function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(e){return e.updatePromises()})}},{key:`discardAnimations`,value:function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(e){return e.playState!==`finished`&&e.playState!==`idle`})}},{key:`restartWebAnimationsNextTick`,value:function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))}},{key:`rAF`,value:function(e){var t=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([t,e]),t}},{key:`requestAnimationFrame`,value:function(e){var t=this;return this.rAF(function(n){t.updateAnimationsPromises(),e(n),t.updateAnimationsPromises()})}},{key:`tick`,value:function(e,t,n){var r=this,i,a;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=e,this.ticking=!1;var o=[],s=[],c=[],l=[];return n.forEach(function(n){n.tick(e,t),n._inEffect?(s.push(n.effect),n.markTarget()):(o.push(n.effect),n.unmarkTarget()),n._needsTick&&(r.ticking=!0);var i=n._inEffect||n._needsTick;n._inTimeline=i,i?c.push(n):l.push(n)}),(i=this.pendingEffects).push.apply(i,o),(a=this.pendingEffects).push.apply(a,s),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[c,l]}}])}();Y.EasingFunction=ax,Y.AnimationTimeline=Ix;const Lx={duration:500},Rx={duration:1e3,easing:`cubic-bezier(0.250, 0.460, 0.450, 0.940)`,iterations:1,fill:`both`};var zx;(function(e){e.NodeAdded=`NodeAdded`,e.NodeUpdated=`NodeUpdated`,e.NodeRemoved=`NodeRemoved`,e.EdgeAdded=`EdgeAdded`,e.EdgeUpdated=`EdgeUpdated`,e.EdgeRemoved=`EdgeRemoved`,e.ComboAdded=`ComboAdded`,e.ComboUpdated=`ComboUpdated`,e.ComboRemoved=`ComboRemoved`})(zx||={});var Bx;(function(e){e.DRAW=`draw`,e.COLLAPSE=`collapse`,e.EXPAND=`expand`,e.TRANSFORM=`transform`})(Bx||={});var Vx;(function(e){e.CLICK=`canvas:click`,e.DBLCLICK=`canvas:dblclick`,e.POINTER_OVER=`canvas:pointerover`,e.POINTER_LEAVE=`canvas:pointerleave`,e.POINTER_ENTER=`canvas:pointerenter`,e.POINTER_MOVE=`canvas:pointermove`,e.POINTER_OUT=`canvas:pointerout`,e.POINTER_DOWN=`canvas:pointerdown`,e.POINTER_UP=`canvas:pointerup`,e.CONTEXT_MENU=`canvas:contextmenu`,e.DRAG_START=`canvas:dragstart`,e.DRAG=`canvas:drag`,e.DRAG_END=`canvas:dragend`,e.DRAG_ENTER=`canvas:dragenter`,e.DRAG_OVER=`canvas:dragover`,e.DRAG_LEAVE=`canvas:dragleave`,e.DROP=`canvas:drop`,e.WHEEL=`canvas:wheel`})(Vx||={});var Hx;(function(e){e.CLICK=`combo:click`,e.DBLCLICK=`combo:dblclick`,e.POINTER_OVER=`combo:pointerover`,e.POINTER_LEAVE=`combo:pointerleave`,e.POINTER_ENTER=`combo:pointerenter`,e.POINTER_MOVE=`combo:pointermove`,e.POINTER_OUT=`combo:pointerout`,e.POINTER_DOWN=`combo:pointerdown`,e.POINTER_UP=`combo:pointerup`,e.CONTEXT_MENU=`combo:contextmenu`,e.DRAG_START=`combo:dragstart`,e.DRAG=`combo:drag`,e.DRAG_END=`combo:dragend`,e.DRAG_ENTER=`combo:dragenter`,e.DRAG_OVER=`combo:dragover`,e.DRAG_LEAVE=`combo:dragleave`,e.DROP=`combo:drop`})(Hx||={});var X;(function(e){e.CLICK=`click`,e.DBLCLICK=`dblclick`,e.POINTER_OVER=`pointerover`,e.POINTER_LEAVE=`pointerleave`,e.POINTER_ENTER=`pointerenter`,e.POINTER_MOVE=`pointermove`,e.POINTER_OUT=`pointerout`,e.POINTER_DOWN=`pointerdown`,e.POINTER_UP=`pointerup`,e.CONTEXT_MENU=`contextmenu`,e.DRAG_START=`dragstart`,e.DRAG=`drag`,e.DRAG_END=`dragend`,e.DRAG_ENTER=`dragenter`,e.DRAG_OVER=`dragover`,e.DRAG_LEAVE=`dragleave`,e.DROP=`drop`,e.KEY_DOWN=`keydown`,e.KEY_UP=`keyup`,e.WHEEL=`wheel`,e.PINCH=`pinch`})(X||={});var Ux;(function(e){e.KEY_DOWN=`keydown`,e.KEY_UP=`keyup`})(Ux||={});var Wx;(function(e){e.CLICK=`edge:click`,e.DBLCLICK=`edge:dblclick`,e.POINTER_OVER=`edge:pointerover`,e.POINTER_LEAVE=`edge:pointerleave`,e.POINTER_ENTER=`edge:pointerenter`,e.POINTER_MOVE=`edge:pointermove`,e.POINTER_OUT=`edge:pointerout`,e.POINTER_DOWN=`edge:pointerdown`,e.POINTER_UP=`edge:pointerup`,e.CONTEXT_MENU=`edge:contextmenu`,e.DRAG_ENTER=`edge:dragenter`,e.DRAG_OVER=`edge:dragover`,e.DRAG_LEAVE=`edge:dragleave`,e.DROP=`edge:drop`})(Wx||={});var Z;(function(e){e.BEFORE_CANVAS_INIT=`beforecanvasinit`,e.AFTER_CANVAS_INIT=`aftercanvasinit`,e.BEFORE_SIZE_CHANGE=`beforesizechange`,e.AFTER_SIZE_CHANGE=`aftersizechange`,e.BEFORE_ELEMENT_CREATE=`beforeelementcreate`,e.AFTER_ELEMENT_CREATE=`afterelementcreate`,e.BEFORE_ELEMENT_UPDATE=`beforeelementupdate`,e.AFTER_ELEMENT_UPDATE=`afterelementupdate`,e.BEFORE_ELEMENT_DESTROY=`beforeelementdestroy`,e.AFTER_ELEMENT_DESTROY=`afterelementdestroy`,e.BEFORE_ELEMENT_TRANSLATE=`beforeelementtranslate`,e.AFTER_ELEMENT_TRANSLATE=`afterelementtranslate`,e.BEFORE_DRAW=`beforedraw`,e.AFTER_DRAW=`afterdraw`,e.BEFORE_RENDER=`beforerender`,e.AFTER_RENDER=`afterrender`,e.BEFORE_ANIMATE=`beforeanimate`,e.AFTER_ANIMATE=`afteranimate`,e.BEFORE_LAYOUT=`beforelayout`,e.AFTER_LAYOUT=`afterlayout`,e.BEFORE_STAGE_LAYOUT=`beforestagelayout`,e.AFTER_STAGE_LAYOUT=`afterstagelayout`,e.BEFORE_TRANSFORM=`beforetransform`,e.AFTER_TRANSFORM=`aftertransform`,e.BATCH_START=`batchstart`,e.BATCH_END=`batchend`,e.BEFORE_DESTROY=`beforedestroy`,e.AFTER_DESTROY=`afterdestroy`,e.BEFORE_RENDERER_CHANGE=`beforerendererchange`,e.AFTER_RENDERER_CHANGE=`afterrendererchange`})(Z||={});var Gx;(function(e){e.UNDO=`undo`,e.REDO=`redo`,e.CANCEL=`cancel`,e.ADD=`add`,e.CLEAR=`clear`,e.CHANGE=`change`})(Gx||={});var Kx;(function(e){e.CLICK=`node:click`,e.DBLCLICK=`node:dblclick`,e.POINTER_OVER=`node:pointerover`,e.POINTER_LEAVE=`node:pointerleave`,e.POINTER_ENTER=`node:pointerenter`,e.POINTER_MOVE=`node:pointermove`,e.POINTER_OUT=`node:pointerout`,e.POINTER_DOWN=`node:pointerdown`,e.POINTER_UP=`node:pointerup`,e.CONTEXT_MENU=`node:contextmenu`,e.DRAG_START=`node:dragstart`,e.DRAG=`node:drag`,e.DRAG_END=`node:dragend`,e.DRAG_ENTER=`node:dragenter`,e.DRAG_OVER=`node:dragover`,e.DRAG_LEAVE=`node:dragleave`,e.DROP=`node:drop`})(Kx||={});const qx=`combo`,Jx=`tree`;var Yx;(function(e){e.NODE=`node`,e.EDGE=`edge`,e.COMBO=`combo`,e.THEME=`theme`,e.PALETTE=`palette`,e.LAYOUT=`layout`,e.BEHAVIOR=`behavior`,e.PLUGIN=`plugin`,e.ANIMATION=`animation`,e.TRANSFORM=`transform`,e.SHAPE=`shape`})(Yx||={});const Xx={animation:{},behavior:{},combo:{},edge:{},layout:{},node:{},palette:{},theme:{},plugin:{},transform:{},shape:{}};function Zx(e,t){let n=Xx[e]?.[t];if(n)return n}var Qx=`G6`;function $x(e){return`[${Qx} v5.0.49] ${e}`}const eS={mute:!1,debug:e=>{!eS.mute&&console.debug($x(e))},info:e=>{!eS.mute&&console.info($x(e))},warn:e=>{!eS.mute&&console.warn($x(e))},error:e=>{!eS.mute&&console.error($x(e))}};function tS(e){let{theme:t}=e;return t?Zx(Yx.THEME,t)||(eS.warn(`The theme of ${t} is not registered.`),{}):{}}function nS(e,t){if(Array.isArray(e)&&e.length===0)return null;let n=Array.isArray(e)?e[0]:e,r=Array.isArray(e)?e.slice(1):t||[];return new Proxy(n,{get(e,t){return typeof e[t]==`function`&&![`onframe`,`onfinish`].includes(t)?(...n)=>{e[t](...n),r.forEach(e=>e[t]?.call(e,...n))}:t===`finished`?Promise.all([n.finished,...r.map(e=>e.finished)]):Reflect.get(e,t)},set(e,t,n){return[`onframe`,`onfinish`].includes(t)||r.forEach(e=>{e[t]=n}),Reflect.set(e,t,n)}})}function rS(e){let t=e.reduce((e,t)=>(Object.entries(t).forEach(([t,n])=>{e[t]===void 0?e[t]=[n]:e[t].push(n)}),e),{});Object.entries(t).forEach(([n,r])=>{(r.length!==e.length||r.some(e=>Wl(e))||r.every(e=>![`sourceNode`,`targetNode`,`childrenNode`].includes(n)&&Gu(e,r[0])))&&delete t[n]});let n=Object.entries(t).reduce((e,[t,n])=>(n.forEach((n,r)=>{e[r]?e[r][t]=n:e[r]={[t]:n}}),e),[]);return e.length!==0&&n.length===0&&n.push({_:0},{_:0}),n}function iS(e){switch(e){case`opacity`:return 1;case`x`:case`y`:case`z`:case`zIndex`:return 0;case`visibility`:return`visible`;case`collapsed`:return!1;case`states`:return[];default:return}}function aS(e,t){let{animation:n}=e;if(n===!1||t===!1)return!1;let r=Object.assign({},Lx);return Kl(n)&&Object.assign(r,n),Kl(t)&&Object.assign(r,t),r}function oS(e){return typeof e==`string`?Zx(Yx.ANIMATION,e)||(eS.warn(`The animation of ${e} is not registered.`),[]):e}function sS(e,t,n,r){let{animation:i}=e;if(i===!1||r===!1)return[];let a=e?.[t]?.animation;if(a===!1)return[];let o=a?.[n];if(o===!1)return[];let s=tS(e)[t]?.animation,c=(e=[])=>oS(e).map(e=>Object.assign(Object.assign(Object.assign(Object.assign({},Rx),Kl(i)&&i),e),Kl(r)&&r));if(o)return c(o);if(!s)return[];let l=s[n];return l===!1?[]:c(l)}function cS(e,t,n,r=[]){if(!r&&e===0&&t===0&&n===0)return null;if(Array.isArray(r)){let i=-1,a=[];for(let o=0;o<r.length;o++){let s=r[o];if(s[0]===`translate`){if(s[1]===e&&s[2]===t)return null;i=o,a.push([`translate`,e,t])}else if(s[0]===`translate3d`){if(s[1]===e&&s[2]===t&&s[3]===n)return null;i=o,a.push([`translate3d`,e,t,n??0])}else a.push(s)}return i===-1&&a.splice(0,0,G(n)?[`translate3d`,e,t,n??0]:[`translate`,e,t]),a.length===0?null:a}let i=r?r.replace(/translate(3d)?\([^)]*\)/g,``):``;return n===0?`translate(${e}, ${t})${i}`:`translate3d(${e}, ${t}, ${n})${i}`}var lS=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};const uS=(e,t,n)=>{if(!n.length)return null;let[r,i]=t,a=t=>{if(t){let n=e.getShape(t);if(!n)return null;let a=`get${vu(t)}Style`,o=(e?.[a])?.bind(e)||(e=>e),s=o?.(r)||{},c=o?.(i)||{};return{shape:n,fromStyle:s,toStyle:c}}else return{shape:e,fromStyle:r,toStyle:i}},o,s=n.map(e=>{var{fields:t,shape:n,states:r}=e,i=lS(e,[`fields`,`shape`,`states`]);let s=a(n);if(!s)return null;let{shape:c,fromStyle:l,toStyle:u}=s,d=[{},{}];if(t.forEach(e=>{Object.assign(d[0],{[e]:l[e]??iS(e)}),Object.assign(d[1],{[e]:u[e]??iS(e)})}),d.some(e=>Object.keys(e).some(e=>[`x`,`y`,`z`].includes(e)))){let{x:e=0,y:t=0,z:n,transform:r=``}=c.attributes||{};d.forEach(i=>{i.transform=cS(i.x??e,i.y??t,i.z??n,r)})}let f=c.animate(rS(d),i);return n===void 0&&(o=f),f}).filter(Boolean),c=o||s?.[0];return c?nS(c,s.filter(e=>e!==e)):null},dS=[{fields:[`opacity`]}],fS=[{fields:[`x`,`y`]}],pS=[{fields:[`x`,`y`]}],mS=pS,hS=[{fields:[`sourceNode`,`targetNode`]}],gS=hS,_S=[{fields:[`childrenNode`,`x`,`y`]}],vS=_S;function yS(e){return`source`in e&&`target`in e}function bS(e){return e.length===2}function xS(e){return e instanceof Float32Array?!0:Array.isArray(e)&&(e.length===2||e.length===3)?e.every(e=>typeof e==`number`):!1}function SS(e,t,n){return e>=t&&e<=n}function CS(e=0){if(Array.isArray(e)){let[t=0,n=t,r=t,i=n]=e;return[t,n,r,i]}return[e,e,e,e]}function wS(e=0){let t=CS(e);return t[0]+t[2]}function TS(e){return e.max[0]-e.min[0]}function ES(e){return e.max[1]-e.min[1]}function DS(e){return[TS(e),ES(e)]}function OS(e,t){let n=xS(e)?kS(e):e.getShape(`key`).getBounds();return t?AS(n,t):n}function kS(e){let[t,n,r=0]=e,i=new tp;return i.setMinMax([t,n,r],[t,n,r]),i}function AS(e,t){let[n,r,i,a]=CS(t),[o,s,c]=e.min,[l,u,d]=e.max,f=new tp;return f.setMinMax([o-a,s-n,c],[l+r,u+i,d]),f}function jS(e){if(e.length===0)return new tp;if(e.length===1)return e[0];let t=new tp;t.setMinMax(e[0].min,e[0].max);for(let n=1;n<e.length;n++){let r=e[n];t.setMinMax([Math.min(t.min[0],r.min[0]),Math.min(t.min[1],r.min[1]),Math.min(t.min[2],r.min[2])],[Math.max(t.max[0],r.max[0]),Math.max(t.max[1],r.max[1]),Math.max(t.max[2],r.max[2])])}return t}function MS(e,t){let[n,r]=e.min,[i,a]=e.max,[o,s]=t.min,[c,l]=t.max;return n>=o&&i<=c&&r>=s&&a<=l}function NS(e,t){return SS(e[0],t.min[0],t.max[0])&&SS(e[1],t.min[1],t.max[1])}function PS(e,t,n=!1){let{min:[r,i],max:[a,o]}=t,s=(e[1]===i||e[1]===o)&&(n||SS(e[0],r,a)),c=(e[0]===r||e[0]===a)&&(n||SS(e[1],i,o));return s||c}function FS(e,t){return!NS(e,t)}function IS(e,t){let{center:n}=t;return e[0]===n[0]&&e[1]===n[1]}function LS(e,t){let[n,r]=e,[i,a]=t.min,[o,s]=t.max,c=n-i,l=o-n,u=r-a,d=s-r,f=Math.min(c,l,u,d);return f===c?`left`:f===l?`right`:f===u?`top`:f===d?`bottom`:`left`}function RS(e,t){let n=ju(e);if(NS(e,t))switch(LS(e,t)){case`left`:n[0]=t.min[0];break;case`right`:n[0]=t.max[0];break;case`top`:n[1]=t.min[1];break;case`bottom`:n[1]=t.max[1];break}else{let[r,i]=e,[a,o]=t.min,[s,c]=t.max;n[0]=SS(r,a,s)?r:r<a?a:s,n[1]=SS(i,o,c)?i:i<o?o:c}return n}function zS(e,t){let{center:n}=e,[r,i]=DS(e),a=t===`up`||t===`down`?n[0]:t===`right`?n[0]-r/6:n[0]+r/6,o=t===`left`||t===`right`?n[1]:t===`down`?n[1]-i/6:n[1]+i/6;return[a,o]}function BS(e,t){let[n,r]=DS(e);return[n,r]=t===`up`||t===`down`?[n,r]:[r,n],(r**2-(Math.sqrt((n/2)**2+r**2)-n/2)**2)/(2*r)}function VS(e){let{min:[t,n],max:[r,i]}=e,a=[t,i],o=[r,i],s=[r,n],c=[t,n];return[[a,o],[o,s],[s,c],[c,a]]}var HS=function(e,t){return e===t},US=function(){function e(e,t){t===void 0&&(t=null),this.value=e,this.next=t}return e.prototype.toString=function(e){return e?e(this.value):`${this.value}`},e}(),WS=function(){function e(e){e===void 0&&(e=HS),this.head=null,this.tail=null,this.compare=e}return e.prototype.prepend=function(e){var t=new US(e,this.head);return this.head=t,this.tail||=t,this},e.prototype.append=function(e){var t=new US(e);return this.head?(this.tail.next=t,this.tail=t,this):(this.head=t,this.tail=t,this)},e.prototype.delete=function(e){if(!this.head)return null;for(var t=null;this.head&&this.compare(this.head.value,e);)t=this.head,this.head=this.head.next;var n=this.head;if(n!==null)for(;n.next;)this.compare(n.next.value,e)?(t=n.next,n.next=n.next.next):n=n.next;return this.compare(this.tail.value,e)&&(this.tail=n),t},e.prototype.find=function(e){var t=e.value,n=t===void 0?void 0:t,r=e.callback,i=r===void 0?void 0:r;if(!this.head)return null;for(var a=this.head;a;){if(i&&i(a.value)||n!==void 0&&this.compare(a.value,n))return a;a=a.next}return null},e.prototype.deleteTail=function(){var e=this.tail;if(this.head===this.tail)return this.head=null,this.tail=null,e;for(var t=this.head;t.next;)t.next.next?t=t.next:t.next=null;return this.tail=t,e},e.prototype.deleteHead=function(){if(!this.head)return null;var e=this.head;return this.head.next?this.head=this.head.next:(this.head=null,this.tail=null),e},e.prototype.fromArray=function(e){var t=this;return e.forEach(function(e){return t.append(e)}),this},e.prototype.toArray=function(){for(var e=[],t=this.head;t;)e.push(t),t=t.next;return e},e.prototype.reverse=function(){for(var e=this.head,t=null,n=null;e;)n=e.next,e.next=t,t=e,e=n;this.tail=this.head,this.head=t},e.prototype.toString=function(e){return e===void 0&&(e=void 0),this.toArray().map(function(t){return t.toString(e)}).toString()},e}();(function(){function e(){this.linkedList=new WS}return e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.peek=function(){return this.linkedList.head?this.linkedList.head.value:null},e.prototype.enqueue=function(e){this.linkedList.append(e)},e.prototype.dequeue=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toString=function(e){return this.linkedList.toString(e)},e})();var GS=function(e,t,n){t===void 0&&(t=[]);var r=t.filter(function(t){return t.source===e||t.target===e});return n===`target`?r.filter(function(t){return t.source===e}).map(function(e){return e.target}):n===`source`?r.filter(function(t){return t.target===e}).map(function(e){return e.source}):r.map(function(t){return t.source===e?t.target:t.source})},KS=function(e,t){return t.filter(function(t){return t.source===e})},qS=function(e,t){return t.filter(function(t){return t.source===e||t.target===e})},JS=function(e){var t={},n=e.nodes,r=n===void 0?[]:n,i=e.edges,a=i===void 0?[]:i;return r.forEach(function(e){t[e.id]={degree:0,inDegree:0,outDegree:0}}),a.forEach(function(e){t[e.source].degree++,t[e.source].outDegree++,t[e.target].degree++,t[e.target].inDegree++}),t},YS={}.toString,XS=function(e,t){return YS.call(e)===`[object `+t+`]`},ZS=(function(e){return XS(e,`Function`)}),QS=(function(e){return Array.isArray?Array.isArray(e):XS(e,`Array`)}),$S=(function(e){var t=typeof e;return e!==null&&t===`object`||t===`function`});function eC(e,t){if(e){var n;if(QS(e))for(var r=0,i=e.length;r<i&&(n=t(e[r],r),n!==!1);r++);else if($S(e)){for(var a in e)if(e.hasOwnProperty(a)&&(n=t(e[a],a),n===!1))break}}}var tC=eC,nC=Array.prototype;nC.splice,nC.indexOf,Array.prototype.splice;var rC=(function(e){return XS(e,`String`)});Number.isInteger&&Number.isInteger,180/Math.PI,Math.PI/180;var iC=Object.values?function(e){return Object.values(e)}:function(e){var t=[];return tC(e,function(n,r){ZS(e)&&r===`prototype`||t.push(n)}),t};({}).toString,Object.prototype;var aC=function(e){if(typeof e!=`object`||!e)return e;var t;if(QS(e)){t=[];for(var n=0,r=e.length;n<r;n++)typeof e[n]==`object`&&e[n]!=null?t[n]=aC(e[n]):t[n]=e[n]}else for(var i in t={},e)typeof e[i]==`object`&&e[i]!=null?t[i]=aC(e[i]):t[i]=e[i];return t},oC=aC,sC=(function(e,t){if(!ZS(e))throw TypeError(`Expected a function`);var n=function(){var r=[...arguments],i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return a.set(i,o),o};return n.cache=new Map,n}),cC;sC(function(e,t){t===void 0&&(t={});var n=t.fontSize,r=t.fontFamily,i=t.fontWeight,a=t.fontStyle,o=t.fontVariant;return cC||=document.createElement(`canvas`).getContext(`2d`),cC.font=[a,o,i,n+`px`,r].join(` `),cC.measureText(rC(e)?e:``).width},function(e,t){return t===void 0&&(t={}),nn([e],iC(t)).join(``)}),function(){function e(){this.map={}}return e.prototype.has=function(e){return this.map[e]!==void 0},e.prototype.get=function(e,t){var n=this.map[e];return n===void 0?t:n},e.prototype.set=function(e,t){this.map[e]=t},e.prototype.clear=function(){this.map={}},e.prototype.delete=function(e){delete this.map[e]},e.prototype.size=function(){return Object.keys(this.map).length},e}();var lC=function(e,t,n){for(var r=1/0,i,a=0;a<t.length;a++){var o=t[a].id;!n[o]&&e[o]<=r&&(r=e[o],i=t[a])}return i},uC=function(e,t,n,r){var i=e.nodes,a=i===void 0?[]:i,o=e.edges,s=o===void 0?[]:o,c=[],l={},u={},d={};a.forEach(function(e,n){var r=e.id;c.push(r),u[r]=1/0,r===t&&(u[r]=0)});for(var f=a.length,p=function(e){var t=lC(u,a,l),i=t.id;if(l[i]=!0,u[i]===1/0)return`continue`;var o=[];o=n?KS(i,s):qS(i,s),o.forEach(function(e){var n=e.target,a=e.source,o=n===i?a:n,s=r&&e[r]?e[r]:1;u[o]>u[t.id]+s?(u[o]=u[t.id]+s,d[o]=[t.id]):u[o]===u[t.id]+s&&d[o].push(t.id)})},m=0;m<f;m++)p(m);d[t]=[t];var h={};for(var g in u)u[g]!==1/0&&dC(t,g,d,h);var _={};for(var g in h)_[g]=h[g][0];return{length:u,path:_,allPath:h}};function dC(e,t,n,r){if(e===t)return[e];if(r[t])return r[t];for(var i=[],a=0,o=n[t];a<o.length;a++){var s=o[a],c=dC(e,s,n,r);if(!c)return;for(var l=0,u=c;l<u.length;l++){var d=u[l];QS(d)?i.push(z(z([],d,!0),[t],!1)):i.push([d,t])}}return r[t]=i,r[t]}var fC=function(e,t,n,r,i){var a=uC(e,t,r,i),o=a.length,s=a.path,c=a.allPath;return{length:o[n],path:s[n],allPath:c[n]}};(function(){function e(e){this.arr=e}return e.prototype.getArr=function(){return this.arr||[]},e.prototype.add=function(t){var n=t.arr;if(!this.arr?.length)return new e(n);if(!n?.length)return new e(this.arr);if(this.arr.length===n.length){var r=[];for(var i in this.arr)r[i]=this.arr[i]+n[i];return new e(r)}},e.prototype.subtract=function(t){var n=t.arr;if(!this.arr?.length)return new e(n);if(!n?.length)return new e(this.arr);if(this.arr.length===n.length){var r=[];for(var i in this.arr)r[i]=this.arr[i]-n[i];return new e(r)}},e.prototype.avg=function(t){var n=[];if(t!==0)for(var r in this.arr)n[r]=this.arr[r]/t;return new e(n)},e.prototype.negate=function(){var t=[];for(var n in this.arr)t[n]=-this.arr[n];return new e(t)},e.prototype.squareEuclideanDistance=function(e){var t=e.arr;if(!this.arr?.length||!t?.length)return 0;if(this.arr.length===t.length){var n=0;for(var r in this.arr)n+=(this.arr[r]-e.arr[r])**2;return n}},e.prototype.euclideanDistance=function(e){var t=e.arr;if(!this.arr?.length||!t?.length)return 0;if(this.arr.length===t.length){var n=0;for(var r in this.arr)n+=(this.arr[r]-e.arr[r])**2;return Math.sqrt(n)}else console.error(`The two vectors are unequal in length.`)},e.prototype.normalize=function(){var t=[],n=oC(this.arr);n.sort(function(e,t){return e-t});var r=n[n.length-1],i=n[0];for(var a in this.arr)t[a]=(this.arr[a]-i)/(r-i);return new e(t)},e.prototype.norm2=function(){if(!this.arr?.length)return 0;var e=0;for(var t in this.arr)e+=this.arr[t]**2;return Math.sqrt(e)},e.prototype.dot=function(e){var t=e.arr;if(!this.arr?.length||!t?.length)return 0;if(this.arr.length===t.length){var n=0;for(var r in this.arr)n+=this.arr[r]*e.arr[r];return n}else console.error(`The two vectors are unequal in length.`)},e.prototype.equal=function(e){var t=e.arr;if(this.arr?.length!==t?.length)return!1;for(var n in this.arr)if(this.arr[n]!==t[n])return!1;return!0},e})();var pC;(function(e){e.EuclideanDistance=`euclideanDistance`})(pC||={}),function(){function e(e){this.count=e.length,this.parent={};for(var t=0,n=e;t<n.length;t++){var r=n[t];this.parent[r]=r}}return e.prototype.find=function(e){for(;this.parent[e]!==e;)e=this.parent[e];return e},e.prototype.union=function(e,t){var n=this.find(e),r=this.find(t);n!==r&&(n<r?(this.parent[t]!==t&&this.union(this.parent[t],e),this.parent[t]=this.parent[e]):(this.parent[e]!==e&&this.union(this.parent[e],t),this.parent[e]=this.parent[t]))},e.prototype.connected=function(e,t){return this.find(e)===this.find(t)},e}();var mC=function(e,t){return e-t};(function(){function e(e){e===void 0&&(e=mC),this.compareFn=e,this.list=[]}return e.prototype.getLeft=function(e){return 2*e+1},e.prototype.getRight=function(e){return 2*e+2},e.prototype.getParent=function(e){return e===0?null:Math.floor((e-1)/2)},e.prototype.isEmpty=function(){return this.list.length<=0},e.prototype.top=function(){return this.isEmpty()?void 0:this.list[0]},e.prototype.delMin=function(){var e=this.top(),t=this.list.pop();return this.list.length>0&&(this.list[0]=t,this.moveDown(0)),e},e.prototype.insert=function(e){if(e!==null){this.list.push(e);var t=this.list.length-1;return this.moveUp(t),!0}return!1},e.prototype.moveUp=function(e){for(var t=this.getParent(e);e&&e>0&&this.compareFn(this.list[t],this.list[e])>0;){var n=this.list[t];this.list[t]=this.list[e],this.list[e]=n,e=t,t=this.getParent(e)}},e.prototype.moveDown=function(e){var t,n=e,r=this.getLeft(e),i=this.getRight(e),a=this.list.length;r!==null&&r<a&&this.compareFn(this.list[n],this.list[r])>0?n=r:i!==null&&i<a&&this.compareFn(this.list[n],this.list[i])>0&&(n=i),e!==n&&(t=[this.list[n],this.list[e]],this.list[e]=t[0],this.list[n]=t[1],this.moveDown(n))},e})();var hC=function(e,t,n){typeof t!=`number`&&(t=1e-6),typeof n!=`number`&&(n=.85);for(var r=1,i=0,a=1e3,o=e.nodes,s=o===void 0?[]:o,c=e.edges,l=c===void 0?[]:c,u=s.length,d,f={},p={},m=0;m<u;++m){var h=s[m],g=h.id;f[g]=1/u,p[g]=1/u}for(var _=JS(e);a>0&&r>t;){i=0;for(var m=0;m<u;++m){var h=s[m],g=h.id;if(d=0,_[h.id].inDegree===0)f[g]=0;else{for(var v=GS(g,l,`source`),y=0;y<v.length;++y){var b=v[y],x=_[b].outDegree;x>0&&(d+=p[b]/x)}f[g]=n*d,i+=f[g]}}i=(1-i)/u,r=0;for(var m=0;m<u;++m){var h=s[m],g=h.id;d=f[g]+i,r+=Math.abs(d-p[g]),p[g]=d}--a}return p},gC=function(){function e(e,t,n,r){e===void 0&&(e=-1),t===void 0&&(t=-1),n===void 0&&(n=-1),r===void 0&&(r=`-1`),this.id=e,this.from=t,this.to=n,this.label=r}return e}(),_C=function(){function e(e,t){e===void 0&&(e=-1),t===void 0&&(t=`-1`),this.id=e,this.label=t,this.edges=[],this.edgeMap={}}return e.prototype.addEdge=function(e){this.edges.push(e),this.edgeMap[e.id]=e},e}(),vC=function(){function e(e,t,n){e===void 0&&(e=-1),t===void 0&&(t=!0),n===void 0&&(n=!1),this.id=e,this.edgeIdAutoIncrease=t,this.edges=[],this.nodes=[],this.nodeMap={},this.edgeMap={},this.nodeLabelMap={},this.edgeLabelMap={},this.counter=0,this.directed=n}return e.prototype.getNodeNum=function(){return this.nodes.length},e.prototype.addNode=function(e,t){if(!this.nodeMap[e]){var n=new _C(e,t);this.nodes.push(n),this.nodeMap[e]=n,this.nodeLabelMap[t]||(this.nodeLabelMap[t]=[]),this.nodeLabelMap[t].push(e)}},e.prototype.addEdge=function(e,t,n,r){if((this.edgeIdAutoIncrease||e===void 0)&&(e=this.counter++),!(this.nodeMap[t]&&this.nodeMap[n]&&this.nodeMap[n].edgeMap[e])){var i=new gC(e,t,n,r);if(this.edges.push(i),this.edgeMap[e]=i,this.nodeMap[t].addEdge(i),this.edgeLabelMap[r]||(this.edgeLabelMap[r]=[]),this.edgeLabelMap[r].push(i),!this.directed){var a=new gC(e,n,t,r);this.nodeMap[n].addEdge(a),this.edgeLabelMap[r].push(a)}}},e}(),yC=function(){function e(e,t,n,r,i){this.fromNode=e,this.toNode=t,this.nodeEdgeNodeLabel={nodeLabel1:n||`-1`,edgeLabel:r||`-1`,nodeLabel2:i||`-1`}}return e.prototype.equalTo=function(e){return this.fromNode===e.formNode&&this.toNode===e.toNode&&this.nodeEdgeNodeLabel===e.nodeEdgeNodeLabel},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e}(),bC=function(){function e(){this.rmpath=[],this.dfsEdgeList=[]}return e.prototype.equalTo=function(e){var t=this.dfsEdgeList.length,n=e.length;if(t!==n)return!1;for(var r=0;r<t;r++)if(this.dfsEdgeList[r]!==e[r])return!1;return!0},e.prototype.notEqualTo=function(e){return!this.equalTo(e)},e.prototype.pushBack=function(e,t,n,r,i){return this.dfsEdgeList.push(new yC(e,t,n,r,i)),this.dfsEdgeList},e.prototype.toGraph=function(e,t){e===void 0&&(e=-1),t===void 0&&(t=!1);var n=new vC(e,!0,t);return this.dfsEdgeList.forEach(function(e){var t=e.fromNode,r=e.toNode,i=e.nodeEdgeNodeLabel,a=i.nodeLabel1,o=i.edgeLabel,s=i.nodeLabel2;a!==`-1`&&n.addNode(t,a),s!==`-1`&&n.addNode(r,s),a!==`-1`&&s!==a&&n.addEdge(void 0,t,r,o)}),n},e.prototype.buildRmpath=function(){this.rmpath=[];for(var e=void 0,t=this.dfsEdgeList.length-1;t>=0;t--){var n=this.dfsEdgeList[t],r=n.fromNode,i=n.toNode;r<i&&(e===void 0||i===e)&&(this.rmpath.push(t),e=r)}return this.rmpath},e.prototype.getNodeNum=function(){var e={};return this.dfsEdgeList.forEach(function(t){e[t.fromNode]||(e[t.fromNode]=!0),e[t.toNode]||(e[t.toNode]=!0)}),Object.keys(e).length},e}(),xC=function(){function e(e){if(this.his={},this.nodesUsed={},this.edgesUsed={},this.edges=[],e){for(;e;){var t=e.edge;this.edges.push(t),this.nodesUsed[t.from]=1,this.nodesUsed[t.to]=1,this.edgesUsed[t.id]=1,e=e.preNode}this.edges=this.edges.reverse()}}return e.prototype.hasNode=function(e){return this.nodesUsed[e.id]===1},e.prototype.hasEdge=function(e){return this.edgesUsed[e.id]===1},e}();(function(){function e(e){var t=e.graphs,n=e.minSupport,r=n===void 0?2:n,i=e.minNodeNum,a=i===void 0?1:i,o=e.maxNodeNum,s=o===void 0?4:o,c=e.top,l=c===void 0?10:c,u=e.directed,d=u===void 0?!1:u,f=e.verbose,p=f===void 0?!1:f;this.graphs=t,this.dfsCode=new bC,this.support=0,this.frequentSize1Subgraphs=[],this.frequentSubgraphs=[],this.minSupport=r,this.top=l,this.directed=d,this.counter=0,this.maxNodeNum=s,this.minNodeNum=a,this.verbose=p,this.maxNodeNum<this.minNodeNum&&(this.maxNodeNum=this.minNodeNum),this.reportDF=[]}return e.prototype.findForwardRootEdges=function(e,t){var n=this,r=[],i=e.nodeMap;return t.edges.forEach(function(e){(n.directed||t.label<=i[e.to].label)&&r.push(e)}),r},e.prototype.findBackwardEdge=function(e,t,n,r){if(!this.directed&&t===n)return null;for(var i=e.nodeMap,a=i[n.to].edges,o=a.length,s=0;s<o;s++){var c=a[s];if(!(r.hasEdge(c)||c.to!==t.from)){if(this.directed){if(i[t.from].label<i[n.to].label||i[t.from].label===i[n.to].label&&t.label<=c.label)return c}else if(t.label<c.label||t.label===c.label&&i[t.to].label<=i[n.to].label)return c}}return null},e.prototype.findForwardPureEdges=function(e,t,n,r){for(var i=[],a=t.to,o=e.nodeMap[a].edges,s=o.length,c=0;c<s;c++){var l=o[c],u=e.nodeMap[l.to];n<=u.label&&!r.hasNode(u)&&i.push(l)}return i},e.prototype.findForwardRmpathEdges=function(e,t,n,r){for(var i=[],a=e.nodeMap,o=a[t.to].label,s=a[t.from].edges,c=s.length,l=0;l<c;l++){var u=s[l],d=a[u.to].label;t.to===u.to||n>d||r.hasNode(a[u.to])||(t.label<u.label||t.label===u.label&&o<=d)&&i.push(u)}return i},e.prototype.getSupport=function(e){var t={};return e.forEach(function(e){t[e.graphId]||(t[e.graphId]=!0)}),Object.keys(t).length},e.prototype.findMinLabel=function(e){var t=void 0;return Object.keys(e).forEach(function(n){var r=e[n],i=r.nodeLabel1,a=r.edgeLabel,o=r.nodeLabel2;if(!t){t={nodeLabel1:i,edgeLabel:a,nodeLabel2:o};return}(i<t.nodeLabel1||i===t.nodeLabel1&&a<t.edgeLabel||i===t.nodeLabel1&&a===t.edgeLabel&&o<t.nodeLabel2)&&(t={nodeLabel1:i,edgeLabel:a,nodeLabel2:o})}),t},e.prototype.isMin=function(){var e=this,t=this.dfsCode;if(this.verbose&&console.log(`isMin checking`,t),t.dfsEdgeList.length===1)return!0;var n=this.directed,r=t.toGraph(-1,n),i=r.nodeMap,a=new bC,o={};r.nodes.forEach(function(t){e.findForwardRootEdges(r,t).forEach(function(e){var n=i[e.to],a=`${t.label}-${e.label}-${n.label}`;o[a]||(o[a]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:n.label});var s={graphId:r.id,edge:e,preNode:null};o[a].projected.push(s)})});var s=this.findMinLabel(o);if(s){a.dfsEdgeList.push(new yC(0,1,s.nodeLabel1,s.edgeLabel,s.nodeLabel2));var c=function o(s){for(var c=a.buildRmpath(),l=a.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,u=a.dfsEdgeList[c[0]].toNode,d={},f=!1,p=0,m=n?-1:0,h=function(t){if(f)return`break`;s.forEach(function(n){var i=new xC(n),o=e.findBackwardEdge(r,i.edges[c[t]],i.edges[c[0]],i);o&&(d[o.label]||(d[o.label]={projected:[],edgeLabel:o.label}),d[o.label].projected.push({graphId:r.id,edge:d,preNode:n}),p=a.dfsEdgeList[c[t]].fromNode,f=!0)})},g=c.length-1;g>m&&h(g)!==`break`;g--);if(f){var _=e.findMinLabel(d);a.dfsEdgeList.push(new yC(u,p,`-1`,_.edgeLabel,`-1`));var v=a.dfsEdgeList.length-1;return e.dfsCode.dfsEdgeList[v]===a.dfsEdgeList[v]?o(d[_.edgeLabel].projected):!1}var y={};f=!1;var b=0;s.forEach(function(t){var n=new xC(t),a=e.findForwardPureEdges(r,n.edges[c[0]],l,n);a.length>0&&(f=!0,b=u,a.forEach(function(e){var n=`${e.label}-${i[e.to].label}`;y[n]||(y[n]={projected:[],edgeLabel:e.label,nodeLabel2:i[e.to].label}),y[n].projected.push({graphId:r.id,edge:e,preNode:t})}))});for(var x=c.length,S=function(t){if(f)return`break`;var n=c[t];s.forEach(function(t){var o=new xC(t),s=e.findForwardRmpathEdges(r,o.edges[n],l,o);s.length>0&&(f=!0,b=a.dfsEdgeList[n].fromNode,s.forEach(function(e){var n=`${e.label}-${i[e.to].label}`;y[n]||(y[n]={projected:[],edgeLabel:e.label,nodeLabel2:i[e.to].label}),y[n].projected.push({graphId:r.id,edge:e,preNode:t})}))})},g=0;g<x&&S(g)!==`break`;g++);if(!f)return!0;var C=e.findMinLabel(y);a.dfsEdgeList.push(new yC(b,u+1,`-1`,C.edgeLabel,C.nodeLabel2));var w=a.dfsEdgeList.length-1;return t.dfsEdgeList[w]===a.dfsEdgeList[w]?o(y[`${C.edgeLabel}-${C.nodeLabel2}`].projected):!1},l=`${s.nodeLabel1}-${s.edgeLabel}-${s.nodeLabel2}`;return c(o[l].projected)}},e.prototype.report=function(){if(!(this.dfsCode.getNodeNum()<this.minNodeNum)){this.counter++;var e=this.dfsCode.toGraph(this.counter,this.directed);this.frequentSubgraphs.push(oC(e))}},e.prototype.subGraphMining=function(e){var t=this;if(!(this.getSupport(e)<this.minSupport)&&this.isMin()){this.report();var n=this.dfsCode.getNodeNum(),r=this.dfsCode.buildRmpath(),i=this.dfsCode.dfsEdgeList[r[0]].toNode,a=this.dfsCode.dfsEdgeList[0].nodeEdgeNodeLabel.nodeLabel1,o={},s={};e.forEach(function(e){for(var c=t.graphs[e.graphId],l=c.nodeMap,u=new xC(e),d=r.length-1;d>=0;d--){var f=t.findBackwardEdge(c,u.edges[r[d]],u.edges[r[0]],u);if(f){var p=`${t.dfsCode.dfsEdgeList[r[d]].fromNode}-${f.label}`;s[p]||(s[p]={projected:[],toNodeId:t.dfsCode.dfsEdgeList[r[d]].fromNode,edgeLabel:f.label}),s[p].projected.push({graphId:e.graphId,edge:f,preNode:e})}}if(!(n>=t.maxNodeNum)){t.findForwardPureEdges(c,u.edges[r[0]],a,u).forEach(function(t){var n=`${i}-${t.label}-${l[t.to].label}`;o[n]||(o[n]={projected:[],fromNodeId:i,edgeLabel:t.label,nodeLabel2:l[t.to].label}),o[n].projected.push({graphId:e.graphId,edge:t,preNode:e})});for(var m=function(n){t.findForwardRmpathEdges(c,u.edges[r[n]],a,u).forEach(function(i){var a=`${t.dfsCode.dfsEdgeList[r[n]].fromNode}-${i.label}-${l[i.to].label}`;o[a]||(o[a]={projected:[],fromNodeId:t.dfsCode.dfsEdgeList[r[n]].fromNode,edgeLabel:i.label,nodeLabel2:l[i.to].label}),o[a].projected.push({graphId:e.graphId,edge:i,preNode:e})})},d=0;d<r.length;d++)m(d)}}),Object.keys(s).forEach(function(e){var n=s[e],r=n.toNodeId,a=n.edgeLabel;t.dfsCode.dfsEdgeList.push(new yC(i,r,`-1`,a,`-1`)),t.subGraphMining(s[e].projected),t.dfsCode.dfsEdgeList.pop()}),Object.keys(o).forEach(function(e){var n=o[e],r=n.fromNodeId,a=n.edgeLabel,s=n.nodeLabel2;t.dfsCode.dfsEdgeList.push(new yC(r,i+1,`-1`,a,s)),t.subGraphMining(o[e].projected),t.dfsCode.dfsEdgeList.pop()})}},e.prototype.generate1EdgeFrequentSubGraphs=function(){var e=this.graphs,t=this.directed,n=this.minSupport,r=this.frequentSize1Subgraphs,i={},a={},o={},s={};return Object.keys(e).forEach(function(n){var r=e[n],c=r.nodeMap;r.nodes.forEach(function(e,r){var l=e.label,u=`${n}-${l}`;if(!o[u]){var d=i[l]||0;d++,i[l]=d}o[u]={graphKey:n,label:l},e.edges.forEach(function(e){var r=l,i=c[e.to].label;if(!t&&r>i){var o=i;i=r,r=o}var u=e.label,d=`${n}-${r}-${u}-${i}`,f=`${r}-${u}-${i}`;if(!a[f]){var p=a[f]||0;p++,a[f]=p}s[d]={graphId:n,nodeLabel1:r,edgeLabel:u,nodeLabel2:i}})})}),Object.keys(i).forEach(function(e){if(!(i[e]<n)){var t={nodes:[],edges:[]};t.nodes.push({id:`0`,label:e}),r.push(t)}}),r},e.prototype.run=function(){var e=this;if(this.frequentSize1Subgraphs=this.generate1EdgeFrequentSubGraphs(),!(this.maxNodeNum<2)){var t=this.graphs;this.directed;var n={};Object.keys(t).forEach(function(r){var i=t[r],a=i.nodeMap;i.nodes.forEach(function(t){e.findForwardRootEdges(i,t).forEach(function(e){var i=a[e.to],o=`${t.label}-${e.label}-${i.label}`;n[o]||(n[o]={projected:[],nodeLabel1:t.label,edgeLabel:e.label,nodeLabel2:i.label});var s={graphId:r,edge:e,preNode:null};n[o].projected.push(s)})})}),Object.keys(n).forEach(function(t){var r=n[t],i=r.projected,a=r.nodeLabel1,o=r.edgeLabel,s=r.nodeLabel2;e.dfsCode.dfsEdgeList.push(new yC(0,1,a,o,s)),e.subGraphMining(i),e.dfsCode.dfsEdgeList.pop()})}},e})(),function(){function e(e){e===void 0&&(e=10),this.linkedList=new WS,this.maxStep=e}return Object.defineProperty(e.prototype,`length`,{get:function(){return this.linkedList.toArray().length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return!this.linkedList.head},e.prototype.isMaxStack=function(){return this.toArray().length>=this.maxStep},e.prototype.peek=function(){return this.isEmpty()?null:this.linkedList.head.value},e.prototype.push=function(e){this.linkedList.prepend(e),this.length>this.maxStep&&this.linkedList.deleteTail()},e.prototype.pop=function(){var e=this.linkedList.deleteHead();return e?e.value:null},e.prototype.toArray=function(){return this.linkedList.toArray().map(function(e){return e.value})},e.prototype.clear=function(){for(;!this.isEmpty();)this.pop()},e}();function Q(e){if(e.id!==void 0)return e.id;if(e.source!==void 0&&e.target!==void 0)return`${e.source}-${e.target}`;throw Error($x(`The datum does not have available id.`))}function SC(e){return e.combo}function CC(e,t){let n={nodes:(e.nodes||[]).map(Q),edges:(e.edges||[]).map(Q),combos:(e.combos||[]).map(Q)};return t?Object.values(n).flat():n}const wC=(e,t,n)=>{var r;switch(n.type){case`degree`:{let i=new Map;return(r=e.nodes)==null||r.forEach(e=>{let r=t(Q(e),n.direction).length;i.set(Q(e),r)}),i}case`betweenness`:return EC(e,n.directed,n.weightPropertyName);case`closeness`:return DC(e,n.directed,n.weightPropertyName);case`eigenvector`:return kC(e,n.directed);case`pagerank`:return OC(e,n.epsilon,n.linkProb);default:return TC(e)}},TC=e=>{var t;let n=new Map;return(t=e.nodes)==null||t.forEach(e=>{n.set(Q(e),0)}),n},EC=(e,t,n)=>{let r=TC(e),{nodes:i=[]}=e;return i.forEach(a=>{i.forEach(i=>{if(a!==i){let{allPath:o}=fC(e,Q(a),Q(i),t,n),s=o.length;o.flat().forEach(e=>{e!==Q(a)&&e!==Q(i)&&r.set(e,r.get(e)+1/s)})}})}),r},DC=(e,t,n)=>{let r=new Map,{nodes:i=[]}=e;return i.forEach(a=>{let o=i.reduce((r,i)=>{if(a!==i){let{length:o}=fC(e,Q(a),Q(i),t,n);r+=o}return r},0);r.set(Q(a),1/o)}),r},OC=(e,t,n)=>{var r;let i=new Map,a=hC(e,t,n);return(r=e.nodes)==null||r.forEach(e=>{i.set(Q(e),a[Q(e)])}),i},kC=(e,t)=>{let{nodes:n=[]}=e,r=AC(e,t),i=jC(r,n.length),a=new Map;return n.forEach((e,t)=>{a.set(Q(e),i[t])}),a},AC=(e,t)=>{let{nodes:n=[],edges:r=[]}=e,i=Array(n.length).fill(null).map(()=>Array(n.length).fill(0));return r.forEach(({source:e,target:r})=>{let a=n.findIndex(t=>Q(t)===e),o=n.findIndex(e=>Q(e)===r);t?i[a][o]=1:(i[a][o]=1,i[o][a]=1)}),i};var jC=(e,t,n=100,r=1e-6)=>{let i=Array(t).fill(1),a=1/0;for(let o=0;o<n&&a>r;o++){let n=Array(t).fill(0);for(let r=0;r<t;r++)for(let a=0;a<t;a++)n[r]+=e[r][a]*i[a];let r=Math.sqrt(n.reduce((e,t)=>e+t*t,0));for(let e=0;e<t;e++)n[e]/=r;a=Math.sqrt(n.reduce((e,t,n)=>e+(t-i[n])*t,0)),i=n}return i};function MC(e,t,n,r=Gu){let i=new Map(e.map(e=>[n(e),e])),a=new Map(t.map(e=>[n(e),e])),o=new Set(i.keys()),s=new Set(a.keys()),c=[],l=[],u=[],d=[];return s.forEach(e=>{o.has(e)?r(i.get(e),a.get(e))?d.push(a.get(e)):l.push(a.get(e)):c.push(a.get(e))}),o.forEach(e=>{s.has(e)||u.push(i.get(e))}),{enter:c,exit:u,keep:d,update:l}}function NC(e,t,n){let r=e=>{n&&!n(e)||(e.style.visibility=t)};e.forEach(e=>{r(e)})}function PC(e,t,n){let r={},i=e=>(e in r||(r[e]=0),`${t}-${e}-${r[e]++}`);return n.map(t=>typeof t==`string`?{type:t,key:i(t)}:typeof t==`function`?t.call(e):t.key?t:Object.assign(Object.assign({},t),{key:i(t.type)}))}var FC=class{constructor(e){this.extensions=[],this.extensionMap={},this.context=e}setExtensions(e){let t=PC(this.context.graph,this.category,e),{enter:n,update:r,exit:i,keep:a}=MC(this.extensions,t,e=>e.key);this.createExtensions(n),this.updateExtensions([...r,...a]),this.destroyExtensions(i),this.extensions=t}createExtension(e){let{category:t}=this,{key:n,type:r}=e,i=Zx(t,r);if(!i)return eS.warn(`The extension ${r} of ${t} is not registered.`);let a=new i(this.context,e);a.initialized=!0,this.extensionMap[n]=a}createExtensions(e){e.forEach(e=>this.createExtension(e))}updateExtension(e){let{key:t}=e,n=this.extensionMap[t];n&&n.update(e)}updateExtensions(e){e.forEach(e=>this.updateExtension(e))}destroyExtension(e){let t=this.extensionMap[e];t&&(t.initialized&&!t.destroyed&&t.destroy(),delete this.extensionMap[e])}destroyExtensions(e){e.forEach(({key:e})=>this.destroyExtension(e))}destroy(){this.destroyExtensions(this.extensions),this.context={},this.extensions=[],this.extensionMap={}}},IC=class{constructor(e,t){this.events=[],this.initialized=!1,this.destroyed=!1,this.context=e,this.options=t}update(e){this.options=Object.assign(this.options,e)}destroy(){this.context={},this.options={},this.destroyed=!0}},LC=class extends IC{},RC=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.isOverlapping=(e,t)=>t.some(t=>e.intersects(t)),this.occupiedBounds=[],this.detectLabelCollision=e=>{let t=this.context.viewport,n={show:[],hide:[]};return this.occupiedBounds=[],e.forEach(e=>{let r=e.getShape(`label`).getRenderBounds();t.isInViewport(r,!0)&&!this.isOverlapping(r,this.occupiedBounds)?(n.show.push(e),this.occupiedBounds.push(AS(r,this.options.padding))):n.hide.push(e)}),n},this.hideLabelIfExceedViewport=(e,t)=>{let{exit:n}=MC(e,t,e=>e.id);n?.forEach(this.hideLabel)},this.nodeCentralities=new Map,this.sortNodesByCentrality=(e,t)=>{let{model:n}=this.context,r=n.getData(),i=n.getRelatedEdgesData.bind(n);return e.map(e=>(this.nodeCentralities.has(e.id)||(this.nodeCentralities=wC(r,i,t)),{node:e,centrality:this.nodeCentralities.get(e.id)})).sort((e,t)=>t.centrality-e.centrality).map(e=>e.node)},this.sortLabelElementsInView=e=>{let{sort:t,sortNode:n,sortCombo:r,sortEdge:i}=this.options,{model:a}=this.context;if(W(t))return e.sort((e,n)=>t(a.getElementDataById(e.id),a.getElementDataById(n.id)));let{node:o=[],edge:s=[],combo:c=[]}=su(e,e=>e.type),l=W(r)?c.sort((e,t)=>r(...a.getComboData([e.id,t.id]))):c,u=W(n)?o.sort((e,t)=>n(...a.getNodeData([e.id,t.id]))):this.sortNodesByCentrality(o,n),d=W(i)?s.sort((e,t)=>i(...a.getEdgeData([e.id,t.id]))):s;return[...l,...u,...d]},this.labelElementsInView=[],this.isFirstRender=!0,this.onToggleVisibility=e=>{if(e.data?.stage===`zIndex`)return;if(!this.validate(e)){this.hiddenElements.size>0&&(this.hiddenElements.forEach(this.showLabel),this.hiddenElements.clear());return}let t=this.isFirstRender?this.getLabelElements():this.getLabelElementsInView();this.hideLabelIfExceedViewport(this.labelElementsInView,t),this.labelElementsInView=t;let n=this.sortLabelElementsInView(this.labelElementsInView),{show:r,hide:i}=this.detectLabelCollision(n);for(let e=r.length-1;e>=0;e--)this.showLabel(r[e]);i.forEach(this.hideLabel)},this.hiddenElements=new Map,this.hideLabel=e=>{let t=e.getShape(`label`);t&&NC(t,`hidden`),this.hiddenElements.set(e.id,e)},this.showLabel=e=>{let t=e.getShape(`label`);t&&NC(t,`visible`),e.toFront(),this.hiddenElements.delete(e.id)},this.onTransform=Zu(this.onToggleVisibility,this.options.throttle,{leading:!0}),this.enableToggle=!0,this.toggle=e=>{this.enableToggle&&this.onToggleVisibility(e)},this.onBeforeRender=()=>{this.enableToggle=!1},this.onAfterRender=e=>{this.onToggleVisibility(e),this.enableToggle=!0},this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents(),this.onToggleVisibility({})}getLabelElements(){let{elementMap:e}=this.context.element,t=[];for(let n in e){let r=e[n];r.isVisible()&&r.getShape(`label`)&&t.push(r)}return t}getLabelElementsInView(){let e=this.context.viewport;return this.getLabelElements().filter(t=>e.isInViewport(t.getShape(`key`).getRenderBounds()))}bindEvents(){let{graph:e}=this.context;e.on(Z.BEFORE_RENDER,this.onBeforeRender),e.on(Z.AFTER_RENDER,this.onAfterRender),e.on(Z.AFTER_DRAW,this.toggle),e.on(Z.AFTER_LAYOUT,this.toggle),e.on(Z.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:e}=this.context;e.off(Z.BEFORE_RENDER,this.onBeforeRender),e.off(Z.AFTER_RENDER,this.onAfterRender),e.off(Z.AFTER_DRAW,this.toggle),e.off(Z.AFTER_LAYOUT,this.toggle),e.off(Z.AFTER_TRANSFORM,this.onTransform)}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}};RC.defaultOptions={enable:!0,throttle:100,padding:0,sortNode:{type:`degree`}};var zC=[0,0,0];function BC(e,t){return e.map((e,n)=>e+t[n])}function VC(e,t){return e.map((e,n)=>e-t[n])}function HC(e,t){return typeof t==`number`?e.map(e=>e*t):e.map((e,n)=>e*t[n])}function UC(e,t){return typeof t==`number`?e.map(e=>e/t):e.map((e,n)=>e/t[n])}function WC(e,t){return e.reduce((e,n,r)=>e+n*t[r],0)}function GC(e,t){let n=ew(e),r=ew(t);return[n[1]*r[2]-n[2]*r[1],n[2]*r[0]-n[0]*r[2],n[0]*r[1]-n[1]*r[0]]}function KC(e,t){return e.map(e=>e*t)}function qC(e,t){return Math.sqrt(e.reduce((e,n,r)=>e+(n-t[r]||0)**2,0))}function JC(e,t){return e.reduce((e,n,r)=>e+Math.abs(n-t[r]),0)}function YC(e){let t=e.reduce((e,t)=>e+t**2,0);return e.map(e=>e/Math.sqrt(t))}function XC(e,t,n=!1){let r=e[0]*t[1]-e[1]*t[0],i=Math.acos(HC(e,t).reduce((e,t)=>e+t,0)/(qC(e,zC)*qC(t,zC)));return n&&r<0&&(i=2*Math.PI-i),i}function ZC(e,t=!0){return t?[-e[1],e[0]]:[e[1],-e[0]]}function QC(e,t){return e.map(e=>e%t)}function $C(e){return[e[0],e[1]]}function ew(e){return bS(e)?[e[0],e[1],0]:e}function tw(e){let[t,n]=e;return!t&&!n?0:Math.atan2(n,t)}function nw(e,t){let[n,r]=e,[i,a]=t,o=VC(n,r),s=VC(i,a);return GC(o,s).every(e=>e===0)}function rw(e,t,n=!1){if(nw(e,t))return;let[r,i]=e,[a,o]=t,s=((r[0]-a[0])*(a[1]-o[1])-(r[1]-a[1])*(a[0]-o[0]))/((r[0]-i[0])*(a[1]-o[1])-(r[1]-i[1])*(a[0]-o[0])),c=o[0]-a[0]?(r[0]-a[0]+s*(i[0]-r[0]))/(o[0]-a[0]):(r[1]-a[1]+s*(i[1]-r[1]))/(o[1]-a[1]);if(!(!n&&(!SS(s,0,1)||!SS(c,0,1))))return[r[0]+s*(i[0]-r[0]),r[1]+s*(i[1]-r[1])]}function iw(e){if(Array.isArray(e))return SS(e[0],0,1)&&SS(e[1],0,1)?e:[.5,.5];let t=e.split(`-`),n=t.includes(`left`)?0:t.includes(`right`)?1:.5,r=t.includes(`top`)?0:t.includes(`bottom`)?1:.5;return[n,r]}function aw(e){let{x:t=0,y:n=0,z:r=0}=e.style||{};return[+t,+n,+r]}function ow(e){let{x:t,y:n,z:r}=e.style||{};return t!==void 0||n!==void 0||r!==void 0}function sw(e,t){let[n,r]=t,{min:i,max:a}=e;return[i[0]+n*(a[0]-i[0]),i[1]+r*(a[1]-i[1])]}function cw(e,t=`center`){let n=iw(t);return sw(e,n)}function lw(e){return[e.x,e.y,e.z??0]}function uw(e){return{x:e[0],y:e[1],z:e[2]??0}}function dw(e,t=0){return e.map(e=>parseFloat(e.toFixed(t)))}function fw(e,t,n,r=!1){if(Gu(e,t))return e;let i=r?VC(e,t):VC(t,e),a=YC(i),o=[a[0]*n,a[1]*n];return BC($C(e),o)}function pw(e,t){return e[1]===t[1]}function mw(e,t){return e[0]===t[0]}function hw(e,t){return pw(e,t)||mw(e,t)}function gw(e,t,n){return nw([e,t],[t,n])}function _w(e,t){return[2*t[0]-e[0],2*t[1]-e[1]]}function vw(e,t,n,r=!0,i=!1){for(let a=0;a<n.length;a++){let o=n[a],s=n[(a+1)%n.length];r&&(o=BC(t,o),s=BC(t,s));let c=i?_w(e,t):e,l=rw([t,c],[o,s]);if(l)return{point:l,line:[o,s]}}return{point:t,line:void 0}}function yw(e,t,n,r){let i=e[0],a=e[1],o=!1;n===void 0&&(n=0),r===void 0&&(r=t.length);let s=r-n;for(let e=0,r=s-1;e<s;r=e++){let s=t[e+n][0],c=t[e+n][1],l=t[r+n][0],u=t[r+n][1];c>a!=u>a&&i<(l-s)*(a-c)/(u-c)+s&&(o=!o)}return o}function bw(e,t,n=!1){let r=cw(t,`center`),i=[cw(t,`left-top`),cw(t,`right-top`),cw(t,`right-bottom`),cw(t,`left-bottom`)];return vw(e,r,i,!1,n).point}function xw(e,t,n=!1){let r=t.center,i=n?_w(e,r):e,a=VC(i,t.center),o=Math.atan2(a[1],a[0]);if(isNaN(o))return r;let s=TS(t)/2,c=ES(t)/2,l=r[0]+s*Math.cos(o),u=r[1]+c*Math.sin(o);return[l,u]}function Sw(e,t){let n=1/0,r=[e[0],t[0]];return e.forEach(e=>{t.forEach(t=>{let i=qC(e,t);i<n&&(n=i,r=[e,t])})}),r}function Cw(e,t){let n=1/0,r=[[0,0],[0,0]];return t.forEach(t=>{let i=ww(e,t);i<n&&(n=i,r=t)}),r}function ww(e,t){let n=Tw(e,t);return qC(e,n)}function Tw(e,t){let[n,r]=t[0],[i,a]=t[1],[o,s]=e,c=i-n,l=a-r;if(c===0&&l===0)return[n,r];let u=((o-n)*c+(s-r)*l)/(c*c+l*l);u>1?u=1:u<0&&(u=0);let d=n+u*c,f=r+u*l;return[d,f]}function Ew(e){let t=e.reduce((e,t)=>BC(e,t),[0,0]);return UC(t,e.length)}function Dw(e,t=!0){let n=Ew(e);return e.sort(([e,r],[i,a])=>{let o=Math.atan2(r-n[1],e-n[0]),s=Math.atan2(a-n[1],i-n[0]);return t?s-o:o-s})}function Ow(e,t){return[e,[e[0],t[1]],t,[t[0],e[1]]]}var kw=class e{constructor(t,n,r){if(this.phase=n,this.pointerByTouch=[],this.initialDistance=null,this.emitter=t,e.instance)return e.callbacks[this.phase].push(r),e.instance;this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.bindEvents(),e.instance=this,e.callbacks[this.phase].push(r)}bindEvents(){let{emitter:e}=this;e.on(X.POINTER_DOWN,this.onPointerDown),e.on(X.POINTER_MOVE,this.onPointerMove),e.on(X.POINTER_UP,this.onPointerUp)}updatePointerPosition(e,t,n){let r=this.pointerByTouch.findIndex(t=>t.pointerId===e);r>=0&&(this.pointerByTouch[r]={x:t,y:n,pointerId:e})}onPointerDown(t){let{x:n,y:r}=t.client||{};if(!(n===void 0||r===void 0)&&(this.pointerByTouch.push({x:n,y:r,pointerId:t.pointerId}),t.pointerType===`touch`&&this.pointerByTouch.length===2)){e.isPinching=!0;let n=this.pointerByTouch[0].x-this.pointerByTouch[1].x,r=this.pointerByTouch[0].y-this.pointerByTouch[1].y;this.initialDistance=Math.sqrt(n*n+r*r),e.callbacks.pinchstart.forEach(e=>e(t,{scale:0}))}}onPointerMove(t){if(this.pointerByTouch.length!==2||this.initialDistance===null)return;let{x:n,y:r}=t.client||{};if(n===void 0||r===void 0)return;this.updatePointerPosition(t.pointerId,n,r);let i=this.pointerByTouch[0].x-this.pointerByTouch[1].x,a=this.pointerByTouch[0].y-this.pointerByTouch[1].y,o=Math.sqrt(i*i+a*a)/this.initialDistance;e.callbacks.pinchmove.forEach(e=>e(t,{scale:(o-1)*5}))}onPointerUp(t){var n;e.callbacks.pinchend.forEach(e=>e(t,{scale:0})),e.isPinching=!1,this.initialDistance=null,this.pointerByTouch=[],(n=e.instance)==null||n.tryDestroy()}destroy(){this.emitter.off(X.POINTER_DOWN,this.onPointerDown),this.emitter.off(X.POINTER_MOVE,this.onPointerMove),this.emitter.off(X.POINTER_UP,this.onPointerUp),e.instance=null}off(t,n){let r=e.callbacks[t].indexOf(n);r>-1&&e.callbacks[t].splice(r,1),this.tryDestroy()}tryDestroy(){Object.values(e.callbacks).every(e=>e.length===0)&&this.destroy()}};kw.isPinching=!1,kw.instance=null,kw.callbacks={pinchstart:[],pinchmove:[],pinchend:[]};var Aw=e=>e.map(e=>ru(e)?e.toLocaleLowerCase():e),jw=class{constructor(e){this.map=new Map,this.boundHandlePinch=()=>{},this.recordKey=new Set,this.onKeyDown=e=>{e?.key&&(this.recordKey.add(e.key),this.trigger(e))},this.onKeyUp=e=>{e?.key&&this.recordKey.delete(e.key)},this.onWheel=e=>{this.triggerExtendKey(X.WHEEL,e)},this.onDrag=e=>{this.triggerExtendKey(X.DRAG,e)},this.handlePinch=(e,t)=>{this.triggerExtendKey(X.PINCH,Object.assign(Object.assign({},e),t))},this.onFocus=()=>{this.recordKey.clear()},this.emitter=e,this.bindEvents()}bind(e,t){e.length!==0&&(e.includes(X.PINCH)&&!this.pinchHandler&&(this.boundHandlePinch=this.handlePinch.bind(this),this.pinchHandler=new kw(this.emitter,`pinchmove`,this.boundHandlePinch)),this.map.set(e,t))}unbind(e,t){this.map.forEach((n,r)=>{Gu(r,e)&&(!t||t===n)&&this.map.delete(r)})}unbindAll(){this.map.clear()}match(e){let t=Aw(Array.from(this.recordKey)).sort(),n=Aw(e).sort();return Gu(t,n)}bindEvents(){var e;let{emitter:t}=this;t.on(X.KEY_DOWN,this.onKeyDown),t.on(X.KEY_UP,this.onKeyUp),t.on(X.WHEEL,this.onWheel),t.on(X.DRAG,this.onDrag),(e=globalThis.addEventListener)==null||e.call(globalThis,`focus`,this.onFocus)}trigger(e){this.map.forEach((t,n)=>{this.match(n)&&t(e)})}triggerExtendKey(e,t){this.map.forEach((n,r)=>{r.includes(e)&&Gu(Array.from(this.recordKey),r.filter(t=>t!==e))&&n(t)})}destroy(){var e,t;this.unbindAll(),this.emitter.off(X.KEY_DOWN,this.onKeyDown),this.emitter.off(X.KEY_UP,this.onKeyUp),this.emitter.off(X.WHEEL,this.onWheel),this.emitter.off(X.DRAG,this.onDrag),(e=this.pinchHandler)==null||e.off(`pinchmove`,this.boundHandlePinch),(t=globalThis.removeEventListener)==null||t.call(globalThis,`blur`,this.onFocus)}},Mw=class e extends LC{constructor(t,n){super(t,Bu({},e.defaultOptions,n)),this.shortcut=new jw(t.graph),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.clearStates=this.clearStates.bind(this),this.bindEvents()}onPointerDown(e){if(!this.validate(e)||!this.isKeydown()||this.startPoint)return;let{canvas:t,graph:n}=this.context,r=Object.assign({},this.options.style);this.options.style.lineWidth&&(r.lineWidth=+this.options.style.lineWidth/n.getZoom()),this.rectShape=new Gy({id:`g6-brush-select`,style:r}),t.appendChild(this.rectShape),this.startPoint=[e.canvas.x,e.canvas.y]}onPointerMove(e){var t;if(!this.startPoint)return;let{immediately:n,mode:r}=this.options;this.endPoint=Nw(e),(t=this.rectShape)==null||t.attr({x:Math.min(this.endPoint[0],this.startPoint[0]),y:Math.min(this.endPoint[1],this.startPoint[1]),width:Math.abs(this.endPoint[0]-this.startPoint[0]),height:Math.abs(this.endPoint[1]-this.startPoint[1])}),n&&r===`default`&&this.updateElementsStates(Ow(this.startPoint,this.endPoint))}onPointerUp(e){if(this.startPoint){if(!this.endPoint){this.clearBrush();return}this.endPoint=Nw(e),this.updateElementsStates(Ow(this.startPoint,this.endPoint)),this.clearBrush()}}clearStates(){this.endPoint||this.clearElementsStates()}clearElementsStates(){let{graph:e}=this.context,t=Object.values(e.getData()).reduce((e,t)=>Object.assign({},e,t.reduce((e,t)=>{let n=(t.states||[])?.filter(e=>e!==this.options.state);return e[Q(t)]=n,e},{})),{});e.setElementState(t,this.options.animation)}updateElementsStates(e){let{graph:t}=this.context,{enableElements:n,state:r,mode:i,onSelect:a}=this.options,o=this.selector(t,e,n),s={};switch(i){case`union`:o.forEach(e=>{s[e]=[...t.getElementState(e),r]});break;case`diff`:o.forEach(e=>{let n=t.getElementState(e);s[e]=n.includes(r)?n.filter(e=>e!==r):[...n,r]});break;case`intersect`:o.forEach(e=>{s[e]=t.getElementState(e).includes(r)?[r]:[]});break;case`default`:default:o.forEach(e=>{s[e]=[r]});break}W(a)&&(s=a(s)),t.setElementState(s,this.options.animation)}selector(e,t,n){if(!n||n.length===0)return[];let r=[],i=e.getData();return n.forEach(n=>{i[`${n}s`].forEach(n=>{let i=Q(n);e.getElementVisibility(i)!==`hidden`&&yw(e.getElementPosition(i),t)&&r.push(i)})}),n.includes(`edge`)&&i.edges?.forEach(e=>{let{source:t,target:n}=e;r.includes(t)&&r.includes(n)&&r.push(Q(e))}),r}clearBrush(){var e;(e=this.rectShape)==null||e.remove(),this.rectShape=void 0,this.startPoint=void 0,this.endPoint=void 0}isKeydown(){let{trigger:e}=this.options,t=Array.isArray(e)?e:[e];return this.shortcut.match(t.filter(e=>e!==`drag`))}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}bindEvents(){let{graph:e}=this.context;e.on(X.POINTER_DOWN,this.onPointerDown),e.on(X.POINTER_MOVE,this.onPointerMove),e.on(X.POINTER_UP,this.onPointerUp),e.on(Vx.CLICK,this.clearStates)}unbindEvents(){let{graph:e}=this.context;e.off(X.POINTER_DOWN,this.onPointerDown),e.off(X.POINTER_MOVE,this.onPointerMove),e.off(X.POINTER_UP,this.onPointerUp),e.off(Vx.CLICK,this.clearStates)}update(e){this.unbindEvents(),this.options=Bu(this.options,e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}};Mw.defaultOptions={animation:!1,enable:!0,enableElements:[`node`,`combo`,`edge`],immediately:!1,mode:`default`,state:`selected`,trigger:[`shift`],style:{width:0,height:0,lineWidth:1,fill:`#1677FF`,stroke:`#1677FF`,fillOpacity:.1,zIndex:2,pointerEvents:`none`}};const Nw=e=>[e.canvas.x,e.canvas.y],Pw=.8,Fw=[`node`,`edge`,`combo`];function Iw(e,t,n,r,i=0){r===`TB`&&t(e,i);let a=n(e);if(a)for(let e of a)Iw(e,t,n,r,i+1);r===`BT`&&t(e,i)}function Lw(e,t,n){let r=[[e,0]];for(;r.length;){let[e,i]=r.shift();t(e,i);let a=n(e);if(a)for(let e of a)r.push([e,i+1])}}function Rw(e,t,n,r,i=`both`){if(t===`combo`||t===`node`)return zw(e,n,r,i);let a=e.getEdgeData(n);if(!a)return[];let o=zw(e,a.source,r-1,i),s=zw(e,a.target,r-1,i);return Array.from(new Set([...o,...s,n]))}function zw(e,t,n,r=`both`){let i=new Set,a=new Set,o=new Set;return Lw(t,(t,i)=>{i>n||(o.add(t),e.getRelatedEdgesData(t,r).forEach(e=>{let t=Q(e);!a.has(t)&&i<n&&(o.add(t),a.add(t))}))},t=>e.getRelatedEdgesData(t,r).map(e=>e.source===t?e.target:e.source).filter(e=>i.has(e)?!1:(i.add(e),!0))),Array.from(o)}function Bw(e){return e.states||[]}var Vw=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Hw=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.onClickSelect=e=>Vw(this,void 0,void 0,function*(){var t,n;this.validate(e)&&(yield this.updateState(e),(n=(t=this.options).onClick)==null||n.call(t,e))}),this.onClickCanvas=e=>Vw(this,void 0,void 0,function*(){var t,n;this.validate(e)&&(yield this.clearState(),(n=(t=this.options).onClick)==null||n.call(t,e))}),this.shortcut=new jw(t.graph),this.bindEvents()}bindEvents(){let{graph:e}=this.context;this.unbindEvents(),Fw.forEach(t=>{e.on(`${t}:${X.CLICK}`,this.onClickSelect)}),e.on(Vx.CLICK,this.onClickCanvas)}get isMultipleSelect(){let{multiple:e,trigger:t}=this.options;return e&&this.shortcut.match(t)}getNeighborIds(e){let{target:t,targetType:n}=e,{graph:r}=this.context,{degree:i}=this.options;return Rw(r,n,t.id,typeof i==`function`?i(e):i).filter(e=>e!==t.id)}updateState(e){return Vw(this,void 0,void 0,function*(){let{state:t,unselectedState:n,neighborState:r,animation:i}=this.options;if(!t&&!r&&!n)return;let{target:a}=e,{graph:o}=this.context,s=o.getElementData(a.id),c=Bw(s).includes(t)?`unselect`:`select`,l={},u=this.isMultipleSelect,d=[a.id],f=this.getNeighborIds(e);if(u)if(Object.assign(l,this.getDataStates()),c===`select`){let e=(e,t)=>{e.forEach(e=>{let r=new Set(o.getElementState(e));r.add(t),r.delete(n),l[e]=Array.from(r)})};e(d,t),e(f,r),n&&Object.keys(l).forEach(e=>{let i=l[e];!i.includes(t)&&!i.includes(r)&&!i.includes(n)&&l[e].push(n)})}else{let e=l[a.id];l[a.id]=e.filter(e=>e!==t&&e!==r),e.includes(n)||l[a.id].push(n),f.forEach(e=>{l[e]=l[e].filter(e=>e!==r),l[e].includes(t)||l[e].push(n)})}else if(c===`select`){Object.assign(l,this.getClearStates(!!n));let e=(e,t)=>{e.forEach(e=>{l[e]||(l[e]=o.getElementState(e)),l[e].push(t)})};e(d,t),e(f,r),n&&Object.keys(l).forEach(e=>{!d.includes(e)&&!f.includes(e)&&l[e].push(n)})}else Object.assign(l,this.getClearStates());yield o.setElementState(l,i)})}getDataStates(){let{graph:e}=this.context,{nodes:t,edges:n,combos:r}=e.getData(),i={};return[...t,...n,...r].forEach(e=>{i[Q(e)]=Bw(e)}),i}getClearStates(e=!1){let{graph:t}=this.context,{state:n,unselectedState:r,neighborState:i}=this.options,a=new Set([n,r,i]),{nodes:o,edges:s,combos:c}=t.getData(),l={};return[...o,...s,...c].forEach(t=>{let n=Bw(t),r=n.filter(e=>!a.has(e));(e||r.length!==n.length)&&(l[Q(t)]=r)}),l}clearState(){return Vw(this,void 0,void 0,function*(){let{graph:e}=this.context;yield e.setElementState(this.getClearStates(),this.options.animation)})}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}unbindEvents(){let{graph:e}=this.context;Fw.forEach(t=>{e.off(`${t}:${X.CLICK}`,this.onClickSelect)}),e.off(Vx.CLICK,this.onClickCanvas)}destroy(){this.unbindEvents(),super.destroy()}};Hw.defaultOptions={animation:!0,enable:!0,multiple:!1,trigger:[`shift`],state:`selected`,neighborState:`selected`,unselectedState:void 0,degree:0};function Uw(e){return!!e.style?.collapsed}function Ww(e,t){if(!e.startsWith(t))return!1;let n=e[t.length];return n>=`A`&&n<=`Z`}function Gw(e,t){return`${t}${vu(e)}`}function Kw(e,t,n=!0){if(!t||!Ww(e,t))return e;let r=e.slice(t.length);return n?hu(r):r}function qw(e,t){let n=Object.entries(e).reduce((e,[n,r])=>(n===`className`||n===`class`||Ww(n,t)&&Object.assign(e,{[Kw(n,t)]:r}),e),{});if(`opacity`in e){let r=Gw(`opacity`,t),i=e.opacity;if(r in e){let t=e[r];Object.assign(n,{opacity:i*t})}else Object.assign(n,{opacity:i})}return n}function Jw(e,t){let n=t.length;return Object.keys(e).reduce((r,i)=>{if(i.startsWith(t)){let t=i.slice(n);r[t]=e[i]}return r},{})}function Yw(e,t){let n=typeof t==`string`?[t]:t,r={};return Object.keys(e).forEach(t=>{n.find(e=>t.startsWith(e))||(r[t]=e[t])}),r}function Xw(e=0){if(typeof e==`number`)return[e,e,e];let[t,n=t,r=t]=e;return[t,n,r]}var Zw=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function Qw(e,t){let{datum:n,graph:r}=t;return typeof e==`function`?e.call(r,n):Object.fromEntries(Object.entries(e).map(([e,t])=>typeof t==`function`?[e,t.call(r,n)]:[e,t]))}function $w(e,t){let n=e?.style||{},r=t?.style||{};for(let e in n)e in r||(r[e]=n[e]);return Object.assign({},e,t,{style:r})}function eT(e){let{x:t,y:n,z:r,class:i,className:a,transform:o,transformOrigin:s,zIndex:c,visibility:l}=e;return Zw(e,[`x`,`y`,`z`,`class`,`className`,`transform`,`transformOrigin`,`zIndex`,`visibility`])}function tT(e,t){let n=Xw(e),r={};return t.text&&!t.fontSize&&(r={fontSize:Math.min(...n)*.5}),t.src&&(!t.width||!t.height)&&(r={width:n[0]*.5,height:n[1]*.5}),r}function nT(e){if(e)return typeof e==`string`||typeof e==`function`||Array.isArray(e)?{type:`group`,field:e=>e.id,color:e,invert:!1}:e}function rT(e,t){if(!t)return{};let{type:n,color:r,field:i,invert:a}=t,o=e=>{let t=typeof r==`string`?Zx(`palette`,r):r;if(typeof t==`function`){let n={};return e.forEach(([e,r])=>{n[e]=t(a?1-r:r)}),n}else if(Array.isArray(t)){let n=a?[...t].reverse():t,r={};return e.forEach(([e,i])=>{r[e]=n[i%t.length]}),r}return{}},s=(e,t)=>typeof e==`string`?t.data?.[e]:e?.(t);if(n===`group`){let t=su(e,e=>{if(!i)return`default`;let t=s(i,e);return t?String(t):`default`}),n=o(Object.keys(t).map((e,t)=>[e,t])),r={};return Object.entries(t).forEach(([e,t])=>{t.forEach(t=>{r[Q(t)]=n[e]})}),r}else if(n===`value`){let[t,n]=e.reduce(([e,t],n)=>{let r=s(i,n);if(typeof r!=`number`)throw Error($x(`Palette field ${i} is not a number`));return[Math.min(e,r),Math.max(t,r)]},[1/0,-1/0]),r=n-t;return o(e.map(e=>[e.id,(s(i,e)-t)/r]))}}function iT(e){let t=typeof e==`string`?Zx(`palette`,e):e;if(typeof t!=`function`)return t}function aT(e,t){let n=2*e;return typeof t==`string`?n=e*Number(t.replace(`%`,``))/100:typeof t==`number`&&(n=t),isNaN(n)&&(n=2*e),n}function oT(e,t,n=1,r=!1){let i=r?n:1,a=(e.max[0]-e.min[0])*i;return aT(a,t)}function sT(e,t,n=1){let r=qC(e[0],e[1])*n;return aT(r,t)}var cT=class extends Ay{constructor(e){uT(e.style),super(e),this.shapeMap={},this.animateMap={},this.render(this.attributes,this),this.setVisibility(),this.bindEvents()}get parsedAttributes(){return this.attributes}upsert(e,t,n,r,i){var a,o,s,c,l,u,d,f;let p=this.shapeMap[e];if(n===!1){p&&((a=i?.beforeDestroy)==null||a.call(i,p),r.removeChild(p),delete this.shapeMap[e],(o=i?.afterDestroy)==null||o.call(i,p));return}let m=typeof t==`string`?Zx(Yx.SHAPE,t):t;if(!m)throw Error($x(`Shape ${t} not found`));if(!p||p.destroyed||!(p instanceof m)){p&&((s=i?.beforeDestroy)==null||s.call(i,p),p?.destroy(),(c=i?.afterDestroy)==null||c.call(i,p)),(l=i?.beforeCreate)==null||l.call(i);let t=new m({className:e,style:n});return r.appendChild(t),this.shapeMap[e]=t,(u=i?.afterCreate)==null||u.call(i,t),t}return(d=i?.beforeUpdate)==null||d.call(i,p),ek(p,n),(f=i?.afterUpdate)==null||f.call(i,p),p}update(e={}){let t=Object.assign({},this.attributes,e);uT(t),$O(this,t),this.render(t,this),this.setVisibility()}bindEvents(){}getGraphicStyle(e){return eT(e)}get compositeShapes(){return[[`badges`,`badge-`],[`ports`,`port-`]]}animate(e,t){if(e.length===0)return null;let n=[];if(e[0].x!==void 0||e[0].y!==void 0||e[0].z!==void 0){let{x:t=0,y:n=0,z:r=0}=this.attributes;e.forEach(e=>{let{x:i=t,y:a=n,z:o=r}=e;Object.assign(e,{transform:o?[[`translate3d`,i,a,o]]:[[`translate`,i,a]]})})}let r=super.animate(e,t);if(r&&(lT(this,r),n.push(r)),Array.isArray(e)&&e.length>0){let r=[`transform`,`transformOrigin`,`x`,`y`,`z`,`zIndex`];if(Object.keys(e[0]).some(e=>!r.includes(e))){Object.entries(this.shapeMap).forEach(([r,i])=>{let a=`get${vu(r)}Style`,o=this[a];if(W(o)){let r=e.map(e=>o.call(this,Object.assign(Object.assign({},this.attributes),e))),a=i.animate(rS(r),t);a&&(lT(i,a),n.push(a))}});let r=(r,i)=>{if(!Uu(r)){let a=`get${vu(i)}Style`,o=this[a];if(W(o)){let i=e.map(e=>o.call(this,Object.assign(Object.assign({},this.attributes),e)));Object.entries(i[0]).map(([e])=>{let a=i.map(t=>t[e]),o=r[e];if(o){let e=o.animate(rS(a),t);e&&(lT(o,e),n.push(e))}})}}};this.compositeShapes.forEach(([e,t])=>{let n=Jw(this.shapeMap,t);r(n,e)})}}return nS(n)}getShape(e){return this.shapeMap[e]}setVisibility(){let{visibility:e}=this.attributes;NC(this,e)}destroy(){this.shapeMap={},this.animateMap={},super.destroy()}};function lT(e,t){t?.finished.then(()=>{let n=e.activeAnimations.findIndex(e=>e===t);n>-1&&e.activeAnimations.splice(n,1)})}function uT(e){if(!e)return{};if(`x`in e||`y`in e||`z`in e){let{x:t=0,y:n=0,z:r,transform:i}=e,a=cS(t,n,r,i);a&&(e.transform=a)}return e}var dT=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},fT=class e extends cT{constructor(t){super($w({style:e.defaultStyleProps},t))}isTextStyle(e){return Ww(e,`label`)}isBackgroundStyle(e){return Ww(e,`background`)}getTextStyle(e){let t=this.getGraphicStyle(e),{padding:n}=t,r=dT(t,[`padding`]);return Yw(r,`background`)}getBackgroundStyle(e){if(e.background===!1)return!1;let t=this.getGraphicStyle(e),{wordWrap:n,wordWrapWidth:r,padding:i}=t,a=qw(t,`background`),{min:[o,s],center:[c,l],halfExtents:[u,d]}=this.shapeMap.text.getGeometryBounds(),[f,p,m,h]=CS(i),g=u*2+h+p,{width:_,height:v}=a;_&&v?Object.assign(a,{x:c-Number(_)/2,y:l-Number(v)/2}):Object.assign(a,{x:o-h,y:s-f,width:n?Math.min(g,r+h+p):g,height:d*2+f+m});let{radius:y}=a;if(typeof y==`string`&&y.endsWith(`%`)){let e=Number(y.replace(`%`,``))/100;a.radius=Math.min(+a.width,+a.height)*e}return a}render(e=this.parsedAttributes,t=this){this.upsert(`text`,qy,this.getTextStyle(e),t),this.upsert(`background`,Gy,this.getBackgroundStyle(e),t)}getGeometryBounds(){return(this.getShape(`background`)||this.getShape(`text`)).getGeometryBounds()}};fT.defaultStyleProps={padding:0,fontSize:12,fontFamily:`system-ui, sans-serif`,wordWrap:!0,maxLines:1,wordWrapWidth:128,textOverflow:`...`,textBaseline:`middle`,backgroundOpacity:.75,backgroundZIndex:-1,backgroundLineWidth:0};var pT=class e extends cT{constructor(t){super($w({style:e.defaultStyleProps},t))}getBadgeStyle(e){return this.getGraphicStyle(e)}render(e=this.parsedAttributes,t=this){this.upsert(`label`,fT,this.getBadgeStyle(e),t)}getGeometryBounds(){let e=this.getShape(`label`);return(e.getShape(`background`)||e.getShape(`text`)).getGeometryBounds()}};pT.defaultStyleProps={padding:[2,4,2,4],fontSize:10,wordWrap:!1,backgroundRadius:`50%`,backgroundOpacity:1};function mT(e,t=!0){let n=[];return e.forEach((e,t)=>{n.push([t===0?`M`:`L`,...e])}),t&&n.push([`Z`]),n}var hT={M:[`x`,`y`],m:[`dx`,`dy`],H:[`x`],h:[`dx`],V:[`y`],v:[`dy`],L:[`x`,`y`],l:[`dx`,`dy`],Z:[],z:[],C:[`x1`,`y1`,`x2`,`y2`,`x`,`y`],c:[`dx1`,`dy1`,`dx2`,`dy2`,`dx`,`dy`],S:[`x2`,`y2`,`x`,`y`],s:[`dx2`,`dy2`,`dx`,`dy`],Q:[`x1`,`y1`,`x`,`y`],q:[`dx1`,`dy1`,`dx`,`dy`],T:[`x`,`y`],t:[`dx`,`dy`],A:[`rx`,`ry`,`rotation`,`large-arc`,`sweep`,`x`,`y`],a:[`rx`,`ry`,`rotation`,`large-arc`,`sweep`,`dx`,`dy`]};function gT(e){let t=e.replace(/[\n\r]/g,``).replace(/-/g,` -`).replace(/(\d*\.)(\d+)(?=\.)/g,`$1$2 `).trim().split(/\s*,|\s+/),n=[],r=``,i={};for(;t.length>0;){let e=t.shift();e in hT?r=e:t.unshift(e),i={type:r},hT[r].forEach(n=>{e=t.shift(),i[n]=e}),r===`M`?r=`L`:r===`m`&&(r=`l`);let[a,...o]=Object.values(i);n.push([a,...o.map(Number)])}return n}function _T(e){let t=[];return(typeof e==`string`?gT(e):e).forEach(e=>{let n=e[0];if(n===`Z`){t.push(t[0]);return}if(n!==`A`)for(let n=1;n<e.length;n+=2)t.push([e[n],e[n+1],0]);else{let n=e.length;t.push([e[n-2],e[n-1],0])}}),t}const vT=e=>{if(e.length<2)return[[`M`,0,0],[`L`,0,0]];let t=e[0],n=e[1],r=e[e.length-1],i=e[e.length-2];e.unshift(i,r),e.push(t,n);let a=[[`M`,r[0],r[1]]];for(let t=1;t<e.length-2;t+=1){let[n,r]=e[t-1],[i,o]=e[t],[s,c]=e[t+1],[l,u]=t===e.length-2?[s,c]:e[t+2],d=i+(s-n)/6,f=o+(c-r)/6,p=s-(l-i)/6,m=c-(u-o)/6;a.push([`C`,d,f,p,m,s,c])}return a};function yT(e,t,n,r,i,a,o){let[s,c]=cw(e,t),l={textAlign:t===`left`?`right`:t===`right`?`left`:`center`,textBaseline:t===`top`?`bottom`:t===`bottom`?`top`:`middle`,transform:[[`translate`,s+n,c+r]]};if(t===`center`||!i)return l;let u=_T(a);if(!u||u.length<=3)return l;let d=u.map((e,t)=>{let n=e,r=u[(t+1)%u.length];return Gu(n,r)?null:[n,r]}).filter(Boolean),f=Cw([s,c],d),p=Tw([s,c],f);if(p&&f&&(l.transform=[[`translate`,p[0]+n,p[1]+r]],o)){let e=Math.atan((f[0][1]-f[1][1])/(f[0][0]-f[1][0]));l.transform.push([`rotate`,e/Math.PI*180]),l.textAlign=`center`,(t===`right`||t===`left`)&&(e>0?l.textBaseline=t===`right`?`bottom`:`top`:l.textBaseline=t===`right`?`top`:`bottom`)}return l}var bT=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},xT=class e extends cT{constructor(t){super($w({style:e.defaultStyleProps},t))}getLabelStyle(e){if(!e.label||!e.d||e.d.length===0)return!1;let t=qw(this.getGraphicStyle(e),`label`),{maxWidth:n,offsetX:r,offsetY:i,autoRotate:a,placement:o,closeToPath:s}=t,c=bT(t,[`maxWidth`,`offsetX`,`offsetY`,`autoRotate`,`placement`,`closeToPath`]),l=this.shapeMap.key,u=l?.getRenderBounds();return Object.assign(yT(u,o,r,i,s,e.d,a),{wordWrapWidth:oT(u,n)},c)}getKeyStyle(e){return this.getGraphicStyle(e)}render(e,t){this.upsert(`key`,By,this.getKeyStyle(e),t),this.upsert(`label`,fT,this.getLabelStyle(e),t)}};xT.defaultStyleProps={label:!0,labelPlacement:`bottom`,labelCloseToPath:!0,labelAutoRotate:!0,labelOffsetX:0,labelOffsetY:0};function ST(e){let t=[],n=e=>{e?.children.length&&e.children.forEach(e=>{t.push(e),n(e)})};return n(e),t}function CT(e){let t=[],n=e.parentNode;for(;n;)t.push(n),n=n.parentNode;return t}var wT=class extends Iy{constructor(e){super(e),this.onMounted=()=>{this.handleRadius()},this.onAttrModified=()=>{this.handleRadius()},ET=this,this.isMutationObserved=!0,this.addEventListener(Nv.MOUNTED,this.onMounted),this.addEventListener(Nv.ATTR_MODIFIED,this.onAttrModified)}handleRadius(){let{radius:e,clipPath:t,width:n=0,height:r=0}=this.attributes;if(e&&n&&r){let[i,a]=this.getBounds().min,o={x:i,y:a,radius:e,width:n,height:r};if(t)Object.assign(this.parsedStyle.clipPath.style,o);else{let e=new Gy({style:o});this.style.clipPath=e}}else t&&(this.style.clipPath=null)}},TT=new WeakMap,ET=null;const DT=e=>{if(ET&&CT(ET).includes(e)){let t=TT.get(e);t?t.includes(ET)||t.push(ET):TT.set(e,[ET])}},OT=e=>{let t=TT.get(e);t&&t.forEach(e=>e.handleRadius())};var kT=class extends cT{constructor(e){super(e)}isImage(){let{src:e}=this.attributes;return!!e}getIconStyle(e=this.attributes){let{width:t=0,height:n=0}=e,r=this.getGraphicStyle(e);return this.isImage()?Object.assign({x:-t/2,y:-n/2},r):Object.assign({textBaseline:`middle`,textAlign:`center`},r)}render(e=this.attributes,t=this){this.upsert(`icon`,this.isImage()?wT:qy,this.getIconStyle(e),t)}},AT=class extends cT{get context(){return this.config.context}get parsedAttributes(){return this.attributes}onframe(){}animate(e,t){let n=super.animate(e,t);return n&&(n.onframe=()=>this.onframe(),n.finished.then(()=>this.onframe())),n}},jT=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},MT=class e extends AT{constructor(t){super($w({style:e.defaultStyleProps},t)),this.type=`node`}getSize(e=this.attributes){let{size:t}=e;return Xw(t)}getKeyStyle(e){let t=this.getGraphicStyle(e);return Object.assign(Yw(t,[`label`,`halo`,`icon`,`badge`,`port`]))}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;let t=qw(this.getGraphicStyle(e),`label`),{placement:n,maxWidth:r,offsetX:i,offsetY:a}=t,o=jT(t,[`placement`,`maxWidth`,`offsetX`,`offsetY`]),s=this.getShape(`key`).getLocalBounds();return Object.assign(KO(s,n,i,a),{wordWrapWidth:oT(s,r)},o)}getHaloStyle(e){if(e.halo===!1)return!1;let t=this.getKeyStyle(e),{fill:n}=t,r=jT(t,[`fill`]),i=qw(this.getGraphicStyle(e),`halo`);return Object.assign(Object.assign(Object.assign({},r),{stroke:n}),i)}getIconStyle(e){if(e.icon===!1||!e.iconText&&!e.iconSrc)return!1;let t=qw(this.getGraphicStyle(e),`icon`);return Object.assign(tT(e.size,t),t)}getBadgesStyle(e){let t=Jw(this.shapeMap,`badge-`),n={};if(Object.keys(t).forEach(e=>{n[e]=!1}),e.badge===!1||!e.badges?.length)return n;let{badges:r=[],badgePalette:i,opacity:a=1}=e,o=jT(e,[`badges`,`badgePalette`,`opacity`]),s=iT(i),c=qw(this.getGraphicStyle(o),`badge`);return r.forEach((e,t)=>{n[t]=Object.assign(Object.assign({backgroundFill:s?s[t%s?.length]:void 0,opacity:a},c),this.getBadgeStyle(e))}),n}getBadgeStyle(e){let t=this.getShape(`key`),{placement:n=`top`,offsetX:r,offsetY:i}=e,a=jT(e,[`placement`,`offsetX`,`offsetY`]),o=KO(t.getLocalBounds(),n,r,i,!0);return Object.assign(Object.assign({},o),a)}getPortsStyle(e){let t=this.getPorts(),n={};if(Object.keys(t).forEach(e=>{n[e]=!1}),e.port===!1||!e.ports?.length)return n;let r=qw(this.getGraphicStyle(e),`port`),{ports:i=[]}=e;return i.forEach((t,i)=>{let a=t.key||i,o=Object.assign(Object.assign({},r),t);if(RO(o))n[a]=!1;else{let[r,i]=this.getPortXY(e,t);n[a]=Object.assign({transform:[[`translate`,r,i]]},o)}}),n}getPortXY(e,t){let{placement:n=`left`}=t,r=this.getShape(`key`);return IO(NT(this.context,r),n)}getPorts(){return Jw(this.shapeMap,`port-`)}getCenter(){return this.getShape(`key`).getBounds().center}getIntersectPoint(e,t=!1){let n=this.getShape(`key`).getBounds();return bw(e,n,t)}drawHaloShape(e,t){let n=this.getHaloStyle(e),r=this.getShape(`key`);this.upsert(`halo`,r.constructor,n,t)}drawIconShape(e,t){let n=this.getIconStyle(e);this.upsert(`icon`,kT,n,t),DT(this)}drawBadgeShapes(e,t){let n=this.getBadgesStyle(e);Object.keys(n).forEach(e=>{let r=n[e];this.upsert(`badge-${e}`,pT,r,t)})}drawPortShapes(e,t){let n=this.getPortsStyle(e);Object.keys(n).forEach(e=>{let r=n[e],i=`port-${e}`;this.upsert(i,Oy,r,t)})}drawLabelShape(e,t){let n=this.getLabelStyle(e);this.upsert(`label`,fT,n,t)}_drawKeyShape(e,t){return this.drawKeyShape(e,t)}render(e=this.parsedAttributes,t=this){this._drawKeyShape(e,t),this.getShape(`key`)&&(this.drawHaloShape(e,t),this.drawIconShape(e,t),this.drawBadgeShapes(e,t),this.drawLabelShape(e,t),this.drawPortShapes(e,t))}update(e){super.update(e),e&&(`x`in e||`y`in e||`z`in e)&&OT(this)}onframe(){this.drawBadgeShapes(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this)}};MT.defaultStyleProps={x:0,y:0,size:32,droppable:!0,draggable:!0,port:!0,ports:[],portZIndex:2,portLinkToCenter:!1,badge:!0,badges:[],badgeZIndex:3,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloStrokeOpacity:.25,haloPointerEvents:`none`,haloZIndex:-1,icon:!0,iconZIndex:1,label:!0,labelIsBillboard:!0,labelMaxWidth:`200%`,labelPlacement:`bottom`,labelWordWrap:!1,labelZIndex:0};function NT(e,t){if(!e)return t.getLocalBounds();let n=e.canvas.getLayer(),r=t.cloneNode();NC(r,`hidden`),n.appendChild(r);let i=r.getLocalBounds();return r.destroy(),i}var PT=class e extends MT{constructor(t){super($w({style:e.defaultStyleProps},t))}drawKeyShape(e,t){return this.upsert(`key`,Oy,this.getKeyStyle(e),t)}getKeyStyle(e){let t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{r:Math.min(...this.getSize(e))/2})}getIconStyle(e){let t=super.getIconStyle(e),{r:n}=this.getShape(`key`).attributes,r=n*2*Pw;return t?Object.assign({width:r,height:r},t):!1}getIntersectPoint(e,t=!1){let n=this.getShape(`key`).getBounds();return xw(e,n,t)}};PT.defaultStyleProps={size:32};var FT=class extends MT{constructor(e){super(e)}get parsedAttributes(){return this.attributes}drawKeyShape(e,t){return this.upsert(`key`,Hy,this.getKeyStyle(e),t)}getKeyStyle(e){let t=super.getKeyStyle(e);return Object.assign(Object.assign({},t),{points:this.getPoints(e)})}getIntersectPoint(e,t=!1){let{points:n}=this.getShape(`key`).attributes,r=[+(this.attributes?.x||0),+(this.attributes?.y||0)];return vw(e,r,n,!0,t).point}},IT=class extends FT{constructor(e){super(e)}getPoints(e){let[t,n]=this.getSize(e);return ZO(t,n)}},LT=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},RT=class e extends PT{constructor(t){super($w({style:e.defaultStyleProps},t))}parseOuterR(){let{size:e}=this.parsedAttributes;return Math.min(...Xw(e))/2}parseInnerR(){let{innerR:e}=this.parsedAttributes;return ru(e)?parseInt(e)/100*this.parseOuterR():e}drawDonutShape(e,t){let{donuts:n}=e;if(!n?.length)return;let r=n.map(e=>G(e)?{value:e}:e),i=qw(this.getGraphicStyle(e),`donut`),a=iT(e.donutPalette);if(!a)return;let o=r.reduce((e,t)=>e+(t.value??0),0),s=this.parseOuterR(),c=this.parseInnerR(),l=0;r.forEach((e,n)=>{let{value:u=0,color:d=a[n%a.length]}=e,f=LT(e,[`value`,`color`]),p=(o===0?1/r.length:u/o)*360;this.upsert(`round${n}`,By,Object.assign(Object.assign(Object.assign({},i),{d:HT(s,c,l,l+p),fill:d}),f),t),l+=p})}render(e,t=this){super.render(e,t),this.drawDonutShape(e,t)}};RT.defaultStyleProps={innerR:`50%`,donuts:[],donutPalette:`tableau`};var zT=(e,t,n,r)=>[e+Math.sin(r)*n,t-Math.cos(r)*n],BT=(e,t,n,r)=>r<=0||n<=r?[[`M`,e-n,t],[`A`,n,n,0,1,1,e+n,t],[`A`,n,n,0,1,1,e-n,t],[`Z`]]:[[`M`,e-n,t],[`A`,n,n,0,1,1,e+n,t],[`A`,n,n,0,1,1,e-n,t],[`Z`],[`M`,e+r,t],[`A`,r,r,0,1,0,e-r,t],[`A`,r,r,0,1,0,e+r,t],[`Z`]],VT=(e,t,n,r,i,a)=>{let[o,s]=[i/360*2*Math.PI,a/360*2*Math.PI],c=[zT(e,t,r,o),zT(e,t,n,o),zT(e,t,n,s),zT(e,t,r,s)],l=s-o>Math.PI?1:0;return[[`M`,c[0][0],c[0][1]],[`L`,c[1][0],c[1][1]],[`A`,n,n,0,l,1,c[2][0],c[2][1]],[`L`,c[3][0],c[3][1]],[`A`,r,r,0,l,0,c[0][0],c[0][1]],[`Z`]]},HT=(e=0,t=0,n,r)=>{let[i,a]=[0,0];return Math.abs(n-r)%360<1e-6?BT(i,a,e,t):VT(i,a,e,t,n,r)},UT=class e extends MT{constructor(t){super($w({style:e.defaultStyleProps},t))}drawKeyShape(e,t){return this.upsert(`key`,jy,this.getKeyStyle(e),t)}getKeyStyle(e){let t=super.getKeyStyle(e),[n,r]=this.getSize(e);return Object.assign(Object.assign({},t),{rx:n/2,ry:r/2})}getIconStyle(e){let t=super.getIconStyle(e),{rx:n,ry:r}=this.getShape(`key`).attributes,i=Math.min(+n,+r)*2*Pw;return t?Object.assign({width:i,height:i},t):!1}getIntersectPoint(e,t=!1){let n=this.getShape(`key`).getBounds();return xw(e,n,t)}};UT.defaultStyleProps={size:[45,35]};var WT=class extends FT{constructor(e){super(e)}getOuterR(e){return e.outerR||Math.min(...this.getSize(e))/2}getPoints(e){return tk(this.getOuterR(e))}getIconStyle(e){let t=super.getIconStyle(e),n=this.getOuterR(e)*Pw;return t?Object.assign({width:n,height:n},t):!1}};function GT(e,t){var n=t.cx,r=n===void 0?0:n,i=t.cy,a=i===void 0?0:i,o=t.r;e.arc(r,a,o,0,Math.PI*2,!1)}function KT(e,t){var n=t.cx,r=n===void 0?0:n,i=t.cy,a=i===void 0?0:i,o=t.rx,s=t.ry;if(e.ellipse)e.ellipse(r,a,o,s,0,0,Math.PI*2,!1);else{var c=o>s?o:s,l=o>s?1:o/s,u=o>s?s/o:1;e.save(),e.scale(l,u),e.arc(r,a,c,0,Math.PI*2)}}function qT(e,t){var n=t.x1,r=t.y1,i=t.x2,a=t.y2,o=t.markerStart,s=t.markerEnd,c=t.markerStartOffset,l=t.markerEndOffset,u=0,d=0,f=0,p=0,m=0,h,g;o&&Sy(o)&&c&&(h=i-n,g=a-r,m=Math.atan2(g,h),u=Math.cos(m)*(c||0),d=Math.sin(m)*(c||0)),s&&Sy(s)&&l&&(h=n-i,g=r-a,m=Math.atan2(g,h),f=Math.cos(m)*(l||0),p=Math.sin(m)*(l||0)),e.moveTo(n+u,r+d),e.lineTo(i+f,a+p)}function JT(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,o=t.d,s=o.absolutePath,c=o.segments,l=0,u=0,d=0,f=0,p=0,m,h;if(n&&Sy(n)&&i){var g=n.parentNode.getStartTangent(),_=Vs(g,2),v=_[0],y=_[1];m=v[0]-y[0],h=v[1]-y[1],p=Math.atan2(h,m),l=Math.cos(p)*(i||0),u=Math.sin(p)*(i||0)}if(r&&Sy(r)&&a){var b=r.parentNode.getEndTangent(),x=Vs(b,2),S=x[0],C=x[1];m=S[0]-C[0],h=S[1]-C[1],p=Math.atan2(h,m),d=Math.cos(p)*(a||0),f=Math.sin(p)*(a||0)}for(var w=0;w<s.length;w++){var T=s[w],E=T[0],D=s[w+1],O=w===0&&(l!==0||u!==0),k=(w===s.length-1||D&&(D[0]===`M`||D[0]===`Z`))&&d!==0&&f!==0,A=O?[l,u]:[0,0],j=Vs(A,2),ee=j[0],te=j[1],M=k?[d,f]:[0,0],ne=Vs(M,2),re=ne[0],ie=ne[1];switch(E){case`M`:e.moveTo(T[1]+ee,T[2]+te);break;case`L`:e.lineTo(T[1]+re,T[2]+ie);break;case`Q`:e.quadraticCurveTo(T[1],T[2],T[3]+re,T[4]+ie);break;case`C`:e.bezierCurveTo(T[1],T[2],T[3],T[4],T[5]+re,T[6]+ie);break;case`A`:var ae=c[w].arcParams,oe=ae.cx,se=ae.cy,ce=ae.rx,le=ae.ry,N=ae.startAngle,ue=ae.endAngle,de=ae.xRotation,fe=ae.sweepFlag;if(e.ellipse)e.ellipse(oe,se,ce,le,de,N,ue,!!(1-fe));else{var pe=ce>le?ce:le,me=ce>le?1:ce/le,he=ce>le?le/ce:1;e.translate(oe,se),e.rotate(de),e.scale(me,he),e.arc(0,0,pe,N,ue,!!(1-fe)),e.scale(1/me,1/he),e.rotate(-de),e.translate(-oe,-se)}k&&e.lineTo(T[6]+d,T[7]+f);break;case`Z`:e.closePath();break}}}function YT(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,o=t.points.points,s=o.length,c=o[0][0],l=o[0][1],u=o[s-1][0],d=o[s-1][1],f=0,p=0,m=0,h=0,g=0,_,v;n&&Sy(n)&&i&&(_=o[1][0]-o[0][0],v=o[1][1]-o[0][1],g=Math.atan2(v,_),f=Math.cos(g)*(i||0),p=Math.sin(g)*(i||0)),r&&Sy(r)&&a&&(_=o[s-1][0]-o[0][0],v=o[s-1][1]-o[0][1],g=Math.atan2(v,_),m=Math.cos(g)*(a||0),h=Math.sin(g)*(a||0)),e.moveTo(c+(f||m),l+(p||h));for(var y=1;y<s-1;y++){var b=o[y];e.lineTo(b[0],b[1])}e.lineTo(u,d)}function XT(e,t){var n=t.markerStart,r=t.markerEnd,i=t.markerStartOffset,a=t.markerEndOffset,o=t.points.points,s=o.length,c=o[0][0],l=o[0][1],u=o[s-1][0],d=o[s-1][1],f=0,p=0,m=0,h=0,g=0,_,v;n&&Sy(n)&&i&&(_=o[1][0]-o[0][0],v=o[1][1]-o[0][1],g=Math.atan2(v,_),f=Math.cos(g)*(i||0),p=Math.sin(g)*(i||0)),r&&Sy(r)&&a&&(_=o[s-2][0]-o[s-1][0],v=o[s-2][1]-o[s-1][1],g=Math.atan2(v,_),m=Math.cos(g)*(a||0),h=Math.sin(g)*(a||0)),e.moveTo(c+f,l+p);for(var y=1;y<s-1;y++){var b=o[y];e.lineTo(b[0],b[1])}e.lineTo(u+m,d+h)}function ZT(e,t){var n=t.x,r=n===void 0?0:n,i=t.y,a=i===void 0?0:i,o=t.radius,s=t.width,c=t.height,l=s,u=c;if(!(o&&o.some(function(e){return e!==0})))e.rect(r,a,l,u);else{var d=s>0?1:-1,f=c>0?1:-1,p=d+f===0,m=o.map(function(e){return cu(e,0,Math.min(Math.abs(l)/2,Math.abs(u)/2))}),h=Vs(m,4),g=h[0],_=h[1],v=h[2],y=h[3];e.moveTo(d*g+r,a),e.lineTo(l-d*_+r,a),_!==0&&e.arc(l-d*_+r,f*_+a,_,-f*Math.PI/2,d>0?0:Math.PI,p),e.lineTo(l+r,u-f*v+a),v!==0&&e.arc(l-d*v+r,u-f*v+a,v,d>0?0:Math.PI,f>0?Math.PI/2:1.5*Math.PI,p),e.lineTo(d*y+r,u+a),y!==0&&e.arc(d*y+r,u-f*y+a,y,f>0?Math.PI/2:-Math.PI/2,d>0?Math.PI:0,p),e.lineTo(r,f*g+a),g!==0&&e.arc(d*g+r,f*g+a,g,d>0?Math.PI:0,f>0?Math.PI*1.5:Math.PI/2,p)}}var QT=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.name=`canvas-path-generator`,e}return Ls(t,e),U(t,[{key:`init`,value:function(){var e,t=(e={},V(V(V(V(V(V(V(V(V(V(e,K.CIRCLE,GT),K.ELLIPSE,KT),K.RECT,ZT),K.LINE,qT),K.POLYLINE,XT),K.POLYGON,YT),K.PATH,JT),K.TEXT,void 0),K.GROUP,void 0),K.IMAGE,void 0),V(V(V(e,K.HTML,void 0),K.MESH,void 0),K.FRAGMENT,void 0));this.context.pathGeneratorFactory=t}},{key:`destroy`,value:function(){delete this.context.pathGeneratorFactory}}])}(qf),$T=Kc(),eE=Kc(),tE=Kc(),nE=Js(),rE=function(){function e(){var t=this;H(this,e),this.isHit=function(e,n,r,i){var a=t.context.pointInPathPickerFactory[e.nodeName];if(a){var o=tc(nE,r),s=ll(eE,Zc(tE,n[0],n[1],0),o);if(a(e,new ap(s[0],s[1]),i,t.isPointInPath,t.context,t.runtime))return!0}return!1},this.isPointInPath=function(e,n){var r=t.runtime.offscreenCanvasCreator.getOrCreateContext(t.context.config.offscreenCanvas),i=t.context.pathGeneratorFactory[e.nodeName];return i&&(r.beginPath(),i(r,e.parsedStyle),r.closePath()),r.isPointInPath(n.x,n.y)}}return U(e,[{key:`apply`,value:function(t,n){var r=this,i=t.renderingService,a=t.renderingContext;this.context=t,this.runtime=n;var o=a.root?.ownerDocument;i.hooks.pick.tapPromise(e.tag,function(){var e=Bf(Rf().mark(function e(t){return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(`return`,r.pick(o,t));case 1:case`end`:return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),i.hooks.pickSync.tap(e.tag,function(e){return r.pick(o,e)})}},{key:`pick`,value:function(e,t){var n=t.topmost,r=t.position,i=r.x,a=r.y,o=Zc($T,i,a,0),s=e.elementsFromBBox(o[0],o[1],o[0],o[1]),c=[],l=Vf(s),u;try{for(l.s();!(u=l.n()).done;){var d=u.value,f=d.getWorldTransform();if(this.isHit(d,o,f,!1)){var p=__(d);if(p){var m=p.parsedStyle.clipPath;if(this.isHit(m,o,m.getWorldTransform(),!0)){if(n)return t.picked=[d],t;c.push(d)}}else{if(n)return t.picked=[d],t;c.push(d)}}}}catch(e){l.e(e)}finally{l.f()}return t.picked=c,t}}])}();rE.tag=`CanvasPicker`;function iE(e,t,n){var r=e.parsedStyle,i=r.cx,a=i===void 0?0:i,o=r.cy,s=o===void 0?0:o,c=r.r,l=r.fill,u=r.stroke,d=r.lineWidth,f=d===void 0?1:d,p=r.increasedLineWidthForHitTesting,m=p===void 0?0:p,h=r.pointerEvents,g=h===void 0?`auto`:h,_=(f+m)/2,v=af(a,s,t.x,t.y),y=D_(g,l,u),b=Vs(y,2),x=b[0],S=b[1];return x&&S||n?v<=c+_:x?v<=c:S?v>=c-_&&v<=c+_:!1}function aE(e,t,n,r){return e/(n*n)+t/(r*r)}function oE(e,t,n){var r=e.parsedStyle,i=r.cx,a=i===void 0?0:i,o=r.cy,s=o===void 0?0:o,c=r.rx,l=r.ry,u=r.fill,d=r.stroke,f=r.lineWidth,p=f===void 0?1:f,m=r.increasedLineWidthForHitTesting,h=m===void 0?0:m,g=r.pointerEvents,_=g===void 0?`auto`:g,v=t.x,y=t.y,b=D_(_,u,d),x=Vs(b,2),S=x[0],C=x[1],w=(p+h)/2,T=(v-a)*(v-a),E=(y-s)*(y-s);return S&&C||n?aE(T,E,c+w,l+w)<=1:S?aE(T,E,c,l)<=1:C?aE(T,E,c-w,l-w)>=1&&aE(T,E,c+w,l+w)<=1:!1}function sE(e,t,n,r,i,a){return i>=e&&i<=e+n&&a>=t&&a<=t+r}function cE(e,t,n,r,i,a,o){var s=i/2;return sE(e-s,t-s,n,i,a,o)||sE(e+n-s,t-s,i,r,a,o)||sE(e+s,t+r-s,n,i,a,o)||sE(e-s,t+s,i,r,a,o)}function lE(e,t,n,r,i,a,o,s){var c=(Math.atan2(s-t,o-e)+Math.PI*2)%(Math.PI*2),l={x:e+n*Math.cos(c),y:t+n*Math.sin(c)};return af(l.x,l.y,o,s)<=a/2}function uE(e,t,n,r,i,a,o){var s=Math.min(e,n),c=Math.max(e,n),l=Math.min(t,r),u=Math.max(t,r),d=i/2;return a>=s-d&&a<=c+d&&o>=l-d&&o<=u+d?_f(e,t,n,r,a,o)<=i/2:!1}function dE(e,t,n,r,i){var a=e.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=e[o][0],c=e[o][1],l=e[o+1][0],u=e[o+1][1];if(uE(s,c,l,u,t,n,r))return!0}if(i){var d=e[0],f=e[a-1];if(uE(d[0],d[1],f[0],f[1],t,n,r))return!0}return!1}var fE=1e-6;function pE(e){return Math.abs(e)<fE?0:e<0?-1:1}function mE(e,t,n){return(n[0]-e[0])*(t[1]-e[1])===(t[0]-e[0])*(n[1]-e[1])&&Math.min(e[0],t[0])<=n[0]&&n[0]<=Math.max(e[0],t[0])&&Math.min(e[1],t[1])<=n[1]&&n[1]<=Math.max(e[1],t[1])}function hE(e,t,n){var r=!1,i=e.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=e[a],s=e[(a+1)%i];if(mE(o,s,[t,n]))return!0;pE(o[1]-n)>0!=pE(s[1]-n)>0&&pE(t-(n-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(r=!r)}return r}function gE(e,t,n){for(var r=!1,i=0;i<e.length;i++){var a=e[i];if(r=hE(a,t,n),r)break}return r}function _E(e,t,n){var r=e.parsedStyle,i=r.x1,a=r.y1,o=r.x2,s=r.y2,c=r.lineWidth,l=c===void 0?1:c,u=r.increasedLineWidthForHitTesting,d=u===void 0?0:u,f=r.pointerEvents,p=f===void 0?`auto`:f,m=r.fill,h=r.stroke,g=D_(p,m,h);return!Vs(g,2)[1]&&!n||!l?!1:uE(i,a,o,s,l+d,t.x,t.y)}function vE(e,t,n,r,i){for(var a=!1,o=t/2,s=0;s<e.length;s++){var c=e[s],l=c.currentPoint,u=c.params,d=c.prePoint,f=c.box;if(!(f&&!sE(f.x-o,f.y-o,f.width+t,f.height+t,n,r)))switch(c.command){case`L`:case`Z`:if(a=uE(d[0],d[1],l[0],l[1],t,n,r),a)return!0;break;case`Q`:if(a=kf(d[0],d[1],u[1],u[2],u[3],u[4],n,r)<=t/2,a)return!0;break;case`C`:if(a=Sf(d[0],d[1],u[1],u[2],u[3],u[4],u[5],u[6],n,r,i)<=t/2,a)return!0;break;case`A`:c.cubicParams||=Td(d[0],d[1],u[1],u[2],u[3],u[4],u[5],u[6],u[7],void 0);for(var p=c.cubicParams,m=d,h=0;h<p.length;h+=6){var g=Sf(m[0],m[1],p[h],p[h+1],p[h+2],p[h+3],p[h+4],p[h+5],n,r,i);if(m=[p[h+4],p[h+5]],a=g<=t/2,a)return!0}break}}return a}function yE(e,t,n,r,i,a){var o=e.parsedStyle,s=o.lineWidth,c=s===void 0?1:s,l=o.increasedLineWidthForHitTesting,u=l===void 0?0:l,d=o.stroke,f=o.fill,p=o.d,m=o.pointerEvents,h=m===void 0?`auto`:m,g=p.segments,_=p.hasArc,v=p.polylines,y=p.polygons,b=D_(h,y?.length&&f,d),x=Vs(b,2),S=x[0],C=x[1],w=Xh(e),T=!1;return S||n?(T=_?r(e,t):gE(y,t.x,t.y)||gE(v,t.x,t.y),T):((C||n)&&(T=vE(g,c+u,t.x,t.y,w)),T)}function bE(e,t,n){var r=e.parsedStyle,i=r.stroke,a=r.fill,o=r.lineWidth,s=o===void 0?1:o,c=r.increasedLineWidthForHitTesting,l=c===void 0?0:c,u=r.points,d=r.pointerEvents,f=D_(d===void 0?`auto`:d,a,i),p=Vs(f,2),m=p[0],h=p[1],g=!1;return(h||n)&&(g=dE(u.points,s+l,t.x,t.y,!0)),!g&&(m||n)&&(g=hE(u.points,t.x,t.y)),g}function xE(e,t,n){var r=e.parsedStyle,i=r.lineWidth,a=i===void 0?1:i,o=r.increasedLineWidthForHitTesting,s=o===void 0?0:o,c=r.points,l=r.pointerEvents,u=l===void 0?`auto`:l,d=r.fill,f=r.stroke,p=D_(u,d,f);return!Vs(p,2)[1]&&!n||!a?!1:dE(c.points,a+s,t.x,t.y,!1)}function SE(e,t,n,r,i){var a=e.parsedStyle,o=a.radius,s=a.fill,c=a.stroke,l=a.lineWidth,u=l===void 0?1:l,d=a.increasedLineWidthForHitTesting,f=d===void 0?0:d,p=a.x,m=p===void 0?0:p,h=a.y,g=h===void 0?0:h,_=a.width,v=a.height,y=a.pointerEvents,b=D_(y===void 0?`auto`:y,s,c),x=Vs(b,2),S=x[0],C=x[1],w=o&&o.some(function(e){return e!==0}),T=u+f;if(w){var E=!1;return(C||n)&&(E=CE(m,g,_,v,o.map(function(e){return cu(e,0,Math.min(Math.abs(_)/2,Math.abs(v)/2))}),T,t.x,t.y)),!E&&(S||n)&&(E=r(e,t)),E}else{var D=T/2;if(S&&C||n)return sE(m-D,g-D,_+D,v+D,t.x,t.y);if(S)return sE(m,g,_,v,t.x,t.y);if(C)return cE(m,g,_,v,T,t.x,t.y)}return!1}function CE(e,t,n,r,i,a,o,s){var c=Vs(i,4),l=c[0],u=c[1],d=c[2],f=c[3];return uE(e+l,t,e+n-u,t,a,o,s)||uE(e+n,t+u,e+n,t+r-d,a,o,s)||uE(e+n-d,t+r,e+f,t+r,a,o,s)||uE(e,t+r-f,e,t+l,a,o,s)||lE(e+n-u,t+u,u,1.5*Math.PI,2*Math.PI,a,o,s)||lE(e+n-d,t+r-d,d,0,.5*Math.PI,a,o,s)||lE(e+f,t+r-f,f,.5*Math.PI,Math.PI,a,o,s)||lE(e+l,t+l,l,Math.PI,1.5*Math.PI,a,o,s)}function wE(e,t,n,r,i,a){var o=e.parsedStyle,s=o.pointerEvents,c=s===void 0?`auto`:s,l=o.x,u=l===void 0?0:l,d=o.y,f=d===void 0?0:d,p=o.width,m=o.height;if(c===`non-transparent-pixel`){var h=i.config.offscreenCanvas,g=a.offscreenCanvasCreator.getOrCreateCanvas(h),_=a.offscreenCanvasCreator.getOrCreateContext(h,{willReadFrequently:!0});return g.width=p,g.height=m,i.defaultStyleRendererFactory[K.IMAGE].render(_,Cs(Cs({},e.parsedStyle),{},{x:0,y:0}),e,void 0,void 0,void 0),_.getImageData(t.x-u,t.y-f,1,1).data.every(function(e){return e!==0})}return!0}function TE(e,t,n,r){var i=e.getGeometryBounds();return t.x>=i.min[0]&&t.y>=i.min[1]&&t.x<=i.max[0]&&t.y<=i.max[1]}var EE=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.name=`canvas-picker`,e}return Ls(t,e),U(t,[{key:`init`,value:function(){var e,t=(e={},V(V(V(V(V(V(V(V(V(V(e,K.CIRCLE,iE),K.ELLIPSE,oE),K.RECT,SE),K.LINE,_E),K.POLYLINE,xE),K.POLYGON,bE),K.PATH,yE),K.TEXT,TE),K.GROUP,null),K.IMAGE,wE),V(V(e,K.HTML,null),K.MESH,null));this.context.pointInPathPickerFactory=t,this.addRenderingPlugin(new rE)}},{key:`destroy`,value:function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()}}])}(qf);function DE(e,t){if(!{}.hasOwnProperty.call(e,t))throw TypeError(`attempted to use private field on non-instance`);return e}var OE=0;function kE(e){return`__private_`+ OE+++`_`+e}var AE=function(){function e(){H(this,e),this.cacheStore=new Map}return U(e,[{key:`onRefAdded`,value:function(e){}},{key:`has`,value:function(e){return this.cacheStore.has(e)}},{key:`put`,value:function(e,t,n){return this.cacheStore.has(e)?!1:(this.cacheStore.set(e,{value:t,counter:new Set([n.entity])}),this.onRefAdded(n),!0)}},{key:`get`,value:function(e,t){var n=this.cacheStore.get(e);return n?(n.counter.has(t.entity)||(n.counter.add(t.entity),this.onRefAdded(t)),n.value):null}},{key:`update`,value:function(e,t,n){var r=this.cacheStore.get(e);return r?(r.value=Cs(Cs({},r.value),t),r.counter.has(n.entity)||(r.counter.add(n.entity),this.onRefAdded(n)),!0):!1}},{key:`release`,value:function(e,t){var n=this.cacheStore.get(e);return n?(n.counter.delete(t.entity),n.counter.size<=0&&this.cacheStore.delete(e),!0):!1}},{key:`releaseRef`,value:function(e){var t=this;Array.from(this.cacheStore.keys()).forEach(function(n){t.release(n,e)})}},{key:`getSize`,value:function(){return this.cacheStore.size}},{key:`clear`,value:function(){this.cacheStore.clear()}}])}(),jE=[],ME=[],NE=function(){function e(){H(this,e)}return U(e,null,[{key:`stop`,value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.api;e.rafId&&=(t.cancelAnimationFrame(e.rafId),null)}},{key:`executeTask`,value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.api;jE.length<=0&&ME.length<=0||(ME.forEach(function(e){return e()}),ME=jE.splice(0,e.TASK_NUM_PER_FRAME),e.rafId=t.requestAnimationFrame(function(){e.executeTask(t)}))}},{key:`sliceImage`,value:function(t,n,r,i){for(var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:e.api,s=t.naturalWidth||t.width,c=t.naturalHeight||t.height,l=n-a,u=r-a,d=Math.ceil(s/l),f=Math.ceil(c/u),p={tileSize:[n,r],gridSize:[f,d],tiles:Array(f).fill(null).map(function(){return Array(d).fill(null)})},m=function(e){for(var a=function(a){jE.push(function(){var d=a*l,f=e*u,m=[Math.min(n,s-d),Math.min(r,c-f)],h=m[0],g=m[1],_=o.createCanvas();_.width=n,_.height=r,_.getContext(`2d`).drawImage(t,d,f,h,g,0,0,h,g),p.tiles[e][a]={x:d,y:f,tileX:a,tileY:e,data:_},i()})},f=0;f<d;f++)a(f)},h=0;h<f;h++)m(h);return e.stop(),e.executeTask(),p}}])}();NE.TASK_NUM_PER_FRAME=10;var PE=new AE;PE.onRefAdded=function(e){var t=this;e.addEventListener(Nv.DESTROY,function(){t.releaseRef(e)},{once:!0})};var FE=function(){function e(t,n){H(this,e),this.gradientCache={},this.patternCache={},this.context=t,this.runtime=n}return U(e,[{key:`getImageSync`,value:function(e,t,n){var r=ru(e)?e:e.src;if(PE.has(r)){var i=PE.get(r,t);if(i.img.complete)return n?.(i),i}return this.getOrCreateImage(e,t).then(function(e){n?.(e)}).catch(function(e){console.error(e)}),null}},{key:`getOrCreateImage`,value:function(e,t){var n=this,r=ru(e)?e:e.src;if(!ru(e)&&!PE.has(r)){var i={img:e,size:[e.naturalWidth||e.width,e.naturalHeight||e.height],tileSize:IE(e)};PE.put(r,i,t)}if(PE.has(r)){var a=PE.get(r,t);return a.img.complete?Promise.resolve(a):new Promise(function(e,t){a.img.addEventListener(`load`,function(){a.size=[a.img.naturalWidth||a.img.width,a.img.naturalHeight||a.img.height],a.tileSize=IE(a.img),e(a)}),a.img.addEventListener(`error`,function(e){t(e)})})}return new Promise(function(e,i){var a=n.context.config.createImage();if(a){var o={img:a,size:[0,0],tileSize:IE(a)};PE.put(r,o,t),a.onload=function(){o.size=[a.naturalWidth||a.width,a.naturalHeight||a.height],o.tileSize=IE(o.img),e(o)},a.onerror=function(e){i(e)},a.crossOrigin=`Anonymous`,a.src=r}})}},{key:`createDownSampledImage`,value:function(){var e=Bf(Rf().mark(function e(t,n){var r,i,a,o,s,c,l,u,d,f,p,m,h,g;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.getOrCreateImage(t,n);case 1:if(r=e.sent,r.downSamplingRate===void 0){e.next=2;break}return e.abrupt(`return`,r);case 2:if(i=this.context.config.enableLargeImageOptimization,a=typeof i==`boolean`?{}:i,o=a.maxDownSampledImageSize,s=o===void 0?2048:o,c=a.downSamplingRateThreshold,l=c===void 0?.5:c,u=this.runtime.globalThis.createImageBitmap,d=Vs(r.size,2),f=d[0],p=d[1],m=r.img,h=Math.min((s+s)/(f+p),Math.max(.01,Math.min(l,.5))),g=Cs(Cs({},r),{},{downSamplingRate:h}),PE.update(r.img.src,g,n),!u){e.next=7;break}return e.prev=3,e.next=4,u(r.img,{resizeWidth:f*h,resizeHeight:p*h});case 4:m=e.sent,e.next=6;break;case 5:e.prev=5,e.catch(3),h=1;case 6:e.next=8;break;case 7:h=1;case 8:return g=Cs(Cs({},this.getImageSync(t,n)),{},{downSampled:m,downSamplingRate:h}),PE.update(r.img.src,g,n),e.abrupt(`return`,g);case 9:case`end`:return e.stop()}},e,this,[[3,5]])}));function t(t,n){return e.apply(this,arguments)}return t}()},{key:`createImageTiles`,value:function(){var e=Bf(Rf().mark(function e(t,n,r,i){var a,o,s,c,l;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.getOrCreateImage(t,i);case 1:return a=e.sent,o=i.ownerDocument.defaultView,s=o.requestAnimationFrame,c=o.cancelAnimationFrame,NE.api={requestAnimationFrame:s,cancelAnimationFrame:c,createCanvas:function(){return Ov.createCanvas()}},l=Cs(Cs({},a),NE.sliceImage(a.img,a.tileSize[0],a.tileSize[0],r)),PE.update(a.img.src,l,i),e.abrupt(`return`,l);case 2:case`end`:return e.stop()}},e,this)}));function t(t,n,r,i){return e.apply(this,arguments)}return t}()},{key:`releaseImage`,value:function(e,t){PE.release(ru(e)?e:e.src,t)}},{key:`releaseImageRef`,value:function(e){PE.releaseRef(e)}},{key:`getOrCreatePatternSync`,value:function(e,t,n,r,i,a,o){var s=this.generatePatternKey(t);if(s&&this.patternCache[s])return this.patternCache[s];var c=t.image,l=t.repetition,u=t.transform,d,f=!1;ru(c)?d=this.getImageSync(c,e,o)?.img:r?(d=r,f=!0):d=c;var p=d&&n.createPattern(d,l);if(p){var m=u?ov(Tg(u),new Dy({})):$s(Js());f&&oc(m,m,[1/i,1/i,1]),p.setTransform({a:m[0],b:m[1],c:m[4],d:m[5],e:m[12]+a[0],f:m[13]+a[1]})}return s&&p&&(this.patternCache[s]=p),p}},{key:`getOrCreateGradient`,value:function(e,t){var n=this.generateGradientKey(e),r=e.type,i=e.steps,a=e.min,o=e.width,s=e.height,c=e.angle,l=e.cx,u=e.cy,d=e.size;if(this.gradientCache[n])return this.gradientCache[n];var f=null;if(r===qm.LinearGradient){var p=ph(a,o,s,c),m=p.x1,h=p.y1,g=p.x2,_=p.y2;f=t.createLinearGradient(m,h,g,_)}else if(r===qm.RadialGradient){var v=mh(a,o,s,l,u,d),y=v.x,b=v.y,x=v.r;f=t.createRadialGradient(y,b,0,y,b,x)}return f&&(i.forEach(function(e){var t=e.offset,n=e.color;if(t.unit===J.kPercentage){var r;(r=f)==null||r.addColorStop(t.value/100,n.toString())}}),this.gradientCache[n]=f),this.gradientCache[n]}},{key:`generateGradientKey`,value:function(e){var t=e.type,n=e.min,r=e.width,i=e.height,a=e.steps,o=e.angle,s=e.cx,c=e.cy,l=e.size;return`gradient-${t}-${o?.toString()||0}-${s?.toString()||0}-${c?.toString()||0}-${l?.toString()||0}-${n[0]}-${n[1]}-${r}-${i}-${a.map(function(e){var t=e.offset,n=e.color;return`${t}${n}`}).join(`-`)}`}},{key:`generatePatternKey`,value:function(e){var t=e.image,n=e.repetition;if(ru(t))return`pattern-${t}-${n}`;if(t.nodeName===`rect`)return`pattern-${t.entity}-${n}`}}])}();FE.isSupportTile=!!Ov.createCanvas();function IE(e){if(!e.complete)return[0,0];var t=e.naturalWidth||e.width,n=e.naturalHeight||e.height,r=256;return[256,512].forEach(function(e){var i=Math.ceil(n/e),a=Math.ceil(t/e);i*a<1e3&&(r=e)}),[r,r]}var LE=function(){function e(){H(this,e)}return U(e,[{key:`apply`,value:function(t){var n=t.renderingService,r=t.renderingContext,i=t.imagePool,a=r.root.ownerDocument.defaultView,o=function(e,t,n){var r=e.parsedStyle,i=r.width,a=r.height;i&&!a?e.setAttribute(`height`,n/t*i):!i&&a&&e.setAttribute(`width`,t/n*a)},s=function(e){var t=e.target,r=t.nodeName,a=t.attributes;if(r===K.IMAGE){var s=a.src,c=a.keepAspectRatio;i.getImageSync(s,t,function(e){var r=e.img,i=r.width,a=r.height;c&&o(t,i,a),t.renderable.dirty=!0,n.dirtify()})}},c=function(e){var t=e.target,r=e.attrName,a=e.prevValue,s=e.newValue;t.nodeName!==K.IMAGE||r!==`src`||(a!==s&&i.releaseImage(a,t),ru(s)&&i.getOrCreateImage(s,t).then(function(e){var r=e.img,i=r.width,a=r.height;t.attributes.keepAspectRatio&&o(t,i,a),t.renderable.dirty=!0,n.dirtify()}).catch(function(){}))};n.hooks.init.tap(e.tag,function(){a.addEventListener(Nv.MOUNTED,s),a.addEventListener(Nv.ATTR_MODIFIED,c)}),n.hooks.destroy.tap(e.tag,function(){a.removeEventListener(Nv.MOUNTED,s),a.removeEventListener(Nv.ATTR_MODIFIED,c)})}}])}();LE.tag=`LoadImage`;var RE=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.name=`image-loader`,e}return Ls(t,e),U(t,[{key:`init`,value:function(e){this.context.imagePool=new FE(this.context,e),this.addRenderingPlugin(new LE)}},{key:`destroy`,value:function(){this.removeAllRenderingPlugins()}}])}(qf),zE=kE(`renderState`),BE=function(){function e(t){H(this,e),this.removedRBushNodeAABBs=[],this.renderQueue=[],Object.defineProperty(this,zE,{writable:!0,value:{restoreStack:[],prevObject:null,currentContext:new Map}}),this.clearFullScreenLastFrame=!1,this.clearFullScreen=!1,this.vpMatrix=Js(),this.dprMatrix=Js(),this.tmpMat4=Js(),this.vec3a=Kc(),this.vec3b=Kc(),this.vec3c=Kc(),this.vec3d=Kc(),this.canvasRendererPluginOptions=t}return U(e,[{key:`apply`,value:function(t,n){var r=this;this.context=t;var i=this.context,a=i.config,o=i.camera,s=i.renderingService,c=i.renderingContext,l=i.rBushRoot,u=i.pathGeneratorFactory,d=a.renderer.getConfig().enableRenderingOptimization;a.renderer.getConfig().enableDirtyCheck=!1,a.renderer.getConfig().enableDirtyRectangleRendering=!1,this.rBush=l,this.pathGeneratorFactory=u;var f=t.contextService,p=c.root.ownerDocument.defaultView,m=function(e){var t=e.target.rBushNode;t!=null&&t.aabb&&r.removedRBushNodeAABBs.push(t.aabb)},h=function(e){var t=e.target.rBushNode;t.aabb&&r.removedRBushNodeAABBs.push(t.aabb)};s.hooks.init.tap(e.tag,function(){p.addEventListener(Nv.UNMOUNTED,m),p.addEventListener(Nv.CULLED,h);var e=f.getDPR(),t=a.width,n=a.height,i=f.getContext();r.clearRect(i,0,0,t*e,n*e,a.background)}),s.hooks.destroy.tap(e.tag,function(){p.removeEventListener(Nv.UNMOUNTED,m),p.removeEventListener(Nv.CULLED,h),r.renderQueue=[],r.removedRBushNodeAABBs=[],DE(r,zE)[zE]={restoreStack:[],prevObject:null,currentContext:null}});var g=function(){var e,t=f.getContext(),n=f.getDPR(),i=a.width,o=a.height,c=r.canvasRendererPluginOptions,l=c.dirtyObjectNumThreshold,u=c.dirtyObjectRatioThreshold,d=s.getStats(),m=d.total,h=d.rendered,g=h/m;r.clearFullScreen=r.clearFullScreenLastFrame||!((e=p.context.renderingPlugins[1])!=null&&e.isFirstTimeRenderingFinished)||s.disableDirtyRectangleRendering()||h>l&&g>u,t&&(typeof t.resetTransform==`function`?t.resetTransform():t.setTransform(1,0,0,1,0,0),r.clearFullScreen&&r.clearRect(t,0,0,i*n,o*n,a.background))},_=function(e,t){for(var i=[e];i.length>0;){var a,o=i.pop();o.isVisible()&&!o.isCulled()&&(d?r.renderDisplayObjectOptimized(o,t,r.context,DE(r,zE)[zE],n):r.renderDisplayObject(o,t,r.context,DE(r,zE)[zE],n));for(var s=((a=o.sortable)==null||(a=a.sorted)==null?void 0:a.length)>0?o.sortable.sorted:o.childNodes,c=s.length-1;c>=0;c--)i.push(s[c])}};s.hooks.endFrame.tap(e.tag,function(){if(g(),c.root.childNodes.length===0){r.clearFullScreenLastFrame=!0;return}d=a.renderer.getConfig().enableRenderingOptimization,DE(r,zE)[zE]={restoreStack:[],prevObject:null,currentContext:DE(r,zE)[zE].currentContext},DE(r,zE)[zE].currentContext.clear(),r.clearFullScreenLastFrame=!1;var e=f.getContext(),t=f.getDPR();if(fc(r.dprMatrix,[t,t,1]),ic(r.vpMatrix,r.dprMatrix,o.getOrthoMatrix()),r.clearFullScreen)d?(e.save(),_(c.root,e),e.restore()):_(c.root,e),r.removedRBushNodeAABBs=[];else{var i=r.safeMergeAABB.apply(r,[r.mergeDirtyAABBs(r.renderQueue)].concat(As(r.removedRBushNodeAABBs.map(function(e){var t=e.minX,n=e.minY,r=e.maxX,i=e.maxY,a=new tp;return a.setMinMax([t,n,0],[r,i,0]),a}))));if(r.removedRBushNodeAABBs=[],tp.isEmpty(i)){r.renderQueue=[];return}var s=r.convertAABB2Rect(i),l=s.x,u=s.y,m=s.width,h=s.height,v=ll(r.vec3a,[l,u,0],r.vpMatrix),y=ll(r.vec3b,[l+m,u,0],r.vpMatrix),b=ll(r.vec3c,[l,u+h,0],r.vpMatrix),x=ll(r.vec3d,[l+m,u+h,0],r.vpMatrix),S=Math.min(v[0],y[0],x[0],b[0]),C=Math.min(v[1],y[1],x[1],b[1]),w=Math.max(v[0],y[0],x[0],b[0]),T=Math.max(v[1],y[1],x[1],b[1]),E=Math.floor(S),D=Math.floor(C),O=Math.ceil(w-S),k=Math.ceil(T-C);e.save(),r.clearRect(e,E,D,O,k,a.background),e.beginPath(),e.rect(E,D,O,k),e.clip(),e.setTransform(r.vpMatrix[0],r.vpMatrix[1],r.vpMatrix[4],r.vpMatrix[5],r.vpMatrix[12],r.vpMatrix[13]),a.renderer.getConfig().enableDirtyRectangleRenderingDebug&&p.dispatchEvent(new Cv(tb.DIRTY_RECTANGLE,{dirtyRect:{x:E,y:D,width:O,height:k}})),r.searchDirtyObjects(i).sort(function(e,t){return e.sortable.renderOrder-t.sortable.renderOrder}).forEach(function(t){t&&t.isVisible()&&!t.isCulled()&&r.renderDisplayObject(t,e,r.context,DE(r,zE)[zE],n)}),e.restore(),r.renderQueue.forEach(function(e){r.saveDirtyAABB(e)}),r.renderQueue=[]}DE(r,zE)[zE].restoreStack.forEach(function(){e.restore()}),DE(r,zE)[zE].restoreStack=[]}),s.hooks.render.tap(e.tag,function(e){r.clearFullScreen||r.renderQueue.push(e)})}},{key:`clearRect`,value:function(e,t,n,r,i,a){e.clearRect(t,n,r,i),a&&(e.fillStyle=a,e.fillRect(t,n,r,i))}},{key:`renderDisplayObjectOptimized`,value:function(e,t,n,r,i){var a=e.nodeName,o=!1,s=!1,c=this.context.styleRendererFactory[a],l=this.pathGeneratorFactory[a],u=e.parsedStyle.clipPath;if(u){o=!r.prevObject||!Hc(u.getWorldTransform(),r.prevObject.getWorldTransform()),o&&(this.applyWorldTransform(t,u),r.prevObject=null);var d=this.pathGeneratorFactory[u.nodeName];d&&(t.save(),s=!0,t.beginPath(),d(t,u.parsedStyle),t.closePath(),t.clip())}if(c){o=!r.prevObject||!Hc(e.getWorldTransform(),r.prevObject.getWorldTransform()),o&&this.applyWorldTransform(t,e);var f=!r.prevObject;if(!f){var p=r.prevObject.nodeName;f=a===K.TEXT?p!==K.TEXT:a===K.IMAGE?p!==K.IMAGE:p===K.TEXT||p===K.IMAGE}c.applyStyleToContext(t,e,f,r),r.prevObject=e}l&&(t.beginPath(),l(t,e.parsedStyle),a!==K.LINE&&a!==K.PATH&&a!==K.POLYLINE&&t.closePath()),c&&c.drawToContext(t,e,DE(this,zE)[zE],this,i),s&&t.restore(),e.dirty(!1)}},{key:`renderDisplayObject`,value:function(e,t,n,r,i){var a=e.nodeName,o=r.restoreStack[r.restoreStack.length-1];o&&!(e.compareDocumentPosition(o)&Tv.DOCUMENT_POSITION_CONTAINS)&&(t.restore(),r.restoreStack.pop());var s=this.context.styleRendererFactory[a],c=this.pathGeneratorFactory[a],l=e.parsedStyle.clipPath;if(l){this.applyWorldTransform(t,l);var u=this.pathGeneratorFactory[l.nodeName];u&&(t.save(),r.restoreStack.push(e),t.beginPath(),u(t,l.parsedStyle),t.closePath(),t.clip())}s&&(this.applyWorldTransform(t,e),t.save(),this.applyAttributesToContext(t,e)),c&&(t.beginPath(),c(t,e.parsedStyle),a!==K.LINE&&a!==K.PATH&&a!==K.POLYLINE&&t.closePath()),s&&(s.render(t,e.parsedStyle,e,n,this,i),t.restore()),e.dirty(!1)}},{key:`applyAttributesToContext`,value:function(e,t){var n=t.parsedStyle,r=n.stroke,i=n.fill,a=n.opacity,o=n.lineDash,s=n.lineDashOffset;o&&e.setLineDash(o),Wl(s)||(e.lineDashOffset=s),Wl(a)||(e.globalAlpha*=a),!Wl(r)&&!Array.isArray(r)&&!r.isNone&&(e.strokeStyle=t.attributes.stroke),!Wl(i)&&!Array.isArray(i)&&!i.isNone&&(e.fillStyle=t.attributes.fill)}},{key:`convertAABB2Rect`,value:function(e){var t=e.getMin(),n=e.getMax(),r=Math.floor(t[0]),i=Math.floor(t[1]),a=Math.ceil(n[0]),o=Math.ceil(n[1]),s=a-r,c=o-i;return{x:r,y:i,width:s,height:c}}},{key:`mergeDirtyAABBs`,value:function(e){var t=new tp;return e.forEach(function(e){var n=e.getRenderBounds();t.add(n);var r=e.renderable.dirtyRenderBounds;r&&t.add(r)}),t}},{key:`searchDirtyObjects`,value:function(e){var t=e.getMin(),n=Vs(t,2),r=n[0],i=n[1],a=e.getMax(),o=Vs(a,2),s=o[0],c=o[1];return this.rBush.search({minX:r,minY:i,maxX:s,maxY:c}).map(function(e){return e.displayObject})}},{key:`saveDirtyAABB`,value:function(e){var t=e.renderable;t.dirtyRenderBounds||=new tp;var n=e.getRenderBounds();n&&t.dirtyRenderBounds.update(n.center,n.halfExtents)}},{key:`applyWorldTransform`,value:function(e,t,n){n?(Xs(this.tmpMat4,t.getLocalTransform()),ic(this.tmpMat4,n,this.tmpMat4),ic(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(Xs(this.tmpMat4,t.getWorldTransform()),ic(this.tmpMat4,this.vpMatrix,this.tmpMat4)),e.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])}},{key:`safeMergeAABB`,value:function(){var e=new tp;return[...arguments].forEach(function(t){e.add(t)}),e}}])}();BE.tag=`CanvasRenderer`;function VE(e,t,n,r,i,a,o){var s,c;if(e.image.nodeName===`rect`){var l=e.image.parsedStyle,u=l.width,d=l.height;c=r.contextService.getDPR();var f=r.config.offscreenCanvas;s=a.offscreenCanvasCreator.getOrCreateCanvas(f),s.width=u*c,s.height=d*c;var p=a.offscreenCanvasCreator.getOrCreateContext(f),m={restoreStack:[],prevObject:null,currentContext:new Map};e.image.forEach(function(e){i.renderDisplayObject(e,p,r,m,a)}),m.restoreStack.forEach(function(){p.restore()})}return o.getOrCreatePatternSync(t,e,n,s,c,t.getGeometryBounds().min,function(){t.dirty(),r.renderingService.dirtify()})}function HE(e,t,n,r){var i;if(e.type===qm.LinearGradient||e.type===qm.RadialGradient){var a=t.getGeometryBounds(),o=a&&a.halfExtents[0]*2||1,s=a&&a.halfExtents[1]*2||1,c=a&&a.min||[0,0];i=r.getOrCreateGradient(Cs(Cs({type:e.type},e.value),{},{min:c,width:o,height:s}),n)}return i}var UE=[`shadowBlur`,`shadowOffsetX`,`shadowOffsetY`],WE=[`lineCap`,`lineJoin`,`miterLimit`],GE={globalAlpha:1,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:`#000`,filter:`none`,globalCompositeOperation:`source-over`,strokeStyle:`#000`,strokeOpacity:1,lineWidth:1,lineDash:[],lineDashOffset:0,lineCap:`butt`,lineJoin:`miter`,miterLimit:10,fillStyle:`#000`,fillOpacity:1},KE={};function qE(e,t,n,r){var i=r.has(t)?r.get(t):GE[t];return i!==n&&(t===`lineDash`?e.setLineDash(n):e[t]=n,r.set(t,n)),i}var JE=function(e){function t(){return H(this,t),Fs(this,t,arguments)}return Ls(t,e),U(t,[{key:`render`,value:function(e,t,n,r,i,a){var o=t.fill,s=t.fillRule,c=t.opacity,l=c===void 0?1:c,u=t.fillOpacity,d=u===void 0?1:u,f=t.stroke,p=t.strokeOpacity,m=p===void 0?1:p,h=t.lineWidth,g=h===void 0?1:h,_=t.lineCap,v=t.lineJoin,y=t.shadowType,b=t.shadowColor,x=t.shadowBlur,S=t.filter,C=t.miterLimit,w=o&&!o.isNone,T=f&&!f.isNone&&g>0,E=o?.alpha===0,D=!!(S&&S.length),O=!Wl(b)&&x>0,k=n.nodeName,A=y===`inner`,j=T&&O&&(k===K.PATH||k===K.LINE||k===K.POLYLINE||E||A);w&&(e.globalAlpha=l*d,j||YE(n,e,O),XE(e,n,o,s,r,i,a,this.imagePool),j||this.clearShadowAndFilter(e,D,O)),T&&(e.globalAlpha=l*m,e.lineWidth=g,Wl(C)||(e.miterLimit=C),Wl(_)||(e.lineCap=_),Wl(v)||(e.lineJoin=v),j&&(A&&(e.globalCompositeOperation=`source-atop`),YE(n,e,!0),A&&(ZE(e,n,f,r,i,a,this.imagePool),e.globalCompositeOperation=GE.globalCompositeOperation,this.clearShadowAndFilter(e,D,!0))),ZE(e,n,f,r,i,a,this.imagePool))}},{key:`clearShadowAndFilter`,value:function(e,t,n){if(n&&(e.shadowColor=`transparent`,e.shadowBlur=0),t){var r=e.filter;!Wl(r)&&r.indexOf(`drop-shadow`)>-1&&(e.filter=r.replace(/drop-shadow\([^)]*\)/,``).trim()||`none`)}}}])}(function(){function e(t){H(this,e),this.imagePool=t}return U(e,[{key:`applyAttributesToContext`,value:function(e,t){}},{key:`render`,value:function(e,t,n,r,i,a){}},{key:`applyCommonStyleToContext`,value:function(e,t,n,r){var i=n?KE:r.prevObject.parsedStyle,a=t.parsedStyle;(n||a.opacity!==i.opacity)&&qE(e,`globalAlpha`,Wl(a.opacity)?GE.globalAlpha:a.opacity,r.currentContext),(n||a.blend!==i.blend)&&qE(e,`globalCompositeOperation`,Wl(a.blend)?GE.globalCompositeOperation:a.blend,r.currentContext)}},{key:`applyStrokeFillStyleToContext`,value:function(e,t,n,r){var i=n?KE:r.prevObject.parsedStyle,a=t.parsedStyle,o=a.lineWidth,s=o===void 0?GE.lineWidth:o,c=a.fill&&!a.fill.isNone;if(a.stroke&&!a.stroke.isNone&&s>0){if(n||t.attributes.stroke!==r.prevObject.attributes.stroke){var l=!Wl(a.stroke)&&!Array.isArray(a.stroke)&&!a.stroke.isNone?t.attributes.stroke:GE.strokeStyle;qE(e,`strokeStyle`,l,r.currentContext)}(n||a.lineWidth!==i.lineWidth)&&qE(e,`lineWidth`,Wl(a.lineWidth)?GE.lineWidth:a.lineWidth,r.currentContext),(n||a.lineDash!==i.lineDash)&&qE(e,`lineDash`,a.lineDash||GE.lineDash,r.currentContext),(n||a.lineDashOffset!==i.lineDashOffset)&&qE(e,`lineDashOffset`,Wl(a.lineDashOffset)?GE.lineDashOffset:a.lineDashOffset,r.currentContext);for(var u=0;u<WE.length;u++){var d=WE[u];(n||a[d]!==i[d])&&qE(e,d,Wl(a[d])?GE[d]:a[d],r.currentContext)}}if(c&&(n||t.attributes.fill!==r.prevObject.attributes.fill)){var f=!Wl(a.fill)&&!Array.isArray(a.fill)&&!a.fill.isNone?t.attributes.fill:GE.fillStyle;qE(e,`fillStyle`,f,r.currentContext)}}},{key:`applyStyleToContext`,value:function(e,t,n,r){var i=t.nodeName;this.applyCommonStyleToContext(e,t,n,r),i===K.IMAGE||this.applyStrokeFillStyleToContext(e,t,n,r)}},{key:`applyShadowAndFilterStyleToContext`,value:function(e,t,n,r){var i=t.parsedStyle;if(n){qE(e,`shadowColor`,i.shadowColor.toString(),r.currentContext);for(var a=0;a<UE.length;a++){var o=UE[a];qE(e,o,i[o]||GE[o],r.currentContext)}}i.filter&&i.filter.length&&qE(e,`filter`,t.attributes.filter,r.currentContext)}},{key:`clearShadowAndFilterStyleForContext`,value:function(e,t,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(t){qE(e,`shadowColor`,GE.shadowColor,r.currentContext);for(var a=0;a<UE.length;a++){var o=UE[a];qE(e,o,GE[o],r.currentContext)}}if(n)if(t&&i){var s=e.filter;!Wl(s)&&s.indexOf(`drop-shadow`)>-1&&qE(e,`filter`,s.replace(/drop-shadow\([^)]*\)/,``).trim()||GE.filter,r.currentContext)}else qE(e,`filter`,GE.filter,r.currentContext)}},{key:`fillToContext`,value:function(e,t,n,r,i){var a=this,o=t.parsedStyle,s=o.fill,c=o.fillRule,l=null;if(Array.isArray(s)&&s.length>0)s.forEach(function(r){var i=qE(e,`fillStyle`,HE(r,t,e,a.imagePool),n.currentContext);l??=i,c?e.fill(c):e.fill()});else{if(Eh(s)){var u=VE(s,t,e,t.ownerDocument.defaultView.context,r,i,this.imagePool);u&&(e.fillStyle=u,l=!0)}c?e.fill(c):e.fill()}l!==null&&qE(e,`fillStyle`,l,n.currentContext)}},{key:`strokeToContext`,value:function(e,t,n,r,i){var a=this,o=t.parsedStyle.stroke,s=null;if(Array.isArray(o)&&o.length>0)o.forEach(function(r){var i=qE(e,`strokeStyle`,HE(r,t,e,a.imagePool),n.currentContext);s??=i,e.stroke()});else{if(Eh(o)){var c=VE(o,t,e,t.ownerDocument.defaultView.context,r,i,this.imagePool);if(c){var l=qE(e,`strokeStyle`,c,n.currentContext);s??=l}}e.stroke()}s!==null&&qE(e,`strokeStyle`,s,n.currentContext)}},{key:`drawToContext`,value:function(e,t,n,r,i){var a=t.nodeName,o=t.parsedStyle,s=o.opacity,c=s===void 0?GE.globalAlpha:s,l=o.fillOpacity,u=l===void 0?GE.fillOpacity:l,d=o.strokeOpacity,f=d===void 0?GE.strokeOpacity:d,p=o.lineWidth,m=p===void 0?GE.lineWidth:p,h=o.fill&&!o.fill.isNone,g=o.stroke&&!o.stroke.isNone&&m>0;if(!(!h&&!g)){var _=!Wl(o.shadowColor)&&o.shadowBlur>0,v=o.shadowType===`inner`,y=o.fill?.alpha===0,b=!!(o.filter&&o.filter.length),x=_&&g&&(a===K.PATH||a===K.LINE||a===K.POLYLINE||y||v),S=null;if(h){x||this.applyShadowAndFilterStyleToContext(e,t,_,n);var C=c*u;S=qE(e,`globalAlpha`,C,n.currentContext),this.fillToContext(e,t,n,r,i),x||this.clearShadowAndFilterStyleForContext(e,_,b,n)}if(g){var w=!1,T=c*f,E=qE(e,`globalAlpha`,T,n.currentContext);if(S=h?S:E,x&&(this.applyShadowAndFilterStyleToContext(e,t,_,n),w=!0,v)){var D=e.globalCompositeOperation;e.globalCompositeOperation=`source-atop`,this.strokeToContext(e,t,n,r,i),e.globalCompositeOperation=D,this.clearShadowAndFilterStyleForContext(e,_,b,n,!0)}this.strokeToContext(e,t,n,r,i),w&&this.clearShadowAndFilterStyleForContext(e,_,b,n)}S!==null&&qE(e,`globalAlpha`,S,n.currentContext)}}}])}());function YE(e,t,n){var r=e.parsedStyle,i=r.filter,a=r.shadowColor,o=r.shadowBlur,s=r.shadowOffsetX,c=r.shadowOffsetY;i&&i.length&&(t.filter=e.style.filter),n&&(t.shadowColor=a.toString(),t.shadowBlur=o||0,t.shadowOffsetX=s||0,t.shadowOffsetY=c||0)}function XE(e,t,n,r,i,a,o,s){var c=arguments.length>8&&arguments[8]!==void 0?arguments[8]:!1;Array.isArray(n)?n.forEach(function(n){e.fillStyle=HE(n,t,e,s),c||(r?e.fill(r):e.fill())}):(Eh(n)&&(e.fillStyle=VE(n,t,e,i,a,o,s)),c||(r?e.fill(r):e.fill()))}function ZE(e,t,n,r,i,a,o){var s=arguments.length>7&&arguments[7]!==void 0?arguments[7]:!1;Array.isArray(n)?n.forEach(function(n){e.strokeStyle=HE(n,t,e,o),s||e.stroke()}):(Eh(n)&&(e.strokeStyle=VE(n,t,e,r,i,a,o)),s||e.stroke())}function QE(e,t){var n=Vs(e,4),r=n[0],i=n[1],a=n[2],o=n[3],s=Vs(t,4),c=s[0],l=s[1],u=s[2],d=s[3],f=Math.max(r,c),p=Math.max(i,l),m=Math.min(r+a,c+u),h=Math.min(i+o,l+d);return m<=f||h<=p?null:[f,p,m-f,h-p]}function $E(e,t){var n=ll(Kc(),[e[0],e[1],0],t),r=ll(Kc(),[e[0]+e[2],e[1],0],t),i=ll(Kc(),[e[0],e[1]+e[3],0],t),a=ll(Kc(),[e[0]+e[2],e[1]+e[3],0],t);return[Math.min(n[0],r[0],i[0],a[0]),Math.min(n[1],r[1],i[1],a[1]),Math.max(n[0],r[0],i[0],a[0])-Math.min(n[0],r[0],i[0],a[0]),Math.max(n[1],r[1],i[1],a[1])-Math.min(n[1],r[1],i[1],a[1])]}var eD=function(e){function t(){return H(this,t),Fs(this,t,arguments)}return Ls(t,e),U(t,[{key:`renderDownSampled`,value:function(e,t,n,r){var i=r.src,a=r.imageCache;if(!a.downSampled){this.imagePool.createDownSampledImage(i,n).then(function(){n.ownerDocument&&(n.dirty(),n.ownerDocument.defaultView.context.renderingService.dirtify())}).catch(function(e){console.error(e)});return}e.drawImage(a.downSampled,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]))}},{key:`renderTile`,value:function(e,t,n,r){var i=r.src,a=r.imageCache,o=r.imageRect,s=r.drawRect,c=a.size,l=e.getTransform(),u=l.a,d=l.b,f=l.c,p=l.d,m=l.e,h=l.f;if(e.resetTransform(),!(a!=null&&a.gridSize)){this.imagePool.createImageTiles(i,[],function(){n.ownerDocument&&(n.dirty(),n.ownerDocument.defaultView.context.renderingService.dirtify())},n).catch(function(e){console.error(e)});return}for(var g=[c[0]/o[2],c[1]/o[3]],_=[a.tileSize[0]/g[0],a.tileSize[1]/g[1]],v=[Math.floor((s[0]-o[0])/_[0]),Math.ceil((s[0]+s[2]-o[0])/_[0])],y=v[0],b=v[1],x=[Math.floor((s[1]-o[1])/_[1]),Math.ceil((s[1]+s[3]-o[1])/_[1])],S=x[0],C=x[1],w=S;w<=C;w++)for(var T=y;T<=b;T++){var E=a.tiles[w][T];if(E){var D=[Math.floor(o[0]+E.tileX*_[0]),Math.floor(o[1]+E.tileY*_[1]),Math.ceil(_[0]),Math.ceil(_[1])];e.drawImage(E.data,D[0],D[1],D[2],D[3])}}e.setTransform(u,d,f,p,m,h)}},{key:`render`,value:function(e,n,r){var i=n.x,a=i===void 0?0:i,o=n.y,s=o===void 0?0:o,c=n.width,l=n.height,u=n.src,d=n.shadowColor,f=n.shadowBlur,p=this.imagePool.getImageSync(u,r),m=p?.img,h=c,g=l;if(m){h||=m.width,g||=m.height;var _=!Wl(d)&&f>0;YE(r,e,_);try{var v=r.ownerDocument.defaultView.getContextService().getDomElement(),y=v.width,b=v.height,x=e.getTransform(),S=x.a,C=x.b,w=x.c,T=x.d,E=x.e,D=x.f,O=Zs(S,w,0,0,C,T,0,0,0,0,1,0,E,D,0,1),k=$E([a,s,h,g],O),A=QE([0,0,y,b],k);if(!A)return;if(!r.ownerDocument.defaultView.getConfig().enableLargeImageOptimization){t.renderFull(e,n,r,{image:m,drawRect:[a,s,h,g]});return}if(k[2]/p.size[0]<(p.downSamplingRate||.5)){this.renderDownSampled(e,n,r,{src:u,imageCache:p,drawRect:[a,s,h,g]});return}if(!FE.isSupportTile){t.renderFull(e,n,r,{image:m,drawRect:[a,s,h,g]});return}this.renderTile(e,n,r,{src:u,imageCache:p,imageRect:k,drawRect:A})}catch{}}}},{key:`drawToContext`,value:function(e,t,n,r,i){this.render(e,t.parsedStyle,t)}}],[{key:`renderFull`,value:function(e,t,n,r){e.drawImage(r.image,Math.floor(r.drawRect[0]),Math.floor(r.drawRect[1]),Math.ceil(r.drawRect[2]),Math.ceil(r.drawRect[3]))}}])}(JE),tD=function(e){function t(){return H(this,t),Fs(this,t,arguments)}return Ls(t,e),U(t,[{key:`render`,value:function(e,t,n,r,i,a){n.getBounds();var o=t.lineWidth,s=o===void 0?1:o,c=t.textAlign,l=c===void 0?`start`:c,u=t.textBaseline,d=u===void 0?`alphabetic`:u,f=t.lineJoin,p=f===void 0?`miter`:f,m=t.miterLimit,h=m===void 0?10:m,g=t.letterSpacing,_=g===void 0?0:g,v=t.stroke,y=t.fill,b=t.fillRule,x=t.fillOpacity,S=x===void 0?1:x,C=t.strokeOpacity,w=C===void 0?1:C,T=t.opacity,E=T===void 0?1:T,D=t.metrics,O=t.x,k=O===void 0?0:O,A=t.y,j=A===void 0?0:A,ee=t.dx,te=t.dy,M=t.shadowColor,ne=t.shadowBlur,re=D.font,ie=D.lines,ae=D.height,oe=D.lineHeight,se=D.lineMetrics;e.font=re,e.lineWidth=s,e.textAlign=l===`middle`?`center`:l;var ce=d;ce===`alphabetic`&&(ce=`bottom`),e.lineJoin=p,Wl(h)||(e.miterLimit=h);var le=j;d===`middle`?le+=-ae/2-oe/2:d===`bottom`||d===`alphabetic`||d===`ideographic`?le+=-ae:(d===`top`||d===`hanging`)&&(le+=-oe);var N=k+(ee||0);le+=te||0,ie.length===1&&(ce===`bottom`?(ce=`middle`,le-=.5*ae):ce===`top`&&(ce=`middle`,le+=.5*ae)),e.textBaseline=ce;var ue=!Wl(M)&&ne>0;YE(n,e,ue);for(var de=0;de<ie.length;de++){var fe=s/2+N;le+=oe,!Wl(v)&&!v.isNone&&s&&this.drawLetterSpacing(e,n,ie[de],se[de],l,fe,le,_,y,b,S,v,w,E,!0,r,i,a),Wl(y)||this.drawLetterSpacing(e,n,ie[de],se[de],l,fe,le,_,y,b,S,v,w,E,!1,r,i,a)}}},{key:`drawLetterSpacing`,value:function(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h,g,_){if(s===0){m?this.strokeText(e,t,n,a,o,d,f,h,g,_):this.fillText(e,t,n,a,o,c,l,u,p,h,g,_);return}var v=e.textAlign;e.textAlign=`left`;var y=a;i===`center`||i===`middle`?y=a-r.width/2:(i===`right`||i===`end`)&&(y=a-r.width);for(var b=Array.from(n),x=e.measureText(n).width,S=0,C=0;C<b.length;++C){var w=b[C];m?this.strokeText(e,t,w,y,o,d,f,h,g,_):this.fillText(e,t,w,y,o,c,l,u,p,h,g,_),S=e.measureText(n.substring(C+1)).width,y+=x-S+s,x=S}e.textAlign=v}},{key:`fillText`,value:function(e,t,n,r,i,a,o,s,c,l,u,d){XE(e,t,a,o,l,u,d,this.imagePool,!0);var f,p=!Wl(s)&&s!==1;p&&(f=e.globalAlpha,e.globalAlpha=s*c),e.fillText(n,r,i),p&&(e.globalAlpha=f)}},{key:`strokeText`,value:function(e,t,n,r,i,a,o,s,c,l){ZE(e,t,a,s,c,l,this.imagePool,!0);var u,d=!Wl(o)&&o!==1;d&&(u=e.globalAlpha,e.globalAlpha=o),e.strokeText(n,r,i),d&&(e.globalAlpha=u)}},{key:`drawToContext`,value:function(e,t,n,r,i){this.render(e,t.parsedStyle,t,t.ownerDocument.defaultView.context,r,i)}}])}(JE),nD=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),e=Fs(this,t),e.name=`canvas-renderer`,e.options=n,e}return Ls(t,e),U(t,[{key:`init`,value:function(){var e,t=Cs({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),n=this.context.imagePool,r=new JE(n),i=(e={},V(V(V(V(V(V(V(V(V(V(e,K.CIRCLE,r),K.ELLIPSE,r),K.RECT,r),K.IMAGE,new eD(n)),K.TEXT,new tD(n)),K.LINE,r),K.POLYLINE,r),K.POLYGON,r),K.PATH,r),K.GROUP,void 0),V(V(V(e,K.HTML,void 0),K.MESH,void 0),K.FRAGMENT,void 0));this.context.defaultStyleRendererFactory=i,this.context.styleRendererFactory=i,this.addRenderingPlugin(new BE(t))}},{key:`destroy`,value:function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory}}])}(qf),rD=function(){function e(){H(this,e)}return U(e,[{key:`apply`,value:function(t,n){var r=this,i=t.renderingService,a=t.renderingContext,o=t.config;this.context=t;var s=a.root.ownerDocument.defaultView,c=function(e){i.hooks.pointerMove.call(e)},l=function(e){i.hooks.pointerUp.call(e)},u=function(e){i.hooks.pointerDown.call(e)},d=function(e){i.hooks.pointerOver.call(e)},f=function(e){i.hooks.pointerOut.call(e)},p=function(e){i.hooks.pointerCancel.call(e)},m=function(e){i.hooks.pointerWheel.call(e)},h=function(e){i.hooks.click.call(e)},g=function(e){n.globalThis.document.addEventListener(`pointermove`,c,!0),e.addEventListener(`pointerdown`,u,!0),e.addEventListener(`pointerleave`,f,!0),e.addEventListener(`pointerover`,d,!0),n.globalThis.addEventListener(`pointerup`,l,!0),n.globalThis.addEventListener(`pointercancel`,p,!0)},_=function(e){e.addEventListener(`touchstart`,u,!0),e.addEventListener(`touchend`,l,!0),e.addEventListener(`touchmove`,c,!0),e.addEventListener(`touchcancel`,p,!0)},v=function(e){n.globalThis.document.addEventListener(`mousemove`,c,!0),e.addEventListener(`mousedown`,u,!0),e.addEventListener(`mouseout`,f,!0),e.addEventListener(`mouseover`,d,!0),n.globalThis.addEventListener(`mouseup`,l,!0)},y=function(e){n.globalThis.document.removeEventListener(`pointermove`,c,!0),e.removeEventListener(`pointerdown`,u,!0),e.removeEventListener(`pointerleave`,f,!0),e.removeEventListener(`pointerover`,d,!0),n.globalThis.removeEventListener(`pointerup`,l,!0),n.globalThis.removeEventListener(`pointercancel`,p,!0)},b=function(e){e.removeEventListener(`touchstart`,u,!0),e.removeEventListener(`touchend`,l,!0),e.removeEventListener(`touchmove`,c,!0),e.removeEventListener(`touchcancel`,p,!0)},x=function(e){n.globalThis.document.removeEventListener(`mousemove`,c,!0),e.removeEventListener(`mousedown`,u,!0),e.removeEventListener(`mouseout`,f,!0),e.removeEventListener(`mouseover`,d,!0),n.globalThis.removeEventListener(`mouseup`,l,!0)};i.hooks.init.tap(e.tag,function(){var e=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(e.style.msContentZooming=`none`,e.style.msTouchAction=`none`):s.supportsPointerEvents&&(e.style.touchAction=`none`),s.supportsPointerEvents?g(e):v(e),s.supportsTouchEvents&&_(e),o.useNativeClickEvent&&e.addEventListener(`click`,h,!0),e.addEventListener(`wheel`,m,{passive:!0,capture:!0})}),i.hooks.destroy.tap(e.tag,function(){var e=r.context.contextService.getDomElement();n.globalThis.navigator.msPointerEnabled?(e.style.msContentZooming=``,e.style.msTouchAction=``):s.supportsPointerEvents&&(e.style.touchAction=``),s.supportsPointerEvents?y(e):x(e),s.supportsTouchEvents&&b(e),o.useNativeClickEvent&&e.removeEventListener(`click`,h,!0),e.removeEventListener(`wheel`,m,!0)})}}])}();rD.tag=`DOMInteraction`;var iD=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.name=`dom-interaction`,e}return Ls(t,e),U(t,[{key:`init`,value:function(){this.addRenderingPlugin(new rD)}},{key:`destroy`,value:function(){this.removeAllRenderingPlugins()}}])}(qf),aD=`g-canvas-camera`,oD=function(){function e(){H(this,e),this.displayObjectHTMLElementMap=new WeakMap}return U(e,[{key:`joinTransformMatrix`,value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];return`matrix(${[e[0],e[1],e[4],e[5],e[12]+t[0],e[13]+t[1]].join(`,`)})`}},{key:`apply`,value:function(t,n){var r=this,i=t.camera,a=t.renderingContext,o=t.renderingService;this.context=t;var s=a.root.ownerDocument.defaultView,c=s.context.eventService.nativeHTMLMap,l=function(e,t){t.style.transform=r.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())},u=function(e){var t=e.target;if(t.nodeName===K.HTML){r.$camera||=r.createCamera(i);var n=r.getOrCreateEl(t);r.$camera.appendChild(n),Object.keys(t.attributes).forEach(function(e){r.updateAttribute(e,t)}),l(t,n),c.set(n,t)}},d=function(e){var t=e.target;if(t.nodeName===K.HTML&&r.$camera){var n=r.getOrCreateEl(t);n&&(n.remove(),c.delete(n))}},f=function(e){var t=e.target;if(t.nodeName===K.HTML){var n=e.attrName;r.updateAttribute(n,t)}},p=function(e){var t=e.target;(t.nodeName===K.FRAGMENT?t.childNodes:[t]).forEach(function(e){if(e.nodeName===K.HTML){var t=r.getOrCreateEl(e);l(e,t)}})},m=function(){if(r.$camera){var e=r.context.config,t=e.width,n=e.height;r.$camera.parentElement.style.width=`${t||0}px`,r.$camera.parentElement.style.height=`${n||0}px`}};o.hooks.init.tap(e.tag,function(){s.addEventListener(tb.RESIZE,m),s.addEventListener(Nv.MOUNTED,u),s.addEventListener(Nv.UNMOUNTED,d),s.addEventListener(Nv.ATTR_MODIFIED,f),s.addEventListener(Nv.BOUNDS_CHANGED,p)}),o.hooks.endFrame.tap(e.tag,function(){r.$camera&&a.renderReasons.has(kv.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(i.getOrthoMatrix()))}),o.hooks.destroy.tap(e.tag,function(){r.$camera&&r.$camera.remove(),s.removeEventListener(tb.RESIZE,m),s.removeEventListener(Nv.MOUNTED,u),s.removeEventListener(Nv.UNMOUNTED,d),s.removeEventListener(Nv.ATTR_MODIFIED,f),s.removeEventListener(Nv.BOUNDS_CHANGED,p)})}},{key:`createCamera`,value:function(e){var t=this.context.config,n=t.document,r=t.width,i=t.height,a=this.context.contextService.getDomElement(),o=a.parentNode;if(o){var s=aD,c=o.querySelector(`#${s}`);if(!c){var l=(n||document).createElement(`div`);l.style.overflow=`hidden`,l.style.pointerEvents=`none`,l.style.position=`absolute`,l.style.left=`0px`,l.style.top=`0px`,l.style.width=`${r||0}px`,l.style.height=`${i||0}px`;var u=(n||document).createElement(`div`);c=u,u.id=s,u.style.position=`absolute`,u.style.left=`${a.offsetLeft||0}px`,u.style.top=`${a.offsetTop||0}px`,u.style.transformOrigin=`left top`,u.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),u.style.pointerEvents=`none`,u.style.width=`100%`,u.style.height=`100%`,l.appendChild(u),o.appendChild(l)}return c}return null}},{key:`getOrCreateEl`,value:function(e){var t=this.context.config.document,n=this.displayObjectHTMLElementMap.get(e);return n||(n=(t||document).createElement(`div`),e.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(e,n),e.id&&(n.id=e.id),e.name&&n.setAttribute(`name`,e.name),e.className&&(n.className=e.className),n.style.position=`absolute`,n.style[`will-change`]=`transform`,n.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),n}},{key:`updateAttribute`,value:function(e,t){var n=this.getOrCreateEl(t);switch(e){case`innerHTML`:var r=t.parsedStyle.innerHTML;ru(r)?n.innerHTML=r:(n.innerHTML=``,n.appendChild(r));break;case`x`:n.style.left=`${t.parsedStyle.x}px`;break;case`y`:n.style.top=`${t.parsedStyle.y}px`;break;case`transformOrigin`:var i=t.parsedStyle.transformOrigin;n.style[`transform-origin`]=`${i[0].buildCSSText(null,null,``)} ${i[1].buildCSSText(null,null,``)}`;break;case`width`:var a=t.parsedStyle.width;n.style.width=G(a)?`${a}px`:a.toString();break;case`height`:var o=t.parsedStyle.height;n.style.height=G(o)?`${o}px`:o.toString();break;case`zIndex`:var s=t.parsedStyle.zIndex;n.style[`z-index`]=`${s}`;break;case`visibility`:var c=t.parsedStyle.visibility;n.style.visibility=c;break;case`pointerEvents`:var l=t.parsedStyle.pointerEvents,u=l===void 0?`auto`:l;n.style.pointerEvents=u;break;case`opacity`:var d=t.parsedStyle.opacity;n.style.opacity=`${d}`;break;case`fill`:var f=t.parsedStyle.fill,p=``;Dh(f)?p=f.isNone?`transparent`:t.getAttribute(`fill`):Array.isArray(f)?p=t.getAttribute(`fill`):Eh(f),n.style.background=p;break;case`stroke`:var m=t.parsedStyle.stroke,h=``;Dh(m)?h=m.isNone?`transparent`:t.getAttribute(`stroke`):Array.isArray(m)?h=t.getAttribute(`stroke`):Eh(m),n.style[`border-color`]=h,n.style[`border-style`]=`solid`;break;case`lineWidth`:var g=t.parsedStyle.lineWidth;n.style[`border-width`]=`${g||0}px`;break;case`lineDash`:n.style[`border-style`]=`dashed`;break;case`filter`:var _=t.style.filter;n.style.filter=_;break;default:!Wl(t.style[e])&&t.style[e]!==``&&(n.style[e]=t.style[e])}}}])}();oD.tag=`HTMLRendering`;var sD=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.name=`html-renderer`,e}return Ls(t,e),U(t,[{key:`init`,value:function(){this.addRenderingPlugin(new oD)}},{key:`destroy`,value:function(){this.removeAllRenderingPlugins()}}])}(qf),cD=function(){function e(t){H(this,e),this.renderingContext=t.renderingContext,this.canvasConfig=t.config}return U(e,[{key:`init`,value:function(){var e=this.canvasConfig,t=e.container,n=e.canvas;if(n)this.$canvas=n,t&&n.parentElement!==t&&t.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(t&&(this.$container=ru(t)?document.getElementById(t):t,this.$container)){var r=document.createElement(`canvas`);this.$container.appendChild(r),this.$container.style.position||(this.$container.style.position=`relative`),this.$canvas=r}this.context=this.$canvas.getContext(`2d`),this.resize(this.canvasConfig.width,this.canvasConfig.height)}},{key:`getContext`,value:function(){return this.context}},{key:`getDomElement`,value:function(){return this.$canvas}},{key:`getDPR`,value:function(){return this.dpr}},{key:`getBoundingClientRect`,value:function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()}},{key:`destroy`,value:function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)}},{key:`resize`,value:function(e,t){this.dpr=this.canvasConfig.devicePixelRatio,this.$canvas&&(this.$canvas.width=this.dpr*e,this.$canvas.height=this.dpr*t,y_(this.$canvas,e,t)),this.renderingContext.renderReasons.add(kv.CAMERA_CHANGED)}},{key:`applyCursorStyle`,value:function(e){this.$container&&this.$container.style&&(this.$container.style.cursor=e)}},{key:`toDataURL`,value:function(){var e=Bf(Rf().mark(function e(){var t,n,r,i=arguments;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&i[0]!==void 0?i[0]:{},n=t.type,r=t.encoderOptions,e.abrupt(`return`,this.context.canvas.toDataURL(n,r));case 1:case`end`:return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}])}(),lD=function(e){function t(){var e;H(this,t);var n=[...arguments];return e=Fs(this,t,[].concat(n)),e.name=`canvas-context-register`,e}return Ls(t,e),U(t,[{key:`init`,value:function(){this.context.ContextService=cD}},{key:`destroy`,value:function(){delete this.context.ContextService}}])}(qf),uD=function(e){function t(e){var n;return H(this,t),n=Fs(this,t,[e]),n.registerPlugin(new lD),n.registerPlugin(new RE),n.registerPlugin(new QT),n.registerPlugin(new nD),n.registerPlugin(new iD),n.registerPlugin(new EE),n.registerPlugin(new sD),n}return Ls(t,e),U(t)}(Jf),dD=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},fD=class e extends MT{constructor(t){super(Object.assign(Object.assign({},t),{style:Object.assign({},e.defaultStyleProps,t.style)})),this.rootPointerEvent=new xv(null),this.forwardEvents=e=>{let t=this.context.canvas,n=t.context.renderingContext.root.ownerDocument.defaultView;this.normalizeToPointerEvent(e,n).forEach(r=>{let i=this.bootstrapEvent(this.rootPointerEvent,r,n,e);qu(t.context.eventService,`mappingTable.pointerupoutside`,[]),t.context.eventService.mapEvent(i)})}}get eventService(){return this.context.canvas.context.eventService}get events(){return[X.CLICK,X.POINTER_DOWN,X.POINTER_MOVE,X.POINTER_UP,X.POINTER_OVER,X.POINTER_LEAVE]}getDomElement(){return this.getShape(`key`).getDomElement()}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.drawPortShapes(e,t)}getKeyStyle(e){let t=Yu(e,[`dx`,`dy`,`innerHTML`,`pointerEvents`,`cursor`]),{dx:n=0,dy:r=0}=t,i=dD(t,[`dx`,`dy`]),[a,o]=this.getSize(e);return Object.assign(Object.assign({x:n,y:r},i),{width:a,height:o})}drawKeyShape(e,t){let n=this.getKeyStyle(e),{x:r,y:i,width:a=0,height:o=0}=n,s=this.upsert(`key-container`,Gy,{x:r,y:i,width:a,height:o,opacity:0},t);return this.upsert(`key`,Fy,n,s)}connectedCallback(){if(!(this.context.canvas.getRenderer(`main`)instanceof uD))return;let e=this.getDomElement();this.events.forEach(t=>{e.addEventListener(t,this.forwardEvents)})}attributeChangedCallback(e,t,n){e===`zIndex`&&t!==n&&(this.getDomElement().style.zIndex=n)}destroy(){let e=this.getDomElement();this.events.forEach(t=>{e.removeEventListener(t,this.forwardEvents)}),super.destroy()}normalizeToPointerEvent(e,t){let n=[];if(t.isTouchEvent(e))for(let t=0;t<e.changedTouches.length;t++){let r=e.changedTouches[t];Eu(r.button)&&(r.button=0),Eu(r.buttons)&&(r.buttons=1),Eu(r.isPrimary)&&(r.isPrimary=e.touches.length===1&&e.type===`touchstart`),Eu(r.width)&&(r.width=r.radiusX||1),Eu(r.height)&&(r.height=r.radiusY||1),Eu(r.tiltX)&&(r.tiltX=0),Eu(r.tiltY)&&(r.tiltY=0),Eu(r.pointerType)&&(r.pointerType=`touch`),Eu(r.pointerId)&&(r.pointerId=r.identifier||0),Eu(r.pressure)&&(r.pressure=r.force||.5),Eu(r.twist)&&(r.twist=0),Eu(r.tangentialPressure)&&(r.tangentialPressure=0),r.isNormalized=!0,r.type=e.type,n.push(r)}else if(t.isMouseEvent(e)){let t=e;Eu(t.isPrimary)&&(t.isPrimary=!0),Eu(t.width)&&(t.width=1),Eu(t.height)&&(t.height=1),Eu(t.tiltX)&&(t.tiltX=0),Eu(t.tiltY)&&(t.tiltY=0),Eu(t.pointerType)&&(t.pointerType=`mouse`),Eu(t.pointerId)&&(t.pointerId=1),Eu(t.pressure)&&(t.pressure=.5),Eu(t.twist)&&(t.twist=0),Eu(t.tangentialPressure)&&(t.tangentialPressure=0),t.isNormalized=!0,n.push(t)}else n.push(e);return n}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey,e.ctrlKey=t.ctrlKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.screen.x=t.screenX,e.screen.y=t.screenY,e.relatedTarget=null}bootstrapEvent(e,t,n,r){e.view=n,e.originalEvent=null,e.nativeEvent=r,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t);let{x:i,y:a}=this.getViewportXY(t);e.viewport.x=i,e.viewport.y=a;let[o,s]=this.context.canvas.getCanvasByViewport([i,a]);return e.canvas.x=o,e.canvas.y=s,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.isTrusted=r.isTrusted,e.type===`pointerleave`&&(e.type=`pointerout`),e}getViewportXY(e){let t,n,{offsetX:r,offsetY:i,clientX:a,clientY:o}=e;if(!Wl(r)&&!Wl(i))t=r,n=i;else{let e=this.eventService.client2Viewport({x:a,y:o});t=e.x,n=e.y}return{x:t,y:n}}onframe(){super.onframe();let{opacity:e}=this.attributes;this.getDomElement().style.opacity=`${e}`}};fD.defaultStyleProps={size:[160,80],halo:!1,icon:!1,label:!1,pointerEvents:`auto`};var pD=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},mD=class e extends MT{constructor(t){super($w({style:e.defaultStyleProps},t))}getKeyStyle(e){let[t,n]=this.getSize(e),r=super.getKeyStyle(e),{fillOpacity:i,opacity:a=i}=r,o=pD(r,[`fillOpacity`,`opacity`]);return Object.assign(Object.assign({opacity:a},o),{width:t,height:n,x:-t/2,y:-n/2})}getBounds(){return this.getShape(`key`).getBounds()}getHaloStyle(e){if(e.halo===!1)return!1;let t=this.getShape(`key`).attributes,{fill:n,stroke:r}=t;pD(t,[`fill`,`stroke`]);let i=qw(this.getGraphicStyle(e),`halo`),a=Number(i.lineWidth),[o,s]=BC(this.getSize(e),[a,a]),{lineWidth:c}=i,l={fill:`transparent`,lineWidth:c/2,width:o-c/2,height:s-c/2,x:-(o-c/2)/2,y:-(s-c/2)/2};return Object.assign(Object.assign({},i),l)}getIconStyle(e){let t=super.getIconStyle(e),[n,r]=this.getSize(e);return t?Object.assign({width:n*Pw,height:r*Pw},t):!1}drawKeyShape(e,t){let n=this.upsert(`key`,wT,this.getKeyStyle(e),t);return DT(this),n}drawHaloShape(e,t){this.upsert(`halo`,Gy,this.getHaloStyle(e),t)}update(e){super.update(e),e&&(`x`in e||`y`in e||`z`in e)&&OT(this)}};mD.defaultStyleProps={size:32};var hD=class extends MT{constructor(e){super(e)}getKeyStyle(e){let[t,n]=this.getSize(e);return Object.assign(Object.assign({},super.getKeyStyle(e)),{width:t,height:n,x:-t/2,y:-n/2})}getIconStyle(e){let t=super.getIconStyle(e),{width:n,height:r}=this.getShape(`key`).attributes;return t?Object.assign({width:n*Pw,height:r*Pw},t):!1}drawKeyShape(e,t){return this.upsert(`key`,Gy,this.getKeyStyle(e),t)}},gD=class extends FT{constructor(e){super(e)}getInnerR(e){return e.innerR||this.getOuterR(e)*3/8}getOuterR(e){return Math.min(...this.getSize(e))/2}getPoints(e){return qO(this.getOuterR(e),this.getInnerR(e))}getIconStyle(e){let t=super.getIconStyle(e),n=this.getInnerR(e)*2*Pw;return t?Object.assign({width:n,height:n},t):!1}getPortXY(e,t){let{placement:n=`top`}=t,r=this.getShape(`key`).getLocalBounds(),i=JO(this.getOuterR(e),this.getInnerR(e));return IO(r,n,i,!1)}},_D=class e extends FT{constructor(t){super($w({style:e.defaultStyleProps},t))}getPoints(e){let{direction:t}=e,[n,r]=this.getSize(e);return YO(n,r,t)}getPortXY(e,t){let{direction:n}=e,{placement:r=`top`}=t,i=this.getShape(`key`).getLocalBounds(),[a,o]=this.getSize(e),s=XO(a,o,n);return IO(i,r,s,!1)}getIconStyle(e){let{icon:t,iconText:n,iconSrc:r,direction:i}=e;if(t===!1||Uu(n||r))return!1;let a=qw(this.getGraphicStyle(e),`icon`),o=this.getShape(`key`).getLocalBounds(),[s,c]=zS(o,i),l=BS(o,i)*2*Pw;return Object.assign({x:s,y:c,width:l,height:l},a)}};_D.defaultStyleProps={size:40,direction:`up`};var vD=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},yD=class e extends MT{constructor(t){super($w({style:e.defaultStyleProps},t)),this.type=`combo`,this.updateComboPosition(this.parsedAttributes)}getKeySize(e){let{collapsed:t,childrenNode:n=[]}=e;return n.length===0?this.getEmptyKeySize(e):t?this.getCollapsedKeySize(e):this.getExpandedKeySize(e)}getEmptyKeySize(e){let{padding:t,collapsedSize:n}=e,[r,i,a,o]=CS(t);return BC(Xw(n),[o+i,r+a,0])}getCollapsedKeySize(e){return Xw(e.collapsedSize)}getExpandedKeySize(e){let t=this.getContentBBox(e);return[TS(t),ES(t),0]}getContentBBox(e){let{childrenNode:t=[],padding:n}=e,r=t.map(e=>this.context.element.getElement(e)).filter(Boolean);if(r.length===0){let t=new tp,{x:n=0,y:r=0,size:i}=e,[a,o]=Xw(i);return t.setMinMax([n-a/2,r-o/2,0],[n+a/2,r+o/2,0]),t}let i=jS(r.map(e=>e.getBounds()));return n?AS(i,n):i}drawCollapsedMarkerShape(e,t){let n=this.getCollapsedMarkerStyle(e);this.upsert(`collapsed-marker`,kT,n,t),DT(this)}getCollapsedMarkerStyle(e){if(!e.collapsed||!e.collapsedMarker)return!1;let t=qw(this.getGraphicStyle(e),`collapsedMarker`),{type:n}=t,r=vD(t,[`type`]),i=this.getShape(`key`),[a,o]=cw(i.getLocalBounds(),`center`),s=Object.assign(Object.assign({},r),{x:a,y:o});if(n){let t=this.getCollapsedMarkerText(n,e);Object.assign(s,{text:t})}return s}getCollapsedMarkerText(e,t){let{childrenData:n=[]}=t,{model:r}=this.context;return e===`descendant-count`?r.getDescendantsData(this.id).length.toString():e===`child-count`?n.length.toString():e===`node-count`?r.getDescendantsData(this.id).filter(e=>r.getElementType(Q(e))===`node`).length.toString():W(e)?e(n):``}getComboPosition(e){let{x:t=0,y:n=0,collapsed:r,childrenData:i=[]}=e;if(i.length===0)return[+t,+n,0];if(r){let{model:e}=this.context,r=e.getDescendantsData(this.id).filter(t=>!e.isCombo(Q(t)));if(r.length>0&&r.some(ow)){let e=r.reduce((e,t)=>BC(e,aw(t)),[0,0,0]);return UC(e,r.length)}return[+t,+n,0]}return this.getContentBBox(e).center}getComboStyle(e){let[t,n]=this.getComboPosition(e);return{x:t,y:n,transform:[[`translate`,t,n]]}}updateComboPosition(e){let t=this.getComboStyle(e);Object.assign(this.style,t);let{x:n,y:r}=t;this.context.model.syncNodeLikeDatum({id:this.id,style:{x:n,y:r}}),OT(this)}render(e,t=this){super.render(e,t),this.drawCollapsedMarkerShape(e,t)}update(e={}){super.update(e),this.updateComboPosition(this.parsedAttributes)}onframe(){super.onframe(),this.attributes.collapsed||this.updateComboPosition(this.parsedAttributes),this.drawKeyShape(this.parsedAttributes,this)}animate(e,t){let n=super.animate(this.attributes.collapsed?e:e.map(e=>{var{x:t,y:n,z:r,transform:i}=e;return vD(e,[`x`,`y`,`z`,`transform`])}),t);return n&&new Proxy(n,{set:(e,t,n)=>(t===`currentTime`&&Promise.resolve().then(()=>this.onframe()),Reflect.set(e,t,n))})}};yD.defaultStyleProps={childrenNode:[],droppable:!0,draggable:!0,collapsed:!1,collapsedSize:32,collapsedMarker:!0,collapsedMarkerZIndex:1,collapsedMarkerFontSize:12,collapsedMarkerTextAlign:`center`,collapsedMarkerTextBaseline:`middle`,collapsedMarkerType:`child-count`};var bD=class extends yD{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert(`key`,Oy,this.getKeyStyle(e),t)}getKeyStyle(e){let{collapsed:t}=e,n=super.getKeyStyle(e),[r]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},n),t&&qw(n,`collapsed`)),{r:r/2})}getCollapsedKeySize(e){let[t,n]=Xw(e.collapsedSize),r=Math.max(t,n)/2;return[r*2,r*2,0]}getExpandedKeySize(e){let t=this.getContentBBox(e),[n,r]=DS(t),i=Math.sqrt(n**2+r**2)/2;return[i*2,i*2,0]}getIntersectPoint(e,t=!1){let n=this.getShape(`key`).getBounds();return xw(e,n,t)}},xD=class extends yD{constructor(e){super(e)}drawKeyShape(e,t){return this.upsert(`key`,Gy,this.getKeyStyle(e),t)}getKeyStyle(e){let t=super.getKeyStyle(e),[n,r]=this.getKeySize(e);return Object.assign(Object.assign(Object.assign({},t),e.collapsed&&qw(t,`collapsed`)),{width:n,height:r,x:-n/2,y:-r/2})}},SD={padding:10};function CD(e,t,n,r,i,a){let{padding:o}=Object.assign(SD,a),s=OS(n,o),c=OS(r,o),l=[e,...i,t],u=null,d=[];for(let e=0,t=l.length;e<t-1;e++){let n=e+1,r=l[e],i=l[n],a=hw(r,i),f=null;if(e===0)if(n===t-1)if(s.intersects(c))f=MD(r,i,s,c);else if(!IS(r,s)&&!IS(i,c)){let e=RS(r,s),t=RS(i,c);f=OD(e,t,ED(e,t)),f.points.unshift(e),f.points.push(t)}else a||(f=jD(r,i,s,c));else NS(i,s)?f=MD(r,i,s,OS(i,o),u):a||(f=kD(r,i,s));else n===t-1?NS(r,c)?f=MD(r,i,OS(r,o),c,u):a||(f=AD(r,i,c,u)):a||(f=OD(r,i,u));f?(d.push(...f.points),u=f.direction):u=ED(r,i),n<t-1&&d.push(i)}return d.map($C)}var wD={N:`S`,S:`N`,W:`E`,E:`W`},TD={N:-Math.PI/2,S:Math.PI/2,E:0,W:Math.PI};function ED(e,t){let[n,r]=e,[i,a]=t;return n===i?r>a?`N`:`S`:r===a?n>i?`W`:`E`:null}function DD(e,t){return t===`N`||t===`S`?ES(e):TS(e)}function OD(e,t,n){let r=[e[0],t[1]],i=[t[0],e[1]],a=ED(e,r),o=ED(e,i),s=n?wD[n]:null,c=a===n||a!==s&&o!==n?r:i;return{points:[c],direction:ED(c,t)}}function kD(e,t,n){if(IS(e,n)){let r=ND(e,t,n);return{points:[r],direction:ED(r,t)}}else{let r=RS(e,n),i=[`left`,`right`].includes(LS(e,n))?[t[0],r[1]]:[r[0],t[1]];return{points:[i],direction:ED(i,t)}}}function AD(e,t,n,r){let i=IS(t,n)?t:RS(t,n),a=[[i[0],e[1]],[e[0],i[1]]],o=a.filter(e=>FS(e,n)&&!PS(e,n,!0)),s=o.filter(t=>ED(t,e)!==r);if(s.length>0){let n=s.find(t=>ED(e,t)===r)||s[0];return{points:[n],direction:ED(n,t)}}else{let i=Ul(a,o)[0],s=fw(t,i,DD(n,r)/2);return{points:[ND(s,e,n),s],direction:ED(s,t)}}}function jD(e,t,n,r){let i=kD(e,t,n),a=ew(i.points[0]);if(NS(a,r)){i=kD(t,e,r);let o=ew(i.points[0]);if(NS(o,n)){let s=fw(e,a,DD(n,ED(e,a))/2),c=fw(t,o,DD(r,ED(t,o))/2),l=[(s[0]+c[0])/2,(s[1]+c[1])/2],u=kD(e,l,n),d=AD(l,t,r,u.direction);i.points=[u.points[0],d.points[0]],i.direction=d.direction}}return i}function MD(e,t,n,r,i){let a=.01,o=jS([n,r]),s=qC(t,o.center)>qC(e,o.center),[c,l]=s?[t,e]:[e,t],u=ES(o)+TS(o),d;if(i){let e=[c[0]+u*Math.cos(TD[i]),c[1]+u*Math.sin(TD[i])];d=fw(RS(e,o),e,a)}else d=fw(RS(c,o),c,-a);let f=ND(d,l,o),p=[dw(d,2),dw(f,2)];if(Gu(dw(d),dw(f))){let e=XC(VC(d,c),[1,0,0])+Math.PI/2;f=[l[0]+u*Math.cos(e),l[1]+u*Math.sin(e),0],f=dw(fw(RS(f,o),l,-a),2);let t=ND(d,f,o);p=[d,t,f]}return{points:s?p.reverse():p,direction:ED(s?d:f,t)}}function ND(e,t,n){let r=[e[0],t[1]];return NS(r,n)&&(r=[t[0],e[1]]),r}function PD(e,t,n,r,i){let a=typeof t==`number`?t:.5;t===`start`&&(a=0),t===`end`&&(a=.99);let o=lw(e.getPoint(a)),s=lw(e.getPoint(a+.01)),c=t===`start`?`left`:t===`end`?`right`:`center`;if(pw(o,s)||!n){let[t,n]=ID(e,a,r,i);return{transform:[[`translate`,t,n]],textAlign:c}}let l=Math.atan2(s[1]-o[1],s[0]-o[0]);s[0]<o[0]&&(c=c===`center`?c:c===`left`?`right`:`left`,r*=-1,l+=Math.PI);let[u,d]=ID(e,a,r,i,l),f=[[`translate`,u,d],[`rotate`,l/Math.PI*180]];return{textAlign:c,transform:f}}function FD(e,t,n,r,i){let a=e.badge?.getGeometryBounds().halfExtents[0]*2||0,o=e.label?.getGeometryBounds().halfExtents[0]*2||0;return PD(e.key,n,!0,(o?(o/2+a/2)*(t===`suffix`?1:-1):0)+r,i)}function ID(e,t,n,r,i){let[a,o]=lw(e.getPoint(t)),s=n,c=r;return i&&(s=n*Math.cos(i)-r*Math.sin(i),c=n*Math.sin(i)+r*Math.cos(i)),[a+s,o+c]}function LD(e,t,n,r){if(Gu(e,t))return e;let i=VC(t,e),a=[e[0]+n*i[0],e[1]+n*i[1]],o=YC(ZC(i,!1));return a[0]+=r*o[0],a[1]+=r*o[1],a}function RD(e){return G(e)?[e,-e]:e}function zD(e){return G(e)?[e,1-e]:e}function BD(e,t,n){return[[`M`,e[0],e[1]],[`Q`,n[0],n[1],t[0],t[1]]]}function VD(e,t,n){return[[`M`,e[0],e[1]],[`C`,n[0][0],n[0][1],n[1][0],n[1][1],t[0],t[1]]]}function HD(e,t=0,n=!1){let r=e.length-1,i=e[0],a=e[r],o=e.slice(1,r),s=[[`M`,i[0],i[1]]];return o.forEach((e,n)=>{let r=o[n-1]||i,c=o[n+1]||a;if(!gw(r,e,c)&&t){let[n,i]=UD(r,e,c,t);s.push([`L`,n[0],n[1]],[`Q`,e[0],e[1],i[0],i[1]],[`L`,i[0],i[1]])}else s.push([`L`,e[0],e[1]])}),s.push([`L`,a[0],a[1]]),n&&s.push([`Z`]),s}function UD(e,t,n,r){let i=JC(e,t),a=JC(n,t),o=Math.min(r,Math.min(i,a)/2),s=[t[0]-o/i*(t[0]-e[0]),t[1]-o/i*(t[1]-e[1])],c=[t[0]-o/a*(t[0]-n[0]),t[1]-o/a*(t[1]-n[1])];return[s,c]}const WD=e=>{let t=Math.PI/2,n=ES(e)/2,r=TS(e)/2,i=Math.atan2(n,r)/2,a=Math.atan2(r,n)/2;return{top:[-t-a,-t+a],"top-right":[-t+a,-i],"right-top":[-t+a,-i],right:[-i,i],"bottom-right":[i,t-a],"right-bottom":[i,t-a],bottom:[t-a,t+a],"bottom-left":[t+a,Math.PI-i],"left-bottom":[t+a,Math.PI-i],left:[Math.PI-i,Math.PI+i],"top-left":[Math.PI+i,-t-a],"left-top":[Math.PI+i,-t-a]}};function GD(e,t,n,r,i){let a=OS(e),o=e.getCenter(),s=r&&zO(r),c=i&&zO(i);if(!s||!c){let r=WD(a),i=r[t][0],l=r[t][1],[u,d]=DS(a),f=Math.max(u,d),p=BC(o,[f*Math.cos(i),f*Math.sin(i),0]),m=BC(o,[f*Math.cos(l),f*Math.sin(l),0]);s=GO(e,p),c=GO(e,m),n||([s,c]=[c,s])}return[s,c]}function KD(e,t,n,r,i,a){let o=e.getPorts()[i||a],s=e.getPorts()[a||i],[c,l]=GD(e,t,n,o,s),u=qD(e,c,l,r);return o&&(c=WO(o,u[0])),s&&(l=WO(s,u.at(-1))),VD(c,l,u)}function qD(e,t,n,r){let i=e.getCenter();if(Gu(t,n)){let e=VC(t,i),a=[r*Math.sign(e[0])||r/2,r*Math.sign(e[1])||-r/2,0];return[BC(t,a),BC(n,HC(a,[1,-1,1]))]}return[fw(i,t,qC(i,t)+r),fw(i,n,qC(i,n)+r)]}function JD(e,t,n,r,i,a,o){let s=LO(e),c=s[a||o],l=s[o||a],[u,d]=GD(e,n,r,c,l),f=YD(e,u,d,i);return c&&(u=WO(c,f[0])),l&&(d=WO(l,f.at(-1))),HD([u,...f,d],t)}function YD(e,t,n,r){let i=[],a=OS(e);if(Gu(t,n))switch(LS(t,a)){case`left`:i.push([t[0]-r,t[1]]),i.push([t[0]-r,t[1]+r]),i.push([t[0],t[1]+r]);break;case`right`:i.push([t[0]+r,t[1]]),i.push([t[0]+r,t[1]+r]),i.push([t[0],t[1]+r]);break;case`top`:i.push([t[0],t[1]-r]),i.push([t[0]+r,t[1]-r]),i.push([t[0]+r,t[1]]);break;case`bottom`:i.push([t[0],t[1]+r]),i.push([t[0]+r,t[1]+r]),i.push([t[0]+r,t[1]]);break}else{let e=LS(t,a),o=LS(n,a);if(e===o){let a=e,o,s;switch(a){case`left`:o=Math.min(t[0],n[0])-r,i.push([o,t[1]]),i.push([o,n[1]]);break;case`right`:o=Math.max(t[0],n[0])+r,i.push([o,t[1]]),i.push([o,n[1]]);break;case`top`:s=Math.min(t[1],n[1])-r,i.push([t[0],s]),i.push([n[0],s]);break;case`bottom`:s=Math.max(t[1],n[1])+r,i.push([t[0],s]),i.push([n[0],s]);break}}else{let s=(e,t)=>({left:[t[0]-r,t[1]],right:[t[0]+r,t[1]],top:[t[0],t[1]-r],bottom:[t[0],t[1]+r]})[e],c=s(e,t),l=s(o,n),u=ND(c,l,a);i.push(c,u,l)}}return i}function XD(e,t){let n=new Set,r=new Set,i=new Set;return e.forEach(a=>{t(a).forEach(t=>{n.add(t),e.includes(t.source)&&e.includes(t.target)?r.add(t):i.add(t)})}),{edges:Array.from(n),internal:Array.from(r),external:Array.from(i)}}function ZD(e,t){let n=[],r=e;for(;r;){n.push(r);let e=t(Q(r));if(e)r=e;else break}if(n.some(e=>e.style?.collapsed)){let e=n.reverse().findIndex(Uw);return n[e]||n.at(-1)}return e}function QD(e,t){return t||(e<4?10:e===4?12:e*2.5)}var $D=n({circle:()=>eO,diamond:()=>nO,rect:()=>iO,simple:()=>oO,triangle:()=>tO,triangleRect:()=>aO,vee:()=>rO});const eO=(e,t)=>{let n=Math.max(e,t)/2;return[[`M`,-e/2,0],[`A`,n,n,0,1,0,2*n-e/2,0],[`A`,n,n,0,1,0,-e/2,0],[`Z`]]},tO=(e,t)=>[[`M`,-e/2,0],[`L`,e/2,-t/2],[`L`,e/2,t/2],[`Z`]],nO=(e,t)=>[[`M`,-e/2,0],[`L`,0,-t/2],[`L`,e/2,0],[`L`,0,t/2],[`Z`]],rO=(e,t)=>[[`M`,-e/2,0],[`L`,e/2,-t/2],[`L`,4*e/5-e/2,0],[`L`,e/2,t/2],[`Z`]],iO=(e,t)=>[[`M`,-e/2,-t/2],[`L`,e/2,-t/2],[`L`,e/2,t/2],[`L`,-e/2,t/2],[`Z`]],aO=(e,t)=>{let n=e/2,r=e/7,i=e-r;return[[`M`,-n,0],[`L`,0,-t/2],[`L`,0,t/2],[`Z`],[`M`,i-n,-t/2],[`L`,i+r-n,-t/2],[`L`,i+r-n,t/2],[`L`,i-n,t/2],[`Z`]]},oO=(e,t)=>[[`M`,e/2,-t/2],[`L`,-e/2,0],[`L`,e/2,0],[`L`,-e/2,0],[`L`,e/2,t/2]];var sO=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},cO=class e extends AT{constructor(t){super($w({style:e.defaultStyleProps},t)),this.type=`edge`}get sourceNode(){let{sourceNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}get targetNode(){let{targetNode:e}=this.parsedAttributes;return this.context.element.getElement(e)}getKeyStyle(e){let t=this.getGraphicStyle(e),{loop:n}=t,r=sO(t,[`loop`]),{sourceNode:i,targetNode:a}=this,o={d:n&&PO(i,a)?this.getLoopPath(e):this.getKeyPath(e)};return By.PARSED_STYLE_LIST.forEach(e=>{e in r&&(o[e]=r[e])}),o}getLoopPath(e){let{sourcePort:t,targetPort:n}=e,r=this.sourceNode,i=OS(r),a=Math.max(TS(i),ES(i)),{placement:o,clockwise:s,dist:c=a}=qw(this.getGraphicStyle(e),`loop`);return KD(r,o,s,c,t,n)}getEndpoints(e,t=!0,n=[]){let{sourcePort:r,targetPort:i}=e,{sourceNode:a,targetNode:o}=this,[s,c]=BO(a,o,r,i);if(!t){let e=s?zO(s):a.getCenter(),t=c?zO(c):o.getCenter();return[e,t]}let l=typeof n==`function`?n():n,u=UO(s||a,l[0]||c||o),d=UO(c||o,l[l.length-1]||s||a);return[u,d]}getHaloStyle(e){if(e.halo===!1)return!1;let t=this.getKeyStyle(e),n=qw(this.getGraphicStyle(e),`halo`);return Object.assign(Object.assign({},t),n)}getLabelStyle(e){if(e.label===!1||!e.labelText)return!1;let t=qw(this.getGraphicStyle(e),`label`),{placement:n,offsetX:r,offsetY:i,autoRotate:a,maxWidth:o}=t,s=sO(t,[`placement`,`offsetX`,`offsetY`,`autoRotate`,`maxWidth`]),c=PD(this.shapeMap.key,n,a,r,i),l=this.shapeMap.key.getLocalBounds(),u=sT([l.min,l.max],o);return Object.assign({wordWrapWidth:u},c,s)}getBadgeStyle(e){if(e.badge===!1||!e.badgeText)return!1;let t=qw(e,`badge`),{offsetX:n,offsetY:r,placement:i}=t,a=sO(t,[`offsetX`,`offsetY`,`placement`]);return Object.assign(a,FD(this.shapeMap,i,e.labelPlacement,n,r))}drawArrow(e,t){var n;let r=t===`start`,i=e[t===`start`?`startArrow`:`endArrow`],a=this.shapeMap.key;if(i){let t=this.getArrowStyle(e,r),[n,i,o]=r?[`markerStart`,`markerStartOffset`,`startArrowOffset`]:[`markerEnd`,`markerEndOffset`,`endArrowOffset`],s=a.parsedStyle[n];if(s)s.attr(t);else{let e=new(t.src?Iy:By)({style:t});a.style[n]=e}a.style[i]=e[o]||t.width/2+ +t.lineWidth}else{let e=r?`markerStart`:`markerEnd`;(n=a.style[e])==null||n.destroy(),a.style[e]=null}}getArrowStyle(e,t){let n=this.getShape(`key`).attributes,r=t?`startArrow`:`endArrow`,i=qw(this.getGraphicStyle(e),r),{size:a,type:o}=i,s=sO(i,[`size`,`type`]),[c,l]=Xw(QD(n.lineWidth,a)),u=(W(o)?o:$D[o]||tO)(c,l);return Object.assign(Yu(n,[`stroke`,`strokeOpacity`,`fillOpacity`]),{width:c,height:l},Object.assign({},u&&{d:u,fill:o===`simple`?``:n.stroke}),s)}drawLabelShape(e,t){let n=this.getLabelStyle(e);this.upsert(`label`,fT,n,t)}drawHaloShape(e,t){let n=this.getHaloStyle(e);this.upsert(`halo`,By,n,t)}drawBadgeShape(e,t){let n=this.getBadgeStyle(e);this.upsert(`badge`,pT,n,t)}drawSourceArrow(e){this.drawArrow(e,`start`)}drawTargetArrow(e){this.drawArrow(e,`end`)}drawKeyShape(e,t){let n=this.getKeyStyle(e);return this.upsert(`key`,By,n,t)}render(e=this.parsedAttributes,t=this){this.drawKeyShape(e,t),this.getShape(`key`)&&(this.drawSourceArrow(e),this.drawTargetArrow(e),this.drawLabelShape(e,t),this.drawHaloShape(e,t),this.drawBadgeShape(e,t))}onframe(){this.drawKeyShape(this.parsedAttributes,this),this.drawSourceArrow(this.parsedAttributes),this.drawTargetArrow(this.parsedAttributes),this.drawHaloShape(this.parsedAttributes,this),this.drawLabelShape(this.parsedAttributes,this),this.drawBadgeShape(this.parsedAttributes,this)}animate(e,t){let n=super.animate(e,t);return n&&new Proxy(n,{set:(e,t,n)=>(t===`currentTime`&&Promise.resolve().then(()=>this.onframe()),Reflect.set(e,t,n))})}};cO.defaultStyleProps={badge:!0,badgeOffsetX:0,badgeOffsetY:0,badgePlacement:`suffix`,isBillboard:!0,label:!0,labelAutoRotate:!0,labelIsBillboard:!0,labelMaxWidth:`80%`,labelOffsetX:4,labelOffsetY:0,labelPlacement:`center`,labelTextBaseline:`middle`,labelWordWrap:!1,halo:!1,haloDroppable:!1,haloLineDash:0,haloLineWidth:12,haloPointerEvents:`none`,haloStrokeOpacity:.25,haloZIndex:-1,loop:!0,startArrow:!1,startArrowLineDash:0,startArrowLineJoin:`round`,startArrowLineWidth:1,startArrowTransformOrigin:`center`,startArrowType:`vee`,endArrow:!1,endArrowLineDash:0,endArrowLineJoin:`round`,endArrowLineWidth:1,endArrowTransformOrigin:`center`,endArrowType:`vee`,loopPlacement:`top`,loopClockwise:!0};var lO=class e extends cO{constructor(t){super($w({style:e.defaultStyleProps},t))}getKeyPath(e){let[t,n]=this.getEndpoints(e),{controlPoints:r,curvePosition:i,curveOffset:a}=e,o=this.getControlPoints(t,n,zD(i),RD(a),r);return VD(t,n,o)}getControlPoints(e,t,n,r,i){return i?.length===2?i:[LD(e,t,n[0],r[0]),LD(e,t,n[1],r[1])]}};lO.defaultStyleProps={curvePosition:.5,curveOffset:20};var uO=class e extends lO{constructor(t){super($w({style:e.defaultStyleProps},t))}getControlPoints(e,t,n,r){let i=t[0]-e[0];return[[e[0]+i*n[0]+r[0],e[1]],[t[0]-i*n[1]+r[1],t[1]]]}};uO.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};var dO=class e extends lO{constructor(t){super($w({style:e.defaultStyleProps},t))}get ref(){return this.context.model.getRootsData()[0]}getEndpoints(e){if(this.sourceNode.id===this.ref.id)return super.getEndpoints(e);let t=aw(this.ref),n=this.sourceNode.getIntersectPoint(t,!0),r=this.targetNode.getIntersectPoint(t);return[n,r]}toRadialCoordinate(e){let t=aw(this.ref),n=qC(e,t),r=tw(VC(e,t));return[n,r]}getControlPoints(e,t,n,r){let[i,a]=this.toRadialCoordinate(e),[o]=this.toRadialCoordinate(t),s=o-i;return[[e[0]+(s*n[0]+r[0])*Math.cos(a),e[1]+(s*n[0]+r[0])*Math.sin(a)],[t[0]-(s*n[1]-r[0])*Math.cos(a),t[1]-(s*n[1]-r[0])*Math.sin(a)]]}};dO.defaultStyleProps={curvePosition:.5,curveOffset:20};var fO=class e extends lO{constructor(t){super($w({style:e.defaultStyleProps},t))}getControlPoints(e,t,n,r){let i=t[1]-e[1];return[[e[0],e[1]+i*n[0]+r[0]],[t[0],t[1]-i*n[1]+r[1]]]}};fO.defaultStyleProps={curvePosition:[.5,.5],curveOffset:[0,0]};var pO=class e extends cO{constructor(t){super($w({style:e.defaultStyleProps},t))}getKeyPath(e){let[t,n]=this.getEndpoints(e);return[[`M`,t[0],t[1]],[`L`,n[0],n[1]]]}};pO.defaultStyleProps={};var mO={enableObstacleAvoidance:!1,offset:10,maxAllowedDirectionChange:Math.PI/2,maximumLoops:3e3,gridSize:5,startDirections:[`top`,`right`,`bottom`,`left`],endDirections:[`top`,`right`,`bottom`,`left`],directionMap:{right:{stepX:1,stepY:0},left:{stepX:-1,stepY:0},bottom:{stepX:0,stepY:1},top:{stepX:0,stepY:-1}},penalties:{0:0,90:0},distFunc:JC},hO=e=>`${Math.round(e[0])}|||${Math.round(e[1])}`;function gO(e,t){let n=e=>Math.round(e/t);return G(e)?n(e):e.map(n)}function _O(e,t){let n=Math.abs(e-t);return n>Math.PI?2*Math.PI-n:n}function vO(e,t){let n=t[0]-e[0],r=t[1]-e[1];return!n&&!r?0:Math.atan2(r,n)}function yO(e,t,n,r){let i=vO(e,t),a=n[hO(e)],o=vO(a||r,e);return _O(o,i)}var bO=(e,t)=>{let{offset:n,gridSize:r}=t,i={};return e.forEach(e=>{if(!e||e.destroyed||!e.isVisible())return;let t=AS(e.getRenderBounds(),n);for(let e=gO(t.min[0],r);e<=gO(t.max[0],r);e+=1)for(let n=gO(t.min[1],r);n<=gO(t.max[1],r);n+=1)i[`${e}|||${n}`]=!0}),i};function xO(e,t,n){return Math.min(...t.map(t=>n(e,t)))}function SO(e,t,n){let r=e[0],i=n(e[0],t);for(let a=0;a<e.length;a++){let o=e[a],s=n(o,t);s<i&&(r=o,i=s)}return r}var CO=(e,t,n,r)=>{if(!t)return[e];let{directionMap:i,offset:a}=r,o=AS(t.getRenderBounds(),a),s=Object.keys(i).reduce((t,r)=>{if(n.includes(r)){let n=i[r],[a,s]=DS(o),c=[e[0]+n.stepX*a,e[1]+n.stepY*s],l=VS(o);for(let n=0;n<l.length;n++){let r=rw([e,c],l[n]);r&&PS(r,o)&&t.push(r)}}return t},[]);return NS(e,o)||s.push(e),s.map(e=>gO(e,r.gridSize))},wO=(e,t,n,r,i,a,o)=>{let s=[],c=[a[0]===r[0]?r[0]:e[0]*o,a[1]===r[1]?r[1]:e[1]*o];s.unshift(c);let l=e,u=t[hO(l)];for(;u;){let e=u,r=l;yO(e,r,t,n)&&(c=[e[0]===r[0]?c[0]:e[0]*o,e[1]===r[1]?c[1]:e[1]*o],s.unshift(c)),u=t[hO(e)],l=e}let d=i.map(e=>[e[0]*o,e[1]*o]),f=SO(d,c,JC);return s.unshift(f),s};function TO(e,t,n,r){let i=$C(e.getCenter()),a=$C(t.getCenter()),o=Object.assign(mO,r),{gridSize:s}=o,c=o.enableObstacleAvoidance?n:[e,t],l=bO(c,o),u=gO(i,s),d=gO(a,s),f=CO(i,e,o.startDirections,o),p=CO(a,t,o.endDirections,o);f.forEach(e=>delete l[hO(e)]),p.forEach(e=>delete l[hO(e)]);let m={},h={},g={},_={},v={},y=new EO;for(let e=0;e<f.length;e++){let t=f[e],n=hO(t);m[n]=t,_[n]=0,v[n]=xO(t,p,o.distFunc),y.add({id:n,value:v[n]})}let b=p.map(e=>hO(e)),x=o.maximumLoops,S,C=1/0;for(let[e,t]of Object.entries(m))v[e]<=C&&(C=v[e],S=t);for(;Object.keys(m).length>0&&x>0;){let e=y.minId(!1);if(e)S=m[e];else break;let t=hO(S);if(b.includes(t))return wO(S,g,u,a,f,d,s);delete m[t],y.remove(t),h[t]=!0;for(let e of Object.values(o.directionMap)){let n=BC(S,[e.stepX,e.stepY]),r=hO(n);if(h[r])continue;let i=yO(S,n,g,u);if(i>o.maxAllowedDirectionChange||l[r])continue;m[r]||(m[r]=n);let a=o.penalties[i],c=o.distFunc(S,n)+(isNaN(a)?s:a),d=_[t]+c,f=_[r];if(f&&d>=f)continue;g[r]=S,_[r]=d,v[r]=d+xO(n,p,o.distFunc),y.add({id:r,value:v[r]})}--x}return[]}var EO=class{constructor(){this.arr=[],this.map={},this.arr=[],this.map={}}_innerAdd(e,t){let n=0,r=t-1;for(;r-n>1;){let t=Math.floor((n+r)/2);if(this.arr[t].value>e.value)r=t;else if(this.arr[t].value<e.value)n=t;else{this.arr.splice(t,0,e),this.map[e.id]=!0;return}}this.arr.splice(r,0,e),this.map[e.id]=!0}add(e){delete this.map[e.id];let t=this.arr.length;if(!t||this.arr[t-1].value<e.value){this.arr.push(e),this.map[e.id]=!0;return}this._innerAdd(e,t)}remove(e){this.map[e]&&delete this.map[e]}_clearAndGetMinId(){let e;for(let t=this.arr.length-1;t>=0;t--)this.map[this.arr[t].id]?e=this.arr[t].id:this.arr.splice(t,1);return e}_findFirstId(){for(;this.arr.length;){let e=this.arr.shift();if(this.map[e.id])return e.id}}minId(e){return e?this._clearAndGetMinId():this._findFirstId()}},DO=class e extends cO{constructor(t){super($w({style:e.defaultStyleProps},t))}getControlPoints(e){let{router:t}=e,{sourceNode:n,targetNode:r}=this,[i,a]=this.getEndpoints(e,!1),o=[];if(!t)o=e.controlPoints;else if(t.type===`shortest-path`){let s=this.context.element.getNodes();o=TO(n,r,s,t),o.length||(o=CD(i,a,n,r,e.controlPoints,{padding:t.offset}))}else t.type===`orth`&&(o=CD(i,a,n,r,e.controlPoints,t));return o}getPoints(e){let t=this.getControlPoints(e),[n,r]=this.getEndpoints(e,!0,t);return[n,...t,r]}getKeyPath(e){let t=this.getPoints(e);return HD(t,e.radius)}getLoopPath(e){let{sourcePort:t,targetPort:n,radius:r}=e,i=this.sourceNode,a=OS(i),o=Math.max(TS(a),ES(a))/4,{placement:s,clockwise:c,dist:l=o}=qw(this.getGraphicStyle(e),`loop`);return JD(i,r,s,c,l,t,n)}};DO.defaultStyleProps={radius:0,controlPoints:[],router:!1};var OO=class e extends cO{constructor(t){super($w({style:e.defaultStyleProps},t))}getKeyPath(e){let{curvePosition:t,curveOffset:n}=e,[r,i]=this.getEndpoints(e),a=e.controlPoint||LD(r,i,t,n);return BD(r,i,a)}};OO.defaultStyleProps={curvePosition:.5,curveOffset:30};var kO=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function AO(e){return e instanceof MT&&e.type===`node`}function jO(e){return e instanceof cO}function MO(e){return e instanceof yD}function NO(e){return AO(e)||jO(e)||MO(e)}function PO(e,t){return!e||!t?!1:e===t}var FO={top:[.5,0],right:[1,.5],bottom:[.5,1],left:[0,.5],"left-top":[0,0],"top-left":[0,0],"left-bottom":[0,1],"bottom-left":[0,1],"right-top":[1,0],"top-right":[1,0],"right-bottom":[1,1],"bottom-right":[1,1],default:[.5,.5]};function IO(e,t,n=FO,r=!0){let i=[.5,.5],a=ru(t)?Ku(n,t.toLocaleLowerCase(),i):t;if(!r&&ru(t))return a;let[o,s]=a||i;return[e.min[0]+TS(e)*o,e.min[1]+ES(e)*s]}function LO(e){if(!e)return{};let t=e.getPorts();return(e.attributes.ports||[]).forEach((n,r)=>{var i;let{key:a,placement:o}=n;RO(n)&&(t[i=a||r]||(t[i]=cw(e.getShape(`key`).getBounds(),o)))}),t}function RO(e){let{r:t}=e;return!t||Number(t)===0}function zO(e){return xS(e)?e:e.getPosition()}function BO(e,t,n,r){let i=VO(e,t,n,r),a=VO(t,e,r,n);return[i,a]}function VO(e,t,n,r){let i=LO(e);if(n)return i[n];let a=Object.values(i);if(a.length===0)return;let o=a.map(e=>zO(e)),s=HO(t,r),[c]=Sw(o,s);return a.find(e=>zO(e)===c)}function HO(e,t){let n=LO(e);if(t)return[zO(n[t])];let r=Object.values(n);return r.length>0?r.map(e=>zO(e)):[e.getCenter()]}function UO(e,t){return MO(e)||AO(e)?GO(e,t):WO(e,t)}function WO(e,t){if(!e||!t)return[0,0,0];if(xS(e))return e;if(e.attributes.linkToCenter)return e.getPosition();let n=xS(t)?t:AO(t)?t.getCenter():t.getPosition();return xw(n,e.getBounds())}function GO(e,t){if(!e||!t)return[0,0,0];let n=xS(t)?t:AO(t)?t.getCenter():t.getPosition();return e.getIntersectPoint(n)||e.getCenter()}function KO(e,t=`bottom`,n=0,r=0,i=!1){let a=t.split(`-`),[o,s]=cw(e,t),[c,l]=i?[`bottom`,`top`]:[`top`,`bottom`],u=a.includes(`top`)?l:a.includes(`bottom`)?c:`middle`,d=a.includes(`left`)?`right`:a.includes(`right`)?`left`:`center`;return{transform:[[`translate`,o+n,s+r]],textBaseline:u,textAlign:d}}function qO(e,t){return[[0,-e],[t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)],[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[0,t],[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],[-t*Math.cos(Math.PI/10),t*Math.sin(Math.PI/10)],[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],[-t*Math.cos(3*Math.PI/10),-t*Math.sin(3*Math.PI/10)]]}function JO(e,t){let n={};return n.top=[0,-e],n.left=[-e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],n[`left-bottom`]=[-e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],n.bottom=[0,t],n[`right-bottom`]=[e*Math.cos(3*Math.PI/10),e*Math.sin(3*Math.PI/10)],n.right=n.default=[e*Math.cos(Math.PI/10),-e*Math.sin(Math.PI/10)],n}function YO(e,t,n){let r=t/2,i=e/2,a={up:[[-i,r],[i,r],[0,-r]],left:[[-i,0],[i,r],[i,-r]],right:[[-i,r],[-i,-r],[i,0]],down:[[-i,-r],[i,-r],[0,r]]};return a[n]||a.up}function XO(e,t,n){let r=t/2,i=e/2,a={};return n===`down`?(a.bottom=a.default=[0,r],a.right=[i,-r],a.left=[-i,-r]):n===`left`?(a.top=[i,-r],a.bottom=[i,r],a.left=a.default=[-i,0]):n===`right`?(a.top=[-i,-r],a.bottom=[-i,r],a.right=a.default=[i,0]):(a.left=[-i,r],a.top=a.default=[0,-r],a.right=[i,r]),a}function ZO(e,t){return[[0,-t/2],[e/2,0],[0,t/2],[-e/2,0]]}function QO(e){return Ku(e,[`style`,`visibility`])!==`hidden`}function $O(e,t){let{zIndex:n,transform:r,transformOrigin:i,visibility:a,cursor:o,clipPath:s,component:c}=t,l=kO(t,[`zIndex`,`transform`,`transformOrigin`,`visibility`,`cursor`,`clipPath`,`component`]);Object.assign(e.attributes,l),r&&e.setAttribute(`transform`,r),G(n)&&e.setAttribute(`zIndex`,n),i&&e.setAttribute(`transformOrigin`,i),a&&e.setAttribute(`visibility`,a),o&&e.setAttribute(`cursor`,o),s&&e.setAttribute(`clipPath`,s),c&&e.setAttribute(`component`,c)}function ek(e,t){`update`in e?e.update(t):e.attr(t)}function tk(e){return[[0,e],[e*Math.sqrt(3)/2,e/2],[e*Math.sqrt(3)/2,-e/2],[0,-e],[-e*Math.sqrt(3)/2,-e/2],[-e*Math.sqrt(3)/2,e/2]]}function nk(e){qu(e,`__to_be_destroyed__`,!0)}function rk(e){return Ku(e,`__to_be_destroyed__`,!1)}var ik=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},ak=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.onCollapseExpand=e=>ik(this,void 0,void 0,function*(){if(!this.validate(e))return;let{target:t}=e;if(!NO(t))return;let n=t.id,{model:r,graph:i}=this.context,a=r.getElementDataById(n);if(!a)return!1;let{onCollapse:o,onExpand:s,animation:c,align:l}=this.options;Uw(a)?(yield i.expandElement(n,{animation:c,align:l}),s?.(n)):(yield i.collapseElement(n,{animation:c,align:l}),o?.(n))}),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){let{graph:e}=this.context,{trigger:t}=this.options;e.on(`node:${t}`,this.onCollapseExpand),e.on(`combo:${t}`,this.onCollapseExpand)}unbindEvents(){let{graph:e}=this.context,{trigger:t}=this.options;e.off(`node:${t}`,this.onCollapseExpand),e.off(`combo:${t}`,this.onCollapseExpand)}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}};ak.defaultOptions={enable:!0,animation:!0,trigger:X.DBLCLICK,align:!0};var ok=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},sk=`g6-create-edge-assist-edge-id`,ck=`g6-create-edge-assist-node-id`,lk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.drop=e=>ok(this,void 0,void 0,function*(){let{targetType:t}=e;[`combo`,`node`].includes(t)&&this.source?yield this.handleCreateEdge(e):yield this.cancelEdge()}),this.handleCreateEdge=e=>ok(this,void 0,void 0,function*(){if(!this.validate(e))return;let{graph:t,canvas:n,batch:r,element:i}=this.context,{style:a}=this.options;if(this.source){this.createEdge(e),yield this.cancelEdge();return}r.startBatch(),n.setCursor(`crosshair`),this.source=this.getSelectedNodeIDs([e.target.id])[0];let o=t.getElementData(this.source);t.addNodeData([{id:ck,style:{visibility:`hidden`,ports:[{key:`port-1`,placement:[.5,.5]}],x:o.style?.x,y:o.style?.y}}]),t.addEdgeData([{id:sk,source:this.source,target:ck,style:Object.assign({pointerEvents:`none`},a)}]),yield i.draw({animation:!1})?.finished}),this.updateAssistEdge=e=>ok(this,void 0,void 0,function*(){if(!this.source)return;let{model:t,element:n}=this.context;t.translateNodeTo(ck,[e.canvas.x,e.canvas.y]),yield n.draw({animation:!1,silence:!0})?.finished}),this.createEdge=e=>{let{graph:t}=this.context,{style:n,onFinish:r,onCreate:i}=this.options;if(e.target?.id===void 0||this.source===void 0)return;let a=this.getSelectedNodeIDs([e.target.id])?.[0],o=`${this.source}-${a}-${$u()}`,s=i({id:o,source:this.source,target:a,style:n});s&&(t.addEdgeData([s]),r(s))},this.cancelEdge=()=>ok(this,void 0,void 0,function*(){if(!this.source)return;let{graph:e,element:t,batch:n}=this.context;e.removeNodeData([ck]),this.source=void 0,yield t.draw({animation:!1})?.finished,n.endBatch()}),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){let{graph:e}=this.context,{trigger:t}=this.options;this.unbindEvents(),t===`click`?(e.on(Kx.CLICK,this.handleCreateEdge),e.on(Hx.CLICK,this.handleCreateEdge),e.on(Vx.CLICK,this.cancelEdge),e.on(Wx.CLICK,this.cancelEdge)):(e.on(Kx.DRAG_START,this.handleCreateEdge),e.on(Hx.DRAG_START,this.handleCreateEdge),e.on(X.POINTER_UP,this.drop)),e.on(X.POINTER_MOVE,this.updateAssistEdge)}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState(`node`,this.options.state).map(e=>e.id).concat(e)))}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}unbindEvents(){let{graph:e}=this.context;e.off(Kx.CLICK,this.handleCreateEdge),e.off(Hx.CLICK,this.handleCreateEdge),e.off(Vx.CLICK,this.cancelEdge),e.off(Wx.CLICK,this.cancelEdge),e.off(Kx.DRAG_START,this.handleCreateEdge),e.off(Hx.DRAG_START,this.handleCreateEdge),e.off(X.POINTER_UP,this.drop),e.off(X.POINTER_MOVE,this.updateAssistEdge)}destroy(){this.unbindEvents(),super.destroy()}};lk.defaultOptions={animation:!0,enable:!0,style:{},trigger:`drag`,onCreate:e=>e,onFinish:()=>{}};var uk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},dk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.isDragging=!1,this.onDragStart=e=>{this.validate(e)&&(this.isDragging=!0,this.context.canvas.setCursor(`grabbing`))},this.onDrag=e=>{if(!this.isDragging||kw.isPinching)return;let t=e.movement?.x??e.dx,n=e.movement?.y??e.dy;(t|n)!==0&&this.translate([t,n],!1)},this.onDragEnd=()=>{var e,t;this.isDragging=!1,this.context.canvas.setCursor(this.defaultCursor),(t=(e=this.options).onFinish)==null||t.call(e)},this.invokeOnFinish=Nu(()=>{var e,t;(t=(e=this.options).onFinish)==null||t.call(e)},300),this.shortcut=new jw(t.graph),this.bindEvents(),this.defaultCursor=this.context.canvas.getConfig().cursor||`default`}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){let{trigger:e}=this.options;if(Kl(e)){let{up:t=[],down:n=[],left:r=[],right:i=[]}=e;this.shortcut.bind(t,e=>this.onTranslate([0,1],e)),this.shortcut.bind(n,e=>this.onTranslate([0,-1],e)),this.shortcut.bind(r,e=>this.onTranslate([1,0],e)),this.shortcut.bind(i,e=>this.onTranslate([-1,0],e))}else{let{graph:e}=this.context;e.on(X.DRAG_START,this.onDragStart),e.on(X.DRAG,this.onDrag),e.on(X.DRAG_END,this.onDragEnd)}}onTranslate(e,t){return uk(this,void 0,void 0,function*(){if(!this.validate(t))return;let{sensitivity:n}=this.options,r=n*-1;yield this.translate(HC(e,r),this.options.animation),this.invokeOnFinish()})}translate(e,t){return uk(this,void 0,void 0,function*(){e=this.clampByDirection(e),e=this.clampByRange(e),e=this.clampByRotation(e),yield this.context.graph.translateBy(e,t)})}clampByRotation([e,t]){let n=this.context.graph.getRotation();if(n%360==0)return[e,t];let r=n*Math.PI/180,i=Math.cos(r),a=Math.sin(r);return[e*i-t*a,e*a+t*i]}clampByDirection([e,t]){let{direction:n}=this.options;return n===`x`?t=0:n===`y`&&(e=0),[e,t]}clampByRange([e,t]){let{viewport:n,canvas:r}=this.context,[i,a]=r.getSize(),[o,s,c,l]=CS(this.options.range),u=[a*o,i*s,a*c,i*l],d=AS(kS(n.getCanvasCenter()),u),f=VC(n.getViewportCenter(),[e,t,0]);if(!NS(f,d)){let{min:[n,r],max:[i,a]}=d;(f[0]<n&&e>0||f[0]>i&&e<0)&&(e=0),(f[1]<r&&t>0||f[1]>a&&t<0)&&(t=0)}return[e,t]}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return typeof t==`function`?t(e):!!t}unbindEvents(){this.shortcut.unbindAll();let{graph:e}=this.context;e.off(X.DRAG_START,this.onDragStart),e.off(X.DRAG,this.onDrag),e.off(X.DRAG_END,this.onDragEnd)}destroy(){this.shortcut.destroy(),this.unbindEvents(),this.context.canvas.setCursor(this.defaultCursor),super.destroy()}};dk.defaultOptions={enable:e=>`targetType`in e?e.targetType===`canvas`:!0,sensitivity:10,direction:`both`,range:1/0};var fk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},pk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.enable=!1,this.enableElements=[`node`,`combo`],this.target=[],this.shadowOrigin=[0,0],this.hiddenEdges=[],this.isDragging=!1,this.onDrop=e=>fk(this,void 0,void 0,function*(){if(this.options.dropEffect!==`link`)return;let{model:t,element:n}=this.context,r=e.target.id;this.target.forEach(e=>{let n=t.getParentData(e,qx);n&&Q(n)===r&&t.refreshComboData(r),t.setParent(e,r,qx)}),yield n?.draw({animation:!0})?.finished}),this.setCursor=e=>{if(this.isDragging)return;let{type:t}=e,{canvas:n}=this.context,{cursor:r}=this.options;t===X.POINTER_ENTER?n.setCursor(r?.grab||`grab`):n.setCursor(r?.default||`default`)},this.onDragStart=this.onDragStart.bind(this),this.onDrag=this.onDrag.bind(this),this.onDragEnd=this.onDragEnd.bind(this),this.onDrop=this.onDrop.bind(this),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}bindEvents(){let{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.addEventListener(`blur`,this.onDragEnd),n.addEventListener(`contextmenu`,this.onDragEnd)),this.enableElements.forEach(t=>{e.on(`${t}:${X.DRAG_START}`,this.onDragStart),e.on(`${t}:${X.DRAG}`,this.onDrag),e.on(`${t}:${X.DRAG_END}`,this.onDragEnd),e.on(`${t}:${X.POINTER_ENTER}`,this.setCursor),e.on(`${t}:${X.POINTER_LEAVE}`,this.setCursor)}),[`link`].includes(this.options.dropEffect)&&(e.on(Hx.DROP,this.onDrop),e.on(Vx.DROP,this.onDrop))}getSelectedNodeIDs(e){return Array.from(new Set(this.context.graph.getElementDataByState(`node`,this.options.state).map(e=>e.id).concat(e)))}getDelta(e){let t=this.context.graph.getZoom();return UC([e.dx,e.dy],t)}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;let{batch:t,canvas:n,graph:r}=this.context;n.setCursor(this.options.cursor?.grabbing||`grabbing`),this.isDragging=!0,t.startBatch();let i=e.target.id;r.getElementState(i).includes(this.options.state)?this.target=this.getSelectedNodeIDs([i]):this.target=[i],this.hideEdge(),this.context.graph.frontElement(this.target),this.options.shadow&&this.createShadow(this.target)}onDrag(e){if(!this.enable)return;let t=this.getDelta(e);this.options.shadow?this.moveShadow(t):this.moveElement(this.target,t)}onDragEnd(){var e,t;if(!this.enable)return;if(this.enable=!1,this.options.shadow){if(!this.shadow)return;this.shadow.style.visibility=`hidden`;let{x:e=0,y:t=0}=this.shadow.attributes,[n,r]=VC([+e,+t],this.shadowOrigin);this.moveElement(this.target,[n,r])}this.showEdges(),(t=(e=this.options).onFinish)==null||t.call(e,this.target);let{batch:n,canvas:r}=this.context;n.endBatch(),r.setCursor(this.options.cursor?.grab||`grab`),this.isDragging=!1,this.target=[]}validate(e){if(this.destroyed||rk(e.target)||this.context.graph.isCollapsingExpanding)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}moveElement(e,t){return fk(this,void 0,void 0,function*(){let{graph:n,model:r}=this.context,{dropEffect:i}=this.options;i===`move`&&e.forEach(e=>r.refreshComboData(e)),n.translateElementBy(Object.fromEntries(e.map(e=>[e,t])),!1)})}moveShadow(e){if(!this.shadow)return;let{x:t=0,y:n=0}=this.shadow.attributes,[r,i]=e;this.shadow.attr({x:+t+r,y:+n+i})}createShadow(e){let t=qw(this.options,`shadow`),n=jS(e.map(e=>this.context.element.getElement(e).getBounds())),[r,i]=n.min;this.shadowOrigin=[r,i];let[a,o]=DS(n),s={width:a,height:o,x:r,y:i};this.shadow?this.shadow.attr(Object.assign(Object.assign(Object.assign({},t),s),{visibility:`visible`})):(this.shadow=new Gy({style:Object.assign(Object.assign(Object.assign({$layer:`transient`},t),s),{pointerEvents:`none`})}),this.context.canvas.appendChild(this.shadow))}showEdges(){this.options.shadow||this.hiddenEdges.length===0||(this.context.graph.showElement(this.hiddenEdges),this.hiddenEdges=[])}hideEdge(){let{hideEdge:e,shadow:t}=this.options;if(e===`none`||t)return;let{graph:n}=this.context;e===`all`?this.hiddenEdges=n.getEdgeData().map(Q):this.hiddenEdges=Array.from(new Set(this.target.map(t=>n.getRelatedEdgesData(t,e).map(Q)).flat())),n.hideElement(this.hiddenEdges)}unbindEvents(){let{graph:e,canvas:t}=this.context,n=t.getLayer().getContextService().$canvas;n&&(n.removeEventListener(`blur`,this.onDragEnd),n.removeEventListener(`contextmenu`,this.onDragEnd)),this.enableElements.forEach(t=>{e.off(`${t}:${X.DRAG_START}`,this.onDragStart),e.off(`${t}:${X.DRAG}`,this.onDrag),e.off(`${t}:${X.DRAG_END}`,this.onDragEnd),e.off(`${t}:${X.POINTER_ENTER}`,this.setCursor),e.off(`${t}:${X.POINTER_LEAVE}`,this.setCursor)}),e.off(`combo:${X.DROP}`,this.onDrop),e.off(`canvas:${X.DROP}`,this.onDrop)}destroy(){var e;this.unbindEvents(),(e=this.shadow)==null||e.destroy(),super.destroy()}};pk.defaultOptions={animation:!0,enable:e=>[`node`,`combo`].includes(e.targetType),dropEffect:`move`,state:`selected`,hideEdge:`none`,shadow:!1,shadowZIndex:100,shadowFill:`#F3F9FF`,shadowFillOpacity:.5,shadowStroke:`#1890FF`,shadowStrokeOpacity:.9,shadowLineDash:[5,5],cursor:{default:`default`,grab:`grab`,grabbing:`grabbing`}};var mk=`*`,hk=function(){function e(){this._events={}}return e.prototype.on=function(e,t,n){return this._events[e]||(this._events[e]=[]),this._events[e].push({callback:t,once:!!n}),this},e.prototype.once=function(e,t){return this.on(e,t,!0)},e.prototype.emit=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=this._events[e]||[],a=this._events[mk]||[],o=function(r){for(var i=r.length,a=0;a<i;a++)if(r[a]){var o=r[a],s=o.callback;o.once&&(r.splice(a,1),r.length===0&&delete t._events[e],i--,a--),s.apply(t,n)}};o(i),o(a)},e.prototype.off=function(e,t){if(!e)this._events={};else if(!t)delete this._events[e];else{for(var n=this._events[e]||[],r=n.length,i=0;i<r;i++)n[i].callback===t&&(n.splice(i,1),r--,i--);n.length===0&&delete this._events[e]}return this},e.prototype.getEvents=function(){return this._events},e}();function gk(e,t,n,r){for(;e.length;){let i=e.shift();if(n(i))return!0;t.add(i.id),r(i.id).forEach(n=>{t.has(n.id)||(t.add(n.id),e.push(n))})}return!1}function _k(e,t,n,r){if(n(e))return!0;t.add(e.id);for(let i of r(e.id))if(!t.has(i.id)&&_k(i,t,n,r))return!0;return!1}var vk=()=>!0,yk=class{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(e){this.graph=e.graph;let t=e.nodeFilter||vk,n=e.edgeFilter||vk;this.nodeFilter=t,this.edgeFilter=e=>{let{source:r,target:i}=this.graph.getEdgeDetail(e.id);return!t(r)||!t(i)?!1:n(e,r,i)},e.cache===`auto`?(this.cacheEnabled=!0,this.startAutoCache()):e.cache===`manual`?this.cacheEnabled=!0:this.cacheEnabled=!1}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map(e=>e.id))};updateCache=e=>{let t=new Set;e.forEach(e=>{let n=this.bothEdgesMap.get(e);if(n&&n.forEach(e=>t.add(e.id)),!this.hasNode(e))this.inEdgesMap.delete(e),this.outEdgesMap.delete(e),this.bothEdgesMap.delete(e),this.allNodesMap.delete(e);else{let n=this.graph.getRelatedEdges(e,`in`).filter(this.edgeFilter),r=this.graph.getRelatedEdges(e,`out`).filter(this.edgeFilter),i=Array.from(new Set([...n,...r]));i.forEach(e=>t.add(e.id)),this.inEdgesMap.set(e,n),this.outEdgesMap.set(e,r),this.bothEdgesMap.set(e,i),this.allNodesMap.set(e,this.graph.getNode(e))}}),t.forEach(e=>{this.hasEdge(e)?this.allEdgesMap.set(e,this.graph.getEdge(e)):this.allEdgesMap.delete(e)})};startAutoCache(){this.refreshCache(),this.graph.on(`changed`,this.handleGraphChanged)}stopAutoCache(){this.graph.off(`changed`,this.handleGraphChanged)}handleGraphChanged=e=>{let t=new Set;e.changes.forEach(n=>{switch(n.type){case`NodeAdded`:t.add(n.value.id);break;case`NodeDataUpdated`:t.add(n.id);break;case`EdgeAdded`:t.add(n.value.source),t.add(n.value.target);break;case`EdgeUpdated`:(n.propertyName===`source`||n.propertyName===`target`)&&(t.add(n.oldValue),t.add(n.newValue));break;case`EdgeDataUpdated`:if(e.graph.hasEdge(n.id)){let r=e.graph.getEdge(n.id);t.add(r.source),t.add(r.target)}break;case`EdgeRemoved`:t.add(n.value.source),t.add(n.value.target);break;case`NodeRemoved`:t.add(n.value.id);break;default:break}}),this.updateCache(t)};checkNodeExistence(e){this.getNode(e)}hasNode(e){if(!this.graph.hasNode(e))return!1;let t=this.graph.getNode(e);return this.nodeFilter(t)}areNeighbors(e,t){return this.checkNodeExistence(e),this.getNeighbors(t).some(t=>t.id===e)}getNode(e){let t=this.graph.getNode(e);if(!this.nodeFilter(t))throw Error(`Node not found for id: `+e);return t}getRelatedEdges(e,t){return this.checkNodeExistence(e),this.cacheEnabled?t===`in`?this.inEdgesMap.get(e):t===`out`?this.outEdgesMap.get(e):this.bothEdgesMap.get(e):this.graph.getRelatedEdges(e,t).filter(this.edgeFilter)}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){let t=this.getRelatedEdges(e,`out`).map(e=>this.getNode(e.target));return Array.from(new Set(t))}getPredecessors(e){let t=this.getRelatedEdges(e,`in`).map(e=>this.getNode(e.source));return Array.from(new Set(t))}getNeighbors(e){let t=this.getPredecessors(e),n=this.getSuccessors(e);return Array.from(new Set([...t,...n]))}hasEdge(e){if(!this.graph.hasEdge(e))return!1;let t=this.graph.getEdge(e);return this.edgeFilter(t)}getEdge(e){let t=this.graph.getEdge(e);if(!this.edgeFilter(t))throw Error(`Edge not found for id: `+e);return t}getEdgeDetail(e){let t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}hasTreeStructure(e){return this.graph.hasTreeStructure(e)}getRoots(e){return this.graph.getRoots(e).filter(this.nodeFilter)}getChildren(e,t){return this.checkNodeExistence(e),this.graph.getChildren(e,t).filter(this.nodeFilter)}getParent(e,t){this.checkNodeExistence(e);let n=this.graph.getParent(e,t);return!n||!this.nodeFilter(n)?null:n}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(e,t,n=`out`){let r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];gk([this.getNode(e)],new Set,t,r)}dfs(e,t,n=`out`){let r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];_k(this.getNode(e),new Set,t,r)}},bk=class e extends hk{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(e){super(),e&&(e.nodes&&this.addNodes(e.nodes),e.edges&&this.addEdges(e.edges),e.tree&&this.addTree(e.tree),e.onChanged&&(this.onChanged=e.onChanged))}batch=e=>{this.batchCount+=1,e(),--this.batchCount,this.batchCount||this.commit()};commit(){let e=this.changes;this.changes=[];let t={graph:this,changes:e};this.emit(`changed`,t),this.onChanged(t)}reduceChanges(e){let t=[];return e.forEach(e=>{switch(e.type){case`NodeRemoved`:{let n=!1;t=t.filter(t=>{if(t.type===`NodeAdded`){let r=t.value.id===e.value.id;return r&&(n=!0),!r}else if(t.type===`NodeDataUpdated`)return t.id!==e.value.id;else if(t.type===`TreeStructureChanged`)return t.nodeId!==e.value.id;return!0}),n||t.push(e);break}case`EdgeRemoved`:{let n=!1;t=t.filter(t=>{if(t.type===`EdgeAdded`){let r=t.value.id===e.value.id;return r&&(n=!0),!r}else if(t.type===`EdgeDataUpdated`||t.type===`EdgeUpdated`)return t.id!==e.value.id;return!0}),n||t.push(e);break}case`NodeDataUpdated`:case`EdgeDataUpdated`:case`EdgeUpdated`:{let n=t.findIndex(t=>t.type===e.type&&t.id===e.id&&(e.propertyName===void 0||t.propertyName===e.propertyName)),r=t[n];r?e.propertyName===void 0?(t.splice(n,1),t.push(e)):r.newValue=e.newValue:t.push(e);break}case`TreeStructureDetached`:t=t.filter(t=>t.type===`TreeStructureAttached`||t.type===`TreeStructureChanged`?t.treeKey!==e.treeKey:!0),t.push(e);break;case`TreeStructureChanged`:{let n=t.find(t=>t.type===`TreeStructureChanged`&&t.treeKey===e.treeKey&&t.nodeId===e.nodeId);n?n.newParentId=e.newParentId:t.push(e);break}default:t.push(e);break}}),t}checkNodeExistence(e){this.getNode(e)}hasNode(e){return this.nodeMap.has(e)}areNeighbors(e,t){return this.getNeighbors(t).some(t=>t.id===e)}getNode(e){let t=this.nodeMap.get(e);if(!t)throw Error(`Node not found for id: `+e);return t}getRelatedEdges(e,t){if(this.checkNodeExistence(e),t===`in`){let t=this.inEdgesMap.get(e);return Array.from(t)}else if(t===`out`){let t=this.outEdgesMap.get(e);return Array.from(t)}else{let t=this.bothEdgesMap.get(e);return Array.from(t)}}getDegree(e,t){return this.getRelatedEdges(e,t).length}getSuccessors(e){let t=this.getRelatedEdges(e,`out`).map(e=>this.getNode(e.target));return Array.from(new Set(t))}getPredecessors(e){let t=this.getRelatedEdges(e,`in`).map(e=>this.getNode(e.source));return Array.from(new Set(t))}getNeighbors(e){let t=this.getPredecessors(e),n=this.getSuccessors(e);return Array.from(new Set([...t,...n]))}doAddNode(e){if(this.hasNode(e.id))throw Error(`Node already exists: `+e.id);this.nodeMap.set(e.id,e),this.inEdgesMap.set(e.id,new Set),this.outEdgesMap.set(e.id,new Set),this.bothEdgesMap.set(e.id,new Set),this.treeIndices.forEach(t=>{t.childrenMap.set(e.id,new Set)}),this.changes.push({type:`NodeAdded`,value:e})}addNodes(e){this.batch(()=>{for(let t of e)this.doAddNode(t)})}addNode(e){this.addNodes([e])}doRemoveNode(e){let t=this.getNode(e);this.bothEdgesMap.get(e)?.forEach(e=>this.doRemoveEdge(e.id)),this.nodeMap.delete(e),this.treeIndices.forEach(n=>{n.childrenMap.get(e)?.forEach(e=>{n.parentMap.delete(e.id)});let r=n.parentMap.get(e);r&&n.childrenMap.get(r.id)?.delete(t),n.parentMap.delete(e),n.childrenMap.delete(e)}),this.bothEdgesMap.delete(e),this.inEdgesMap.delete(e),this.outEdgesMap.delete(e),this.changes.push({type:`NodeRemoved`,value:t})}removeNodes(e){this.batch(()=>{e.forEach(e=>this.doRemoveNode(e))})}removeNode(e){this.removeNodes([e])}updateNodeDataProperty(e,t,n){let r=this.getNode(e);this.batch(()=>{let i=r.data[t],a=n;r.data[t]=a,this.changes.push({type:`NodeDataUpdated`,id:e,propertyName:t,oldValue:i,newValue:a})})}mergeNodeData(e,t){this.batch(()=>{Object.entries(t).forEach(([t,n])=>{this.updateNodeDataProperty(e,t,n)})})}updateNodeData(...e){let t=e[0],n=this.getNode(t);if(typeof e[1]==`string`){this.updateNodeDataProperty(t,e[1],e[2]);return}let r;if(typeof e[1]==`function`){let t=e[1];r=t(n.data)}else typeof e[1]==`object`&&(r=e[1]);this.batch(()=>{let e=n.data,i=r;n.data=r,this.changes.push({type:`NodeDataUpdated`,id:t,oldValue:e,newValue:i})})}checkEdgeExistence(e){if(!this.hasEdge(e))throw Error(`Edge not found for id: `+e)}hasEdge(e){return this.edgeMap.has(e)}getEdge(e){return this.checkEdgeExistence(e),this.edgeMap.get(e)}getEdgeDetail(e){let t=this.getEdge(e);return{edge:t,source:this.getNode(t.source),target:this.getNode(t.target)}}doAddEdge(e){if(this.hasEdge(e.id))throw Error(`Edge already exists: `+e.id);this.checkNodeExistence(e.source),this.checkNodeExistence(e.target),this.edgeMap.set(e.id,e);let t=this.inEdgesMap.get(e.target),n=this.outEdgesMap.get(e.source),r=this.bothEdgesMap.get(e.source),i=this.bothEdgesMap.get(e.target);t.add(e),n.add(e),r.add(e),i.add(e),this.changes.push({type:`EdgeAdded`,value:e})}addEdges(e){this.batch(()=>{for(let t of e)this.doAddEdge(t)})}addEdge(e){this.addEdges([e])}doRemoveEdge(e){let t=this.getEdge(e),n=this.outEdgesMap.get(t.source),r=this.inEdgesMap.get(t.target),i=this.bothEdgesMap.get(t.source),a=this.bothEdgesMap.get(t.target);n.delete(t),r.delete(t),i.delete(t),a.delete(t),this.edgeMap.delete(e),this.changes.push({type:`EdgeRemoved`,value:t})}removeEdges(e){this.batch(()=>{e.forEach(e=>this.doRemoveEdge(e))})}removeEdge(e){this.removeEdges([e])}updateEdgeSource(e,t){let n=this.getEdge(e);this.checkNodeExistence(t);let r=n.source,i=t;this.outEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.outEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.source=t,this.batch(()=>{this.changes.push({type:`EdgeUpdated`,id:e,propertyName:`source`,oldValue:r,newValue:i})})}updateEdgeTarget(e,t){let n=this.getEdge(e);this.checkNodeExistence(t);let r=n.target,i=t;this.inEdgesMap.get(r).delete(n),this.bothEdgesMap.get(r).delete(n),this.inEdgesMap.get(i).add(n),this.bothEdgesMap.get(i).add(n),n.target=t,this.batch(()=>{this.changes.push({type:`EdgeUpdated`,id:e,propertyName:`target`,oldValue:r,newValue:i})})}updateEdgeDataProperty(e,t,n){let r=this.getEdge(e);this.batch(()=>{let i=r.data[t],a=n;r.data[t]=a,this.changes.push({type:`EdgeDataUpdated`,id:e,propertyName:t,oldValue:i,newValue:a})})}updateEdgeData(...e){let t=e[0],n=this.getEdge(t);if(typeof e[1]==`string`){this.updateEdgeDataProperty(t,e[1],e[2]);return}let r;if(typeof e[1]==`function`){let t=e[1];r=t(n.data)}else typeof e[1]==`object`&&(r=e[1]);this.batch(()=>{let e=n.data,i=r;n.data=r,this.changes.push({type:`EdgeDataUpdated`,id:t,oldValue:e,newValue:i})})}mergeEdgeData(e,t){this.batch(()=>{Object.entries(t).forEach(([t,n])=>{this.updateEdgeDataProperty(e,t,n)})})}checkTreeExistence(e){if(!this.hasTreeStructure(e))throw Error(`Tree structure not found for treeKey: `+e)}hasTreeStructure(e){return this.treeIndices.has(e)}attachTreeStructure(e){this.treeIndices.has(e)||(this.treeIndices.set(e,{parentMap:new Map,childrenMap:new Map}),this.batch(()=>{this.changes.push({type:`TreeStructureAttached`,treeKey:e})}))}detachTreeStructure(e){this.checkTreeExistence(e),this.treeIndices.delete(e),this.batch(()=>{this.changes.push({type:`TreeStructureDetached`,treeKey:e})})}addTree(e,t){this.batch(()=>{this.attachTreeStructure(t);let n=[],r=Array.isArray(e)?e:[e];for(;r.length;){let e=r.shift();n.push(e),e.children&&r.push(...e.children)}this.addNodes(n),n.forEach(e=>{e.children?.forEach(n=>{this.setParent(n.id,e.id,t)})})})}getRoots(e){return this.checkTreeExistence(e),this.getAllNodes().filter(t=>!this.getParent(t.id,e))}getChildren(e,t){this.checkNodeExistence(e),this.checkTreeExistence(t);let n=this.treeIndices.get(t).childrenMap.get(e);return Array.from(n||[])}getParent(e,t){return this.checkNodeExistence(e),this.checkTreeExistence(t),this.treeIndices.get(t).parentMap.get(e)||null}getAncestors(e,t){let n=[],r=this.getNode(e),i;for(;i=this.getParent(r.id,t);)n.push(i),r=i;return n}setParent(e,t,n){this.checkTreeExistence(n);let r=this.treeIndices.get(n);if(!r)return;let i=this.getNode(e),a=r.parentMap.get(e);if(a?.id===t)return;if(t==null){a&&r.childrenMap.get(a.id)?.delete(i),r.parentMap.delete(e);return}let o=this.getNode(t);r.parentMap.set(e,o),a&&r.childrenMap.get(a.id)?.delete(i);let s=r.childrenMap.get(o.id);s||(s=new Set,r.childrenMap.set(o.id,s)),s.add(i),this.batch(()=>{this.changes.push({type:`TreeStructureChanged`,treeKey:n,nodeId:e,oldParentId:a?.id,newParentId:o.id})})}dfsTree(e,t,n){return _k(this.getNode(e),new Set,t,e=>this.getChildren(e,n))}bfsTree(e,t,n){return gk([this.getNode(e)],new Set,t,e=>this.getChildren(e,n))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(e,t,n=`out`){let r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return gk([this.getNode(e)],new Set,t,r)}dfs(e,t,n=`out`){let r={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[n];return _k(this.getNode(e),new Set,t,r)}clone(){let t=this.getAllNodes().map(e=>({...e,data:{...e.data}})),n=this.getAllEdges().map(e=>({...e,data:{...e.data}})),r=new e({nodes:t,edges:n});return this.treeIndices.forEach(({parentMap:e,childrenMap:t},n)=>{let i=new Map;e.forEach((e,t)=>{i.set(t,r.getNode(e.id))});let a=new Map;t.forEach((e,t)=>{a.set(t,new Set(Array.from(e).map(e=>r.getNode(e.id))))}),r.treeIndices.set(n,{parentMap:i,childrenMap:a})}),r}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(e){return new yk({graph:this,...e})}},xk=class{constructor(e,t){this.context=e,this.options=t||{}}},Sk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Ck=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function wk(e){let{type:t}=e;return[`compact-box`,`mindmap`,`dendrogram`,`indented`].includes(t)}function Tk(e){return!Array.isArray(e)&&e?.preLayout}function Ek(e){let{nodes:t,edges:n}=e,r={nodes:[],edges:[],combos:[]};return t.forEach(e=>{let t=e.data._isCombo?r.combos:r.nodes,{x:n,y:i,z:a=0}=e.data;t?.push({id:e.id,style:{x:n,y:i,z:a}})}),n.forEach(e=>{let{id:t,source:n,target:i,data:{points:a=[],controlPoints:o=a.slice(1,a.length-1)}}=e;r.edges.push({id:t,source:n,target:i,style:Object.assign({},o?.length?{controlPoints:o.map(lw)}:{})})}),r}function Dk(e,t){class n extends xk{constructor(t,n){if(super(t,n),this.instance=new e({}),this.id=this.instance.id,`stop`in this.instance&&`tick`in this.instance){let e=this.instance;this.stop=e.stop.bind(e),this.tick=t=>{let n=e.tick(t);return Ek(n)}}}execute(e,t){return Sk(this,void 0,void 0,function*(){return Ek(yield this.instance.execute(this.graphData2LayoutModel(e),this.transformOptions(Bu({},this.options,t))))})}transformOptions(e){if(!(`onTick`in e))return e;let t=e.onTick;return e.onTick=e=>t(Ek(e)),e}graphData2LayoutModel(e){let{nodes:n=[],edges:r=[],combos:i=[]}=e,a=n.map(e=>{let t=Q(e),{data:n,style:r,combo:i}=e,a=Ck(e,[`data`,`style`,`combo`]),o={id:t,data:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),{data:n}),i?{parentId:i}:{}),{style:r}),a)};return r?.x&&Object.assign(o.data,{x:r.x}),r?.y&&Object.assign(o.data,{y:r.y}),r?.z&&Object.assign(o.data,{z:r.z}),o}),o=new Map(a.map(e=>[e.id,e])),s=r.filter(e=>{let{source:t,target:n}=e;return o.has(t)&&o.has(n)}).map(e=>{let{source:t,target:n,data:r,style:i}=e;return{id:Q(e),source:t,target:n,data:Object.assign({},r),style:Object.assign({},i)}}),c=i.map(e=>({id:Q(e),data:Object.assign({_isCombo:!0},e.data),style:Object.assign({},e.style)})),l=new bk({nodes:[...a,...c],edges:s});return t.model.model.hasTreeStructure(`combo`)&&(l.attachTreeStructure(qx),a.forEach(e=>{let n=t.model.model.getParent(e.id,qx);n&&l.hasNode(n.id)&&l.setParent(e.id,n.id,qx)})),l}}return n}function Ok(e,t,...n){if(t in e)return e[t](...n);if(`instance`in e){let r=e.instance;if(t in r)return r[t](...n)}return null}function kk(e,t){if(t in e)return e[t];if(`instance`in e){let n=e.instance;if(t in n)return n[t]}return null}var Ak=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},jk=class extends pk{get forceLayoutInstance(){return this.context.layout.getLayoutInstance().find(e=>[`d3-force`,`d3-force-3d`].includes(e?.id))}validate(e){return this.context.layout?this.forceLayoutInstance?super.validate(e):(eS.warn(`DragElementForce only works with d3-force or d3-force-3d layout`),!1):!1}moveElement(e,t){return Ak(this,void 0,void 0,function*(){let n=this.forceLayoutInstance;this.context.graph.getNodeData(e).forEach((r,i)=>{let{x:a=0,y:o=0}=r.style||{};n&&Ok(n,`setFixedPosition`,e[i],[...BC([+a,+o],t)])})})}onDragStart(e){if(this.enable=this.validate(e),!this.enable)return;this.target=this.getSelectedNodeIDs([e.target.id]),this.hideEdge(),this.context.graph.frontElement(this.target);let t=this.forceLayoutInstance;t&&kk(t,`simulation`).alphaTarget(.3).restart(),this.context.graph.getNodeData(this.target).forEach(e=>{let{x:n=0,y:r=0}=e.style||{};t&&Ok(t,`setFixedPosition`,Q(e),[+n,+r])})}onDrag(e){if(!this.enable)return;let t=this.getDelta(e);this.moveElement(this.target,t)}onDragEnd(){let e=this.forceLayoutInstance;e&&kk(e,`simulation`).alphaTarget(0),!this.options.fixed&&this.context.graph.getNodeData(this.target).forEach(t=>{e&&Ok(e,`setFixedPosition`,Q(t),[null,null,null])})}},Mk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Nk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.isZoomEvent=e=>!!(e.data&&`scale`in e.data),this.relatedEdgeToUpdate=new Set,this.zoom=this.context.graph.getZoom(),this.fixElementSize=e=>Mk(this,void 0,void 0,function*(){if(!this.validate(e))return;let{graph:t}=this.context,{state:n,nodeFilter:r,edgeFilter:i,comboFilter:a}=this.options,o=(n?t.getElementDataByState(`node`,n):t.getNodeData()).filter(r),s=(n?t.getElementDataByState(`edge`,n):t.getEdgeData()).filter(i),c=(n?t.getElementDataByState(`combo`,n):t.getComboData()).filter(a),l=this.isZoomEvent(e)?this.zoom=Math.max(.01,Math.min(e.data.scale,10)):this.zoom,u=[...o,...c];u.length>0&&u.forEach(e=>this.fixNodeLike(e,l)),this.updateRelatedEdges(),s.length>0&&s.forEach(e=>this.fixEdge(e,l))}),this.cachedStyles=new Map,this.getOriginalFieldValue=(e,t,n)=>{let r=this.cachedStyles.get(e)||[],i=r.find(e=>e.shape===t)?.style||{};return n in i||(i[n]=t.attributes[n],this.cachedStyles.set(e,[...r.filter(e=>e.shape!==t),{shape:t,style:i}])),i[n]},this.scaleEntireElement=(e,t,n)=>{t.setLocalScale(1/n);let r=this.cachedStyles.get(e)||[];r.push({shape:t}),this.cachedStyles.set(e,r)},this.scaleSpecificShapes=(e,t,n)=>{let r=ST(e);(Array.isArray(n)?n:[n]).forEach(n=>{let{shape:i,fields:a}=n,o=typeof i==`function`?i(r):e.getShape(i);if(o){if(!a){this.scaleEntireElement(e.id,o,t);return}a.forEach(n=>{let r=this.getOriginalFieldValue(e.id,o,n);G(r)&&(o.style[n]=r/t)})}})},this.skipIfExceedViewport=e=>{let{viewport:t}=this.context;return!t?.isInViewport(e.getRenderBounds(),!1,30)},this.fixNodeLike=(e,t)=>{let n=Q(e),{element:r,model:i}=this.context,a=r.getElement(n);if(!a||this.skipIfExceedViewport(a))return;i.getRelatedEdgesData(n).forEach(e=>this.relatedEdgeToUpdate.add(Q(e)));let o=this.options[a.type];if(!o){this.scaleEntireElement(n,a,t);return}this.scaleSpecificShapes(a,t,o)},this.fixEdge=(e,t)=>{let n=Q(e),r=this.context.element.getElement(n);if(!r||this.skipIfExceedViewport(r))return;let i=this.options.edge;if(!i){r.style.transformOrigin=`center`,this.scaleEntireElement(n,r,t);return}this.scaleSpecificShapes(r,t,i)},this.updateRelatedEdges=()=>{let{element:e}=this.context;this.relatedEdgeToUpdate.size>0&&this.relatedEdgeToUpdate.forEach(t=>{e.getElement(t)?.update({})}),this.relatedEdgeToUpdate.clear()},this.resetTransform=e=>Mk(this,void 0,void 0,function*(){e.data?.firstRender||(this.options.reset?this.restoreCachedStyles():this.fixElementSize({data:{scale:this.zoom}}))}),this.bindEvents()}restoreCachedStyles(){if(this.cachedStyles.size>0){this.cachedStyles.forEach(e=>{e.forEach(({shape:e,style:t})=>{if(Uu(t))e.setLocalScale(1);else{if(this.options.state)return;Object.entries(t).forEach(([t,n])=>e.style[t]=n)}})});let{graph:e,element:t}=this.context,n=Object.keys(Object.fromEntries(this.cachedStyles)).filter(t=>t&&e.getElementType(t)===`node`);if(n.length>0){let r=new Set;n.forEach(t=>{e.getRelatedEdgesData(t).forEach(e=>r.add(Q(e)))}),r.forEach(e=>{(t?.getElement(e))?.update({})})}}}bindEvents(){let{graph:e}=this.context;e.on(Z.AFTER_DRAW,this.resetTransform),e.on(Z.AFTER_TRANSFORM,this.fixElementSize)}unbindEvents(){let{graph:e}=this.context;e.off(Z.AFTER_DRAW,this.resetTransform),e.off(Z.AFTER_TRANSFORM,this.fixElementSize)}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}destroy(){this.unbindEvents(),super.destroy()}};Nk.defaultOptions={enable:e=>e.data.scale<1,nodeFilter:()=>!0,edgeFilter:()=>!0,comboFilter:()=>!0,edge:[{shape:`key`,fields:[`lineWidth`]},{shape:`halo`,fields:[`lineWidth`]},{shape:`label`}],reset:!1};var Pk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Fk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.focus=e=>Pk(this,void 0,void 0,function*(){if(!this.validate(e))return;let{graph:t}=this.context;yield t.focusElement(e.target.id,this.options.animation)}),this.bindEvents()}bindEvents(){let{graph:e}=this.context;this.unbindEvents(),Fw.forEach(t=>{e.on(`${t}:${X.CLICK}`,this.focus)})}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}unbindEvents(){let{graph:e}=this.context;Fw.forEach(t=>{e.off(`${t}:${X.CLICK}`,this.focus)})}destroy(){this.unbindEvents(),super.destroy()}};Fk.defaultOptions={animation:{easing:`ease-in`,duration:500},enable:!0};var Ik=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.isFrozen=!1,this.toggleFrozen=e=>{this.isFrozen=e.type===`dragstart`},this.hoverElement=e=>{if(!this.validate(e))return;let t=e.type===X.POINTER_ENTER;this.updateElementsState(e,t);let{onHover:n,onHoverEnd:r}=this.options;t?n?.(e):r?.(e)},this.updateElementsState=(e,t)=>{if(!this.options.state&&!this.options.inactiveState)return;let{graph:n}=this.context,{state:r,animation:i,inactiveState:a}=this.options,o=this.getActiveIds(e),s={};if(r&&Object.assign(s,this.getElementsState(o,r,t)),a){let e=CC(n.getData(),!0).filter(e=>!o.includes(e));Object.assign(s,this.getElementsState(e,a,t))}n.setElementState(s,i)},this.getElementsState=(e,t,n)=>{let{graph:r}=this.context,i={};return e.forEach(e=>{let a=r.getElementState(e);n?i[e]=a.includes(t)?a:[...a,t]:i[e]=a.filter(e=>e!==t)}),i},this.bindEvents()}bindEvents(){let{graph:e}=this.context;this.unbindEvents(),Fw.forEach(t=>{e.on(`${t}:${X.POINTER_ENTER}`,this.hoverElement),e.on(`${t}:${X.POINTER_LEAVE}`,this.hoverElement)});let t=this.context.canvas.document;t.addEventListener(`${X.DRAG_START}`,this.toggleFrozen),t.addEventListener(`${X.DRAG_END}`,this.toggleFrozen)}getActiveIds(e){let{graph:t}=this.context,{degree:n,direction:r}=this.options,i=e.target.id;return n?Rw(t,e.targetType,i,typeof n==`function`?n(e):n,r):[i]}validate(e){if(this.destroyed||this.isFrozen||rk(e.target)||this.context.graph.isCollapsingExpanding)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}unbindEvents(){let{graph:e}=this.context;Fw.forEach(t=>{e.off(`${t}:${X.POINTER_ENTER}`,this.hoverElement),e.off(`${t}:${X.POINTER_LEAVE}`,this.hoverElement)});let t=this.context.canvas.document;t.removeEventListener(`${X.DRAG_START}`,this.toggleFrozen),t.removeEventListener(`${X.DRAG_END}`,this.toggleFrozen)}destroy(){this.unbindEvents(),super.destroy()}};Ik.defaultOptions={animation:!1,enable:!0,degree:0,direction:`both`,state:`active`,inactiveState:void 0};var Lk=class extends Mw{onPointerDown(e){if(!super.validate(e)||!super.isKeydown()||this.points)return;let{canvas:t}=this.context;this.pathShape=new By({id:`g6-lasso-select`,style:this.options.style}),t.appendChild(this.pathShape),this.points=[Nw(e)]}onPointerMove(e){var t;if(!this.points)return;let{immediately:n,mode:r}=this.options;this.points.push(Nw(e)),(t=this.pathShape)==null||t.setAttribute(`d`,mT(this.points)),n&&r===`default`&&this.points.length>2&&super.updateElementsStates(this.points)}onPointerUp(){if(this.points){if(this.points.length<2){this.clearLasso();return}super.updateElementsStates(this.points),this.clearLasso()}}clearLasso(){var e;(e=this.pathShape)==null||e.remove(),this.pathShape=void 0,this.points=void 0}},Rk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.hiddenShapes=[],this.isVisible=!0,this.setElementsVisibility=(e,t,n)=>{e.filter(Boolean).forEach(e=>{t===`hidden`&&!e.isVisible()?this.hiddenShapes.push(e):t===`visible`&&this.hiddenShapes.includes(e)?this.hiddenShapes.splice(this.hiddenShapes.indexOf(e),1):NC(e,t,n)})},this.filterShapes=(e,t)=>{if(W(t))return n=>!t(e,n);let n=t?.[e];return e=>e.className?!n?.includes(e.className):!0},this.hideShapes=e=>{if(!this.validate(e)||!this.isVisible)return;let{element:t}=this.context,{shapes:n={}}=this.options;this.setElementsVisibility(t.getNodes(),`hidden`,this.filterShapes(`node`,n)),this.setElementsVisibility(t.getEdges(),`hidden`,this.filterShapes(`edge`,n)),this.setElementsVisibility(t.getCombos(),`hidden`,this.filterShapes(`combo`,n)),this.isVisible=!1},this.showShapes=Nu(e=>{if(!this.validate(e)||this.isVisible)return;let{element:t}=this.context;this.setElementsVisibility(t.getNodes(),`visible`),this.setElementsVisibility(t.getEdges(),`visible`),this.setElementsVisibility(t.getCombos(),`visible`),this.isVisible=!0},this.options.debounce),this.bindEvents()}bindEvents(){let{graph:e}=this.context;e.on(Z.BEFORE_TRANSFORM,this.hideShapes),e.on(Z.AFTER_TRANSFORM,this.showShapes)}unbindEvents(){let{graph:e}=this.context;e.off(Z.BEFORE_TRANSFORM,this.hideShapes),e.off(Z.AFTER_TRANSFORM,this.showShapes)}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy()}};Rk.defaultOptions={enable:!0,debounce:200,shapes:e=>e===`node`};var zk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Bk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.onWheel=e=>zk(this,void 0,void 0,function*(){this.options.preventDefault&&e.preventDefault();let t=e.deltaX,n=e.deltaY;yield this.scroll([-t,-n],e)}),this.shortcut=new jw(t.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){var e,t;let{trigger:n}=this.options;if(this.shortcut.unbindAll(),Kl(n)){(e=this.graphDom)==null||e.removeEventListener(X.WHEEL,this.onWheel);let{up:t=[],down:r=[],left:i=[],right:a=[]}=n;this.shortcut.bind(t,e=>this.scroll([0,-10],e)),this.shortcut.bind(r,e=>this.scroll([0,10],e)),this.shortcut.bind(i,e=>this.scroll([-10,0],e)),this.shortcut.bind(a,e=>this.scroll([10,0],e))}else (t=this.graphDom)==null||t.addEventListener(X.WHEEL,this.onWheel,{passive:!1})}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}formatDisplacement(e){let{sensitivity:t}=this.options;return e=HC(e,t),e=this.clampByDirection(e),e=this.clampByRange(e),e}clampByDirection([e,t]){let{direction:n}=this.options;return n===`x`?t=0:n===`y`&&(e=0),[e,t]}clampByRange([e,t]){let{viewport:n,canvas:r}=this.context,[i,a]=r.getSize(),[o,s,c,l]=CS(this.options.range),u=[a*o,i*s,a*c,i*l],d=AS(kS(n.getCanvasCenter()),u),f=VC(n.getViewportCenter(),[e,t,0]);if(!NS(f,d)){let{min:[n,r],max:[i,a]}=d;(f[0]<n&&e>0||f[0]>i&&e<0)&&(e=0),(f[1]<r&&t>0||f[1]>a&&t<0)&&(t=0)}return[e,t]}scroll(e,t){return zk(this,void 0,void 0,function*(){if(!this.validate(t))return;let{onFinish:n}=this.options,r=this.context.graph,i=this.formatDisplacement(e);yield r.translateBy(i,!1),n?.()})}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.graphDom)==null||e.removeEventListener(X.WHEEL,this.onWheel),super.destroy()}};Bk.defaultOptions={enable:!0,sensitivity:1,preventDefault:!0,range:1/0};var Vk=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},Hk=class e extends LC{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.zoom=(e,t,n)=>Vk(this,void 0,void 0,function*(){if(!this.validate(t))return;let{graph:r}=this.context,i=this.options.origin;!i&&`viewport`in t&&(i=lw(t.viewport));let{sensitivity:a,onFinish:o}=this.options,s=1+cu(e,-50,50)*a/100,c=r.getZoom();yield r.zoomTo(c*s,n,i),o?.()}),this.onReset=()=>Vk(this,void 0,void 0,function*(){yield this.context.graph.zoomTo(1,this.options.animation)}),this.preventDefault=e=>{this.options.preventDefault&&e.preventDefault()},this.shortcut=new jw(t.graph),this.bindEvents()}update(e){super.update(e),this.bindEvents()}bindEvents(){let{trigger:e}=this.options;if(this.shortcut.unbindAll(),Array.isArray(e)&&(e.includes(X.PINCH)?this.shortcut.bind([X.PINCH],e=>{this.zoom(e.scale,e,!1)}):(this.context.canvas.getContainer()?.addEventListener(X.WHEEL,this.preventDefault),this.shortcut.bind([...e,X.WHEEL],e=>{let{deltaX:t,deltaY:n}=e;this.zoom(-(n??t),e,!1)}))),typeof e==`object`){let{zoomIn:t=[],zoomOut:n=[],reset:r=[]}=e;this.shortcut.bind(t,e=>this.zoom(10,e,this.options.animation)),this.shortcut.bind(n,e=>this.zoom(-10,e,this.options.animation)),this.shortcut.bind(r,this.onReset)}}validate(e){if(this.destroyed)return!1;let{enable:t}=this.options;return W(t)?t(e):!!t}destroy(){var e;this.shortcut.destroy(),(e=this.context.canvas.getContainer())==null||e.removeEventListener(X.WHEEL,this.preventDefault),super.destroy()}};Hk.defaultOptions={animation:{duration:200},enable:!0,sensitivity:1,trigger:[],preventDefault:!0};var Uk=r(((exports,t)=>{(function(n,r){typeof exports==`object`&&typeof t==`object`?t.exports=r():typeof define==`function`&&define.amd?define([],r):typeof exports==`object`?exports.Hierarchy=r():n.Hierarchy=r()})(typeof self<`u`?self:exports,function(){return(function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,`a`,t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=``,n(n.s=5)})([(function(e,t){function n(e,t,n,r){return r===void 0&&(r=`height`),n===`center`?(e[r]+t[r])/2:e.height}e.exports={assign:Object.assign,getHeight:n}}),(function(e,t,n){var r=n(3);e.exports=function(){function e(e,t){t===void 0&&(t={});var n=this;n.options=t,n.rootNode=r(e,t)}var t=e.prototype;return t.execute=function(){throw Error(`please override this method`)},e}()}),(function(e,t,n){var r=n(4),i=[`LR`,`RL`,`TB`,`BT`,`H`,`V`],a=[`LR`,`RL`,`H`],o=function(e){return a.indexOf(e)>-1},s=i[0];e.exports=function(e,t,n){var a=t.direction||s;if(t.isHorizontal=o(a),a&&i.indexOf(a)===-1)throw TypeError(`Invalid direction: `+a);if(a===i[0])n(e,t);else if(a===i[1])n(e,t),e.right2left();else if(a===i[2])n(e,t);else if(a===i[3])n(e,t),e.bottom2top();else if(a===i[4]||a===i[5]){var l=r(e,t),u=l.left,d=l.right;n(u,t),n(d,t),t.isHorizontal?u.right2left():u.bottom2top(),d.translate(u.x-d.x,u.y-d.y),e.x=u.x,e.y=d.y;var f=e.getBoundingBox();t.isHorizontal?f.top<0&&e.translate(0,-f.top):f.left<0&&e.translate(-f.left,0)}var p=t.fixedRoot;return p===void 0&&(p=!0),p&&e.translate(-(e.x+e.width/2+e.hgap),-(e.y+e.height/2+e.vgap)),c(e,t),e};function c(e,t){if(t.radial){var n=t.isHorizontal?[`x`,`y`]:[`y`,`x`],r=n[0],i=n[1],a={x:1/0,y:1/0},o={x:-1/0,y:-1/0},s=0;e.DFTraverse(function(e){s++;var t=e.x,n=e.y;a.x=Math.min(a.x,t),a.y=Math.min(a.y,n),o.x=Math.max(o.x,t),o.y=Math.max(o.y,n)});var c=o[i]-a[i];if(c===0)return;var l=Math.PI*2/s;e.DFTraverse(function(t){var n=(t[i]-a[i])/c*(Math.PI*2-l)+l,o=t[r]-e[r];t.x=Math.cos(n)*o,t.y=Math.sin(n)*o})}}}),(function(e,t,n){var r=n(0),i=18,a=i*2,o=i,s={getId:function(e){return e.id||e.name},getPreH:function(e){return e.preH||0},getPreV:function(e){return e.preV||0},getHGap:function(e){return e.hgap||o},getVGap:function(e){return e.vgap||o},getChildren:function(e){return e.children},getHeight:function(e){return e.height||a},getWidth:function(e){var t=e.label||` `;return e.width||t.split(``).length*i}};function c(e,t){var n=this;if(n.vgap=n.hgap=0,e instanceof c)return e;n.data=e;var r=t.getHGap(e),i=t.getVGap(e);return n.preH=t.getPreH(e),n.preV=t.getPreV(e),n.width=t.getWidth(e),n.height=t.getHeight(e),n.width+=n.preH,n.height+=n.preV,n.id=t.getId(e),n.x=n.y=0,n.depth=0,n.children||=[],n.addGap(r,i),n}r.assign(c.prototype,{isRoot:function(){return this.depth===0},isLeaf:function(){return this.children.length===0},addGap:function(e,t){var n=this;n.hgap+=e,n.vgap+=t,n.width+=2*e,n.height+=2*t},eachNode:function(e){for(var t=[this],n;n=t.shift();)e(n),t=n.children.concat(t)},DFTraverse:function(e){this.eachNode(e)},BFTraverse:function(e){for(var t=[this],n;n=t.shift();)e(n),t=t.concat(n.children)},getBoundingBox:function(){var e={left:Number.MAX_VALUE,top:Number.MAX_VALUE,width:0,height:0};return this.eachNode(function(t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.width=Math.max(e.width,t.x+t.width),e.height=Math.max(e.height,t.y+t.height)}),e},translate:function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),this.eachNode(function(n){n.x+=e,n.y+=t,n.x+=n.preH,n.y+=n.preV})},right2left:function(){var e=this,t=e.getBoundingBox();e.eachNode(function(e){e.x=e.x-(e.x-t.left)*2-e.width}),e.translate(t.width,0)},bottom2top:function(){var e=this,t=e.getBoundingBox();e.eachNode(function(e){e.y=e.y-(e.y-t.top)*2-e.height}),e.translate(0,t.height)}});function l(e,t,n){t===void 0&&(t={}),t=r.assign({},s,t);var i=new c(e,t),a=[i],o;if(!n&&!e.collapsed){for(;o=a.shift();)if(!o.data.collapsed){var l=t.getChildren(o.data),u=l?l.length:0;if(o.children=Array(u),l&&u)for(var d=0;d<u;d++){var f=new c(l[d],t);o.children[d]=f,a.push(f),f.parent=o,f.depth=o.depth+1}}}return i}e.exports=l}),(function(e,t,n){var r=n(3);e.exports=function(e,t){for(var n=r(e.data,t,!0),i=r(e.data,t,!0),a=e.children.length,o=Math.round(a/2),s=t.getSide||function(e,t){return t<o?`right`:`left`},c=0;c<a;c++){var l=e.children[c];s(l,c)===`right`?i.children.push(l):n.children.push(l)}return n.eachNode(function(e){e.isRoot()||(e.side=`left`)}),i.eachNode(function(e){e.isRoot()||(e.side=`right`)}),{left:n,right:i}}}),(function(e,t,n){e.exports={compactBox:n(6),dendrogram:n(8),indented:n(10),mindmap:n(12)}}),(function(e,t,n){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(1),o=n(7),s=n(2),c=n(0),l=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.execute=function(){var e=this;return s(e.rootNode,e.options,o)},t}(a),u={};function d(e,t){return t=c.assign({},u,t),new l(e,t).execute()}e.exports=d}),(function(e,t){function n(e,t,n,r){r===void 0&&(r=[]);var i=this;i.w=e||0,i.h=t||0,i.y=n||0,i.x=0,i.c=r||[],i.cs=r.length,i.prelim=0,i.mod=0,i.shift=0,i.change=0,i.tl=null,i.tr=null,i.el=null,i.er=null,i.msel=0,i.mser=0}n.fromNode=function(e,t){if(!e)return null;var r=[];return e.children.forEach(function(e){r.push(n.fromNode(e,t))}),t?new n(e.height,e.width,e.x,r):new n(e.width,e.height,e.y,r)};function r(e,t,n){n?e.y+=t:e.x+=t,e.children.forEach(function(e){r(e,t,n)})}function i(e,t){var n=t?e.y:e.x;return e.children.forEach(function(e){n=Math.min(i(e,t),n)}),n}function a(e,t){var n=i(e,t);r(e,-n,t)}function o(e,t,n){n?t.y=e.x:t.x=e.x,e.c.forEach(function(e,r){o(e,t.children[r],n)})}function s(e,t,n){n===void 0&&(n=0),t?(e.x=n,n+=e.width):(e.y=n,n+=e.height),e.children.forEach(function(e){s(e,t,n)})}e.exports=function(e,t){t===void 0&&(t={});var r=t.isHorizontal;function i(e){if(e.cs===0){c(e);return}i(e.c[0]);for(var t=b(p(e.c[0].el),0,null),n=1;n<e.cs;++n){i(e.c[n]);var r=p(e.c[n].er);l(e,n,t),t=b(r,n,t)}g(e),c(e)}function c(e){e.cs===0?(e.el=e,e.er=e,e.msel=e.mser=0):(e.el=e.c[0].el,e.msel=e.c[0].msel,e.er=e.c[e.cs-1].er,e.mser=e.c[e.cs-1].mser)}function l(e,t,n){for(var r=e.c[t-1],i=r.mod,a=e.c[t],o=a.mod;r!==null&&a!==null;){p(r)>n.low&&(n=n.nxt);var s=i+r.prelim+r.w-(o+a.prelim);s>0&&(o+=s,u(e,t,n.index,s));var c=p(r),l=p(a);c<=l&&(r=f(r),r!==null&&(i+=r.mod)),c>=l&&(a=d(a),a!==null&&(o+=a.mod))}!r&&a?m(e,t,a,o):r&&!a&&h(e,t,r,i)}function u(e,t,n,r){e.c[t].mod+=r,e.c[t].msel+=r,e.c[t].mser+=r,v(e,t,n,r)}function d(e){return e.cs===0?e.tl:e.c[0]}function f(e){return e.cs===0?e.tr:e.c[e.cs-1]}function p(e){return e.y+e.h}function m(e,t,n,r){var i=e.c[0].el;i.tl=n;var a=r-n.mod-e.c[0].msel;i.mod+=a,i.prelim-=a,e.c[0].el=e.c[t].el,e.c[0].msel=e.c[t].msel}function h(e,t,n,r){var i=e.c[t].er;i.tr=n;var a=r-n.mod-e.c[t].mser;i.mod+=a,i.prelim-=a,e.c[t].er=e.c[t-1].er,e.c[t].mser=e.c[t-1].mser}function g(e){e.prelim=(e.c[0].prelim+e.c[0].mod+e.c[e.cs-1].mod+e.c[e.cs-1].prelim+e.c[e.cs-1].w)/2-e.w/2}function _(e,t){t+=e.mod,e.x=e.prelim+t,y(e);for(var n=0;n<e.cs;n++)_(e.c[n],t)}function v(e,t,n,r){if(n!==t-1){var i=t-n;e.c[n+1].shift+=r/i,e.c[t].shift-=r/i,e.c[t].change-=r-r/i}}function y(e){for(var t=0,n=0,r=0;r<e.cs;r++)t+=e.c[r].shift,n+=t+e.c[r].change,e.c[r].mod+=n}function b(e,t,n){for(;n!==null&&e>=n.low;)n=n.nxt;return{low:e,index:t,nxt:n}}s(e,r);var x=n.fromNode(e,r);return i(x),_(x,0),o(x,e,r),a(e,r),e}}),(function(e,t,n){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(1),o=n(9),s=n(2),c=n(0),l=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.execute=function(){var e=this;return e.rootNode.width=0,s(e.rootNode,e.options,o)},t}(a),u={};function d(e,t){return t=c.assign({},u,t),new l(e,t).execute()}e.exports=d}),(function(e,t,n){var r=n(0);function i(e,t){e===void 0&&(e=0),t===void 0&&(t=[]);var n=this;n.x=n.y=0,n.leftChild=n.rightChild=null,n.height=0,n.children=t}var a={isHorizontal:!0,nodeSep:20,nodeSize:20,rankSep:200,subTreeSep:10};function o(e,t,n){n?(t.x=e.x,t.y=e.y):(t.x=e.y,t.y=e.x),e.children.forEach(function(e,r){o(e,t.children[r],n)})}e.exports=function(e,t){t===void 0&&(t={}),t=r.assign({},a,t);var n=0;function s(e){if(!e)return null;e.width=0,e.depth&&e.depth>n&&(n=e.depth);var t=e.children,r=t.length,a=new i(e.height,[]);return t.forEach(function(e,t){var n=s(e);a.children.push(n),t===0&&(a.leftChild=n),t===r-1&&(a.rightChild=n)}),a.originNode=e,a.isLeaf=e.isLeaf(),a}function c(e){if(e.isLeaf||e.children.length===0)e.drawingDepth=n;else{var t=e.children.map(function(e){return c(e)});e.drawingDepth=Math.min.apply(null,t)-1}return e.drawingDepth}var l;function u(e){e.x=e.drawingDepth*t.rankSep,e.isLeaf?(e.y=0,l&&(e.y=l.y+l.height+t.nodeSep,e.originNode.parent!==l.originNode.parent&&(e.y+=t.subTreeSep)),l=e):(e.children.forEach(function(e){u(e)}),e.y=(e.leftChild.y+e.rightChild.y)/2)}var d=s(e);return c(d),u(d),o(d,e,t.isHorizontal),e}}),(function(e,t,n){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(1),o=n(11),s=n(4),c=n(0),l=[`LR`,`RL`,`H`],u=l[0],d=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.execute=function(){var e=this,t=e.options,n=e.rootNode;t.isHorizontal=!0;var r=t.indent,i=r===void 0?20:r,a=t.dropCap,c=a===void 0?!0:a,d=t.direction,f=d===void 0?u:d,p=t.align;if(f&&l.indexOf(f)===-1)throw TypeError(`Invalid direction: `+f);if(f===l[0])o(n,i,c,p);else if(f===l[1])o(n,i,c,p),n.right2left();else if(f===l[2]){var m=s(n,t),h=m.left,g=m.right;o(h,i,c,p),h.right2left(),o(g,i,c,p);var _=h.getBoundingBox();g.translate(_.width,0),n.x=g.x-n.width/2}return n},t}(a),f={};function p(e,t){return t=c.assign({},f,t),new d(e,t).execute()}e.exports=p}),(function(e,t,n){var r=n(0);function i(e,t,n,i,a){var o=(typeof n==`function`?n(e):n)*e.depth;if(!i)try{if(e.id===e.parent.children[0].id){e.x+=o,e.y=t?t.y:0;return}}catch{}if(e.x+=o,t){if(e.y=t.y+r.getHeight(t,e,a),t.parent&&e.parent.id!==t.parent.id){var s=t.parent,c=s.y+r.getHeight(s,e,a);e.y=c>e.y?c:e.y}}else e.y=0}e.exports=function(e,t,n,r){var a=null;e.eachNode(function(e){i(e,a,t,n,r),a=e})}}),(function(e,t,n){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(1),o=n(13),s=n(2),c=n(0),l=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.execute=function(){var e=this;return s(e.rootNode,e.options,o)},t}(a),u={};function d(e,t){return t=c.assign({},u,t),new l(e,t).execute()}e.exports=d}),(function(e,t,n){var r=n(0);function i(e,t){var n=0;return e.children.length?e.children.forEach(function(e){n+=i(e,t)}):n=e.height,e._subTreeSep=t.getSubTreeSep(e.data),e.totalHeight=Math.max(e.height,n)+2*e._subTreeSep,e.totalHeight}function a(e){var t=e.children,n=t.length;if(n){t.forEach(function(e){a(e)});var r=t[0],i=t[n-1],o=i.y-r.y+i.height,s=0;if(t.forEach(function(e){s+=e.totalHeight}),o>e.height)e.y=r.y+o/2-e.height/2;else if(t.length!==1||e.height>s){var c=e.y+(e.height-o)/2-r.y;t.forEach(function(e){e.translate(0,c)})}else e.y=(r.y+r.height/2+i.y+i.height/2)/2-e.height/2}}var o={getSubTreeSep:function(){return 0}};e.exports=function(e,t){t===void 0&&(t={}),t=r.assign({},o,t),e.parent={x:0,width:0,height:0,y:0},e.BFTraverse(function(e){e.x=e.parent.x+e.parent.width}),e.parent=null,i(e,t),e.startY=0,e.y=e.totalHeight/2-e.height/2,e.eachNode(function(e){var t=e.children,n=t.length;if(n){var r=t[0];if(r.startY=e.startY+e._subTreeSep,n===1)r.y=e.y+e.height/2-r.height/2;else{r.y=r.startY+r.totalHeight/2-r.height/2;for(var i=1;i<n;i++){var a=t[i];a.startY=t[i-1].startY+t[i-1].totalHeight,a.y=a.startY+a.totalHeight/2-a.height/2}}}}),a(e)}})])})})),Wk=(e,t)=>{if(e!==`next`&&e!==`prev`)return t},Gk=e=>{e.prev.next=e.next,e.next.prev=e.prev,delete e.next,delete e.prev},Kk=class{constructor(){let e={};e.prev=e,e.next=e.prev,this.shortcut=e}dequeue(){let e=this.shortcut,t=e.prev;if(t&&t!==e)return Gk(t),t}enqueue(e){let t=this.shortcut;e.prev&&e.next&&Gk(e),e.next=t.next,t.next.prev=e,t.next=e,e.prev=t}toString(){let e=[],t=this.shortcut,n=t.prev;for(;n!==t;)e.push(JSON.stringify(n,Wk)),n=n?.prev;return`[${e.join(`, `)}]`}},qk=class extends Kk{},Jk=()=>1;const Yk=(e,t)=>{if(e.getAllNodes().length<=1)return[];let n=Qk(e,t||Jk);return Xk(n.graph,n.buckets,n.zeroIdx).map(t=>e.getRelatedEdges(t.v,`out`).filter(({target:e})=>e===t.w))?.flat()};var Xk=(e,t,n)=>{let r=[],i=t[t.length-1],a=t[0],o;for(;e.getAllNodes().length;){for(;o=a.dequeue();)Zk(e,t,n,o);for(;o=i.dequeue();)Zk(e,t,n,o);if(e.getAllNodes().length){for(let i=t.length-2;i>0;--i)if(o=t[i].dequeue(),o){r=r.concat(Zk(e,t,n,o,!0));break}}}return r},Zk=(e,t,n,r,i)=>{var a,o;let s=[];return e.hasNode(r.v)&&((a=e.getRelatedEdges(r.v,`in`))==null||a.forEach(r=>{let a=r.data.weight,o=e.getNode(r.source);i&&s.push({v:r.source,w:r.target,in:0,out:0}),o.data.out===void 0&&(o.data.out=0),o.data.out-=a,$k(t,n,Object.assign({v:o.id},o.data))}),(o=e.getRelatedEdges(r.v,`out`))==null||o.forEach(r=>{let i=r.data.weight,a=r.target,o=e.getNode(a);o.data.in===void 0&&(o.data.in=0),o.data.in-=i,$k(t,n,Object.assign({v:o.id},o.data))}),e.removeNode(r.v)),i?s:void 0},Qk=(e,t)=>{let n=new bk,r=0,i=0;e.getAllNodes().forEach(e=>{n.addNode({id:e.id,data:{v:e.id,in:0,out:0}})}),e.getAllEdges().forEach(e=>{let a=n.getRelatedEdges(e.source,`out`).find(t=>t.target===e.target),o=t?.(e)||1;a?n.updateEdgeData(a?.id,Object.assign(Object.assign({},a.data),{weight:a.data.weight+o})):n.addEdge({id:e.id,source:e.source,target:e.target,data:{weight:o}}),i=Math.max(i,n.getNode(e.source).data.out+=o),r=Math.max(r,n.getNode(e.target).data.in+=o)});let a=[],o=i+r+3;for(let e=0;e<o;e++)a.push(new qk);let s=r+1;return n.getAllNodes().forEach(e=>{$k(a,s,Object.assign({v:e.id},n.getNode(e.id).data))}),{buckets:a,zeroIdx:s,graph:n}},$k=(e,t,n)=>{n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)},eA=(e,t)=>{(t===`greedy`?Yk(e,(e=>e=>e.data.weight||1)(e)):tA(e))?.forEach(t=>{let n=t.data;e.removeEdge(t.id),n.forwardName=t.data.name,n.reversed=!0,e.addEdge({id:t.id,source:t.target,target:t.source,data:Object.assign({},n)})})},tA=e=>{let t=[],n={},r={},i=a=>{r[a]||(r[a]=!0,n[a]=!0,e.getRelatedEdges(a,`out`).forEach(e=>{n[e.target]?t.push(e):i(e.target)}),delete n[a])};return e.getAllNodes().forEach(e=>i(e.id)),t},nA=e=>{e.getAllEdges().forEach(t=>{let n=t.data;if(n.reversed){e.removeEdge(t.id);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.addEdge({id:t.id,source:t.target,target:t.source,data:Object.assign(Object.assign({},n),{forwardName:r})})}})},rA=(e,t)=>Number(e)-Number(t);const iA=(e,t,n,r)=>{let i;do i=`${r}${Math.random()}`;while(e.hasNode(i));return n.dummy=t,e.addNode({id:i,data:n}),i},aA=e=>{let t=new bk;return e.getAllNodes().forEach(e=>{t.addNode(Object.assign({},e))}),e.getAllEdges().forEach(e=>{let n=t.getRelatedEdges(e.source,`out`).find(t=>t.target===e.target);n?t.updateEdgeData(n?.id,Object.assign(Object.assign({},n.data),{weight:n.data.weight+e.data.weight||0,minlen:Math.max(n.data.minlen,e.data.minlen||1)})):t.addEdge({id:e.id,source:e.source,target:e.target,data:{weight:e.data.weight||0,minlen:e.data.minlen||1}})}),t},oA=e=>{let t=new bk;return e.getAllNodes().forEach(n=>{e.getChildren(n.id).length||t.addNode(Object.assign({},n))}),e.getAllEdges().forEach(e=>{t.addEdge(e)}),t},sA=(e,t)=>e?.reduce((e,n,r)=>(e[n]=t[r],e),{}),cA=(e,t)=>{let n=Number(e.x),r=Number(e.y),i=Number(t.x)-n,a=Number(t.y)-r,o=Number(e.width)/2,s=Number(e.height)/2;if(!i&&!a)return{x:0,y:0};let c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,l=s):(i<0&&(o=-o),c=o,l=o*a/i),{x:n+c,y:r+l}},lA=e=>{let t=[],n=pA(e)+1;for(let e=0;e<n;e++)t.push([]);e.getAllNodes().forEach(e=>{let n=e.data.rank;n!==void 0&&t[n]&&t[n].push(e.id)});for(let r=0;r<n;r++)t[r]=t[r].sort((t,n)=>rA(e.getNode(t).data.order,e.getNode(n).data.order));return t},uA=e=>{let t=e.getAllNodes().filter(e=>e.data.rank!==void 0).map(e=>e.data.rank),n=Math.min(...t);e.getAllNodes().forEach(e=>{e.data.hasOwnProperty(`rank`)&&n!==1/0&&(e.data.rank-=n)})},dA=(e,t=0)=>{let n=e.getAllNodes(),r=n.filter(e=>e.data.rank!==void 0).map(e=>e.data.rank),i=Math.min(...r),a=[];n.forEach(e=>{let t=(e.data.rank||0)-i;a[t]||(a[t]=[]),a[t].push(e.id)});let o=0;for(let n=0;n<a.length;n++){let r=a[n];r===void 0?n%t!==0&&--o:o&&r?.forEach(t=>{let n=e.getNode(t);n&&(n.data.rank=n.data.rank||0,n.data.rank+=o)})}},fA=(e,t,n,r)=>{let i={width:0,height:0};return G(n)&&G(r)&&(i.rank=n,i.order=r),iA(e,`border`,i,t)},pA=e=>{let t;return e.getAllNodes().forEach(e=>{let n=e.data.rank;n!==void 0&&(t===void 0||n>t)&&(t=n)}),t||=0,t},mA=(e,t)=>{let n={lhs:[],rhs:[]};return e?.forEach(e=>{t(e)?n.lhs.push(e):n.rhs.push(e)}),n},hA=(e,t)=>e.reduce((e,n)=>{let r=t(e),i=t(n);return r>i?n:e});var gA=(e,t,n,r,i,a)=>{r.includes(t.id)||(r.push(t.id),n||a.push(t.id),i(t.id).forEach(t=>gA(e,t,n,r,i,a)),n&&a.push(t.id))};const _A=(e,t,n,r)=>{let i=Array.isArray(t)?t:[t],a=t=>r?e.getSuccessors(t):e.getNeighbors(t),o=[],s=[];return i.forEach(t=>{if(e.hasNode(t.id))gA(e,t,n===`post`,s,a,o);else throw Error(`Graph does not have node: ${t}`)}),o},vA=e=>{let t=n=>{let r=e.getChildren(n),i=e.getNode(n);if(r?.length&&r.forEach(e=>t(e.id)),i.data.hasOwnProperty(`minRank`)){i.data.borderLeft=[],i.data.borderRight=[];for(let t=i.data.minRank,r=i.data.maxRank+1;t<r;t+=1)yA(e,`borderLeft`,`_bl`,n,i,t),yA(e,`borderRight`,`_br`,n,i,t)}};e.getRoots().forEach(e=>t(e.id))};var yA=(e,t,n,r,i,a)=>{let o={rank:a,borderType:t,width:0,height:0},s=i.data[t][a-1],c=iA(e,`border`,o,n);i.data[t][a]=c,e.setParent(c,r),s&&e.addEdge({id:`e${Math.random()}`,source:s,target:c,data:{weight:1}})},bA=(e,t)=>{let n=t.toLowerCase();(n===`lr`||n===`rl`)&&SA(e)},xA=(e,t)=>{let n=t.toLowerCase();(n===`bt`||n===`rl`)&&wA(e),(n===`lr`||n===`rl`)&&(EA(e),SA(e))},SA=e=>{e.getAllNodes().forEach(e=>{CA(e)}),e.getAllEdges().forEach(e=>{CA(e)})},CA=e=>{let t=e.data.width;e.data.width=e.data.height,e.data.height=t},wA=e=>{e.getAllNodes().forEach(e=>{TA(e.data)}),e.getAllEdges().forEach(e=>{var t;(t=e.data.points)==null||t.forEach(e=>TA(e)),e.data.hasOwnProperty(`y`)&&TA(e.data)})},TA=e=>{e?.y&&(e.y=-e.y)},EA=e=>{e.getAllNodes().forEach(e=>{DA(e.data)}),e.getAllEdges().forEach(e=>{var t;(t=e.data.points)==null||t.forEach(e=>DA(e)),e.data.hasOwnProperty(`x`)&&DA(e.data)})},DA=e=>{let t=e.x;e.x=e.y,e.y=t},OA=e=>{let t=iA(e,`root`,{},`_root`),n=AA(e),r=Math.max(...Object.values(n));Math.abs(r)===1/0&&(r=1);let i=r-1,a=2*i+1;e.getAllEdges().forEach(e=>{e.data.minlen*=a});let o=jA(e)+1;return e.getRoots().forEach(r=>{kA(e,t,a,o,i,n,r.id)}),{nestingRoot:t,nodeRankFactor:a}},kA=(e,t,n,r,i,a,o)=>{let s=e.getChildren(o);if(!s?.length){o!==t&&e.addEdge({id:`e${Math.random()}`,source:t,target:o,data:{weight:0,minlen:n}});return}let c=fA(e,`_bt`),l=fA(e,`_bb`),u=e.getNode(o);e.setParent(c,o),u.data.borderTop=c,e.setParent(l,o),u.data.borderBottom=l,s?.forEach(s=>{kA(e,t,n,r,i,a,s.id);let u=s.data.borderTop?s.data.borderTop:s.id,d=s.data.borderBottom?s.data.borderBottom:s.id,f=s.data.borderTop?r:2*r,p=u===d?i-a[o]+1:1;e.addEdge({id:`e${Math.random()}`,source:c,target:u,data:{minlen:p,weight:f,nestingEdge:!0}}),e.addEdge({id:`e${Math.random()}`,source:d,target:l,data:{minlen:p,weight:f,nestingEdge:!0}})}),e.getParent(o)||e.addEdge({id:`e${Math.random()}`,source:t,target:c,data:{weight:0,minlen:i+a[o]}})},AA=e=>{let t={},n=(r,i)=>{e.getChildren(r)?.forEach(e=>n(e.id,i+1)),t[r]=i};return e.getRoots().forEach(e=>n(e.id,1)),t},jA=e=>{let t=0;return e.getAllEdges().forEach(e=>{t+=e.data.weight}),t},MA=(e,t)=>{t&&e.removeNode(t),e.getAllEdges().forEach(t=>{t.data.nestingEdge&&e.removeEdge(t.id)})},NA=`edge`,PA=`edge-label`,FA=(e,t)=>{e.getAllEdges().forEach(n=>IA(e,n,t))},IA=(e,t,n)=>{let r=t.source,i=e.getNode(r).data.rank,a=t.target,o=e.getNode(a).data.rank,s=t.data.labelRank;if(o===i+1)return;e.removeEdge(t.id);let c,l,u;for(u=0,++i;i<o;++u,++i)t.data.points=[],l={originalEdge:t,width:0,height:0,rank:i},c=iA(e,NA,l,`_d`),i===s&&(l.width=t.data.width,l.height=t.data.height,l.dummy=PA,l.labelpos=t.data.labelpos),e.addEdge({id:`e${Math.random()}`,source:r,target:c,data:{weight:t.data.weight}}),u===0&&n.push(c),r=c;e.addEdge({id:`e${Math.random()}`,source:r,target:a,data:{weight:t.data.weight}})},LA=(e,t)=>{t.forEach(t=>{let n=e.getNode(t),{data:r}=n,i=r.originalEdge,a;i&&e.addEdge(i);let o=t;for(;n.data.dummy;)a=e.getSuccessors(o)[0],e.removeNode(o),i.data.points.push({x:n.data.x,y:n.data.y}),n.data.dummy===PA&&(i.data.x=n.data.x,i.data.y=n.data.y,i.data.width=n.data.width,i.data.height=n.data.height),o=a.id,n=e.getNode(o)})};const RA=(e,t,n)=>{let r={},i;n?.forEach(n=>{let a=e.getParent(n),o,s;for(;a;){if(o=e.getParent(a.id),o?(s=r[o.id],r[o.id]=a.id):(s=i,i=a.id),s&&s!==a.id){t.hasNode(s)||t.addNode({id:s,data:{}}),t.hasNode(a.id)||t.addNode({id:a.id,data:{}}),t.hasEdge(`e${s}-${a.id}`)||t.addEdge({id:`e${s}-${a.id}`,source:s,target:a.id,data:{}});return}a=o}})},zA=(e,t,n)=>{let r=BA(e),i=new bk({tree:[{id:r,children:[],data:{}}]});return e.getAllNodes().forEach(a=>{let o=e.getParent(a.id);(a.data.rank===t||a.data.minRank<=t&&t<=a.data.maxRank)&&(i.hasNode(a.id)||i.addNode(Object.assign({},a)),o?.id&&!i.hasNode(o?.id)&&i.addNode(Object.assign({},o)),i.setParent(a.id,o?.id||r),e.getRelatedEdges(a.id,n).forEach(t=>{let n=t.source===a.id?t.target:t.source;i.hasNode(n)||i.addNode(Object.assign({},e.getNode(n)));let r=i.getRelatedEdges(n,`out`).find(({target:e})=>e===a.id),o=r===void 0?0:r.data.weight;r?i.updateEdgeData(r.id,Object.assign(Object.assign({},r.data),{weight:t.data.weight+o})):i.addEdge({id:t.id,source:n,target:a.id,data:{weight:t.data.weight+o}})}),a.data.hasOwnProperty(`minRank`)&&i.updateNodeData(a.id,Object.assign(Object.assign({},a.data),{borderLeft:a.data.borderLeft[t],borderRight:a.data.borderRight[t]})))}),i};var BA=e=>{let t;for(;e.hasNode(t=`_root${Math.random()}`););return t},VA=(e,t,n)=>{let r=sA(n,n.map((e,t)=>t)),i=t.map(t=>e.getRelatedEdges(t,`out`).map(e=>({pos:r[e.target]||0,weight:e.data.weight}))?.sort((e,t)=>e.pos-t.pos)).flat().filter(e=>e!==void 0),a=1;for(;a<n.length;)a<<=1;let o=2*a-1;--a;let s=Array(o).fill(0,0,o),c=0;return i?.forEach(e=>{if(e){let t=e.pos+a;s[t]+=e.weight;let n=0;for(;t>0;)t%2&&(n+=s[t+1]),t=t-1>>1,s[t]+=e.weight;c+=e.weight*n}}),c};const HA=(e,t)=>{let n=0;for(let r=1;r<t?.length;r+=1)n+=VA(e,t[r-1],t[r]);return n},UA=e=>{let t={},n=e.getAllNodes(),r=n.map(e=>e.data.rank??-1/0),i=Math.max(...r),a=[];for(let e=0;e<i+1;e++)a.push([]);let o=n.sort((t,n)=>e.getNode(t.id).data.rank-e.getNode(n.id).data.rank);return o.filter(t=>e.getNode(t.id).data.fixorder!==void 0).sort((t,n)=>e.getNode(t.id).data.fixorder-e.getNode(n.id).data.fixorder)?.forEach(n=>{isNaN(e.getNode(n.id).data.rank)||a[e.getNode(n.id).data.rank].push(n.id),t[n.id]=!0}),o?.forEach(n=>e.dfsTree(n.id,e=>{if(t.hasOwnProperty(e.id))return!0;t[e.id]=!0,isNaN(e.data.rank)||a[e.data.rank].push(e.id)})),a},WA=(e,t)=>t.map(t=>{let n=e.getRelatedEdges(t,`in`);if(!n?.length)return{v:t};let r={sum:0,weight:0};return n?.forEach(t=>{let n=e.getNode(t.source);r.sum+=t.data.weight*n.data.order,r.weight+=t.data.weight}),{v:t,barycenter:r.sum/r.weight,weight:r.weight}});var GA=(e,t)=>{var n,r;let i={};e?.forEach((e,t)=>{i[e.v]={i:t,indegree:0,in:[],out:[],vs:[e.v]};let n=i[e.v];e.barycenter!==void 0&&(n.barycenter=e.barycenter,n.weight=e.weight)}),(n=t.getAllEdges())==null||n.forEach(e=>{let t=i[e.source],n=i[e.target];t!==void 0&&n!==void 0&&(n.indegree++,t.out.push(i[e.target]))});let a=(r=Object.values(i)).filter?.call(r,e=>!e.indegree);return KA(a)},KA=e=>{var t,n;let r=[],i=e=>t=>{t.merged||(t.barycenter===void 0||e.barycenter===void 0||t.barycenter>=e.barycenter)&&qA(e,t)},a=t=>n=>{n.in.push(t),--n.indegree===0&&e.push(n)};for(;e?.length;){let o=e.pop();r.push(o),(t=o.in.reverse())==null||t.forEach(e=>i(o)(e)),(n=o.out)==null||n.forEach(e=>a(o)(e))}let o=r.filter(e=>!e.merged),s=[`vs`,`i`,`barycenter`,`weight`];return o.map(e=>{let t={};return s?.forEach(n=>{e[n]!==void 0&&(t[n]=e[n])}),t})},qA=(e,t)=>{let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs?.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0},JA=GA;const YA=(e,t,n,r)=>{let i=mA(e,e=>{let t=e.hasOwnProperty(`fixorder`)&&!isNaN(e.fixorder);return r?!t&&e.hasOwnProperty(`barycenter`):t||e.hasOwnProperty(`barycenter`)}),a=i.lhs,o=i.rhs.sort((e,t)=>-e.i- -t.i),s=[],c=0,l=0,u=0;a?.sort(ZA(!!t,!!n)),u=XA(s,o,u),a?.forEach(e=>{u+=e.vs?.length,s.push(e.vs),c+=e.barycenter*e.weight,l+=e.weight,u=XA(s,o,u)});let d={vs:s.flat()};return l&&(d.barycenter=c/l,d.weight=l),d};var XA=(e,t,n)=>{let r=n,i;for(;t.length&&(i=t[t.length-1]).i<=r;)t.pop(),e?.push(i.vs),r++;return r},ZA=(e,t)=>(n,r)=>{if(n.fixorder!==void 0&&r.fixorder!==void 0)return n.fixorder-r.fixorder;if(n.barycenter<r.barycenter)return-1;if(n.barycenter>r.barycenter)return 1;if(t&&n.order!==void 0&&r.order!==void 0){if(n.order<r.order)return-1;if(n.order>r.order)return 1}return e?r.i-n.i:n.i-r.i};const QA=(e,t,n,r,i,a)=>{var o;let s=e.getChildren(t).map(e=>e.id),c=e.getNode(t),l=c?c.data.borderLeft:void 0,u=c?c.data.borderRight:void 0,d={};l&&(s=s?.filter(e=>e!==l&&e!==u));let f=WA(e,s||[]);f?.forEach(t=>{if(e.getChildren(t.v)?.length){let i=QA(e,t.v,n,r,a);d[t.v]=i,i.hasOwnProperty(`barycenter`)&&ej(t,i)}});let p=JA(f,n);$A(p,d),(o=p.filter(e=>e.vs.length>0))==null||o.forEach(t=>{let n=e.getNode(t.vs[0]);n&&(t.fixorder=n.data.fixorder,t.order=n.data.order)});let m=YA(p,r,i,a);if(l&&(m.vs=[l,m.vs,u].flat(),e.getPredecessors(l)?.length)){let t=e.getNode(e.getPredecessors(l)?.[0].id||``),n=e.getNode(e.getPredecessors(u)?.[0].id||``);m.hasOwnProperty(`barycenter`)||(m.barycenter=0,m.weight=0),m.barycenter=(m.barycenter*m.weight+t.data.order+n.data.order)/(m.weight+2),m.weight+=2}return m};var $A=(e,t)=>{e?.forEach(e=>{e.vs=(e.vs?.map(e=>t[e]?t[e].vs:e)).flat()})},ej=(e,t)=>{e.barycenter===void 0?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)};const tj=(e,t)=>{let n=pA(e),r=[],i=[];for(let e=1;e<n+1;e++)r.push(e);for(let e=n-1;e>-1;e--)i.push(e);let a=nj(e,r,`in`),o=nj(e,i,`out`),s=UA(e);ij(e,s);let c=1/0,l;for(let n=0,r=0;r<4;++n,++r){rj(n%2?a:o,n%4>=2,!1,t),s=lA(e);let i=HA(e,s);i<c&&(r=0,l=ju(s),c=i)}s=UA(e),ij(e,s);for(let n=0,r=0;r<4;++n,++r){rj(n%2?a:o,n%4>=2,!0,t),s=lA(e);let i=HA(e,s);i<c&&(r=0,l=ju(s),c=i)}ij(e,l)};var nj=(e,t,n)=>t.map(t=>zA(e,t,n)),rj=(e,t,n,r)=>{let i=new bk;e?.forEach(e=>{let a=e.getRoots()[0].id,o=QA(e,a,i,t,n,r);for(let t=0;t<o.vs?.length;t++){let n=e.getNode(o.vs[t]);n&&(n.data.order=t)}RA(e,i,o.vs)})},ij=(e,t)=>{t?.forEach(t=>{t?.forEach((t,n)=>{e.getNode(t).data.order=n})})};const aj=(e,t)=>{let n=e.getAllNodes().filter(t=>!e.getChildren(t.id)?.length).map(e=>e.data.rank),r=Math.max(...n),i=[];for(let e=0;e<r+1;e++)i[e]=[];t?.forEach(t=>{let n=e.getNode(t);!n||n.data.dummy||isNaN(n.data.rank)||(n.data.fixorder=i[n.data.rank].length,i[n.data.rank].push(t))})};var oj=e=>{let t={},n=0,r=i=>{let a=n;e.getChildren(i).forEach(e=>r(e.id)),t[i]={low:a,lim:n++}};return e.getRoots().forEach(e=>r(e.id)),t},sj=(e,t,n,r)=>{let i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.getParent(c)?.id,i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(l=c,c=r;c&&c!==l;)a.push(c),c=e.getParent(c)?.id;return{lca:l,path:i.concat(a.reverse())}};const cj=(e,t)=>{let n=oj(e);t.forEach(t=>{let r=t,i=e.getNode(r),a=i.data.originalEdge;if(!a)return;let o=sj(e,n,a.source,a.target),s=o.path,c=o.lca,l=0,u=s[l],d=!0;for(;r!==a.target;){if(i=e.getNode(r),d){for(;u!==c&&e.getNode(u)?.data.maxRank<i.data.rank;)l++,u=s[l];u===c&&(d=!1)}if(!d){for(;l<s.length-1&&e.getNode(s[l+1])?.data.minRank<=i.data.rank;)l++;u=s[l]}e.hasNode(u)&&e.setParent(r,u),r=e.getSuccessors(r)[0].id}})},lj=(e,t)=>{let n={};return t?.length&&t.reduce((t,r)=>{let i=0,a=0,o=t.length,s=r?.[r?.length-1];return r?.forEach((t,c)=>{var l;let u=dj(e,t),d=u?e.getNode(u.id).data.order:o;(u||t===s)&&((l=r.slice(a,c+1))==null||l.forEach(t=>{var r;(r=e.getPredecessors(t))==null||r.forEach(r=>{let a=e.getNode(r.id),o=a.data.order;(o<i||d<o)&&!(a.data.dummy&&e.getNode(t)?.data.dummy)&&fj(n,r.id,t)})}),a=c+1,i=d)}),r}),n},uj=(e,t)=>{let n={};function r(t,r,i,a,o){var s;let c;for(let l=r;l<i;l++)c=t[l],e.getNode(c)?.data.dummy&&((s=e.getPredecessors(c))==null||s.forEach(t=>{let r=e.getNode(t.id);r.data.dummy&&(r.data.order<a||r.data.order>o)&&fj(n,t.id,c)}))}function i(e){return JSON.stringify(e.slice(1))}function a(e,t){let n=i(e);t.get(n)||(r(...e),t.set(n,!0))}return t?.length&&t.reduce((t,n)=>{let r=-1,i,o=0,s=new Map;return n?.forEach((c,l)=>{if(e.getNode(c)?.data.dummy===`border`){let t=e.getPredecessors(c)||[];t.length&&(i=e.getNode(t[0].id).data.order,a([n,o,l,r,i],s),o=l,r=i)}a([n,o,n.length,i,t.length],s)}),n}),n},dj=(e,t)=>{if(e.getNode(t)?.data.dummy)return e.getPredecessors(t)?.find(t=>e.getNode(t.id).data.dummy)},fj=(e,t,n)=>{let r=t,i=n;if(r>i){let e=r;r=i,i=e}let a=e[r];a||(e[r]=a={}),a[i]=!0},pj=(e,t,n)=>{let r=t,i=n;if(r>i){let e=t;r=i,i=e}return!!e[r]},mj=(e,t,n,r)=>{let i={},a={},o={};return t?.forEach(e=>{e?.forEach((e,t)=>{i[e]=e,a[e]=e,o[e]=t})}),t?.forEach(e=>{let t=-1;e?.forEach(e=>{let s=r(e).map(e=>e.id);if(s.length){s=s.sort((e,t)=>o[e]-o[t]);let r=(s.length-1)/2;for(let c=Math.floor(r),l=Math.ceil(r);c<=l;++c){let r=s[c];a[e]===e&&t<o[r]&&!pj(n,e,r)&&(a[r]=e,a[e]=i[e]=i[r],t=o[r])}}})}),{root:i,align:a}},hj=(e,t,n,r,i,a,o)=>{var s;let c={},l=gj(e,t,n,i,a,o),u=o?`borderLeft`:`borderRight`,d=(e,t)=>{let n=l.getAllNodes(),r=n.pop(),i={};for(;r;)i[r.id]?e(r.id):(i[r.id]=!0,n.push(r),n=n.concat(t(r.id))),r=n.pop()};return d(e=>{c[e]=(l.getRelatedEdges(e,`in`)||[]).reduce((e,t)=>Math.max(e,(c[t.source]||0)+t.data.weight),0)},l.getPredecessors.bind(l)),d(t=>{let n=(l.getRelatedEdges(t,`out`)||[]).reduce((e,t)=>Math.min(e,(c[t.target]||0)-t.data.weight),1/0),r=e.getNode(t);n!==1/0&&r.data.borderType!==u&&(c[t]=Math.max(c[t],n))},l.getSuccessors.bind(l)),(s=Object.values(r))==null||s.forEach(e=>{c[e]=c[n[e]]}),c},gj=(e,t,n,r,i,a)=>{let o=new bk,s=bj(r,i,a);return t?.forEach(t=>{let r;t?.forEach(t=>{let i=n[t];if(o.hasNode(i)||o.addNode({id:i,data:{}}),r){let a=n[r],c=o.getRelatedEdges(a,`out`).find(e=>e.target===i);c?o.updateEdgeData(c.id,Object.assign(Object.assign({},c.data),{weight:Math.max(s(e,t,r),c.data.weight||0)})):o.addEdge({id:`e${Math.random()}`,source:a,target:i,data:{weight:Math.max(s(e,t,r),0)}})}r=t})}),o},_j=(e,t)=>hA(Object.values(t),t=>{var n;let r=-1/0,i=1/0;return(n=Object.keys(t))==null||n.forEach(n=>{let a=t[n],o=xj(e,n)/2;r=Math.max(a+o,r),i=Math.min(a-o,i)}),r-i});function vj(e,t){let n=Object.values(t),r=Math.min(...n),i=Math.max(...n);[`u`,`d`].forEach(n=>{[`l`,`r`].forEach(a=>{let o=n+a,s=e[o],c;if(s===t)return;let l=Object.values(s);c=a===`l`?r-Math.min(...l):i-Math.max(...l),c&&(e[o]={},Object.keys(s).forEach(t=>{e[o][t]=s[t]+c}))})})}const yj=(e,t)=>{let n={};return Object.keys(e.ul).forEach(r=>{if(t)n[r]=e[t.toLowerCase()][r];else{let t=Object.values(e).map(e=>e[r]);n[r]=(t[0]+t[1])/2}}),n},bj=(e,t,n)=>(r,i,a)=>{let o=r.getNode(i),s=r.getNode(a),c=0,l=0;if(c+=o.data.width/2,o.data.hasOwnProperty(`labelpos`))switch((o.data.labelpos||``).toLowerCase()){case`l`:l=-o.data.width/2;break;case`r`:l=o.data.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(o.data.dummy?t:e)/2,c+=(s.data.dummy?t:e)/2,c+=s.data.width/2,s.data.labelpos)switch((s.data.labelpos||``).toLowerCase()){case`l`:l=s.data.width/2;break;case`r`:l=-s.data.width/2;break}return l&&(c+=n?l:-l),l=0,c},xj=(e,t)=>e.getNode(t).data.width||0;var Sj=(e,t)=>{let{ranksep:n=0}=t||{},r=lA(e),i=0;r?.forEach(t=>{let r=t.map(t=>e.getNode(t).data.height),a=Math.max(...r,0);t?.forEach(t=>{e.getNode(t).data.y=i+a/2}),i+=a+n})},Cj=(e,t)=>{let{align:n,nodesep:r=0,edgesep:i=0}=t||{},a=lA(e),o=Object.assign(lj(e,a),uj(e,a)),s={},c=[];[`u`,`d`].forEach(t=>{c=t===`u`?a:Object.values(a).reverse(),[`l`,`r`].forEach(n=>{n===`r`&&(c=c.map(e=>Object.values(e).reverse()));let a=(t===`u`?e.getPredecessors:e.getSuccessors).bind(e),l=mj(e,c,o,a),u=hj(e,c,l.root,l.align,r,i,n===`r`);n===`r`&&Object.keys(u).forEach(e=>u[e]=-u[e]),s[t+n]=u})});let l=_j(e,s);return l&&vj(s,l),yj(s,n)};const wj=(e,t)=>{var n;let r=oA(e);Sj(r,t);let i=Cj(r,t);(n=Object.keys(i))==null||n.forEach(e=>{r.getNode(e).data.x=i[e]})};var Tj=e=>{let t={},n=r=>{var i;let a=e.getNode(r);if(!a)return 0;if(t[r])return a.data.rank;t[r]=!0;let o;return(i=e.getRelatedEdges(r,`out`))==null||i.forEach(e=>{let t=n(e.target),r=e.data.minlen,i=t-r;i&&(o===void 0||i<o)&&(o=i)}),o||=0,a.data.rank=o,o};e.getAllNodes().filter(t=>e.getRelatedEdges(t.id,`in`).length===0).forEach(e=>n(e.id))},Ej=e=>{let t={},n,r=i=>{var a;let o=e.getNode(i);if(!o)return 0;if(t[i])return o.data.rank;t[i]=!0;let s;return(a=e.getRelatedEdges(i,`out`))==null||a.forEach(e=>{let t=r(e.target),n=e.data.minlen,i=t-n;i&&(s===void 0||i<s)&&(s=i)}),s||=0,(n===void 0||s<n)&&(n=s),o.data.rank=s,s};e.getAllNodes().filter(t=>e.getRelatedEdges(t.id,`in`).length===0).forEach(e=>{e&&r(e.id)}),n===void 0&&(n=0);let i={},a=(t,n)=>{var r;let o=e.getNode(t),s=isNaN(o.data.layer)?n:o.data.layer;(o.data.rank===void 0||o.data.rank<s)&&(o.data.rank=s),!i[t]&&(i[t]=!0,(r=e.getRelatedEdges(t,`out`))==null||r.forEach(e=>{a(e.target,s+e.data.minlen)}))};e.getAllNodes().forEach(e=>{let t=e.data;t&&(isNaN(t.layer)?t.rank-=n:a(e.id,t.layer))})},Dj=(e,t)=>e.getNode(t.target).data.rank-e.getNode(t.source).data.rank-t.data.minlen,Oj=e=>{let t=new bk({tree:[]}),n=e.getAllNodes()[0],r=e.getAllNodes().length;t.addNode(n);let i,a;for(;kj(t,e)<r;)i=Mj(t,e),a=t.hasNode(i.source)?Dj(e,i):-Dj(e,i),Nj(t,e,a);return t},kj=(e,t)=>{let n=r=>{t.getRelatedEdges(r,`both`).forEach(i=>{let a=i.source,o=r===a?i.target:a;!e.hasNode(o)&&!Dj(t,i)&&(e.addNode({id:o,data:{}}),e.addEdge({id:i.id,source:r,target:o,data:{}}),n(o))})};return e.getAllNodes().forEach(e=>n(e.id)),e.getAllNodes().length},Aj=e=>{let t=new bk({tree:[]}),n=e.getAllNodes()[0],r=e.getAllNodes().length;t.addNode(n);let i,a;for(;jj(t,e)<r;)i=Mj(t,e),a=t.hasNode(i.source)?Dj(e,i):-Dj(e,i),Nj(t,e,a);return t},jj=(e,t)=>{let n=r=>{var i;(i=t.getRelatedEdges(r,`both`))==null||i.forEach(i=>{let a=i.source,o=r===a?i.target:a;!e.hasNode(o)&&(t.getNode(o).data.layer!==void 0||!Dj(t,i))&&(e.addNode({id:o,data:{}}),e.addEdge({id:i.id,source:r,target:o,data:{}}),n(o))})};return e.getAllNodes().forEach(e=>n(e.id)),e.getAllNodes().length},Mj=(e,t)=>hA(t.getAllEdges(),n=>e.hasNode(n.source)===e.hasNode(n.target)?1/0:Dj(t,n)),Nj=(e,t,n)=>{e.getAllNodes().forEach(e=>{let r=t.getNode(e.id);r.data.rank||(r.data.rank=0),r.data.rank+=n})};const Pj=e=>{let t=aA(e);Tj(t);let n=Oj(t);Rj(n),Fj(n,t);let r,i;for(;r=Bj(n);)i=Vj(n,t,r),Hj(n,t,r,i)},Fj=(e,t)=>{let n=_A(e,e.getAllNodes(),`post`,!1);n=n.slice(0,n?.length-1),n.forEach(n=>{Ij(e,t,n)})};var Ij=(e,t,n)=>{let r=e.getNode(n).data.parent,i=e.getRelatedEdges(n,`both`).find(e=>e.target===r||e.source===r);i.data.cutvalue=Lj(e,t,n)};const Lj=(e,t,n)=>{let r=e.getNode(n).data.parent,i=!0,a=t.getRelatedEdges(n,`out`).find(e=>e.target===r),o=0;return a||=(i=!1,t.getRelatedEdges(r,`out`).find(e=>e.target===n)),o=a.data.weight,t.getRelatedEdges(n,`both`).forEach(t=>{let a=t.source===n,s=a?t.target:t.source;if(s!==r){let r=a===i,c=t.data.weight;if(o+=r?c:-c,Wj(e,n,s)){let t=e.getRelatedEdges(n,`both`).find(e=>e.source===s||e.target===s).data.cutvalue;o+=r?-t:t}}}),o},Rj=(e,t=e.getAllNodes()[0].id)=>{zj(e,{},1,t)};var zj=(e,t,n,r,i)=>{var a;let o=n,s=n,c=e.getNode(r);return t[r]=!0,(a=e.getNeighbors(r))==null||a.forEach(n=>{t[n.id]||(s=zj(e,t,s,n.id,r))}),c.data.low=o,c.data.lim=s++,i?c.data.parent=i:delete c.data.parent,s};const Bj=e=>e.getAllEdges().find(e=>e.data.cutvalue<0),Vj=(e,t,n)=>{let r=n.source,i=n.target;t.getRelatedEdges(r,`out`).find(e=>e.target===i)||(r=n.target,i=n.source);let a=e.getNode(r),o=e.getNode(i),s=a,c=!1;a.data.lim>o.data.lim&&(s=o,c=!0);let l=t.getAllEdges().filter(t=>c===Gj(e.getNode(t.source),s)&&c!==Gj(e.getNode(t.target),s));return hA(l,e=>Dj(t,e))},Hj=(e,t,n,r)=>{let i=e.getRelatedEdges(n.source,`both`).find(e=>e.source===n.target||e.target===n.target);i&&e.removeEdge(i.id),e.addEdge({id:`e${Math.random()}`,source:r.source,target:r.target,data:{}}),Rj(e),Fj(e,t),Uj(e,t)};var Uj=(e,t)=>{let n=e.getAllNodes().find(e=>!e.data.parent),r=_A(e,n,`pre`,!1);r=r.slice(1),r.forEach(n=>{let r=e.getNode(n).data.parent,i=t.getRelatedEdges(n,`out`).find(e=>e.target===r),a=!1;!i&&t.hasNode(r)&&(i=t.getRelatedEdges(r,`out`).find(e=>e.target===n),a=!0),t.getNode(n).data.rank=(t.hasNode(r)&&t.getNode(r).data.rank||0)+(a?i?.data.minlen:-i?.data.minlen)})},Wj=(e,t,n)=>e.getRelatedEdges(t,`both`).find(e=>e.source===n||e.target===n),Gj=(e,t)=>t.data.low<=e.data.lim&&e.data.lim<=t.data.lim;const Kj=(e,t)=>{switch(t){case`network-simplex`:Yj(e);break;case`tight-tree`:Jj(e);break;case`longest-path`:qj(e);break;default:Jj(e)}};var qj=Tj,Jj=e=>{Ej(e),Aj(e)},Yj=e=>{Pj(e)};const Xj=(e,t)=>{let{edgeLabelSpace:n,keepNodeOrder:r,prevGraph:i,rankdir:a,ranksep:o}=t;!r&&i&&Qj(e,i);let s=aM(e);n&&(t.ranksep=oM(s,{rankdir:a,ranksep:o}));let c;try{c=Zj(s,t)}catch(e){if(e.message===`Not possible to find intersection inside of the rectangle`){console.error(`The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:
`,e);return}throw e}return $j(e,s),c};var Zj=(e,t)=>{let{acyclicer:n,ranker:r,rankdir:i=`tb`,nodeOrder:a,keepNodeOrder:o,align:s,nodesep:c=50,edgesep:l=20,ranksep:u=50}=t;hM(e),eA(e,n);let{nestingRoot:d,nodeRankFactor:f}=OA(e);Kj(oA(e),r),sM(e),dA(e,f),MA(e,d),uA(e),cM(e),lM(e);let p=[];FA(e,p),cj(e,p),vA(e),o&&aj(e,a),tj(e,o),gM(e),bA(e,i),wj(e,{align:s,nodesep:c,edgesep:l,ranksep:u}),_M(e),mM(e),LA(e,p),fM(e),xA(e,i);let{width:m,height:h}=uM(e);return dM(e),pM(e),nA(e),{width:m,height:h}},Qj=(e,t)=>{e.getAllNodes().forEach(n=>{let r=e.getNode(n.id);if(t.hasNode(n.id)){let e=t.getNode(n.id);r.data.fixorder=e.data._order,delete e.data._order}else delete r.data.fixorder})},$j=(e,t)=>{e.getAllNodes().forEach(n=>{let r=e.getNode(n.id);if(r){let e=t.getNode(n.id);r.data.x=e.data.x,r.data.y=e.data.y,r.data._order=e.data.order,r.data._rank=e.data.rank,t.getChildren(n.id)?.length&&(r.data.width=e.data.width,r.data.height=e.data.height)}}),e.getAllEdges().forEach(n=>{let r=e.getEdge(n.id),i=t.getEdge(n.id);r.data.points=i?i.data.points:[],i&&i.data.hasOwnProperty(`x`)&&(r.data.x=i.data.x,r.data.y=i.data.y)})},eM=[`width`,`height`,`layer`,`fixorder`],tM={width:0,height:0},nM=[`minlen`,`weight`,`width`,`height`,`labeloffset`],rM={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:`r`},iM=[`labelpos`],aM=e=>{let t=new bk({tree:[]});return e.getAllNodes().forEach(n=>{let r=yM(e.getNode(n.id).data),i=Object.assign(Object.assign({},tM),r),a=vM(i,eM);t.hasNode(n.id)||t.addNode({id:n.id,data:Object.assign({},a)});let o=e.hasTreeStructure(`combo`)?e.getParent(n.id,`combo`):e.getParent(n.id);Wl(o)||(t.hasNode(o.id)||t.addNode(Object.assign({},o)),t.setParent(n.id,o.id))}),e.getAllEdges().forEach(n=>{let r=yM(e.getEdge(n.id).data),i={};iM?.forEach(e=>{r[e]!==void 0&&(i[e]=r[e])}),t.addEdge({id:n.id,source:n.source,target:n.target,data:Object.assign({},rM,vM(r,nM),i)})}),t},oM=(e,t)=>{let{ranksep:n=0,rankdir:r}=t;return e.getAllNodes().forEach(e=>{isNaN(e.data.layer)||e.data.layer||(e.data.layer=0)}),e.getAllEdges().forEach(e=>{e.data.minlen*=2,e.data.labelpos?.toLowerCase()!==`c`&&(r===`TB`||r===`BT`?e.data.width+=e.data.labeloffset:e.data.height+=e.data.labeloffset)}),n/2},sM=e=>{e.getAllEdges().forEach(t=>{if(t.data.width&&t.data.height){let n=e.getNode(t.source),r=e.getNode(t.target),i={e:t,rank:(r.data.rank-n.data.rank)/2+n.data.rank};iA(e,`edge-proxy`,i,`_ep`)}})},cM=e=>{let t=0;return e.getAllNodes().forEach(n=>{n.data.borderTop&&(n.data.minRank=e.getNode(n.data.borderTop)?.data.rank,n.data.maxRank=e.getNode(n.data.borderBottom)?.data.rank,t=Math.max(t,n.data.maxRank||-1/0))}),t},lM=e=>{e.getAllNodes().forEach(t=>{t.data.dummy===`edge-proxy`&&(e.getEdge(t.data.e.id).data.labelRank=t.data.rank,e.removeNode(t.id))})},uM=(e,t)=>{let n,r=0,i,a=0,{marginx:o=0,marginy:s=0}=t||{},c=e=>{if(!e.data)return;let t=e.data.x,o=e.data.y,s=e.data.width,c=e.data.height;!isNaN(t)&&!isNaN(s)&&(n===void 0&&(n=t-s/2),n=Math.min(n,t-s/2),r=Math.max(r,t+s/2)),!isNaN(o)&&!isNaN(c)&&(i===void 0&&(i=o-c/2),i=Math.min(i,o-c/2),a=Math.max(a,o+c/2))};return e.getAllNodes().forEach(e=>{c(e)}),e.getAllEdges().forEach(e=>{e?.data.hasOwnProperty(`x`)&&c(e)}),n-=o,i-=s,e.getAllNodes().forEach(e=>{e.data.x-=n,e.data.y-=i}),e.getAllEdges().forEach(e=>{var t;(t=e.data.points)==null||t.forEach(e=>{e.x-=n,e.y-=i}),e.data.hasOwnProperty(`x`)&&(e.data.x-=n),e.data.hasOwnProperty(`y`)&&(e.data.y-=i)}),{width:r-n+o,height:a-i+s}},dM=e=>{e.getAllEdges().forEach(t=>{let n=e.getNode(t.source),r=e.getNode(t.target),i,a;t.data.points?(i=t.data.points[0],a=t.data.points[t.data.points.length-1]):(t.data.points=[],i={x:r.data.x,y:r.data.y},a={x:n.data.x,y:n.data.y}),t.data.points.unshift(cA(n.data,i)),t.data.points.push(cA(r.data,a))})},fM=e=>{e.getAllEdges().forEach(e=>{if(e.data.hasOwnProperty(`x`))switch((e.data.labelpos===`l`||e.data.labelpos===`r`)&&(e.data.width-=e.data.labeloffset),e.data.labelpos){case`l`:e.data.x-=e.data.width/2+e.data.labeloffset;break;case`r`:e.data.x+=e.data.width/2+e.data.labeloffset;break}})},pM=e=>{e.getAllEdges().forEach(e=>{var t;e.data.reversed&&((t=e.data.points)==null||t.reverse())})},mM=e=>{e.getAllNodes().forEach(t=>{if(e.getChildren(t.id)?.length){let n=e.getNode(t.id),r=e.getNode(n.data.borderTop),i=e.getNode(n.data.borderBottom),a=e.getNode(n.data.borderLeft[n.data.borderLeft?.length-1]),o=e.getNode(n.data.borderRight[n.data.borderRight?.length-1]);n.data.width=Math.abs(o?.data.x-a?.data.x)||10,n.data.height=Math.abs(i?.data.y-r?.data.y)||10,n.data.x=(a?.data.x||0)+n.data.width/2,n.data.y=(r?.data.y||0)+n.data.height/2}}),e.getAllNodes().forEach(t=>{t.data.dummy===`border`&&e.removeNode(t.id)})},hM=e=>{e.getAllEdges().forEach(t=>{if(t.source===t.target){let n=e.getNode(t.source);n.data.selfEdges||(n.data.selfEdges=[]),n.data.selfEdges.push(t),e.removeEdge(t.id)}})},gM=e=>{lA(e)?.forEach(t=>{let n=0;t?.forEach((t,r)=>{var i;let a=e.getNode(t);a.data.order=r+n,(i=a.data.selfEdges)==null||i.forEach(t=>{iA(e,`selfedge`,{width:t.data.width,height:t.data.height,rank:a.data.rank,order:r+ ++n,e:t},`_se`)}),delete a.data.selfEdges})})},_M=e=>{e.getAllNodes().forEach(t=>{let n=e.getNode(t.id);if(n.data.dummy===`selfedge`){let r=e.getNode(n.data.e.source),i=r.data.x+r.data.width/2,a=r.data.y,o=n.data.x-i,s=r.data.height/2;e.hasEdge(n.data.e.id)?e.updateEdgeData(n.data.e.id,n.data.e.data):e.addEdge({id:n.data.e.id,source:n.data.e.source,target:n.data.e.target,data:n.data.e.data}),e.removeNode(t.id),n.data.e.data.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{y:a,x:i+o},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.data.e.data.x=n.data.x,n.data.e.data.y=n.data.y}})},vM=(e,t)=>{let n={};return t?.forEach(t=>{e[t]!==void 0&&(n[t]=+e[t])}),n},yM=(e={})=>{let t={};return Object.keys(e).forEach(n=>{t[n.toLowerCase()]=e[n]}),t};const bM=Array.isArray,xM=e=>{let t=[],n=e.length;for(let r=0;r<n;r+=1){t[r]=[];for(let i=0;i<n;i+=1)r===i?t[r][i]=0:e[r][i]===0||!e[r][i]?t[r][i]=1/0:t[r][i]=e[r][i]}for(let e=0;e<n;e+=1)for(let r=0;r<n;r+=1)for(let i=0;i<n;i+=1)t[r][i]>t[r][e]+t[e][i]&&(t[r][i]=t[r][e]+t[e][i]);return t},SM=(e,t)=>{let{nodes:n,edges:r}=e,i=[],a={};if(!n)throw Error(`invalid nodes data!`);return n&&n.forEach((e,t)=>{a[e.id]=t,i.push([])}),r?.forEach(e=>{let{source:n,target:r}=e,o=a[n],s=a[r];o===void 0||s===void 0||(i[o][s]=1,t||(i[s][o]=1))}),i},CM=(e,t)=>{let n=[];return e.forEach(e=>{let r=[];e.forEach(e=>{r.push(e*t)}),n.push(r)}),n},wM=e=>{let t=1/0,n=1/0,r=-1/0,i=-1/0;return e.forEach(e=>{let a=e.data.size;bM(a)?a.length===1&&(a=[a[0],a[0]]):G(a)?a=[a,a]:(a===void 0||isNaN(a))&&(a=[30,30]);let o=[a[0]/2,a[1]/2],s=e.data.x-o[0],c=e.data.x+o[0],l=e.data.y-o[1],u=e.data.y+o[1];t>s&&(t=s),n>l&&(n=l),r<c&&(r=c),i<u&&(i=u)}),{minX:t,minY:n,maxX:r,maxY:i}},TM=(e,t)=>Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),EM=(e,t,n,r=`TB`,i,a={})=>{if(!t?.length)return;let{stopBranchFn:o,stopAllFn:s}=a;for(let c=0;c<t.length;c++){let l=t[c];if(e.hasNode(l.id)&&!o?.(l)){if(s?.(l))return;r===`TB`&&n(l),EM(e,e.getChildren(l.id,i),n,r,i,a),r!==`TB`&&n(l)}}},DM=e=>{if(e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof Array){let t=[];return e.forEach(e=>{t.push(e)}),t.map(e=>DM(e))}if(typeof e==`object`){let t={};return Object.keys(e).forEach(n=>{t[n]=DM(e[n])}),t}return e},OM=(e,t)=>{let n=DM(e);return n.data=n.data||{},t&&(G(n.data.x)||(n.data.x=Math.random()*t[0]),G(n.data.y)||(n.data.y=Math.random()*t[1])),n};function kM(e){if(!e)return[0,0,0];if(G(e))return[e,e,e];if(e.length===0)return[0,0,0];let[t,n=t,r=t]=e;return[t,n,r]}function AM(e,t){let n;return n=W(t)?t:G(t)?()=>t:()=>e,n}function jM(e,t,n=!0){return!t&&t!==0?t=>{let{size:r}=t.data||{};return r?Array.isArray(r)?n?Math.max(...r)||e:r:Kl(r)&&r.width&&r.height?n?Math.max(r.width,r.height)||e:[r.width,r.height]:r:e}:W(t)?t:G(t)?()=>t:Array.isArray(t)?()=>n?Math.max(...t)||e:t:Kl(t)&&t.width&&t.height?()=>n?Math.max(t.width,t.height)||e:[t.width,t.height]:()=>e}const MM=(e,t,n=10)=>{let r,i=typeof t==`function`?t:()=>t||0;return r=e?Array.isArray(e)?t=>e:W(e)?e:t=>e:e=>{if(e.data?.bboxSize)return e.data?.bboxSize;if(e.data?.size){let t=e.data.size;return Array.isArray(t)?t:Kl(t)?[t.width,t.height]:t}return n},e=>{let t=r(e),n=i(e);return Math.max(...kM(t))+n}};var NM={rankdir:`TB`,nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:`tight-tree`,controlPoints:!1,radial:!1,focusNode:null},PM=class{constructor(e={}){this.options=e,this.id=`antv-dagre`,this.options=Object.assign(Object.assign({},NM),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,t)})}genericDagreLayout(e,t,n){return en(this,void 0,void 0,function*(){let{nodeSize:r,align:i,rankdir:a=`TB`,ranksep:o,nodesep:s,ranksepFunc:c,nodesepFunc:l,edgeLabelSpace:u,ranker:d,nodeOrder:f,begin:p,controlPoints:m,radial:h,sortByCombo:g,preset:_}=Object.assign(Object.assign({},this.options),n),v=new bk({tree:[]}),y=AM(o||50,c),b=AM(s||50,l),x=b,S=y;(a===`LR`||a===`RL`)&&(x=y,S=b);let C=jM(10,r,!1),w=t.getAllNodes(),T=t.getAllEdges();w.forEach(e=>{let t=kM(C(e)),n=S(e),r=x(e),i=t[0]+2*r,a=t[1]+2*n,o=e.data.layer;G(o)?v.addNode({id:e.id,data:{width:i,height:a,layer:o}}):v.addNode({id:e.id,data:{width:i,height:a}})}),g&&(v.attachTreeStructure(`combo`),w.forEach(e=>{let{parentId:t}=e.data;t!==void 0&&v.hasNode(t)&&v.setParent(e.id,t,`combo`)})),T.forEach(e=>{v.addEdge({id:e.id,source:e.source,target:e.target,data:{weight:e.data.weight||1}})});let E;_?.length&&(E=new bk({nodes:_})),Xj(v,{prevGraph:E,edgeLabelSpace:u,keepNodeOrder:!!f,nodeOrder:f||[],acyclicer:`greedy`,ranker:d,rankdir:a,nodesep:s,align:i});let D=[0,0];if(p){let e=1/0,t=1/0;v.getAllNodes().forEach(n=>{e>n.data.x&&(e=n.data.x),t>n.data.y&&(t=n.data.y)}),v.getAllEdges().forEach(n=>{var r;(r=n.data.points)==null||r.forEach(n=>{e>n.x&&(e=n.x),t>n.y&&(t=n.y)})}),D[0]=p[0]-e,D[1]=p[1]-t}let O=a===`LR`||a===`RL`;if(!h){let e=new Set,t=a===`BT`||a===`RL`?(e,t)=>t-e:(e,t)=>e-t;v.getAllNodes().forEach(t=>{t.data.x=t.data.x+D[0],t.data.y=t.data.y+D[1],e.add(O?t.data.x:t.data.y)});let n=Array.from(e).sort(t),r=O?(e,t)=>e.x!==t.x:(e,t)=>e.y!==t.y,i=O?(e,t,n)=>{let r=Math.max(t.y,n.y),i=Math.min(t.y,n.y);return e.filter(e=>e.y<=r&&e.y>=i)}:(e,t,n)=>{let r=Math.max(t.x,n.x),i=Math.min(t.x,n.x);return e.filter(e=>e.x<=r&&e.x>=i)};v.getAllEdges().forEach((e,t)=>{u&&m&&e.data.type!==`loop`&&(e.data.controlPoints=FM(e.data.points?.map(({x:e,y:t})=>({x:e+D[0],y:t+D[1]})),v.getNode(e.source),v.getNode(e.target),n,O,r,i))})}let k=[];k=v.getAllNodes().map(e=>OM(e));let A=v.getAllEdges();return e&&(k.forEach(e=>{t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})}),A.forEach(e=>{t.mergeEdgeData(e.id,{controlPoints:e.data.controlPoints})})),{nodes:k,edges:A}})}},FM=(e,t,n,r,i,a,o)=>{let s=e?.slice(1,e.length-1)||[];if(t&&n){let{x:e,y:c}=t.data,{x:l,y:u}=n.data;if(i&&(e=t.data.y,c=t.data.x,l=n.data.y,u=n.data.x),u!==c&&e!==l){let d=r.indexOf(c),f=r[d+1];if(f){let e=s[0],t=i?{x:(c+f)/2,y:e?.y||l}:{x:e?.x||l,y:(c+f)/2};(!e||a(e,t))&&s.unshift(t)}let p=r.indexOf(u),m=Math.abs(p-d);if(m===1)s=o(s,t.data,n.data),s.length||s.push(i?{x:(c+u)/2,y:e}:{x:e,y:(c+u)/2});else if(m>1){let t=r[p-1];if(t){let n=s[s.length-1],r=i?{x:(u+t)/2,y:n?.y||l}:{x:n?.x||e,y:(u+t)/2};(!n||a(n,r))&&s.push(r)}}}}return s};const IM=(e,t,n)=>{let r=e.getAllNodes(),i=e.getAllEdges();if(!r?.length)return{nodes:[],edges:i};if(r.length===1)return t&&e.mergeNodeData(r[0].id,{x:n[0],y:n[1]}),{nodes:[Object.assign(Object.assign({},r[0]),{data:Object.assign(Object.assign({},r[0].data),{x:n[0],y:n[1]})})],edges:i}};var LM={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},RM=class{constructor(e={}){this.options=e,this.id=`circular`,this.options=Object.assign(Object.assign({},LM),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericCircularLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericCircularLayout(!0,e,t)})}genericCircularLayout(e,t,n){return en(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.options),n),{width:i,height:a,center:o,divisions:s,startAngle:c=0,endAngle:l=2*Math.PI,angleRatio:u,ordering:d,clockwise:f,nodeSpacing:p,nodeSize:m}=r,h=t.getAllNodes(),g=t.getAllEdges(),[_,v,y]=VM(i,a,o),b=h?.length;if(!b||b===1)return IM(t,e,y);let x=(l-c)/b,{radius:S,startRadius:C,endRadius:w}=r;if(p){let e=AM(10,p),t=jM(10,m),n=-1/0;h.forEach(e=>{let r=t(e);n<r&&(n=r)});let r=0;h.forEach((t,i)=>{i===0?r+=n||10:r+=(e(t)||0)+(n||10)}),S=r/(2*Math.PI)}else !S&&!C&&!w?S=Math.min(v,_)/2:!C&&w?C=w:C&&!w&&(w=C);let T=x*u,E=[];E=d===`topology`?zM(t,h):d===`topology-directed`?zM(t,h,!0):d===`degree`?BM(t,h):h.map(e=>OM(e));let D=Math.ceil(b/s);for(let e=0;e<b;++e){let t=S;!t&&C!==null&&w!==null&&(t=C+e*(w-C)/(b-1)),t||=10+e*100/(b-1);let n=c+e%D*T+2*Math.PI/s*Math.floor(e/D);f||(n=l-e%D*T-2*Math.PI/s*Math.floor(e/D)),E[e].data.x=y[0]+Math.cos(n)*t,E[e].data.y=y[1]+Math.sin(n)*t}return e&&E.forEach(e=>{t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})}),{nodes:E,edges:g}})}},zM=(e,t,n=!1)=>{let r=[OM(t[0])],i={},a=t.length;i[t[0].id]=!0;let o=0;return t.forEach((s,c)=>{if(c!==0)if((c===a-1||e.getDegree(s.id,`both`)!==e.getDegree(t[c+1].id,`both`)||e.areNeighbors(r[o].id,s.id))&&!i[s.id])r.push(OM(s)),i[s.id]=!0,o++;else{let c=n?e.getSuccessors(r[o].id):e.getNeighbors(r[o].id),l=!1;for(let t=0;t<c.length;t++){let n=c[t];if(e.getDegree(n.id)===e.getDegree(s.id)&&!i[n.id]){r.push(OM(n)),i[n.id]=!0,l=!0;break}}let u=0;for(;!l&&(i[t[u].id]||(r.push(OM(t[u])),i[t[u].id]=!0,l=!0),u++,u!==a););}}),r};function BM(e,t){let n=[];return t.forEach((e,t)=>{n.push(OM(e))}),n.sort((t,n)=>e.getDegree(t.id,`both`)-e.getDegree(n.id,`both`)),n}var VM=(e,t,n)=>{let r=e,i=t,a=n;return!r&&typeof window<`u`&&(r=window.innerWidth),!i&&typeof window<`u`&&(i=window.innerHeight),a||=[r/2,i/2],[r,i,a]},HM={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:3/2*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:`degree`},UM=class{constructor(e={}){this.options=e,this.id=`concentric`,this.options=Object.assign(Object.assign({},HM),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericConcentricLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericConcentricLayout(!0,e,t)})}genericConcentricLayout(e,t,n){return en(this,void 0,void 0,function*(){let{center:r,width:i,height:a,sortBy:o,maxLevelDiff:s,sweep:c,clockwise:l,equidistant:u,preventOverlap:d,startAngle:f=3/2*Math.PI,nodeSize:p,nodeSpacing:m}=Object.assign(Object.assign({},this.options),n),h=t.getAllNodes(),g=t.getAllEdges(),_=!i&&typeof window<`u`?window.innerWidth:i,v=!a&&typeof window<`u`?window.innerHeight:a,y=r||[_/2,v/2];if(!h?.length||h.length===1)return IM(t,e,y);let b=[],x,S=0;bM(p)?x=Math.max(p[0],p[1]):W(p)?(x=-1/0,h.forEach(e=>{let t=Math.max(...kM(p(e)));t>x&&(x=t)})):x=p,bM(m)?S=Math.max(m[0],m[1]):G(m)&&(S=m),h.forEach(e=>{let t=OM(e);b.push(t);let n=x,{data:r}=t;bM(r.size)?n=Math.max(r.size[0],r.size[1]):G(r.size)?n=r.size:Kl(r.size)&&(n=Math.max(r.size.width,r.size.height)),x=Math.max(x,n),W(m)&&(S=Math.max(m(e),S))});let C={};b.forEach((e,t)=>{C[e.id]=t});let w=o;(!ru(w)||b[0].data[w]===void 0)&&(w=`degree`),w===`degree`?b.sort((e,n)=>t.getDegree(n.id,`both`)-t.getDegree(e.id,`both`)):b.sort((e,t)=>t.data[w]-e.data[w]);let T=b[0],E=(s||(w===`degree`?t.getDegree(T.id,`both`):T.data[w]))/4,D=[{nodes:[]}],O=D[0];b.forEach(e=>{if(O.nodes.length>0){let n=w===`degree`?Math.abs(t.getDegree(O.nodes[0].id,`both`)-t.getDegree(e.id,`both`)):Math.abs(O.nodes[0].data[w]-e.data[w]);E&&n>=E&&(O={nodes:[]},D.push(O))}O.nodes.push(e)});let k=x+S;if(!d){let e=D.length>0&&D[0].nodes.length>1,t=(Math.min(_,v)/2-k)/(D.length+(e?1:0));k=Math.min(k,t)}let A=0;if(D.forEach(e=>{if(e.dTheta=(c===void 0?2*Math.PI-2*Math.PI/e.nodes.length:c)/Math.max(1,e.nodes.length-1),e.nodes.length>1&&d){let t=Math.cos(e.dTheta)-Math.cos(0),n=Math.sin(e.dTheta)-Math.sin(0),r=Math.sqrt(k*k/(t*t+n*n));A=Math.max(r,A)}e.r=A,A+=k}),u){let e=0,t=0;for(let n=0;n<D.length;n++){let r=(D[n].r||0)-t;e=Math.max(e,r)}t=0,D.forEach((n,r)=>{r===0&&(t=n.r||0),n.r=t,t+=e})}return D.forEach(e=>{let t=e.dTheta||0,n=e.r||0;e.nodes.forEach((e,r)=>{let i=f+(l?1:-1)*t*r;e.data.x=y[0]+n*Math.cos(i),e.data.y=y[1]+n*Math.sin(i)})}),e&&b.forEach(e=>t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})),{nodes:b,edges:g}})}};function WM(e){let t=+this._x.call(null,e),n=+this._y.call(null,e);return GM(this.cover(t,n),t,n,e)}function GM(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var i,a=e._root,o={data:r},s=e._x0,c=e._y0,l=e._x1,u=e._y1,d,f,p,m,h,g,_,v;if(!a)return e._root=o,e;for(;a.length;)if((h=t>=(d=(s+l)/2))?s=d:l=d,(g=n>=(f=(c+u)/2))?c=f:u=f,i=a,!(a=a[_=g<<1|h]))return i[_]=o,e;if(p=+e._x.call(null,a.data),m=+e._y.call(null,a.data),t===p&&n===m)return o.next=a,i?i[_]=o:e._root=o,e;do i=i?i[_]=[,,,,]:e._root=[,,,,],(h=t>=(d=(s+l)/2))?s=d:l=d,(g=n>=(f=(c+u)/2))?c=f:u=f;while((_=g<<1|h)==(v=(m>=f)<<1|p>=d));return i[v]=a,i[_]=o,e}function KM(e){var t,n,r=e.length,i,a,o=Array(r),s=Array(r),c=1/0,l=1/0,u=-1/0,d=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=i,s[n]=a,i<c&&(c=i),i>u&&(u=i),a<l&&(l=a),a>d&&(d=a));if(c>u||l>d)return this;for(this.cover(c,l).cover(u,d),n=0;n<r;++n)GM(this,o[n],s[n],e[n]);return this}function qM(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(e))+1,a=(r=Math.floor(t))+1;else{for(var o=i-n||1,s=this._root,c,l;n>e||e>=i||r>t||t>=a;)switch(l=(t<r)<<1|e<n,c=[,,,,],c[l]=s,s=c,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function JM(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function YM(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function XM(e,t,n,r,i){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=i}function ZM(e,t,n){var r,i=this._x0,a=this._y0,o,s,c,l,u=this._x1,d=this._y1,f=[],p=this._root,m,h;for(p&&f.push(new XM(p,i,a,u,d)),n==null?n=1/0:(i=e-n,a=t-n,u=e+n,d=t+n,n*=n);m=f.pop();)if(!(!(p=m.node)||(o=m.x0)>u||(s=m.y0)>d||(c=m.x1)<i||(l=m.y1)<a))if(p.length){var g=(o+c)/2,_=(s+l)/2;f.push(new XM(p[3],g,_,c,l),new XM(p[2],o,_,g,l),new XM(p[1],g,s,c,_),new XM(p[0],o,s,g,_)),(h=(t>=_)<<1|e>=g)&&(m=f[f.length-1],f[f.length-1]=f[f.length-1-h],f[f.length-1-h]=m)}else{var v=e-+this._x.call(null,p.data),y=t-+this._y.call(null,p.data),b=v*v+y*y;if(b<n){var x=Math.sqrt(n=b);i=e-x,a=t-x,u=e+x,d=t+x,r=p.data}}return r}function QM(e){if(isNaN(u=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,c=this._x1,l=this._y1,u,d,f,p,m,h,g,_;if(!n)return this;if(n.length)for(;;){if((m=u>=(f=(o+c)/2))?o=f:c=f,(h=d>=(p=(s+l)/2))?s=p:l=p,t=n,!(n=n[g=h<<1|m]))return this;if(!n.length)break;(t[g+1&3]||t[g+2&3]||t[g+3&3])&&(r=t,_=g)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[g]=a:delete t[g],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[_]=n:this._root=n),this):(this._root=a,this)}function $M(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function eN(){return this._root}function tN(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function nN(e){var t=[],n,r=this._root,i,a,o,s,c;for(r&&t.push(new XM(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.x1,c=n.y1)&&r.length){var l=(a+s)/2,u=(o+c)/2;(i=r[3])&&t.push(new XM(i,l,u,s,c)),(i=r[2])&&t.push(new XM(i,a,u,l,c)),(i=r[1])&&t.push(new XM(i,l,o,s,u)),(i=r[0])&&t.push(new XM(i,a,o,l,u))}return this}function rN(e){var t=[],n=[],r;for(this._root&&t.push(new XM(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,c=r.x1,l=r.y1,u=(o+c)/2,d=(s+l)/2;(a=i[0])&&t.push(new XM(a,o,s,u,d)),(a=i[1])&&t.push(new XM(a,u,s,c,d)),(a=i[2])&&t.push(new XM(a,o,d,u,l)),(a=i[3])&&t.push(new XM(a,u,d,c,l))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function iN(e){return e[0]}function aN(e){return arguments.length?(this._x=e,this):this._x}function oN(e){return e[1]}function sN(e){return arguments.length?(this._y=e,this):this._y}function cN(e,t,n){var r=new lN(t??iN,n??oN,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function lN(e,t,n,r,i,a){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function uN(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var dN=cN.prototype=lN.prototype;dN.copy=function(){var e=new lN(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=uN(t),e;for(n=[{source:t,target:e._root=[,,,,]}];t=n.pop();)for(var i=0;i<4;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=[,,,,]}):t.target[i]=uN(r));return e},dN.add=WM,dN.addAll=KM,dN.cover=qM,dN.data=JM,dN.extent=YM,dN.find=ZM,dN.remove=QM,dN.removeAll=$M,dN.root=eN,dN.size=tN,dN.visit=nN,dN.visitAfter=rN,dN.x=aN,dN.y=sN;function fN(e){let t=+this._x.call(null,e),n=+this._y.call(null,e),r=+this._z.call(null,e);return pN(this.cover(t,n,r),t,n,r,e)}function pN(e,t,n,r,i){if(isNaN(t)||isNaN(n)||isNaN(r))return e;var a,o=e._root,s={data:i},c=e._x0,l=e._y0,u=e._z0,d=e._x1,f=e._y1,p=e._z1,m,h,g,_,v,y,b,x,S,C,w;if(!o)return e._root=s,e;for(;o.length;)if((b=t>=(m=(c+d)/2))?c=m:d=m,(x=n>=(h=(l+f)/2))?l=h:f=h,(S=r>=(g=(u+p)/2))?u=g:p=g,a=o,!(o=o[C=S<<2|x<<1|b]))return a[C]=s,e;if(_=+e._x.call(null,o.data),v=+e._y.call(null,o.data),y=+e._z.call(null,o.data),t===_&&n===v&&r===y)return s.next=o,a?a[C]=s:e._root=s,e;do a=a?a[C]=Array(8):e._root=Array(8),(b=t>=(m=(c+d)/2))?c=m:d=m,(x=n>=(h=(l+f)/2))?l=h:f=h,(S=r>=(g=(u+p)/2))?u=g:p=g;while((C=S<<2|x<<1|b)==(w=(y>=g)<<2|(v>=h)<<1|_>=m));return a[w]=o,a[C]=s,e}function mN(e){Array.isArray(e)||(e=Array.from(e));let t=e.length,n=new Float64Array(t),r=new Float64Array(t),i=new Float64Array(t),a=1/0,o=1/0,s=1/0,c=-1/0,l=-1/0,u=-1/0;for(let d=0,f,p,m,h;d<t;++d)isNaN(p=+this._x.call(null,f=e[d]))||isNaN(m=+this._y.call(null,f))||isNaN(h=+this._z.call(null,f))||(n[d]=p,r[d]=m,i[d]=h,p<a&&(a=p),p>c&&(c=p),m<o&&(o=m),m>l&&(l=m),h<s&&(s=h),h>u&&(u=h));if(a>c||o>l||s>u)return this;this.cover(a,o,s).cover(c,l,u);for(let a=0;a<t;++a)pN(this,n[a],r[a],i[a],e[a]);return this}function hN(e,t,n){if(isNaN(e=+e)||isNaN(t=+t)||isNaN(n=+n))return this;var r=this._x0,i=this._y0,a=this._z0,o=this._x1,s=this._y1,c=this._z1;if(isNaN(r))o=(r=Math.floor(e))+1,s=(i=Math.floor(t))+1,c=(a=Math.floor(n))+1;else{for(var l=o-r||1,u=this._root,d,f;r>e||e>=o||i>t||t>=s||a>n||n>=c;)switch(f=(n<a)<<2|(t<i)<<1|e<r,d=Array(8),d[f]=u,u=d,l*=2,f){case 0:o=r+l,s=i+l,c=a+l;break;case 1:r=o-l,s=i+l,c=a+l;break;case 2:o=r+l,i=s-l,c=a+l;break;case 3:r=o-l,i=s-l,c=a+l;break;case 4:o=r+l,s=i+l,a=c-l;break;case 5:r=o-l,s=i+l,a=c-l;break;case 6:o=r+l,i=s-l,a=c-l;break;case 7:r=o-l,i=s-l,a=c-l;break}this._root&&this._root.length&&(this._root=u)}return this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=c,this}function gN(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function _N(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function vN(e,t,n,r,i,a,o){this.node=e,this.x0=t,this.y0=n,this.z0=r,this.x1=i,this.y1=a,this.z1=o}function yN(e,t,n,r){var i,a=this._x0,o=this._y0,s=this._z0,c,l,u,d,f,p,m=this._x1,h=this._y1,g=this._z1,_=[],v=this._root,y,b;for(v&&_.push(new vN(v,a,o,s,m,h,g)),r==null?r=1/0:(a=e-r,o=t-r,s=n-r,m=e+r,h=t+r,g=n+r,r*=r);y=_.pop();)if(!(!(v=y.node)||(c=y.x0)>m||(l=y.y0)>h||(u=y.z0)>g||(d=y.x1)<a||(f=y.y1)<o||(p=y.z1)<s))if(v.length){var x=(c+d)/2,S=(l+f)/2,C=(u+p)/2;_.push(new vN(v[7],x,S,C,d,f,p),new vN(v[6],c,S,C,x,f,p),new vN(v[5],x,l,C,d,S,p),new vN(v[4],c,l,C,x,S,p),new vN(v[3],x,S,u,d,f,C),new vN(v[2],c,S,u,x,f,C),new vN(v[1],x,l,u,d,S,C),new vN(v[0],c,l,u,x,S,C)),(b=(n>=C)<<2|(t>=S)<<1|e>=x)&&(y=_[_.length-1],_[_.length-1]=_[_.length-1-b],_[_.length-1-b]=y)}else{var w=e-+this._x.call(null,v.data),T=t-+this._y.call(null,v.data),E=n-+this._z.call(null,v.data),D=w*w+T*T+E*E;if(D<r){var O=Math.sqrt(r=D);a=e-O,o=t-O,s=n-O,m=e+O,h=t+O,g=n+O,i=v.data}}return i}var bN=(e,t,n,r,i,a)=>Math.sqrt((e-r)**2+(t-i)**2+(n-a)**2);function xN(e,t,n,r){let i=[],a=e-r,o=t-r,s=n-r,c=e+r,l=t+r,u=n+r;return this.visit((d,f,p,m,h,g,_)=>{if(!d.length)do{let a=d.data;bN(e,t,n,this._x(a),this._y(a),this._z(a))<=r&&i.push(a)}while(d=d.next);return f>c||p>l||m>u||h<a||g<o||_<s}),i}function SN(e){if(isNaN(f=+this._x.call(null,e))||isNaN(p=+this._y.call(null,e))||isNaN(m=+this._z.call(null,e)))return this;var t,n=this._root,r,i,a,o=this._x0,s=this._y0,c=this._z0,l=this._x1,u=this._y1,d=this._z1,f,p,m,h,g,_,v,y,b,x,S;if(!n)return this;if(n.length)for(;;){if((v=f>=(h=(o+l)/2))?o=h:l=h,(y=p>=(g=(s+u)/2))?s=g:u=g,(b=m>=(_=(c+d)/2))?c=_:d=_,t=n,!(n=n[x=b<<2|y<<1|v]))return this;if(!n.length)break;(t[x+1&7]||t[x+2&7]||t[x+3&7]||t[x+4&7]||t[x+5&7]||t[x+6&7]||t[x+7&7])&&(r=t,S=x)}for(;n.data!==e;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):t?(a?t[x]=a:delete t[x],(n=t[0]||t[1]||t[2]||t[3]||t[4]||t[5]||t[6]||t[7])&&n===(t[7]||t[6]||t[5]||t[4]||t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[S]=n:this._root=n),this):(this._root=a,this)}function CN(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function wN(){return this._root}function TN(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function EN(e){var t=[],n,r=this._root,i,a,o,s,c,l,u;for(r&&t.push(new vN(r,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));n=t.pop();)if(!e(r=n.node,a=n.x0,o=n.y0,s=n.z0,c=n.x1,l=n.y1,u=n.z1)&&r.length){var d=(a+c)/2,f=(o+l)/2,p=(s+u)/2;(i=r[7])&&t.push(new vN(i,d,f,p,c,l,u)),(i=r[6])&&t.push(new vN(i,a,f,p,d,l,u)),(i=r[5])&&t.push(new vN(i,d,o,p,c,f,u)),(i=r[4])&&t.push(new vN(i,a,o,p,d,f,u)),(i=r[3])&&t.push(new vN(i,d,f,s,c,l,p)),(i=r[2])&&t.push(new vN(i,a,f,s,d,l,p)),(i=r[1])&&t.push(new vN(i,d,o,s,c,f,p)),(i=r[0])&&t.push(new vN(i,a,o,s,d,f,p))}return this}function DN(e){var t=[],n=[],r;for(this._root&&t.push(new vN(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));r=t.pop();){var i=r.node;if(i.length){var a,o=r.x0,s=r.y0,c=r.z0,l=r.x1,u=r.y1,d=r.z1,f=(o+l)/2,p=(s+u)/2,m=(c+d)/2;(a=i[0])&&t.push(new vN(a,o,s,c,f,p,m)),(a=i[1])&&t.push(new vN(a,f,s,c,l,p,m)),(a=i[2])&&t.push(new vN(a,o,p,c,f,u,m)),(a=i[3])&&t.push(new vN(a,f,p,c,l,u,m)),(a=i[4])&&t.push(new vN(a,o,s,m,f,p,d)),(a=i[5])&&t.push(new vN(a,f,s,m,l,p,d)),(a=i[6])&&t.push(new vN(a,o,p,m,f,u,d)),(a=i[7])&&t.push(new vN(a,f,p,m,l,u,d))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.z0,r.x1,r.y1,r.z1);return this}function ON(e){return e[0]}function kN(e){return arguments.length?(this._x=e,this):this._x}function AN(e){return e[1]}function jN(e){return arguments.length?(this._y=e,this):this._y}function MN(e){return e[2]}function NN(e){return arguments.length?(this._z=e,this):this._z}function PN(e,t,n,r){var i=new FN(t??ON,n??AN,r??MN,NaN,NaN,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function FN(e,t,n,r,i,a,o,s,c){this._x=e,this._y=t,this._z=n,this._x0=r,this._y0=i,this._z0=a,this._x1=o,this._y1=s,this._z1=c,this._root=void 0}function IN(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var LN=PN.prototype=FN.prototype;LN.copy=function(){var e=new FN(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=IN(t),e;for(n=[{source:t,target:e._root=Array(8)}];t=n.pop();)for(var i=0;i<8;++i)(r=t.source[i])&&(r.length?n.push({source:r,target:t.target[i]=Array(8)}):t.target[i]=IN(r));return e},LN.add=fN,LN.addAll=mN,LN.cover=hN,LN.data=gN,LN.extent=_N,LN.find=yN,LN.findAllWithinRadius=xN,LN.remove=SN,LN.removeAll=CN,LN.root=wN,LN.size=TN,LN.visit=EN,LN.visitAfter=DN,LN.x=kN,LN.y=jN,LN.z=NN;var RN=.81,zN=.1;function BN(e,t,n,r,i=2){let a=t/n,o=e.getAllNodes(),s=o.map((e,t)=>{let{nodeStrength:n,x:r,y:i,z:o,size:s}=e.data;return{x:r,y:i,z:o,size:s,index:t,id:e.id,vx:0,vy:0,vz:0,weight:a*n}}),c=(i===2?cN(s,e=>e.x,e=>e.y):PN(s,e=>e.x,e=>e.y,e=>e.z)).visitAfter(VN),l=new Map;return s.forEach(e=>{l.set(e.id,e),UN(e,c,i)}),s.map((e,t)=>{let{id:n,data:i}=o[t],{mass:a=1}=i;r[n]={x:e.vx/a,y:e.vy/a,z:e.vz/a}}),r}function VN(e){let t=0,n=0,r=0,i=0,a=0,o=e.length;if(o){for(let s=0;s<o;s++){let o=e[s];o&&o.weight&&(t+=o.weight,n+=o.x*o.weight,r+=o.y*o.weight,i+=o.z*o.weight,a+=o.size*o.weight)}e.x=n/t,e.y=r/t,e.z=i/t,e.size=a/t,e.weight=t}else{let t=e;e.x=t.data.x,e.y=t.data.y,e.z=t.data.z,e.size=t.data.size,e.weight=t.data.weight}}var HN=(e,t,n,r,i,a,o)=>{if(e.data?.id===a.id)return;let s=[n,r,i][o-1],c=a.x-e.x||zN,l=a.y-e.y||zN,u=a.z-e.z||zN,d=[c,l,u],f=s-t,p=0;for(let e=0;e<o;e++)p+=d[e]*d[e];let m=Math.sqrt(p)*p;if(f*f*RN<p){let t=e.weight/m;return a.vx+=c*t,a.vy+=l*t,a.vz+=u*t,!0}if(e.length)return!1;if(e.data!==a){let t=e.data.weight/m;a.vx+=c*t,a.vy+=l*t,a.vz+=u*t}};function UN(e,t,n){t.visit((t,r,i,a,o)=>HN(t,r,i,a,o,e,n))}var WN={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:`mean`},GN=class{constructor(e={}){this.options=e,this.id=`force`,this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=Object.assign(Object.assign({},WN),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericForceLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericForceLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<`u`&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let t=0;(this.judgingDistance>this.lastOptions.minMovement||t<1)&&t<e;t++)this.runOneStep(this.lastCalcGraph,this.lastGraph,t,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);let t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(e=>this.lastGraph.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:this.options.dimensions===3?e.data.z:void 0})),t}genericForceLayout(e,t,n){return en(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.options),n),i=t.getAllNodes(),a=t.getAllEdges(),o=this.formatOptions(r,t),{dimensions:s,width:c,height:l,nodeSize:u,getMass:d,nodeStrength:f,edgeStrength:p,linkDistance:m}=o,h=i.map((e,t)=>Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{x:G(e.data.x)?e.data.x:Math.random()*c,y:G(e.data.y)?e.data.y:Math.random()*l,z:G(e.data.z)?e.data.z:Math.random()*Math.sqrt(c*l),size:u(e)||30,mass:d(e),nodeStrength:f(e)})})),g=a.map(e=>Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{edgeStrength:p(e),linkDistance:m(e,t.getNode(e.source),t.getNode(e.target))})}));if(!i?.length)return this.lastResult={nodes:[],edges:a},{nodes:[],edges:a};let _={};i.forEach((e,t)=>{_[e.id]={x:0,y:0,z:0}});let v=new bk({nodes:h,edges:g});this.formatCentripetal(o,v);let{maxIteration:y,minMovement:b,onTick:x}=o;if(this.lastLayoutNodes=h,this.lastLayoutEdges=g,this.lastAssign=e,this.lastGraph=t,this.lastCalcGraph=v,this.lastOptions=o,this.lastVelMap=_,typeof window>`u`)return;let S=0;return new Promise(n=>{this.timeInterval=window.setInterval(()=>{(!i||!this.running)&&n({nodes:XN(t,h),edges:a}),this.runOneStep(v,t,S,_,o),this.updatePosition(t,v,_,o),e&&h.forEach(e=>t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:s===3?e.data.z:void 0})),x?.({nodes:XN(t,h),edges:a}),S++,(S>=y||this.judgingDistance<b)&&(window.clearInterval(this.timeInterval),n({nodes:XN(t,h),edges:a}))},0),this.running=!0})})}formatOptions(e,t){let n=Object.assign({},e),{width:r,height:i,getMass:a}=e;return n.width=!r&&typeof window<`u`?window.innerWidth:r,n.height=!i&&typeof window<`u`?window.innerHeight:i,e.center||(n.center=[n.width/2,n.height/2]),a||(n.getMass=e=>{let n=1;G(e?.data.mass)&&(n=e?.data.mass);let r=t.getDegree(e.id,`both`);return!r||r<5?n:r*5*n}),n.nodeSize=MM(e.nodeSize,e.nodeSpacing),n.linkDistance=e.linkDistance?AM(1,e.linkDistance):e=>1+n.nodeSize(t.getNode(e.source))+n.nodeSize(t.getNode(e.target)),n.nodeStrength=AM(1,e.nodeStrength),n.edgeStrength=AM(1,e.edgeStrength),n}formatCentripetal(e,t){let{dimensions:n,centripetalOptions:r,center:i,clusterNodeStrength:a,leafCluster:o,clustering:s,nodeClusterBy:c}=e,l=t.getAllNodes(),u=r||{leaf:2,single:2,others:1,center:e=>({x:i[0],y:i[1],z:n===3?i[2]:void 0})};typeof a!=`function`&&(e.clusterNodeStrength=e=>a);let d,f;if(o&&c&&(d=KN(t,c),f=Array.from(new Set(l?.map(e=>e.data[c])))||[],e.centripetalOptions=Object.assign(u,{single:100,leaf:t=>{let{siblingLeaves:n,sameTypeLeaves:r}=d[t.id]||{};return r?.length===n?.length||f?.length===1?1:e.clusterNodeStrength(t)},others:1,center:e=>{let n=t.getDegree(e.id,`both`);if(!n)return{x:100,y:100,z:0};let r;if(n===1){let{sameTypeLeaves:t=[]}=d[e.id]||{};t.length===1?r=void 0:t.length>1&&(r=YN(t))}else r=void 0;return{x:r?.x,y:r?.y,z:r?.z}}})),s&&c){d||=KN(t,c),f||=Array.from(new Set(l.map(e=>e.data[c]))),f=f.filter(e=>e!==void 0);let n={};f.forEach(e=>{let r=l.filter(t=>t.data[c]===e).map(e=>t.getNode(e.id));n[e]=YN(r)}),e.centripetalOptions=Object.assign(u,{single:t=>e.clusterNodeStrength(t),leaf:t=>e.clusterNodeStrength(t),others:t=>e.clusterNodeStrength(t),center:e=>{let t=n[e.data[c]];return{x:t?.x,y:t?.y,z:t?.z}}})}let{leaf:p,single:m,others:h}=e.centripetalOptions||{};p&&typeof p!=`function`&&(e.centripetalOptions.leaf=()=>p),m&&typeof m!=`function`&&(e.centripetalOptions.single=()=>m),h&&typeof h!=`function`&&(e.centripetalOptions.others=()=>h)}runOneStep(e,t,n,r,i){let a={},o=e.getAllNodes(),s=e.getAllEdges();if(!o?.length)return;let{monitor:c}=i;if(this.calRepulsive(e,a,i),s&&this.calAttractive(e,a,i),this.calGravity(e,t,a,i),this.updateVelocity(e,a,r,i),c){let e=this.calTotalEnergy(a,o);c({energy:e,nodes:t.getAllNodes(),edges:t.getAllEdges(),iterations:n})}}calTotalEnergy(e,t){if(!t?.length)return 0;let n=0;return t.forEach((t,r)=>{let i=e[t.id].x,a=e[t.id].y,o=this.options.dimensions===3?e[t.id].z:0,s=i*i+a*a+o*o,{mass:c=1}=t.data;n+=c*s*.5}),n}calRepulsive(e,t,n){let{dimensions:r,factor:i,coulombDisScale:a}=n;BN(e,i,a*a,t,r)}calAttractive(e,t,n){let{dimensions:r,nodeSize:i}=n;e.getAllEdges().forEach((n,a)=>{let{source:o,target:s}=n,c=e.getNode(o),l=e.getNode(s);if(!c||!l)return;let u=l.data.x-c.data.x,d=l.data.y-c.data.y,f=r===3?l.data.z-c.data.z:0;!u&&!d&&(u=Math.random()*.01,d=Math.random()*.01,r===3&&!f&&(f=Math.random()*.01));let p=Math.sqrt(u*u+d*d+f*f);if(p<i(c)+i(l))return;let m=u/p,h=d/p,g=f/p,{linkDistance:_=200,edgeStrength:v=200}=n.data||{},y=(_-p)*v,b=c.data.mass||1,x=l.data.mass||1,S=1/b,C=1/x,w=m*y,T=h*y,E=g*y;t[o].x-=w*S,t[o].y-=T*S,t[o].z-=E*S,t[s].x+=w*C,t[s].y+=T*C,t[s].z+=E*C})}calGravity(e,t,n,r){let{getCenter:i}=r,a=e.getAllNodes(),o=t.getAllNodes(),s=t.getAllEdges(),{width:c,height:l,center:u,gravity:d,centripetalOptions:f}=r;a&&a.forEach(r=>{let{id:a,data:p}=r,{mass:m,x:h,y:g,z:_}=p,v=t.getNode(a),y=0,b=0,x=0,S=d,C=e.getDegree(a,`in`),w=e.getDegree(a,`out`),T=e.getDegree(a,`both`),E=i?.(v,T);if(E){let[e,t,n]=E;y=h-e,b=g-t,S=n}else y=h-u[0],b=g-u[1],x=_-u[2];if(S&&(n[a].x-=S*y/m,n[a].y-=S*b/m,n[a].z-=S*x/m),f){let{leaf:e,single:t,others:r,center:i}=f,{x:u,y:d,z:p,centerStrength:y}=i?.(v,o,s,c,l)||{x:0,y:0,z:0,centerStrength:0};if(!G(u)||!G(d))return;let b=(h-u)/m,x=(g-d)/m,S=(_-p)/m;if(y&&(n[a].x-=y*b,n[a].y-=y*x,n[a].z-=y*S),T===0){let e=t(v);if(!e)return;n[a].x-=e*b,n[a].y-=e*x,n[a].z-=e*S;return}if(C===0||w===0){let t=e(v,o,s);if(!t)return;n[a].x-=t*b,n[a].y-=t*x,n[a].z-=t*S;return}let E=r(v);if(!E)return;n[a].x-=E*b,n[a].y-=E*x,n[a].z-=E*S}})}updateVelocity(e,t,n,r){let{damping:i,maxSpeed:a,interval:o,dimensions:s}=r,c=e.getAllNodes();c?.length&&c.forEach(e=>{let{id:r}=e,c=(n[r].x+t[r].x*o)*i||.01,l=(n[r].y+t[r].y*o)*i||.01,u=s===3?(n[r].z+t[r].z*o)*i||.01:0,d=Math.sqrt(c*c+l*l+u*u);if(d>a){let e=a/d;c=e*c,l=e*l,u=e*u}n[r]={x:c,y:l,z:u}})}updatePosition(e,t,n,r){let{distanceThresholdMode:i,interval:a,dimensions:o}=r,s=t.getAllNodes();if(!s?.length){this.judgingDistance=0;return}let c=0;i===`max`?this.judgingDistance=-1/0:i===`min`&&(this.judgingDistance=1/0),s.forEach(r=>{let{id:s}=r,l=e.getNode(s);if(G(l.data.fx)&&G(l.data.fy)){t.mergeNodeData(s,{x:l.data.fx,y:l.data.fy,z:o===3?l.data.fz:void 0});return}let u=n[s].x*a,d=n[s].y*a,f=o===3?n[s].z*a:0;t.mergeNodeData(s,{x:r.data.x+u,y:r.data.y+d,z:r.data.z+f});let p=Math.sqrt(u*u+d*d+f*f);switch(i){case`max`:this.judgingDistance<p&&(this.judgingDistance=p);break;case`min`:this.judgingDistance>p&&(this.judgingDistance=p);break;default:c+=p;break}}),(!i||i===`mean`)&&(this.judgingDistance=c/s.length)}},KN=(e,t)=>{let n=e.getAllNodes();if(!n?.length)return{};let r={};return n.forEach((n,i)=>{e.getDegree(n.id,`both`)===1&&(r[n.id]=qN(e,`leaf`,n,t))}),r},qN=(e,t,n,r)=>{let i=e.getDegree(n.id,`in`),a=e.getDegree(n.id,`out`),o=n,s=[];i===0?(o=e.getSuccessors(n.id)[0],s=e.getNeighbors(o.id)):a===0&&(o=e.getPredecessors(n.id)[0],s=e.getNeighbors(o.id)),s=s.filter(t=>e.getDegree(t.id,`in`)===0||e.getDegree(t.id,`out`)===0);let c=JN(e,t,r,n,s);return{coreNode:o,siblingLeaves:s,sameTypeLeaves:c}},JN=(e,t,n,r,i)=>{let a=r.data[n]||``,o=i?.filter(e=>e.data[n]===a)||[];return t===`leaf`&&(o=o.filter(t=>e.getDegree(t.id,`in`)===0||e.getDegree(t.id,`out`)===0)),o},YN=e=>{let t={x:0,y:0};e.forEach(e=>{let{x:n,y:r}=e.data;t.x+=n||0,t.y+=r||0});let n=e.length||1;return{x:t.x/n,y:t.y/n}},XN=(e,t)=>t.map(t=>{let{id:n,data:r}=t,i=e.getNode(n);return Object.assign(Object.assign({},i),{data:Object.assign(Object.assign({},i.data),{x:r.x,y:r.y,z:r.z})})}),ZN=n({isAnyArray:()=>QN});function QN(e){let t=$N.call(e);return t.endsWith(`Array]`)&&!t.includes(`Big`)}var $N,eP=a((()=>{$N=Object.prototype.toString}));function tP(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QN(e))throw TypeError(`input must be an array`);if(e.length===0)throw TypeError(`input must not be empty`);var n=t.fromIndex,r=n===void 0?0:n,i=t.toIndex,a=i===void 0?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw Error(`fromIndex must be a positive integer smaller than length`);if(a<=r||a>e.length||!Number.isInteger(a))throw Error(`toIndex must be an integer greater than fromIndex and at most equal to length`);for(var o=e[r],s=r+1;s<a;s++)e[s]>o&&(o=e[s]);return o}var nP=a((()=>{eP()}));function rP(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!QN(e))throw TypeError(`input must be an array`);if(e.length===0)throw TypeError(`input must not be empty`);var n=t.fromIndex,r=n===void 0?0:n,i=t.toIndex,a=i===void 0?e.length:i;if(r<0||r>=e.length||!Number.isInteger(r))throw Error(`fromIndex must be a positive integer smaller than length`);if(a<=r||a>e.length||!Number.isInteger(a))throw Error(`toIndex must be an integer greater than fromIndex and at most equal to length`);for(var o=e[r],s=r+1;s<a;s++)e[s]<o&&(o=e[s]);return o}var iP=a((()=>{eP()})),aP=n({default:()=>oP});function oP(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(QN(e)){if(e.length===0)throw TypeError(`input must not be empty`)}else throw TypeError(`input must be an array`);var n;if(t.output!==void 0){if(!QN(t.output))throw TypeError(`output option must be an array if specified`);n=t.output}else n=Array(e.length);var r=rP(e),i=tP(e);if(r===i)throw RangeError(`minimum and maximum input values are equal. Cannot rescale a constant array`);var a=t.min,o=a===void 0?t.autoMinMax?r:0:a,s=t.max,c=s===void 0?t.autoMinMax?i:1:s;if(o>=c)throw RangeError(`min option must be smaller than max option`);for(var l=(c-o)/(i-r),u=0;u<e.length;u++)n[u]=(e[u]-r)*l+o;return n}var sP=a((()=>{eP(),nP(),iP()})),cP=t(r((exports=>{Object.defineProperty(exports,`__esModule`,{value:!0});var t=(eP(),i(ZN)),n=(sP(),i(aP)),r=` `.repeat(2),a=` `.repeat(4);function o(){return s(this)}function s(e,t={}){let{maxRows:n=15,maxColumns:i=10,maxNumSize:o=8,padMinus:s=`auto`}=t;return`${e.constructor.name} {
${r}[
${a}${c(e,n,i,o,s)}
${r}]
${r}rows: ${e.rows}
${r}columns: ${e.columns}
}`}function c(e,t,n,r,i){let{rows:o,columns:s}=e,c=Math.min(o,t),u=Math.min(s,n),d=[];if(i===`auto`){i=!1;loop:for(let t=0;t<c;t++)for(let n=0;n<u;n++)if(e.get(t,n)<0){i=!0;break loop}}for(let t=0;t<c;t++){let n=[];for(let a=0;a<u;a++)n.push(l(e.get(t,a),r,i));d.push(`${n.join(` `)}`)}return u!==s&&(d[d.length-1]+=` ... ${s-n} more columns`),c!==o&&d.push(`... ${o-t} more rows`),d.join(`\n${a}`)}function l(e,t,n){return(e>=0&&n?` ${u(e,t-1)}`:u(e,t)).padEnd(t)}function u(e,t){let n=e.toString();if(n.length<=t)return n;let r=e.toFixed(t);if(r.length>t&&(r=e.toFixed(Math.max(0,t-(r.length-t)))),r.length<=t&&!r.startsWith(`0.000`)&&!r.startsWith(`-0.000`))return r;let i=e.toExponential(t);return i.length>t&&(i=e.toExponential(Math.max(0,t-(i.length-t)))),i.slice(0)}function d(e,t){e.prototype.add=function(e){return typeof e==`number`?this.addS(e):this.addM(e)},e.prototype.addS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e);return this},e.prototype.addM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e.get(t,n));return this},e.add=function(e,n){return new t(e).add(n)},e.prototype.sub=function(e){return typeof e==`number`?this.subS(e):this.subM(e)},e.prototype.subS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e);return this},e.prototype.subM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e.get(t,n));return this},e.sub=function(e,n){return new t(e).sub(n)},e.prototype.subtract=e.prototype.sub,e.prototype.subtractS=e.prototype.subS,e.prototype.subtractM=e.prototype.subM,e.subtract=e.sub,e.prototype.mul=function(e){return typeof e==`number`?this.mulS(e):this.mulM(e)},e.prototype.mulS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e);return this},e.prototype.mulM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e.get(t,n));return this},e.mul=function(e,n){return new t(e).mul(n)},e.prototype.multiply=e.prototype.mul,e.prototype.multiplyS=e.prototype.mulS,e.prototype.multiplyM=e.prototype.mulM,e.multiply=e.mul,e.prototype.div=function(e){return typeof e==`number`?this.divS(e):this.divM(e)},e.prototype.divS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e);return this},e.prototype.divM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e.get(t,n));return this},e.div=function(e,n){return new t(e).div(n)},e.prototype.divide=e.prototype.div,e.prototype.divideS=e.prototype.divS,e.prototype.divideM=e.prototype.divM,e.divide=e.div,e.prototype.mod=function(e){return typeof e==`number`?this.modS(e):this.modM(e)},e.prototype.modS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e);return this},e.prototype.modM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)%e.get(t,n));return this},e.mod=function(e,n){return new t(e).mod(n)},e.prototype.modulus=e.prototype.mod,e.prototype.modulusS=e.prototype.modS,e.prototype.modulusM=e.prototype.modM,e.modulus=e.mod,e.prototype.and=function(e){return typeof e==`number`?this.andS(e):this.andM(e)},e.prototype.andS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e);return this},e.prototype.andM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)&e.get(t,n));return this},e.and=function(e,n){return new t(e).and(n)},e.prototype.or=function(e){return typeof e==`number`?this.orS(e):this.orM(e)},e.prototype.orS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e);return this},e.prototype.orM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)|e.get(t,n));return this},e.or=function(e,n){return new t(e).or(n)},e.prototype.xor=function(e){return typeof e==`number`?this.xorS(e):this.xorM(e)},e.prototype.xorS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e);return this},e.prototype.xorM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)^e.get(t,n));return this},e.xor=function(e,n){return new t(e).xor(n)},e.prototype.leftShift=function(e){return typeof e==`number`?this.leftShiftS(e):this.leftShiftM(e)},e.prototype.leftShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e);return this},e.prototype.leftShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)<<e.get(t,n));return this},e.leftShift=function(e,n){return new t(e).leftShift(n)},e.prototype.signPropagatingRightShift=function(e){return typeof e==`number`?this.signPropagatingRightShiftS(e):this.signPropagatingRightShiftM(e)},e.prototype.signPropagatingRightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e);return this},e.prototype.signPropagatingRightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>e.get(t,n));return this},e.signPropagatingRightShift=function(e,n){return new t(e).signPropagatingRightShift(n)},e.prototype.rightShift=function(e){return typeof e==`number`?this.rightShiftS(e):this.rightShiftM(e)},e.prototype.rightShiftS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e);return this},e.prototype.rightShiftM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)>>>e.get(t,n));return this},e.rightShift=function(e,n){return new t(e).rightShift(n)},e.prototype.zeroFillRightShift=e.prototype.rightShift,e.prototype.zeroFillRightShiftS=e.prototype.rightShiftS,e.prototype.zeroFillRightShiftM=e.prototype.rightShiftM,e.zeroFillRightShift=e.rightShift,e.prototype.not=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,~this.get(e,t));return this},e.not=function(e){return new t(e).not()},e.prototype.abs=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.abs(this.get(e,t)));return this},e.abs=function(e){return new t(e).abs()},e.prototype.acos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acos(this.get(e,t)));return this},e.acos=function(e){return new t(e).acos()},e.prototype.acosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.acosh(this.get(e,t)));return this},e.acosh=function(e){return new t(e).acosh()},e.prototype.asin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asin(this.get(e,t)));return this},e.asin=function(e){return new t(e).asin()},e.prototype.asinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.asinh(this.get(e,t)));return this},e.asinh=function(e){return new t(e).asinh()},e.prototype.atan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atan(this.get(e,t)));return this},e.atan=function(e){return new t(e).atan()},e.prototype.atanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.atanh(this.get(e,t)));return this},e.atanh=function(e){return new t(e).atanh()},e.prototype.cbrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cbrt(this.get(e,t)));return this},e.cbrt=function(e){return new t(e).cbrt()},e.prototype.ceil=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.ceil(this.get(e,t)));return this},e.ceil=function(e){return new t(e).ceil()},e.prototype.clz32=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.clz32(this.get(e,t)));return this},e.clz32=function(e){return new t(e).clz32()},e.prototype.cos=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cos(this.get(e,t)));return this},e.cos=function(e){return new t(e).cos()},e.prototype.cosh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.cosh(this.get(e,t)));return this},e.cosh=function(e){return new t(e).cosh()},e.prototype.exp=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.exp(this.get(e,t)));return this},e.exp=function(e){return new t(e).exp()},e.prototype.expm1=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.expm1(this.get(e,t)));return this},e.expm1=function(e){return new t(e).expm1()},e.prototype.floor=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.floor(this.get(e,t)));return this},e.floor=function(e){return new t(e).floor()},e.prototype.fround=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.fround(this.get(e,t)));return this},e.fround=function(e){return new t(e).fround()},e.prototype.log=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log(this.get(e,t)));return this},e.log=function(e){return new t(e).log()},e.prototype.log1p=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log1p(this.get(e,t)));return this},e.log1p=function(e){return new t(e).log1p()},e.prototype.log10=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log10(this.get(e,t)));return this},e.log10=function(e){return new t(e).log10()},e.prototype.log2=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.log2(this.get(e,t)));return this},e.log2=function(e){return new t(e).log2()},e.prototype.round=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.round(this.get(e,t)));return this},e.round=function(e){return new t(e).round()},e.prototype.sign=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sign(this.get(e,t)));return this},e.sign=function(e){return new t(e).sign()},e.prototype.sin=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sin(this.get(e,t)));return this},e.sin=function(e){return new t(e).sin()},e.prototype.sinh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sinh(this.get(e,t)));return this},e.sinh=function(e){return new t(e).sinh()},e.prototype.sqrt=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.sqrt(this.get(e,t)));return this},e.sqrt=function(e){return new t(e).sqrt()},e.prototype.tan=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tan(this.get(e,t)));return this},e.tan=function(e){return new t(e).tan()},e.prototype.tanh=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.tanh(this.get(e,t)));return this},e.tanh=function(e){return new t(e).tanh()},e.prototype.trunc=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)this.set(e,t,Math.trunc(this.get(e,t)));return this},e.trunc=function(e){return new t(e).trunc()},e.pow=function(e,n){return new t(e).pow(n)},e.prototype.pow=function(e){return typeof e==`number`?this.powS(e):this.powM(e)},e.prototype.powS=function(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)**e);return this},e.prototype.powM=function(e){if(e=t.checkMatrix(e),this.rows!==e.rows||this.columns!==e.columns)throw RangeError(`Matrices dimensions must be equal`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)**e.get(t,n));return this}}function f(e,t,n){let r=n?e.rows:e.rows-1;if(t<0||t>r)throw RangeError(`Row index out of range`)}function p(e,t,n){let r=n?e.columns:e.columns-1;if(t<0||t>r)throw RangeError(`Column index out of range`)}function m(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw RangeError(`vector size must be the same as the number of columns`);return t}function h(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw RangeError(`vector size must be the same as the number of rows`);return t}function g(e,n){if(!t.isAnyArray(n))throw TypeError(`row indices must be an array`);for(let t=0;t<n.length;t++)if(n[t]<0||n[t]>=e.rows)throw RangeError(`row indices are out of range`)}function _(e,n){if(!t.isAnyArray(n))throw TypeError(`column indices must be an array`);for(let t=0;t<n.length;t++)if(n[t]<0||n[t]>=e.columns)throw RangeError(`column indices are out of range`)}function v(e,t,n,r,i){if(arguments.length!==5)throw RangeError(`expected 4 arguments`);if(b(`startRow`,t),b(`endRow`,n),b(`startColumn`,r),b(`endColumn`,i),t>n||r>i||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||i<0||i>=e.columns)throw RangeError(`Submatrix indices are out of range`)}function y(e,t=0){let n=[];for(let r=0;r<e;r++)n.push(t);return n}function b(e,t){if(typeof t!=`number`)throw TypeError(`${e} must be a number`)}function x(e){if(e.isEmpty())throw Error(`Empty matrix has no elements to index`)}function S(e){let t=y(e.rows);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]+=e.get(n,r);return t}function C(e){let t=y(e.columns);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]+=e.get(n,r);return t}function w(e){let t=0;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t+=e.get(n,r);return t}function T(e){let t=y(e.rows,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[n]*=e.get(n,r);return t}function E(e){let t=y(e.columns,1);for(let n=0;n<e.rows;++n)for(let r=0;r<e.columns;++r)t[r]*=e.get(n,r);return t}function D(e){let t=1;for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)t*=e.get(n,r);return t}function O(e,t,n){let r=e.rows,i=e.columns,a=[];for(let o=0;o<r;o++){let r=0,s=0,c=0;for(let t=0;t<i;t++)c=e.get(o,t)-n[o],r+=c,s+=c*c;t?a.push((s-r*r/i)/(i-1)):a.push((s-r*r/i)/i)}return a}function k(e,t,n){let r=e.rows,i=e.columns,a=[];for(let o=0;o<i;o++){let i=0,s=0,c=0;for(let t=0;t<r;t++)c=e.get(t,o)-n[o],i+=c,s+=c*c;t?a.push((s-i*i/r)/(r-1)):a.push((s-i*i/r)/r)}return a}function A(e,t,n){let r=e.rows,i=e.columns,a=r*i,o=0,s=0,c=0;for(let t=0;t<r;t++)for(let r=0;r<i;r++)c=e.get(t,r)-n,o+=c,s+=c*c;return t?(s-o*o/a)/(a-1):(s-o*o/a)/a}function j(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[n])}function ee(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t[r])}function te(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)-t)}function M(e){let t=[];for(let n=0;n<e.rows;n++){let r=0;for(let t=0;t<e.columns;t++)r+=e.get(n,t)**2/(e.columns-1);t.push(Math.sqrt(r))}return t}function ne(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[n])}function re(e){let t=[];for(let n=0;n<e.columns;n++){let r=0;for(let t=0;t<e.rows;t++)r+=e.get(t,n)**2/(e.rows-1);t.push(Math.sqrt(r))}return t}function ie(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t[r])}function ae(e){let t=e.size-1,n=0;for(let r=0;r<e.columns;r++)for(let i=0;i<e.rows;i++)n+=e.get(i,r)**2/t;return Math.sqrt(n)}function oe(e,t){for(let n=0;n<e.rows;n++)for(let r=0;r<e.columns;r++)e.set(n,r,e.get(n,r)/t)}var se=class e{static from1DArray(e,t,n){if(e*t!==n.length)throw RangeError(`data length does not match given dimensions`);let r=new N(e,t);for(let i=0;i<e;i++)for(let e=0;e<t;e++)r.set(i,e,n[i*t+e]);return r}static rowVector(e){let t=new N(1,e.length);for(let n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){let t=new N(e.length,1);for(let n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static zeros(e,t){return new N(e,t)}static ones(e,t){return new N(e,t).fill(1)}static rand(e,t,n={}){if(typeof n!=`object`)throw TypeError(`options must be an object`);let{random:r=Math.random}=n,i=new N(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++)i.set(n,e,r());return i}static randInt(e,t,n={}){if(typeof n!=`object`)throw TypeError(`options must be an object`);let{min:r=0,max:i=1e3,random:a=Math.random}=n;if(!Number.isInteger(r))throw TypeError(`min must be an integer`);if(!Number.isInteger(i))throw TypeError(`max must be an integer`);if(r>=i)throw RangeError(`min must be smaller than max`);let o=i-r,s=new N(e,t);for(let n=0;n<e;n++)for(let e=0;e<t;e++){let t=r+Math.round(a()*o);s.set(n,e,t)}return s}static eye(e,t,n){t===void 0&&(t=e),n===void 0&&(n=1);let r=Math.min(e,t),i=this.zeros(e,t);for(let e=0;e<r;e++)i.set(e,e,n);return i}static diag(e,t,n){let r=e.length;t===void 0&&(t=r),n===void 0&&(n=t);let i=Math.min(r,t,n),a=this.zeros(t,n);for(let t=0;t<i;t++)a.set(t,t,e[t]);return a}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,i=new N(n,r);for(let a=0;a<n;a++)for(let n=0;n<r;n++)i.set(a,n,Math.min(e.get(a,n),t.get(a,n)));return i}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);let n=e.rows,r=e.columns,i=new this(n,r);for(let a=0;a<n;a++)for(let n=0;n<r;n++)i.set(a,n,Math.max(e.get(a,n),t.get(a,n)));return i}static checkMatrix(t){return e.isMatrix(t)?t:new N(t)}static isMatrix(e){return e!=null&&e.klass===`Matrix`}get size(){return this.rows*this.columns}apply(e){if(typeof e!=`function`)throw TypeError(`callback must be a function`);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.call(this,t,n);return this}to1DArray(){let e=[];for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.push(this.get(t,n));return e}to2DArray(){let e=[];for(let t=0;t<this.rows;t++){e.push([]);for(let n=0;n<this.columns;n++)e[t].push(this.get(t,n))}return e}toJSON(){return this.to2DArray()}isRowVector(){return this.rows===1}isColumnVector(){return this.columns===1}isVector(){return this.rows===1||this.columns===1}isSquare(){return this.rows===this.columns}isEmpty(){return this.rows===0||this.columns===0}isSymmetric(){if(this.isSquare()){for(let e=0;e<this.rows;e++)for(let t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let e=0;e<this.rows;e++)if(this.get(e,e)!==0)return!1;return!0}isEchelonForm(){let e=0,t=0,n=-1,r=!0,i=!1;for(;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&i===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>n?(i=!0,n=t):(r=!1,i=!0);e++}return r}isReducedEchelonForm(){let e=0,t=0,n=-1,r=!0,i=!1;for(;e<this.rows&&r;){for(t=0,i=!1;t<this.columns&&i===!1;)this.get(e,t)===0?t++:this.get(e,t)===1&&t>n?(i=!0,n=t):(r=!1,i=!0);for(let n=t+1;n<this.rows;n++)this.get(e,n)!==0&&(r=!1);e++}return r}echelonForm(){let e=this.clone(),t=0,n=0;for(;t<e.rows&&n<e.columns;){let r=t;for(let i=t;i<e.rows;i++)e.get(i,n)>e.get(r,n)&&(r=i);if(e.get(r,n)===0)n++;else{e.swapRows(t,r);let i=e.get(t,n);for(let r=n;r<e.columns;r++)e.set(t,r,e.get(t,r)/i);for(let r=t+1;r<e.rows;r++){let i=e.get(r,n)/e.get(t,n);e.set(r,n,0);for(let a=n+1;a<e.columns;a++)e.set(r,a,e.get(r,a)-e.get(t,a)*i)}t++,n++}}return e}reducedEchelonForm(){let e=this.echelonForm(),t=e.columns,n=e.rows,r=n-1;for(;r>=0;)if(e.maxRow(r)===0)r--;else{let i=0,a=!1;for(;i<n&&a===!1;)e.get(r,i)===1?a=!0:i++;for(let n=0;n<r;n++){let a=e.get(n,i);for(let o=i;o<t;o++){let t=e.get(n,o)-a*e.get(r,o);e.set(n,o,t)}}r--}return e}set(){throw Error(`set method is unimplemented`)}get(){throw Error(`get method is unimplemented`)}repeat(e={}){if(typeof e!=`object`)throw TypeError(`options must be an object`);let{rows:t=1,columns:n=1}=e;if(!Number.isInteger(t)||t<=0)throw TypeError(`rows must be a positive integer`);if(!Number.isInteger(n)||n<=0)throw TypeError(`columns must be a positive integer`);let r=new N(this.rows*t,this.columns*n);for(let e=0;e<t;e++)for(let t=0;t<n;t++)r.setSubMatrix(this,this.rows*e,this.columns*t);return r}fill(e){for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){f(this,e);let t=[];for(let n=0;n<this.columns;n++)t.push(this.get(e,n));return t}getRowVector(e){return N.rowVector(this.getRow(e))}setRow(e,t){f(this,e),t=m(this,t);for(let n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){f(this,e),f(this,t);for(let n=0;n<this.columns;n++){let r=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,r)}return this}getColumn(e){p(this,e);let t=[];for(let n=0;n<this.rows;n++)t.push(this.get(n,e));return t}getColumnVector(e){return N.columnVector(this.getColumn(e))}setColumn(e,t){p(this,e),t=h(this,t);for(let n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){p(this,e),p(this,t);for(let n=0;n<this.rows;n++){let r=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,r)}return this}addRowVector(e){e=m(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=m(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=m(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=m(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=h(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=h(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=h(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=h(this,e);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){f(this,e);for(let n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){p(this,e);for(let n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(e){if(this.isEmpty())return NaN;switch(e){case`row`:{let e=Array(this.rows).fill(-1/0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e[t]&&(e[t]=this.get(t,n));return e}case`column`:{let e=Array(this.columns).fill(-1/0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e[n]&&(e[n]=this.get(t,n));return e}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}default:throw Error(`invalid option: ${e}`)}}maxIndex(){x(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}min(e){if(this.isEmpty())return NaN;switch(e){case`row`:{let e=Array(this.rows).fill(1/0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e[t]&&(e[t]=this.get(t,n));return e}case`column`:{let e=Array(this.columns).fill(1/0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e[n]&&(e[n]=this.get(t,n));return e}case void 0:{let e=this.get(0,0);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}default:throw Error(`invalid option: ${e}`)}}minIndex(){x(this);let e=this.get(0,0),t=[0,0];for(let n=0;n<this.rows;n++)for(let r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}maxRow(e){if(f(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){f(this,e),x(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r),n[1]=r);return n}minRow(e){if(f(this,e),this.isEmpty())return NaN;let t=this.get(e,0);for(let n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){f(this,e),x(this);let t=this.get(e,0),n=[e,0];for(let r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r),n[1]=r);return n}maxColumn(e){if(p(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){p(this,e),x(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e),n[0]=r);return n}minColumn(e){if(p(this,e),this.isEmpty())return NaN;let t=this.get(0,e);for(let n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){p(this,e),x(this);let t=this.get(0,e),n=[0,e];for(let r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e),n[0]=r);return n}diag(){let e=Math.min(this.rows,this.columns),t=[];for(let n=0;n<e;n++)t.push(this.get(n,n));return t}norm(e=`frobenius`){switch(e){case`max`:return this.max();case`frobenius`:return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${e}`)}}cumulativeSum(){let e=0;for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(t){e.isMatrix(t)&&(t=t.to1DArray());let n=this.to1DArray();if(n.length!==t.length)throw RangeError(`vectors do not have the same size`);let r=0;for(let e=0;e<n.length;e++)r+=n[e]*t[e];return r}mmul(e){e=N.checkMatrix(e);let t=this.rows,n=this.columns,r=e.columns,i=new N(t,r),a=new Float64Array(n);for(let o=0;o<r;o++){for(let t=0;t<n;t++)a[t]=e.get(t,o);for(let e=0;e<t;e++){let t=0;for(let r=0;r<n;r++)t+=this.get(e,r)*a[r];i.set(e,o,t)}}return i}mpow(e){if(!this.isSquare())throw RangeError(`Matrix must be square`);if(!Number.isInteger(e)||e<0)throw RangeError(`Exponent must be a non-negative integer`);let t=N.eye(this.rows),n=this;for(let r=e;r>=1;r/=2)r&1&&(t=t.mmul(n)),n=n.mmul(n);return t}strassen2x2(e){e=N.checkMatrix(e);let t=new N(2,2),n=this.get(0,0),r=e.get(0,0),i=this.get(0,1),a=e.get(0,1),o=this.get(1,0),s=e.get(1,0),c=this.get(1,1),l=e.get(1,1),u=(n+c)*(r+l),d=(o+c)*r,f=n*(a-l),p=c*(s-r),m=(n+i)*l,h=(o-n)*(r+a),g=(i-c)*(s+l),_=u+p-m+g,v=f+m,y=d+p,b=u-d+f+h;return t.set(0,0,_),t.set(0,1,v),t.set(1,0,y),t.set(1,1,b),t}strassen3x3(e){e=N.checkMatrix(e);let t=new N(3,3),n=this.get(0,0),r=this.get(0,1),i=this.get(0,2),a=this.get(1,0),o=this.get(1,1),s=this.get(1,2),c=this.get(2,0),l=this.get(2,1),u=this.get(2,2),d=e.get(0,0),f=e.get(0,1),p=e.get(0,2),m=e.get(1,0),h=e.get(1,1),g=e.get(1,2),_=e.get(2,0),v=e.get(2,1),y=e.get(2,2),b=(n+r+i-a-o-l-u)*h,x=(n-a)*(-f+h),S=o*(-d+f+m-h-g-_+y),C=(-n+a+o)*(d-f+h),w=(a+o)*(-d+f),T=n*d,E=(-n+c+l)*(d-p+g),D=(-n+c)*(p-g),O=(c+l)*(-d+p),k=(n+r+i-o-s-c-l)*g,A=l*(-d+p+m-h-g-_+v),j=(-i+l+u)*(h+_-v),ee=(i-u)*(h-v),te=i*_,M=(l+u)*(-_+v),ne=(-i+o+s)*(g+_-y),re=(i-s)*(g-y),ie=(o+s)*(-_+y),ae=r*m,oe=s*v,se=a*p,ce=c*f,le=u*y,ue=T+te+ae,de=b+C+w+T+j+te+M,fe=T+E+O+k+te+ne+ie,pe=x+S+C+T+te+ne+re,me=x+C+w+T+oe,he=te+ne+re+ie+se,ge=T+E+D+A+j+ee+te,_e=j+ee+te+M+ce,ve=T+E+D+O+le;return t.set(0,0,ue),t.set(0,1,de),t.set(0,2,fe),t.set(1,0,pe),t.set(1,1,me),t.set(1,2,he),t.set(2,0,ge),t.set(2,1,_e),t.set(2,2,ve),t}mmulStrassen(t){t=N.checkMatrix(t);let n=this.clone(),r=n.rows,i=n.columns,a=t.rows,o=t.columns;i!==a&&console.warn(`Multiplying ${r} x ${i} and ${a} x ${o} matrix: dimensions do not match.`);function s(t,n,r){let i=t.rows,a=t.columns;if(i===n&&a===r)return t;{let i=e.zeros(n,r);return i=i.setSubMatrix(t,0,0),i}}let c=Math.max(r,a),l=Math.max(i,o);n=s(n,c,l),t=s(t,c,l);function u(t,n,r,i){if(r<=512||i<=512)return t.mmul(n);r%2==1&&i%2==1?(t=s(t,r+1,i+1),n=s(n,r+1,i+1)):r%2==1?(t=s(t,r+1,i),n=s(n,r+1,i)):i%2==1&&(t=s(t,r,i+1),n=s(n,r,i+1));let a=parseInt(t.rows/2,10),o=parseInt(t.columns/2,10),c=t.subMatrix(0,a-1,0,o-1),l=n.subMatrix(0,a-1,0,o-1),d=t.subMatrix(0,a-1,o,t.columns-1),f=n.subMatrix(0,a-1,o,n.columns-1),p=t.subMatrix(a,t.rows-1,0,o-1),m=n.subMatrix(a,n.rows-1,0,o-1),h=t.subMatrix(a,t.rows-1,o,t.columns-1),g=n.subMatrix(a,n.rows-1,o,n.columns-1),_=u(e.add(c,h),e.add(l,g),a,o),v=u(e.add(p,h),l,a,o),y=u(c,e.sub(f,g),a,o),b=u(h,e.sub(m,l),a,o),x=u(e.add(c,d),g,a,o),S=u(e.sub(p,c),e.add(l,f),a,o),C=u(e.sub(d,h),e.add(m,g),a,o),w=e.add(_,b);w.sub(x),w.add(C);let T=e.add(y,x),E=e.add(v,b),D=e.sub(_,v);D.add(y),D.add(S);let O=e.zeros(2*w.rows,2*w.columns);return O=O.setSubMatrix(w,0,0),O=O.setSubMatrix(T,w.rows,0),O=O.setSubMatrix(E,0,w.columns),O=O.setSubMatrix(D,w.rows,w.columns),O.subMatrix(0,r-1,0,i-1)}return u(n,t,c,l)}scaleRows(e={}){if(typeof e!=`object`)throw TypeError(`options must be an object`);let{min:t=0,max:r=1}=e;if(!Number.isFinite(t))throw TypeError(`min must be a number`);if(!Number.isFinite(r))throw TypeError(`max must be a number`);if(t>=r)throw RangeError(`min must be smaller than max`);let i=new N(this.rows,this.columns);for(let e=0;e<this.rows;e++){let a=this.getRow(e);a.length>0&&n(a,{min:t,max:r,output:a}),i.setRow(e,a)}return i}scaleColumns(e={}){if(typeof e!=`object`)throw TypeError(`options must be an object`);let{min:t=0,max:r=1}=e;if(!Number.isFinite(t))throw TypeError(`min must be a number`);if(!Number.isFinite(r))throw TypeError(`max must be a number`);if(t>=r)throw RangeError(`min must be smaller than max`);let i=new N(this.rows,this.columns);for(let e=0;e<this.columns;e++){let a=this.getColumn(e);a.length&&n(a,{min:t,max:r,output:a}),i.setColumn(e,a)}return i}flipRows(){let e=Math.ceil(this.columns/2);for(let t=0;t<this.rows;t++)for(let n=0;n<e;n++){let e=this.get(t,n),r=this.get(t,this.columns-1-n);this.set(t,n,r),this.set(t,this.columns-1-n,e)}return this}flipColumns(){let e=Math.ceil(this.rows/2);for(let t=0;t<this.columns;t++)for(let n=0;n<e;n++){let e=this.get(n,t),r=this.get(this.rows-1-n,t);this.set(n,t,r),this.set(this.rows-1-n,t,e)}return this}kroneckerProduct(e){e=N.checkMatrix(e);let t=this.rows,n=this.columns,r=e.rows,i=e.columns,a=new N(t*r,n*i);for(let o=0;o<t;o++)for(let t=0;t<n;t++)for(let n=0;n<r;n++)for(let s=0;s<i;s++)a.set(r*o+n,i*t+s,this.get(o,t)*e.get(n,s));return a}kroneckerSum(e){if(e=N.checkMatrix(e),!this.isSquare()||!e.isSquare())throw Error(`Kronecker Sum needs two Square Matrices`);let t=this.rows,n=e.rows,r=this.kroneckerProduct(N.eye(n,n)),i=N.eye(t,t).kroneckerProduct(e);return r.add(i)}transpose(){let e=new N(this.columns,this.rows);for(let t=0;t<this.rows;t++)for(let n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e=ce){for(let t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e=ce){for(let t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,r){v(this,e,t,n,r);let i=new N(t-e+1,r-n+1);for(let a=e;a<=t;a++)for(let t=n;t<=r;t++)i.set(a-e,t-n,this.get(a,t));return i}subMatrixRow(e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw RangeError(`Argument out of range`);let r=new N(e.length,n-t+1);for(let i=0;i<e.length;i++)for(let a=t;a<=n;a++){if(e[i]<0||e[i]>=this.rows)throw RangeError(`Row index out of range: ${e[i]}`);r.set(i,a-t,this.get(e[i],a))}return r}subMatrixColumn(e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw RangeError(`Argument out of range`);let r=new N(n-t+1,e.length);for(let i=0;i<e.length;i++)for(let a=t;a<=n;a++){if(e[i]<0||e[i]>=this.columns)throw RangeError(`Column index out of range: ${e[i]}`);r.set(a-t,i,this.get(a,e[i]))}return r}setSubMatrix(e,t,n){if(e=N.checkMatrix(e),e.isEmpty())return this;let r=t+e.rows-1,i=n+e.columns-1;v(this,t,r,n,i);for(let r=0;r<e.rows;r++)for(let i=0;i<e.columns;i++)this.set(t+r,n+i,e.get(r,i));return this}selection(e,t){g(this,e),_(this,t);let n=new N(e.length,t.length);for(let r=0;r<e.length;r++){let i=e[r];for(let e=0;e<t.length;e++){let a=t[e];n.set(r,e,this.get(i,a))}}return n}trace(){let e=Math.min(this.rows,this.columns),t=0;for(let n=0;n<e;n++)t+=this.get(n,n);return t}clone(){return this.constructor.copy(this,new N(this.rows,this.columns))}static copy(e,t){for(let[n,r,i]of e.entries())t.set(n,r,i);return t}sum(e){switch(e){case`row`:return S(this);case`column`:return C(this);case void 0:return w(this);default:throw Error(`invalid option: ${e}`)}}product(e){switch(e){case`row`:return T(this);case`column`:return E(this);case void 0:return D(this);default:throw Error(`invalid option: ${e}`)}}mean(e){let t=this.sum(e);switch(e){case`row`:for(let e=0;e<this.rows;e++)t[e]/=this.columns;return t;case`column`:for(let e=0;e<this.columns;e++)t[e]/=this.rows;return t;case void 0:return t/this.size;default:throw Error(`invalid option: ${e}`)}}variance(e,n={}){if(typeof e==`object`&&(n=e,e=void 0),typeof n!=`object`)throw TypeError(`options must be an object`);let{unbiased:r=!0,mean:i=this.mean(e)}=n;if(typeof r!=`boolean`)throw TypeError(`unbiased must be a boolean`);switch(e){case`row`:if(!t.isAnyArray(i))throw TypeError(`mean must be an array`);return O(this,r,i);case`column`:if(!t.isAnyArray(i))throw TypeError(`mean must be an array`);return k(this,r,i);case void 0:if(typeof i!=`number`)throw TypeError(`mean must be a number`);return A(this,r,i);default:throw Error(`invalid option: ${e}`)}}standardDeviation(e,t){typeof e==`object`&&(t=e,e=void 0);let n=this.variance(e,t);if(e===void 0)return Math.sqrt(n);for(let e=0;e<n.length;e++)n[e]=Math.sqrt(n[e]);return n}center(e,n={}){if(typeof e==`object`&&(n=e,e=void 0),typeof n!=`object`)throw TypeError(`options must be an object`);let{center:r=this.mean(e)}=n;switch(e){case`row`:if(!t.isAnyArray(r))throw TypeError(`center must be an array`);return j(this,r),this;case`column`:if(!t.isAnyArray(r))throw TypeError(`center must be an array`);return ee(this,r),this;case void 0:if(typeof r!=`number`)throw TypeError(`center must be a number`);return te(this,r),this;default:throw Error(`invalid option: ${e}`)}}scale(e,n={}){if(typeof e==`object`&&(n=e,e=void 0),typeof n!=`object`)throw TypeError(`options must be an object`);let r=n.scale;switch(e){case`row`:if(r===void 0)r=M(this);else if(!t.isAnyArray(r))throw TypeError(`scale must be an array`);return ne(this,r),this;case`column`:if(r===void 0)r=re(this);else if(!t.isAnyArray(r))throw TypeError(`scale must be an array`);return ie(this,r),this;case void 0:if(r===void 0)r=ae(this);else if(typeof r!=`number`)throw TypeError(`scale must be a number`);return oe(this,r),this;default:throw Error(`invalid option: ${e}`)}}toString(e){return s(this,e)}[Symbol.iterator](){return this.entries()}*entries(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield[e,t,this.get(e,t)]}*values(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.columns;t++)yield this.get(e,t)}};se.prototype.klass=`Matrix`,typeof Symbol<`u`&&(se.prototype[Symbol.for(`nodejs.util.inspect.custom`)]=o);function ce(e,t){return e-t}function le(e){return e.every(e=>typeof e==`number`)}se.random=se.rand,se.randomInt=se.randInt,se.diagonal=se.diag,se.prototype.diagonal=se.prototype.diag,se.identity=se.eye,se.prototype.negate=se.prototype.neg,se.prototype.tensorProduct=se.prototype.kroneckerProduct;var N=class e extends se{data;#initData(e,t){if(this.data=[],Number.isInteger(t)&&t>=0)for(let n=0;n<e;n++)this.data.push(new Float64Array(t));else throw TypeError(`nColumns must be a positive integer`);this.rows=e,this.columns=t}constructor(n,r){if(super(),e.isMatrix(n))this.#initData(n.rows,n.columns),e.copy(n,this);else if(Number.isInteger(n)&&n>=0)this.#initData(n,r);else if(t.isAnyArray(n)){let e=n;if(n=e.length,r=n?e[0].length:0,typeof r!=`number`)throw TypeError(`Data must be a 2D array with at least one element`);this.data=[];for(let t=0;t<n;t++){if(e[t].length!==r)throw RangeError(`Inconsistent array dimensions`);if(!le(e[t]))throw TypeError(`Input data contains non-numeric values`);this.data.push(Float64Array.from(e[t]))}this.rows=n,this.columns=r}else throw TypeError(`First argument must be a positive number or an array`)}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}removeRow(e){return f(this,e),this.data.splice(e,1),--this.rows,this}addRow(e,t){return t===void 0&&(t=e,e=this.rows),f(this,e,!0),t=Float64Array.from(m(this,t)),this.data.splice(e,0,t),this.rows+=1,this}removeColumn(e){p(this,e);for(let t=0;t<this.rows;t++){let n=new Float64Array(this.columns-1);for(let r=0;r<e;r++)n[r]=this.data[t][r];for(let r=e+1;r<this.columns;r++)n[r-1]=this.data[t][r];this.data[t]=n}return--this.columns,this}addColumn(e,t){t===void 0&&(t=e,e=this.columns),p(this,e,!0),t=h(this,t);for(let n=0;n<this.rows;n++){let r=new Float64Array(this.columns+1),i=0;for(;i<e;i++)r[i]=this.data[n][i];for(r[i++]=t[n];i<this.columns+1;i++)r[i]=this.data[n][i-1];this.data[n]=r}return this.columns+=1,this}};d(se,N);var ue=class e extends se{#matrix;get size(){return this.#matrix.size}get rows(){return this.#matrix.rows}get columns(){return this.#matrix.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(e){return N.isMatrix(e)&&e.klassType===`SymmetricMatrix`}static zeros(e){return new this(e)}static ones(e){return new this(e).fill(1)}constructor(e){if(super(),N.isMatrix(e)){if(!e.isSymmetric())throw TypeError(`not symmetric data`);this.#matrix=N.copy(e,new N(e.rows,e.rows))}else if(Number.isInteger(e)&&e>=0)this.#matrix=new N(e,e);else if(this.#matrix=new N(e),!this.isSymmetric())throw TypeError(`not symmetric data`)}clone(){let t=new e(this.diagonalSize);for(let[e,n,r]of this.upperRightEntries())t.set(e,n,r);return t}toMatrix(){return new N(this)}get(e,t){return this.#matrix.get(e,t)}set(e,t,n){return this.#matrix.set(e,t,n),this.#matrix.set(t,e,n),this}removeCross(e){return this.#matrix.removeRow(e),this.#matrix.removeColumn(e),this}addCross(e,t){t===void 0&&(t=e,e=this.diagonalSize);let n=t.slice();return n.splice(e,1),this.#matrix.addRow(e,n),this.#matrix.addColumn(e,t),this}applyMask(e){if(e.length!==this.diagonalSize)throw RangeError(`Mask size do not match with matrix size`);let t=[];for(let[n,r]of e.entries()){if(r)continue;t.push(n)}t.reverse();for(let e of t)this.removeCross(e);return this}toCompact(){let{diagonalSize:e}=this,t=Array(e*(e+1)/2);for(let n=0,r=0,i=0;i<t.length;i++)t[i]=this.get(r,n),++n>=e&&(n=++r);return t}static fromCompact(t){let n=t.length,r=(Math.sqrt(8*n+1)-1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);let i=new e(r);for(let e=0,a=0,o=0;o<n;o++)i.set(e,a,t[o]),++e>=r&&(e=++a);return i}*upperRightEntries(){for(let e=0,t=0;e<this.diagonalSize;){let n=this.get(e,t);yield[e,t,n],++t>=this.diagonalSize&&(t=++e)}}*upperRightValues(){for(let e=0,t=0;e<this.diagonalSize;)yield this.get(e,t),++t>=this.diagonalSize&&(t=++e)}};ue.prototype.klassType=`SymmetricMatrix`;var de=class e extends ue{static isDistanceMatrix(e){return ue.isSymmetricMatrix(e)&&e.klassSubType===`DistanceMatrix`}constructor(e){if(super(e),!this.isDistance())throw TypeError(`Provided arguments do no produce a distance matrix`)}set(e,t,n){return e===t&&(n=0),super.set(e,t,n)}addCross(e,t){return t===void 0&&(t=e,e=this.diagonalSize),t=t.slice(),t[e]=0,super.addCross(e,t)}toSymmetricMatrix(){return new ue(this)}clone(){let t=new e(this.diagonalSize);for(let[e,n,r]of this.upperRightEntries()){if(e===n)continue;t.set(e,n,r)}return t}toCompact(){let{diagonalSize:e}=this,t=(e-1)*e/2,n=Array(t);for(let t=1,r=0,i=0;i<n.length;i++)n[i]=this.get(r,t),++t>=e&&(t=++r+1);return n}static fromCompact(e){let t=e.length;if(t===0)return new this(0);let n=(Math.sqrt(8*t+1)+1)/2;if(!Number.isInteger(n))throw TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(e)}`);let r=new this(n);for(let i=1,a=0,o=0;o<t;o++)r.set(i,a,e[o]),++i>=n&&(i=++a+1);return r}};de.prototype.klassSubType=`DistanceMatrix`;var fe=class extends se{constructor(e,t,n){super(),this.matrix=e,this.rows=t,this.columns=n}},pe=class extends fe{constructor(e,t){p(e,t),super(e,e.rows,1),this.column=t}set(e,t,n){return this.matrix.set(e,this.column,n),this}get(e){return this.matrix.get(e,this.column)}},me=class extends fe{constructor(e,t){_(e,t),super(e,e.rows,t.length),this.columnIndices=t}set(e,t,n){return this.matrix.set(e,this.columnIndices[t],n),this}get(e,t){return this.matrix.get(e,this.columnIndices[t])}},he=class extends fe{constructor(e){super(e,e.rows,e.columns)}set(e,t,n){return this.matrix.set(e,this.columns-t-1,n),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}},ge=class extends fe{constructor(e){super(e,e.rows,e.columns)}set(e,t,n){return this.matrix.set(this.rows-e-1,t,n),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}},_e=class extends fe{constructor(e,t){f(e,t),super(e,1,e.columns),this.row=t}set(e,t,n){return this.matrix.set(this.row,t,n),this}get(e,t){return this.matrix.get(this.row,t)}},ve=class extends fe{constructor(e,t){g(e,t),super(e,t.length,e.columns),this.rowIndices=t}set(e,t,n){return this.matrix.set(this.rowIndices[e],t,n),this}get(e,t){return this.matrix.get(this.rowIndices[e],t)}},P=class extends fe{constructor(e,t,n){g(e,t),_(e,n),super(e,t.length,n.length),this.rowIndices=t,this.columnIndices=n}set(e,t,n){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],n),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}},ye=class extends fe{constructor(e,t,n,r,i){v(e,t,n,r,i),super(e,n-t+1,i-r+1),this.startRow=t,this.startColumn=r}set(e,t,n){return this.matrix.set(this.startRow+e,this.startColumn+t,n),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}},be=class extends fe{constructor(e){super(e,e.columns,e.rows)}set(e,t,n){return this.matrix.set(t,e,n),this}get(e,t){return this.matrix.get(t,e)}},xe=class extends se{constructor(e,t={}){let{rows:n=1}=t;if(e.length%n!==0)throw Error(`the data length is not divisible by the number of rows`);super(),this.rows=n,this.columns=e.length/n,this.data=e}set(e,t,n){let r=this._calculateIndex(e,t);return this.data[r]=n,this}get(e,t){let n=this._calculateIndex(e,t);return this.data[n]}_calculateIndex(e,t){return e*this.columns+t}},Se=class extends se{constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}};function Ce(e,n){if(t.isAnyArray(e))return e[0]&&t.isAnyArray(e[0])?new Se(e):new xe(e,n);throw Error(`the argument is not an array`)}var we=class{constructor(e){e=Se.checkMatrix(e);let t=e.clone(),n=t.rows,r=t.columns,i=new Float64Array(n),a=1,o,s,c,l,u,d,f,p,m;for(o=0;o<n;o++)i[o]=o;for(p=new Float64Array(n),s=0;s<r;s++){for(o=0;o<n;o++)p[o]=t.get(o,s);for(o=0;o<n;o++){for(m=Math.min(o,s),u=0,c=0;c<m;c++)u+=t.get(o,c)*p[c];p[o]-=u,t.set(o,s,p[o])}for(l=s,o=s+1;o<n;o++)Math.abs(p[o])>Math.abs(p[l])&&(l=o);if(l!==s){for(c=0;c<r;c++)d=t.get(l,c),t.set(l,c,t.get(s,c)),t.set(s,c,d);f=i[l],i[l]=i[s],i[s]=f,a=-a}if(s<n&&t.get(s,s)!==0)for(o=s+1;o<n;o++)t.set(o,s,t.get(o,s)/t.get(s,s))}this.LU=t,this.pivotVector=i,this.pivotSign=a}isSingular(){let e=this.LU,t=e.columns;for(let n=0;n<t;n++)if(e.get(n,n)===0)return!0;return!1}solve(e){e=N.checkMatrix(e);let t=this.LU;if(t.rows!==e.rows)throw Error(`Invalid matrix dimensions`);if(this.isSingular())throw Error(`LU matrix is singular`);let n=e.columns,r=e.subMatrixRow(this.pivotVector,0,n-1),i=t.columns,a,o,s;for(s=0;s<i;s++)for(a=s+1;a<i;a++)for(o=0;o<n;o++)r.set(a,o,r.get(a,o)-r.get(s,o)*t.get(a,s));for(s=i-1;s>=0;s--){for(o=0;o<n;o++)r.set(s,o,r.get(s,o)/t.get(s,s));for(a=0;a<s;a++)for(o=0;o<n;o++)r.set(a,o,r.get(a,o)-r.get(s,o)*t.get(a,s))}return r}get determinant(){let e=this.LU;if(!e.isSquare())throw Error(`Matrix must be square`);let t=this.pivotSign,n=e.columns;for(let r=0;r<n;r++)t*=e.get(r,r);return t}get lowerTriangularMatrix(){let e=this.LU,t=e.rows,n=e.columns,r=new N(t,n);for(let i=0;i<t;i++)for(let t=0;t<n;t++)i>t?r.set(i,t,e.get(i,t)):i===t?r.set(i,t,1):r.set(i,t,0);return r}get upperTriangularMatrix(){let e=this.LU,t=e.rows,n=e.columns,r=new N(t,n);for(let i=0;i<t;i++)for(let t=0;t<n;t++)i<=t?r.set(i,t,e.get(i,t)):r.set(i,t,0);return r}get pivotPermutationVector(){return Array.from(this.pivotVector)}};function Te(e,t){let n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):t===0?0:(n=e/t,Math.abs(t)*Math.sqrt(1+n*n))}var Ee=class{constructor(e){e=Se.checkMatrix(e);let t=e.clone(),n=e.rows,r=e.columns,i=new Float64Array(r),a,o,s,c;for(s=0;s<r;s++){let e=0;for(a=s;a<n;a++)e=Te(e,t.get(a,s));if(e!==0){for(t.get(s,s)<0&&(e=-e),a=s;a<n;a++)t.set(a,s,t.get(a,s)/e);for(t.set(s,s,t.get(s,s)+1),o=s+1;o<r;o++){for(c=0,a=s;a<n;a++)c+=t.get(a,s)*t.get(a,o);for(c=-c/t.get(s,s),a=s;a<n;a++)t.set(a,o,t.get(a,o)+c*t.get(a,s))}}i[s]=-e}this.QR=t,this.Rdiag=i}solve(e){e=N.checkMatrix(e);let t=this.QR,n=t.rows;if(e.rows!==n)throw Error(`Matrix row dimensions must agree`);if(!this.isFullRank())throw Error(`Matrix is rank deficient`);let r=e.columns,i=e.clone(),a=t.columns,o,s,c,l;for(c=0;c<a;c++)for(s=0;s<r;s++){for(l=0,o=c;o<n;o++)l+=t.get(o,c)*i.get(o,s);for(l=-l/t.get(c,c),o=c;o<n;o++)i.set(o,s,i.get(o,s)+l*t.get(o,c))}for(c=a-1;c>=0;c--){for(s=0;s<r;s++)i.set(c,s,i.get(c,s)/this.Rdiag[c]);for(o=0;o<c;o++)for(s=0;s<r;s++)i.set(o,s,i.get(o,s)-i.get(c,s)*t.get(o,c))}return i.subMatrix(0,a-1,0,r-1)}isFullRank(){let e=this.QR.columns;for(let t=0;t<e;t++)if(this.Rdiag[t]===0)return!1;return!0}get upperTriangularMatrix(){let e=this.QR,t=e.columns,n=new N(t,t),r,i;for(r=0;r<t;r++)for(i=0;i<t;i++)r<i?n.set(r,i,e.get(r,i)):r===i?n.set(r,i,this.Rdiag[r]):n.set(r,i,0);return n}get orthogonalMatrix(){let e=this.QR,t=e.rows,n=e.columns,r=new N(t,n),i,a,o,s;for(o=n-1;o>=0;o--){for(i=0;i<t;i++)r.set(i,o,0);for(r.set(o,o,1),a=o;a<n;a++)if(e.get(o,o)!==0){for(s=0,i=o;i<t;i++)s+=e.get(i,o)*r.get(i,a);for(s=-s/e.get(o,o),i=o;i<t;i++)r.set(i,a,r.get(i,a)+s*e.get(i,o))}}return r}},De=class{constructor(e,t={}){if(e=Se.checkMatrix(e),e.isEmpty())throw Error(`Matrix must be non-empty`);let n=e.rows,r=e.columns,{computeLeftSingularVectors:i=!0,computeRightSingularVectors:a=!0,autoTranspose:o=!1}=t,s=!!i,c=!!a,l=!1,u;if(n<r)if(!o)u=e.clone(),console.warn(`Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose`);else{u=e.transpose(),n=u.rows,r=u.columns,l=!0;let t=s;s=c,c=t}else u=e.clone();let d=Math.min(n,r),f=Math.min(n+1,r),p=new Float64Array(f),m=new N(n,d),h=new N(r,r),g=new Float64Array(r),_=new Float64Array(n),v=new Float64Array(f);for(let e=0;e<f;e++)v[e]=e;let y=Math.min(n-1,r),b=Math.max(0,Math.min(r-2,n)),x=Math.max(y,b);for(let e=0;e<x;e++){if(e<y){p[e]=0;for(let t=e;t<n;t++)p[e]=Te(p[e],u.get(t,e));if(p[e]!==0){u.get(e,e)<0&&(p[e]=-p[e]);for(let t=e;t<n;t++)u.set(t,e,u.get(t,e)/p[e]);u.set(e,e,u.get(e,e)+1)}p[e]=-p[e]}for(let t=e+1;t<r;t++){if(e<y&&p[e]!==0){let r=0;for(let i=e;i<n;i++)r+=u.get(i,e)*u.get(i,t);r=-r/u.get(e,e);for(let i=e;i<n;i++)u.set(i,t,u.get(i,t)+r*u.get(i,e))}g[t]=u.get(e,t)}if(s&&e<y)for(let t=e;t<n;t++)m.set(t,e,u.get(t,e));if(e<b){g[e]=0;for(let t=e+1;t<r;t++)g[e]=Te(g[e],g[t]);if(g[e]!==0){g[e+1]<0&&(g[e]=0-g[e]);for(let t=e+1;t<r;t++)g[t]/=g[e];g[e+1]+=1}if(g[e]=-g[e],e+1<n&&g[e]!==0){for(let t=e+1;t<n;t++)_[t]=0;for(let t=e+1;t<n;t++)for(let n=e+1;n<r;n++)_[t]+=g[n]*u.get(t,n);for(let t=e+1;t<r;t++){let r=-g[t]/g[e+1];for(let i=e+1;i<n;i++)u.set(i,t,u.get(i,t)+r*_[i])}}if(c)for(let t=e+1;t<r;t++)h.set(t,e,g[t])}}let S=Math.min(r,n+1);if(y<r&&(p[y]=u.get(y,y)),n<S&&(p[S-1]=0),b+1<S&&(g[b]=u.get(b,S-1)),g[S-1]=0,s){for(let e=y;e<d;e++){for(let t=0;t<n;t++)m.set(t,e,0);m.set(e,e,1)}for(let e=y-1;e>=0;e--)if(p[e]!==0){for(let t=e+1;t<d;t++){let r=0;for(let i=e;i<n;i++)r+=m.get(i,e)*m.get(i,t);r=-r/m.get(e,e);for(let i=e;i<n;i++)m.set(i,t,m.get(i,t)+r*m.get(i,e))}for(let t=e;t<n;t++)m.set(t,e,-m.get(t,e));m.set(e,e,1+m.get(e,e));for(let t=0;t<e-1;t++)m.set(t,e,0)}else{for(let t=0;t<n;t++)m.set(t,e,0);m.set(e,e,1)}}if(c)for(let e=r-1;e>=0;e--){if(e<b&&g[e]!==0)for(let t=e+1;t<r;t++){let n=0;for(let i=e+1;i<r;i++)n+=h.get(i,e)*h.get(i,t);n=-n/h.get(e+1,e);for(let i=e+1;i<r;i++)h.set(i,t,h.get(i,t)+n*h.get(i,e))}for(let t=0;t<r;t++)h.set(t,e,0);h.set(e,e,1)}let C=S-1,w=2**-52;for(;S>0;){let e,t;for(e=S-2;e>=-1&&e!==-1;e--){let t=Number.MIN_VALUE+w*Math.abs(p[e]+Math.abs(p[e+1]));if(Math.abs(g[e])<=t||Number.isNaN(g[e])){g[e]=0;break}}if(e===S-2)t=4;else{let n;for(n=S-1;n>=e&&n!==e;n--){let t=(n===S?0:Math.abs(g[n]))+(n===e+1?0:Math.abs(g[n-1]));if(Math.abs(p[n])<=w*t){p[n]=0;break}}n===e?t=3:n===S-1?t=1:(t=2,e=n)}switch(e++,t){case 1:{let t=g[S-2];g[S-2]=0;for(let n=S-2;n>=e;n--){let i=Te(p[n],t),a=p[n]/i,o=t/i;if(p[n]=i,n!==e&&(t=-o*g[n-1],g[n-1]=a*g[n-1]),c)for(let e=0;e<r;e++)i=a*h.get(e,n)+o*h.get(e,S-1),h.set(e,S-1,-o*h.get(e,n)+a*h.get(e,S-1)),h.set(e,n,i)}break}case 2:{let t=g[e-1];g[e-1]=0;for(let r=e;r<S;r++){let i=Te(p[r],t),a=p[r]/i,o=t/i;if(p[r]=i,t=-o*g[r],g[r]=a*g[r],s)for(let t=0;t<n;t++)i=a*m.get(t,r)+o*m.get(t,e-1),m.set(t,e-1,-o*m.get(t,r)+a*m.get(t,e-1)),m.set(t,r,i)}break}case 3:{let t=Math.max(Math.abs(p[S-1]),Math.abs(p[S-2]),Math.abs(g[S-2]),Math.abs(p[e]),Math.abs(g[e])),i=p[S-1]/t,a=p[S-2]/t,o=g[S-2]/t,l=p[e]/t,u=g[e]/t,d=((a+i)*(a-i)+o*o)/2,f=i*o*(i*o),_=0;(d!==0||f!==0)&&(_=d<0?0-Math.sqrt(d*d+f):Math.sqrt(d*d+f),_=f/(d+_));let v=(l+i)*(l-i)+_,y=l*u;for(let t=e;t<S-1;t++){let i=Te(v,y);i===0&&(i=Number.MIN_VALUE);let a=v/i,o=y/i;if(t!==e&&(g[t-1]=i),v=a*p[t]+o*g[t],g[t]=a*g[t]-o*p[t],y=o*p[t+1],p[t+1]=a*p[t+1],c)for(let e=0;e<r;e++)i=a*h.get(e,t)+o*h.get(e,t+1),h.set(e,t+1,-o*h.get(e,t)+a*h.get(e,t+1)),h.set(e,t,i);if(i=Te(v,y),i===0&&(i=Number.MIN_VALUE),a=v/i,o=y/i,p[t]=i,v=a*g[t]+o*p[t+1],p[t+1]=-o*g[t]+a*p[t+1],y=o*g[t+1],g[t+1]=a*g[t+1],s&&t<n-1)for(let e=0;e<n;e++)i=a*m.get(e,t)+o*m.get(e,t+1),m.set(e,t+1,-o*m.get(e,t)+a*m.get(e,t+1)),m.set(e,t,i)}g[S-2]=v;break}case 4:if(p[e]<=0&&(p[e]=p[e]<0?-p[e]:0,c))for(let t=0;t<=C;t++)h.set(t,e,-h.get(t,e));for(;e<C&&!(p[e]>=p[e+1]);){let t=p[e];if(p[e]=p[e+1],p[e+1]=t,c&&e<r-1)for(let n=0;n<r;n++)t=h.get(n,e+1),h.set(n,e+1,h.get(n,e)),h.set(n,e,t);if(s&&e<n-1)for(let r=0;r<n;r++)t=m.get(r,e+1),m.set(r,e+1,m.get(r,e)),m.set(r,e,t);e++}S--;break}}if(l){let e=h;h=m,m=e}this.m=n,this.n=r,this.s=p,this.U=m,this.V=h}solve(e){let t=e,n=this.threshold,r=this.s.length,i=N.zeros(r,r);for(let e=0;e<r;e++)Math.abs(this.s[e])<=n?i.set(e,e,0):i.set(e,e,1/this.s[e]);let a=this.U,o=this.rightSingularVectors,s=o.mmul(i),c=o.rows,l=a.rows,u=N.zeros(c,l);for(let e=0;e<c;e++)for(let t=0;t<l;t++){let n=0;for(let i=0;i<r;i++)n+=s.get(e,i)*a.get(t,i);u.set(e,t,n)}return u.mmul(t)}solveForDiagonal(e){return this.solve(N.diag(e))}inverse(){let e=this.V,t=this.threshold,n=e.rows,r=e.columns,i=new N(n,this.s.length);for(let a=0;a<n;a++)for(let n=0;n<r;n++)Math.abs(this.s[n])>t&&i.set(a,n,e.get(a,n)/this.s[n]);let a=this.U,o=a.rows,s=a.columns,c=new N(n,o);for(let e=0;e<n;e++)for(let t=0;t<o;t++){let n=0;for(let r=0;r<s;r++)n+=i.get(e,r)*a.get(t,r);c.set(e,t,n)}return c}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let e=Math.max(this.m,this.n)*this.s[0]*2**-52,t=0,n=this.s;for(let r=0,i=n.length;r<i;r++)n[r]>e&&t++;return t}get diagonal(){return Array.from(this.s)}get threshold(){return 2**-52/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return N.diag(this.s)}};function Oe(e,t=!1){return e=Se.checkMatrix(e),t?new De(e).inverse():ke(e,N.eye(e.rows))}function ke(e,t,n=!1){return e=Se.checkMatrix(e),t=Se.checkMatrix(t),n?new De(e).solve(t):e.isSquare()?new we(e).solve(t):new Ee(e).solve(t)}function Ae(e){if(e=N.checkMatrix(e),e.isSquare()){if(e.columns===0)return 1;let t,n,r,i;if(e.columns===2)return t=e.get(0,0),n=e.get(0,1),r=e.get(1,0),i=e.get(1,1),t*i-n*r;if(e.columns===3){let i,a,o;return i=new P(e,[1,2],[1,2]),a=new P(e,[1,2],[0,2]),o=new P(e,[1,2],[0,1]),t=e.get(0,0),n=e.get(0,1),r=e.get(0,2),t*Ae(i)-n*Ae(a)+r*Ae(o)}else return new we(e).determinant}else throw Error(`determinant can only be calculated for a square matrix`)}function je(e,t){let n=[];for(let r=0;r<e;r++)r!==t&&n.push(r);return n}function Me(e,t,n,r=1e-9,i=1e-9){if(e>i)return Array(t.rows+1).fill(0);{let e=t.addRow(n,[0]);for(let t=0;t<e.rows;t++)Math.abs(e.get(t,0))<r&&e.set(t,0,0);return e.to1DArray()}}function Ne(e,t={}){let{thresholdValue:n=1e-9,thresholdError:r=1e-9}=t;e=N.checkMatrix(e);let i=e.rows,a=new N(i,i);for(let t=0;t<i;t++){let o=N.columnVector(e.getRow(t)),s=e.subMatrixRow(je(i,t)).transpose(),c=new De(s).solve(o),l=N.sub(o,s.mmul(c)).abs().max();a.setRow(t,Me(l,c,t,n,r))}return a}function Pe(e,t=2**-52){if(e=N.checkMatrix(e),e.isEmpty())return e.transpose();let n=new De(e,{autoTranspose:!0}),r=n.leftSingularVectors,i=n.rightSingularVectors,a=n.diagonal;for(let e=0;e<a.length;e++)Math.abs(a[e])>t?a[e]=1/a[e]:a[e]=0;return i.mmul(N.diag(a).mmul(r.transpose()))}function Fe(e,n=e,r={}){e=new N(e);let i=!1;if(typeof n==`object`&&!N.isMatrix(n)&&!t.isAnyArray(n)?(r=n,n=e,i=!0):n=new N(n),e.rows!==n.rows)throw TypeError(`Both matrices must have the same number of rows`);let{center:a=!0}=r;a&&(e=e.center(`column`),i||(n=n.center(`column`)));let o=e.transpose().mmul(n);for(let t=0;t<o.rows;t++)for(let n=0;n<o.columns;n++)o.set(t,n,o.get(t,n)*(1/(e.rows-1)));return o}function Ie(e,n=e,r={}){e=new N(e);let i=!1;if(typeof n==`object`&&!N.isMatrix(n)&&!t.isAnyArray(n)?(r=n,n=e,i=!0):n=new N(n),e.rows!==n.rows)throw TypeError(`Both matrices must have the same number of rows`);let{center:a=!0,scale:o=!0}=r;a&&(e.center(`column`),i||n.center(`column`)),o&&(e.scale(`column`),i||n.scale(`column`));let s=e.standardDeviation(`column`,{unbiased:!0}),c=i?s:n.standardDeviation(`column`,{unbiased:!0}),l=e.transpose().mmul(n);for(let t=0;t<l.rows;t++)for(let n=0;n<l.columns;n++)l.set(t,n,l.get(t,n)*(1/(s[t]*c[n]))*(1/(e.rows-1)));return l}var Le=class{constructor(e,t={}){let{assumeSymmetric:n=!1}=t;if(e=Se.checkMatrix(e),!e.isSquare())throw Error(`Matrix is not a square matrix`);if(e.isEmpty())throw Error(`Matrix must be non-empty`);let r=e.columns,i=new N(r,r),a=new Float64Array(r),o=new Float64Array(r),s=e,c,l,u=!1;if(u=n?!0:e.isSymmetric(),u){for(c=0;c<r;c++)for(l=0;l<r;l++)i.set(c,l,s.get(c,l));Re(r,o,a,i),ze(r,o,a,i)}else{let e=new N(r,r),t=new Float64Array(r);for(l=0;l<r;l++)for(c=0;c<r;c++)e.set(c,l,s.get(c,l));Be(r,e,t,i),Ve(r,o,a,i,e)}this.n=r,this.e=o,this.d=a,this.V=i}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let e=this.n,t=this.e,n=this.d,r=new N(e,e),i,a;for(i=0;i<e;i++){for(a=0;a<e;a++)r.set(i,a,0);r.set(i,i,n[i]),t[i]>0?r.set(i,i+1,t[i]):t[i]<0&&r.set(i,i-1,t[i])}return r}};function Re(e,t,n,r){let i,a,o,s,c,l,u,d;for(c=0;c<e;c++)n[c]=r.get(e-1,c);for(s=e-1;s>0;s--){for(d=0,o=0,l=0;l<s;l++)d+=Math.abs(n[l]);if(d===0)for(t[s]=n[s-1],c=0;c<s;c++)n[c]=r.get(s-1,c),r.set(s,c,0),r.set(c,s,0);else{for(l=0;l<s;l++)n[l]/=d,o+=n[l]*n[l];for(i=n[s-1],a=Math.sqrt(o),i>0&&(a=-a),t[s]=d*a,o-=i*a,n[s-1]=i-a,c=0;c<s;c++)t[c]=0;for(c=0;c<s;c++){for(i=n[c],r.set(c,s,i),a=t[c]+r.get(c,c)*i,l=c+1;l<=s-1;l++)a+=r.get(l,c)*n[l],t[l]+=r.get(l,c)*i;t[c]=a}for(i=0,c=0;c<s;c++)t[c]/=o,i+=t[c]*n[c];for(u=i/(o+o),c=0;c<s;c++)t[c]-=u*n[c];for(c=0;c<s;c++){for(i=n[c],a=t[c],l=c;l<=s-1;l++)r.set(l,c,r.get(l,c)-(i*t[l]+a*n[l]));n[c]=r.get(s-1,c),r.set(s,c,0)}}n[s]=o}for(s=0;s<e-1;s++){if(r.set(e-1,s,r.get(s,s)),r.set(s,s,1),o=n[s+1],o!==0){for(l=0;l<=s;l++)n[l]=r.get(l,s+1)/o;for(c=0;c<=s;c++){for(a=0,l=0;l<=s;l++)a+=r.get(l,s+1)*r.get(l,c);for(l=0;l<=s;l++)r.set(l,c,r.get(l,c)-a*n[l])}}for(l=0;l<=s;l++)r.set(l,s+1,0)}for(c=0;c<e;c++)n[c]=r.get(e-1,c),r.set(e-1,c,0);r.set(e-1,e-1,1),t[0]=0}function ze(e,t,n,r){let i,a,o,s,c,l,u,d,f,p,m,h,g,_,v,y;for(o=1;o<e;o++)t[o-1]=t[o];t[e-1]=0;let b=0,x=0,S=2**-52;for(l=0;l<e;l++){for(x=Math.max(x,Math.abs(n[l])+Math.abs(t[l])),u=l;u<e&&!(Math.abs(t[u])<=S*x);)u++;if(u>l)do{for(i=n[l],d=(n[l+1]-i)/(2*t[l]),f=Te(d,1),d<0&&(f=-f),n[l]=t[l]/(d+f),n[l+1]=t[l]*(d+f),p=n[l+1],a=i-n[l],o=l+2;o<e;o++)n[o]-=a;for(b+=a,d=n[u],m=1,h=m,g=m,_=t[l+1],v=0,y=0,o=u-1;o>=l;o--)for(g=h,h=m,y=v,i=m*t[o],a=m*d,f=Te(d,t[o]),t[o+1]=v*f,v=t[o]/f,m=d/f,d=m*n[o]-v*i,n[o+1]=a+v*(m*i+v*n[o]),c=0;c<e;c++)a=r.get(c,o+1),r.set(c,o+1,v*r.get(c,o)+m*a),r.set(c,o,m*r.get(c,o)-v*a);d=-v*y*g*_*t[l]/p,t[l]=v*d,n[l]=m*d}while(Math.abs(t[l])>S*x);n[l]=n[l]+b,t[l]=0}for(o=0;o<e-1;o++){for(c=o,d=n[o],s=o+1;s<e;s++)n[s]<d&&(c=s,d=n[s]);if(c!==o)for(n[c]=n[o],n[o]=d,s=0;s<e;s++)d=r.get(s,o),r.set(s,o,r.get(s,c)),r.set(s,c,d)}}function Be(e,t,n,r){let i=e-1,a,o,s,c,l,u,d;for(u=1;u<=i-1;u++){for(d=0,c=u;c<=i;c++)d+=Math.abs(t.get(c,u-1));if(d!==0){for(s=0,c=i;c>=u;c--)n[c]=t.get(c,u-1)/d,s+=n[c]*n[c];for(o=Math.sqrt(s),n[u]>0&&(o=-o),s-=n[u]*o,n[u]=n[u]-o,l=u;l<e;l++){for(a=0,c=i;c>=u;c--)a+=n[c]*t.get(c,l);for(a/=s,c=u;c<=i;c++)t.set(c,l,t.get(c,l)-a*n[c])}for(c=0;c<=i;c++){for(a=0,l=i;l>=u;l--)a+=n[l]*t.get(c,l);for(a/=s,l=u;l<=i;l++)t.set(c,l,t.get(c,l)-a*n[l])}n[u]=d*n[u],t.set(u,u-1,d*o)}}for(c=0;c<e;c++)for(l=0;l<e;l++)r.set(c,l,c===l?1:0);for(u=i-1;u>=1;u--)if(t.get(u,u-1)!==0){for(c=u+1;c<=i;c++)n[c]=t.get(c,u-1);for(l=u;l<=i;l++){for(o=0,c=u;c<=i;c++)o+=n[c]*r.get(c,l);for(o=o/n[u]/t.get(u,u-1),c=u;c<=i;c++)r.set(c,l,r.get(c,l)+o*n[c])}}}function Ve(e,t,n,r,i){let a=e-1,o=e-1,s=2**-52,c=0,l=0,u=0,d=0,f=0,p=0,m=0,h=0,g,_,v,y,b,x,S,C,w,T,E,D,O,k,A;for(g=0;g<e;g++)for((g<0||g>o)&&(n[g]=i.get(g,g),t[g]=0),_=Math.max(g-1,0);_<e;_++)l+=Math.abs(i.get(g,_));for(;a>=0;){for(y=a;y>0&&(p=Math.abs(i.get(y-1,y-1))+Math.abs(i.get(y,y)),p===0&&(p=l),!(Math.abs(i.get(y,y-1))<s*p));)y--;if(y===a)i.set(a,a,i.get(a,a)+c),n[a]=i.get(a,a),t[a]=0,a--,h=0;else if(y===a-1){if(S=i.get(a,a-1)*i.get(a-1,a),u=(i.get(a-1,a-1)-i.get(a,a))/2,d=u*u+S,m=Math.sqrt(Math.abs(d)),i.set(a,a,i.get(a,a)+c),i.set(a-1,a-1,i.get(a-1,a-1)+c),C=i.get(a,a),d>=0){for(m=u>=0?u+m:u-m,n[a-1]=C+m,n[a]=n[a-1],m!==0&&(n[a]=C-S/m),t[a-1]=0,t[a]=0,C=i.get(a,a-1),p=Math.abs(C)+Math.abs(m),u=C/p,d=m/p,f=Math.sqrt(u*u+d*d),u/=f,d/=f,_=a-1;_<e;_++)m=i.get(a-1,_),i.set(a-1,_,d*m+u*i.get(a,_)),i.set(a,_,d*i.get(a,_)-u*m);for(g=0;g<=a;g++)m=i.get(g,a-1),i.set(g,a-1,d*m+u*i.get(g,a)),i.set(g,a,d*i.get(g,a)-u*m);for(g=0;g<=o;g++)m=r.get(g,a-1),r.set(g,a-1,d*m+u*r.get(g,a)),r.set(g,a,d*r.get(g,a)-u*m)}else n[a-1]=C+u,n[a]=C+u,t[a-1]=m,t[a]=-m;a-=2,h=0}else{if(C=i.get(a,a),w=0,S=0,y<a&&(w=i.get(a-1,a-1),S=i.get(a,a-1)*i.get(a-1,a)),h===10){for(c+=C,g=0;g<=a;g++)i.set(g,g,i.get(g,g)-C);p=Math.abs(i.get(a,a-1))+Math.abs(i.get(a-1,a-2)),C=w=.75*p,S=-.4375*p*p}if(h===30&&(p=(w-C)/2,p=p*p+S,p>0)){for(p=Math.sqrt(p),w<C&&(p=-p),p=C-S/((w-C)/2+p),g=0;g<=a;g++)i.set(g,g,i.get(g,g)-p);c+=p,C=w=S=.964}for(h+=1,b=a-2;b>=y&&(m=i.get(b,b),f=C-m,p=w-m,u=(f*p-S)/i.get(b+1,b)+i.get(b,b+1),d=i.get(b+1,b+1)-m-f-p,f=i.get(b+2,b+1),p=Math.abs(u)+Math.abs(d)+Math.abs(f),u/=p,d/=p,f/=p,!(b===y||Math.abs(i.get(b,b-1))*(Math.abs(d)+Math.abs(f))<s*(Math.abs(u)*(Math.abs(i.get(b-1,b-1))+Math.abs(m)+Math.abs(i.get(b+1,b+1))))));)b--;for(g=b+2;g<=a;g++)i.set(g,g-2,0),g>b+2&&i.set(g,g-3,0);for(v=b;v<=a-1&&(k=v!==a-1,v!==b&&(u=i.get(v,v-1),d=i.get(v+1,v-1),f=k?i.get(v+2,v-1):0,C=Math.abs(u)+Math.abs(d)+Math.abs(f),C!==0&&(u/=C,d/=C,f/=C)),C!==0);v++)if(p=Math.sqrt(u*u+d*d+f*f),u<0&&(p=-p),p!==0){for(v===b?y!==b&&i.set(v,v-1,-i.get(v,v-1)):i.set(v,v-1,-p*C),u+=p,C=u/p,w=d/p,m=f/p,d/=u,f/=u,_=v;_<e;_++)u=i.get(v,_)+d*i.get(v+1,_),k&&(u+=f*i.get(v+2,_),i.set(v+2,_,i.get(v+2,_)-u*m)),i.set(v,_,i.get(v,_)-u*C),i.set(v+1,_,i.get(v+1,_)-u*w);for(g=0;g<=Math.min(a,v+3);g++)u=C*i.get(g,v)+w*i.get(g,v+1),k&&(u+=m*i.get(g,v+2),i.set(g,v+2,i.get(g,v+2)-u*f)),i.set(g,v,i.get(g,v)-u),i.set(g,v+1,i.get(g,v+1)-u*d);for(g=0;g<=o;g++)u=C*r.get(g,v)+w*r.get(g,v+1),k&&(u+=m*r.get(g,v+2),r.set(g,v+2,r.get(g,v+2)-u*f)),r.set(g,v,r.get(g,v)-u),r.set(g,v+1,r.get(g,v+1)-u*d)}}}if(l!==0){for(a=e-1;a>=0;a--)if(u=n[a],d=t[a],d===0)for(y=a,i.set(a,a,1),g=a-1;g>=0;g--){for(S=i.get(g,g)-u,f=0,_=y;_<=a;_++)f+=i.get(g,_)*i.get(_,a);if(t[g]<0)m=S,p=f;else if(y=g,t[g]===0?i.set(g,a,S===0?-f/(s*l):-f/S):(C=i.get(g,g+1),w=i.get(g+1,g),d=(n[g]-u)*(n[g]-u)+t[g]*t[g],x=(C*p-m*f)/d,i.set(g,a,x),i.set(g+1,a,Math.abs(C)>Math.abs(m)?(-f-S*x)/C:(-p-w*x)/m)),x=Math.abs(i.get(g,a)),s*x*x>1)for(_=g;_<=a;_++)i.set(_,a,i.get(_,a)/x)}else if(d<0)for(y=a-1,Math.abs(i.get(a,a-1))>Math.abs(i.get(a-1,a))?(i.set(a-1,a-1,d/i.get(a,a-1)),i.set(a-1,a,-(i.get(a,a)-u)/i.get(a,a-1))):(A=He(0,-i.get(a-1,a),i.get(a-1,a-1)-u,d),i.set(a-1,a-1,A[0]),i.set(a-1,a,A[1])),i.set(a,a-1,0),i.set(a,a,1),g=a-2;g>=0;g--){for(T=0,E=0,_=y;_<=a;_++)T+=i.get(g,_)*i.get(_,a-1),E+=i.get(g,_)*i.get(_,a);if(S=i.get(g,g)-u,t[g]<0)m=S,f=T,p=E;else if(y=g,t[g]===0?(A=He(-T,-E,S,d),i.set(g,a-1,A[0]),i.set(g,a,A[1])):(C=i.get(g,g+1),w=i.get(g+1,g),D=(n[g]-u)*(n[g]-u)+t[g]*t[g]-d*d,O=(n[g]-u)*2*d,D===0&&O===0&&(D=s*l*(Math.abs(S)+Math.abs(d)+Math.abs(C)+Math.abs(w)+Math.abs(m))),A=He(C*f-m*T+d*E,C*p-m*E-d*T,D,O),i.set(g,a-1,A[0]),i.set(g,a,A[1]),Math.abs(C)>Math.abs(m)+Math.abs(d)?(i.set(g+1,a-1,(-T-S*i.get(g,a-1)+d*i.get(g,a))/C),i.set(g+1,a,(-E-S*i.get(g,a)-d*i.get(g,a-1))/C)):(A=He(-f-w*i.get(g,a-1),-p-w*i.get(g,a),m,d),i.set(g+1,a-1,A[0]),i.set(g+1,a,A[1]))),x=Math.max(Math.abs(i.get(g,a-1)),Math.abs(i.get(g,a))),s*x*x>1)for(_=g;_<=a;_++)i.set(_,a-1,i.get(_,a-1)/x),i.set(_,a,i.get(_,a)/x)}for(g=0;g<e;g++)if(g<0||g>o)for(_=g;_<e;_++)r.set(g,_,i.get(g,_));for(_=e-1;_>=0;_--)for(g=0;g<=o;g++){for(m=0,v=0;v<=Math.min(_,o);v++)m+=r.get(g,v)*i.get(v,_);r.set(g,_,m)}}}function He(e,t,n,r){let i,a;return Math.abs(n)>Math.abs(r)?(i=r/n,a=n+i*r,[(e+i*t)/a,(t-i*e)/a]):(i=n/r,a=r+i*n,[(i*e+t)/a,(i*t-e)/a])}var Ue=class{constructor(e){if(e=Se.checkMatrix(e),!e.isSymmetric())throw Error(`Matrix is not symmetric`);let t=e,n=t.rows,r=new N(n,n),i=!0,a,o,s;for(o=0;o<n;o++){let e=0;for(s=0;s<o;s++){let n=0;for(a=0;a<s;a++)n+=r.get(s,a)*r.get(o,a);n=(t.get(o,s)-n)/r.get(s,s),r.set(o,s,n),e+=n*n}for(e=t.get(o,o)-e,i&&=e>0,r.set(o,o,Math.sqrt(Math.max(e,0))),s=o+1;s<n;s++)r.set(o,s,0)}this.L=r,this.positiveDefinite=i}isPositiveDefinite(){return this.positiveDefinite}solve(e){e=Se.checkMatrix(e);let t=this.L,n=t.rows;if(e.rows!==n)throw Error(`Matrix dimensions do not match`);if(this.isPositiveDefinite()===!1)throw Error(`Matrix is not positive definite`);let r=e.columns,i=e.clone(),a,o,s;for(s=0;s<n;s++)for(o=0;o<r;o++){for(a=0;a<s;a++)i.set(s,o,i.get(s,o)-i.get(a,o)*t.get(s,a));i.set(s,o,i.get(s,o)/t.get(s,s))}for(s=n-1;s>=0;s--)for(o=0;o<r;o++){for(a=s+1;a<n;a++)i.set(s,o,i.get(s,o)-i.get(a,o)*t.get(a,s));i.set(s,o,i.get(s,o)/t.get(s,s))}return i}get lowerTriangularMatrix(){return this.L}},We=class{constructor(e,n={}){e=Se.checkMatrix(e);let{Y:r}=n,{scaleScores:i=!1,maxIterations:a=1e3,terminationCriteria:o=1e-10}=n,s;if(r){if(r=t.isAnyArray(r)&&typeof r[0]==`number`?N.columnVector(r):Se.checkMatrix(r),r.rows!==e.rows)throw Error(`Y should have the same number of rows as X`);s=r.getColumnVector(0)}else s=e.getColumnVector(0);let c=1,l,u,d,f;for(let t=0;t<a&&c>o;t++)d=e.transpose().mmul(s).div(s.transpose().mmul(s).get(0,0)),d=d.div(d.norm()),l=e.mmul(d).div(d.transpose().mmul(d).get(0,0)),t>0&&(c=l.clone().sub(f).pow(2).sum()),f=l.clone(),r?(u=r.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),u=u.div(u.norm()),s=r.mmul(u).div(u.transpose().mmul(u).get(0,0))):s=l;if(r){let t=e.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));t=t.div(t.norm());let n=e.clone().sub(l.clone().mmul(t.transpose())),i=s.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),a=r.clone().sub(l.clone().mulS(i.get(0,0)).mmul(u.transpose()));this.t=l,this.p=t.transpose(),this.w=d.transpose(),this.q=u,this.u=s,this.s=l.transpose().mmul(l),this.xResidual=n,this.yResidual=a,this.betas=i}else this.w=d.transpose(),this.s=l.transpose().mmul(l).sqrt(),i?this.t=l.clone().div(this.s.get(0,0)):this.t=l,this.xResidual=e.sub(l.mmul(d.transpose()))}};exports.AbstractMatrix=se,exports.CHO=Ue,exports.CholeskyDecomposition=Ue,exports.DistanceMatrix=de,exports.EVD=Le,exports.EigenvalueDecomposition=Le,exports.LU=we,exports.LuDecomposition=we,exports.Matrix=N,exports.MatrixColumnSelectionView=me,exports.MatrixColumnView=pe,exports.MatrixFlipColumnView=he,exports.MatrixFlipRowView=ge,exports.MatrixRowSelectionView=ve,exports.MatrixRowView=_e,exports.MatrixSelectionView=P,exports.MatrixSubView=ye,exports.MatrixTransposeView=be,exports.NIPALS=We,exports.Nipals=We,exports.QR=Ee,exports.QrDecomposition=Ee,exports.SVD=De,exports.SingularValueDecomposition=De,exports.SymmetricMatrix=ue,exports.WrapperMatrix1D=xe,exports.WrapperMatrix2D=Se,exports.correlation=Ie,exports.covariance=Fe,exports.default=N,exports.determinant=Ae,exports.inverse=Oe,exports.linearDependencies=Ne,exports.pseudoInverse=Pe,exports.solve=ke,exports.wrap=Ce}))(),1);cP.AbstractMatrix,cP.CHO,cP.CholeskyDecomposition,cP.DistanceMatrix,cP.EVD,cP.EigenvalueDecomposition,cP.LU,cP.LuDecomposition;const lP=cP.Matrix;cP.MatrixColumnSelectionView,cP.MatrixColumnView,cP.MatrixFlipColumnView,cP.MatrixFlipRowView,cP.MatrixRowSelectionView,cP.MatrixRowView,cP.MatrixSelectionView,cP.MatrixSubView,cP.MatrixTransposeView,cP.NIPALS,cP.Nipals,cP.QR,cP.QrDecomposition,cP.SVD;const uP=cP.SingularValueDecomposition;cP.SymmetricMatrix,cP.WrapperMatrix1D,cP.WrapperMatrix2D,cP.correlation,cP.covariance,cP.default.Matrix?cP.default.Matrix:cP.Matrix,cP.determinant,cP.inverse,cP.linearDependencies,cP.pseudoInverse,cP.solve,cP.wrap;var dP={center:[0,0],linkDistance:50},fP=class{constructor(e={}){this.options=e,this.id=`mds`,this.options=Object.assign(Object.assign({},dP),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericMDSLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericMDSLayout(!0,e,t)})}genericMDSLayout(e,t,n){return en(this,void 0,void 0,function*(){let{center:r=[0,0],linkDistance:i=50}=Object.assign(Object.assign({},this.options),n),a=t.getAllNodes(),o=t.getAllEdges();if(!a?.length||a.length===1)return IM(t,e,r);let s=SM({nodes:a,edges:o},!1),c=xM(s);pP(c);let l=CM(c,i),u=mP(l),d=[];return u.forEach((e,t)=>{let n=OM(a[t]);n.data.x=e[0]+r[0],n.data.y=e[1]+r[1],d.push(n)}),e&&d.forEach(e=>t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})),{nodes:d,edges:o}})}},pP=e=>{let t=-999999;e.forEach(e=>{e.forEach(e=>{e!==1/0&&t<e&&(t=e)})}),e.forEach((n,r)=>{n.forEach((n,i)=>{n===1/0&&(e[r][i]=t)})})},mP=e=>{let t=lP.mul(lP.pow(e,2),-.5),n=t.mean(`row`),r=t.mean(`column`),i=t.mean();t.add(i).subRowVector(n).subColumnVector(r);let a=new uP(t),o=lP.sqrt(a.diagonalMatrix).diagonal();return a.leftSingularVectors.toJSON().map(e=>lP.mul([e],[o]).toJSON()[0].splice(0,2))};function hP(e){return!!e.tick&&!!e.stop}var gP={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},_P={center:[0,0],comboPadding:10,treeKey:`combo`},vP=class{constructor(e={}){this.options=e,this.id=`comboCombined`,this.options=Object.assign(Object.assign({},_P),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericComboCombinedLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericComboCombinedLayout(!0,e,t)})}genericComboCombinedLayout(e,t,n){return en(this,void 0,void 0,function*(){let r=this.initVals(Object.assign(Object.assign({},this.options),n)),{center:i,treeKey:a,outerLayout:o}=r,s=t.getAllNodes().filter(e=>!e.data._isCombo),c=t.getAllNodes().filter(e=>e.data._isCombo),l=t.getAllEdges(),u=s?.length;if(!u||u===1)return IM(t,e,i);let d=[],f=new Map;s.forEach(e=>{f.set(e.id,e)});let p=new Map;c.forEach(e=>{p.set(e.id,e)});let m=new Map,h=this.getInnerGraphs(t,a,f,p,l,r,m);yield Promise.all(h);let g=new Map,_=[],v=new Map,y=!0;t.getRoots(a).forEach(e=>{let n=m.get(e.id),r=p.get(e.id)||f.get(e.id),i={id:e.id,data:Object.assign(Object.assign({},e.data),{x:n.data.x||r.data.x,y:n.data.y||r.data.y,fx:n.data.fx||r.data.fx,fy:n.data.fy||r.data.fy,mass:n.data.mass||r.data.mass,size:n.data.size})};_.push(i),g.set(e.id,!0),!isNaN(i.data.x)&&i.data.x!==0&&!isNaN(i.data.y)&&i.data.y!==0?y=!1:(i.data.x=Math.random()*100,i.data.y=Math.random()*100),EM(t,[e],t=>{t.id!==e.id&&v.set(t.id,e.id)},`TB`,a)});let b=[];l.forEach(e=>{let t=v.get(e.source)||e.source,n=v.get(e.target)||e.target;t!==n&&g.has(t)&&g.has(n)&&b.push({id:e.id,source:t,target:n,data:{}})});let x;if(_?.length){if(_.length===1)_[0].data.x=i[0],_[0].data.y=i[1];else{let e=new bk({nodes:_,edges:b}),t=o||new GN;y&&gP[t.id]&&(yield(_.length<100?new fP:new UM).assign(e));let n=Object.assign({center:i,kg:5,preventOverlap:!0,animate:!1},t.id===`force`?{gravity:1,factor:4,linkDistance:(e,t,n)=>{let r=Math.max(...t.data.size)||32,i=Math.max(...n.data.size)||32;return r/2+i/2+200}}:{});x=yield yP(t,e,n)}m.forEach(e=>{var t;let n=x.nodes.find(t=>t.id===e.id);if(n){let{x:t,y:r}=n.data;e.data.visited=!0,e.data.x=t,e.data.y=r,d.push({id:e.id,data:{x:t,y:r}})}let{x:r,y:i}=e.data;(t=e.data.nodes)==null||t.forEach(e=>{d.push({id:e.id,data:{x:e.data.x+r,y:e.data.y+i}})})}),m.forEach(({data:e})=>{let{x:t,y:n,visited:r,nodes:i}=e;i?.forEach(e=>{if(!r){let r=d.find(t=>t.id===e.id);r.data.x+=t||0,r.data.y+=n||0}})})}return e&&d.forEach(e=>{t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})}),{nodes:d,edges:l}})}initVals(e){let t=Object.assign({},e),{nodeSize:n,spacing:r,comboPadding:i}=e,a,o;if(o=G(r)?()=>r:W(r)?r:()=>0,t.spacing=o,!n)a=e=>{let t=o(e);return e.size?bM(e.size)?((e.size[0]>e.size[1]?e.size[0]:e.size[1])+t)/2:Kl(e.size)?((e.size.width>e.size.height?e.size.width:e.size.height)+t)/2:(e.size+t)/2:32+t/2};else if(W(n))a=e=>{let t=n(e),r=o(e);return bM(e.size)?((e.size[0]>e.size[1]?e.size[0]:e.size[1])+r)/2:((t||32)+r)/2};else if(bM(n)){let e=(n[0]>n[1]?n[0]:n[1])/2;a=t=>e+o(t)/2}else{let e=n/2;a=t=>e+o(t)/2}t.nodeSize=a;let s;return s=G(i)?()=>i:bM(i)?()=>Math.max.apply(null,i):W(i)?i:()=>0,t.comboPadding=s,t}getInnerGraphs(e,t,n,r,i,a,o){let{nodeSize:s,comboPadding:c,spacing:l,innerLayout:u}=a,d=u||new UM({}),f={center:[0,0],preventOverlap:!0,nodeSpacing:l},p=[],m=e=>{let t=c?.(e)||10;return bM(t)&&(t=Math.max(...t)),{size:t?[t*2,t*2]:[30,30],padding:t}};return e.getRoots(t).forEach(a=>{o.set(a.id,{id:a.id,data:{nodes:[],size:m(a).size}});let c=Promise.resolve();EM(e,[a],a=>{if(!a.data._isCombo)return;let{size:l,padding:u}=m(a);if(!e.getChildren(a.id,t)?.length)o.set(a.id,{id:a.id,data:Object.assign(Object.assign({},a.data),{size:l})});else{let l=o.get(a.id);o.set(a.id,{id:a.id,data:Object.assign({nodes:[]},l?.data)});let p=new Map,m=e.getChildren(a.id,t).map(e=>{if(e.data._isCombo)return o.has(e.id)||o.set(e.id,{id:e.id,data:Object.assign({},e.data)}),p.set(e.id,!0),o.get(e.id);let t=n.get(e.id)||r.get(e.id);return p.set(e.id,!0),{id:e.id,data:Object.assign(Object.assign({},t.data),e.data)}}),h={nodes:m,edges:i.filter(e=>p.has(e.source)&&p.has(e.target))},g=1/0;m.forEach(e=>{let{size:t}=e.data;t||=o.get(e.id)?.data.size||s?.(e)||[30,30],G(t)&&(t=[t,t]);let[n,r]=t;g>n&&(g=n),g>r&&(g=r),e.data.size=t}),c=c.then(()=>en(this,void 0,void 0,function*(){let e=new bk(h);yield yP(d,e,f,!0);let{minX:t,minY:n,maxX:r,maxY:i}=wM(m),s={x:(r+t)/2,y:(i+n)/2};h.nodes.forEach(e=>{e.data.x-=s.x,e.data.y-=s.y});let c=[Math.max(r-t,g)+u*2,Math.max(i-n,g)+u*2];o.get(a.id).data.size=c,o.get(a.id).data.nodes=m}))}return!0},`BT`,t),p.push(c)}),p}};function yP(e,t,n,r){return en(this,void 0,void 0,function*(){return hP(e)?(e.execute(t,n),e.stop(),e.tick(n.iterations??300)):r?yield e.assign(t,n):yield e.execute(t,n)})}function bP(e,t){var n,r=1;e??=0,t??=0;function i(){var i,a=n.length,o,s=0,c=0;for(i=0;i<a;++i)o=n[i],s+=o.x,c+=o.y;for(s=(s/a-e)*r,c=(c/a-t)*r,i=0;i<a;++i)o=n[i],o.x-=s,o.y-=c}return i.initialize=function(e){n=e},i.x=function(t){return arguments.length?(e=+t,i):e},i.y=function(e){return arguments.length?(t=+e,i):t},i.strength=function(e){return arguments.length?(r=+e,i):r},i}function xP(e){return function(){return e}}function SP(e){return(e()-.5)*1e-6}function CP(e){return e.x+e.vx}function wP(e){return e.y+e.vy}function TP(e){var t,n,r,i=1,a=1;typeof e!=`function`&&(e=xP(e==null?1:+e));function o(){for(var e,o=t.length,c,l,u,d,f,p,m=0;m<a;++m)for(c=cN(t,CP,wP).visitAfter(s),e=0;e<o;++e)l=t[e],f=n[l.index],p=f*f,u=l.x+l.vx,d=l.y+l.vy,c.visit(h);function h(e,t,n,a,o){var s=e.data,c=e.r,m=f+c;if(s){if(s.index>l.index){var h=u-s.x-s.vx,g=d-s.y-s.vy,_=h*h+g*g;_<m*m&&(h===0&&(h=SP(r),_+=h*h),g===0&&(g=SP(r),_+=g*g),_=(m-(_=Math.sqrt(_)))/_*i,l.vx+=(h*=_)*(m=(c*=c)/(p+c)),l.vy+=(g*=_)*m,s.vx-=h*(m=1-m),s.vy-=g*m)}return}return t>u+m||a<u-m||n>d+m||o<d-m}}function s(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function c(){if(t){var r,i=t.length,a;for(n=Array(i),r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}}return o.initialize=function(e,n){t=e,r=n,c()},o.iterations=function(e){return arguments.length?(a=+e,o):a},o.strength=function(e){return arguments.length?(i=+e,o):i},o.radius=function(t){return arguments.length?(e=typeof t==`function`?t:xP(+t),c(),o):e},o}function EP(e){return e.index}function DP(e,t){var n=e.get(t);if(!n)throw Error(`node not found: `+t);return n}function OP(e){var t=EP,n=d,r,i=xP(30),a,o,s,c,l,u=1;e??=[];function d(e){return 1/Math.min(s[e.source.index],s[e.target.index])}function f(t){for(var n=0,i=e.length;n<u;++n)for(var o=0,s,d,f,p,m,h,g;o<i;++o)s=e[o],d=s.source,f=s.target,p=f.x+f.vx-d.x-d.vx||SP(l),m=f.y+f.vy-d.y-d.vy||SP(l),h=Math.sqrt(p*p+m*m),h=(h-a[o])/h*t*r[o],p*=h,m*=h,f.vx-=p*(g=c[o]),f.vy-=m*g,d.vx+=p*(g=1-g),d.vy+=m*g}function p(){if(o){var n,i=o.length,l=e.length,u=new Map(o.map((e,n)=>[t(e,n,o),e])),d;for(n=0,s=Array(i);n<l;++n)d=e[n],d.index=n,typeof d.source!=`object`&&(d.source=DP(u,d.source)),typeof d.target!=`object`&&(d.target=DP(u,d.target)),s[d.source.index]=(s[d.source.index]||0)+1,s[d.target.index]=(s[d.target.index]||0)+1;for(n=0,c=Array(l);n<l;++n)d=e[n],c[n]=s[d.source.index]/(s[d.source.index]+s[d.target.index]);r=Array(l),m(),a=Array(l),h()}}function m(){if(o)for(var t=0,i=e.length;t<i;++t)r[t]=+n(e[t],t,e)}function h(){if(o)for(var t=0,n=e.length;t<n;++t)a[t]=+i(e[t],t,e)}return f.initialize=function(e,t){o=e,l=t,p()},f.links=function(t){return arguments.length?(e=t,p(),f):e},f.id=function(e){return arguments.length?(t=e,f):t},f.iterations=function(e){return arguments.length?(u=+e,f):u},f.strength=function(e){return arguments.length?(n=typeof e==`function`?e:xP(+e),m(),f):n},f.distance=function(e){return arguments.length?(i=typeof e==`function`?e:xP(+e),h(),f):i},f}var kP={value:()=>{}};function AP(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+``)||r in n||/[\s.]/.test(r))throw Error(`illegal type: `+r);n[r]=[]}return new jP(n)}function jP(e){this._=e}function MP(e,t){return e.trim().split(/^|\s+/).map(function(e){var n=``,r=e.indexOf(`.`);if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw Error(`unknown type: `+e);return{type:e,name:n}})}jP.prototype=AP.prototype={constructor:jP,on:function(e,t){var n=this._,r=MP(e+``,n),i,a=-1,o=r.length;if(arguments.length<2){for(;++a<o;)if((i=(e=r[a]).type)&&(i=NP(n[i],e.name)))return i;return}if(t!=null&&typeof t!=`function`)throw Error(`invalid callback: `+t);for(;++a<o;)if(i=(e=r[a]).type)n[i]=PP(n[i],e.name,t);else if(t==null)for(i in n)n[i]=PP(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new jP(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=Array(i),r=0,i,a;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(a=this._[e],r=0,i=a.length;r<i;++r)a[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw Error(`unknown type: `+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};function NP(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function PP(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=kP,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var FP=AP,IP=0,LP=0,RP=0,zP=1e3,BP,VP,HP=0,UP=0,WP=0,GP=typeof performance==`object`&&performance.now?performance:Date,KP=typeof window==`object`&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qP(){return UP||=(KP(JP),GP.now()+WP)}function JP(){UP=0}function YP(){this._call=this._time=this._next=null}YP.prototype=XP.prototype={constructor:YP,restart:function(e,t,n){if(typeof e!=`function`)throw TypeError(`callback is not a function`);n=(n==null?qP():+n)+(t==null?0:+t),!this._next&&VP!==this&&(VP?VP._next=this:BP=this,VP=this),this._call=e,this._time=n,tF()},stop:function(){this._call&&(this._call=null,this._time=1/0,tF())}};function XP(e,t,n){var r=new YP;return r.restart(e,t,n),r}function ZP(){qP(),++IP;for(var e=BP,t;e;)(t=UP-e._time)>=0&&e._call.call(void 0,t),e=e._next;--IP}function QP(){UP=(HP=GP.now())+WP,IP=LP=0;try{ZP()}finally{IP=0,eF(),UP=0}}function $P(){var e=GP.now(),t=e-HP;t>zP&&(WP-=t,HP=e)}function eF(){for(var e,t=BP,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:BP=n);VP=e,tF(r)}function tF(e){IP||(LP&&=clearTimeout(LP),e-UP>24?(e<1/0&&(LP=setTimeout(QP,e-GP.now()-WP)),RP&&=clearInterval(RP)):(RP||=(HP=GP.now(),setInterval($P,zP)),IP=1,KP(QP)))}var nF=1664525,rF=1013904223,iF=4294967296;function aF(){let e=1;return()=>(e=(nF*e+rF)%iF)/iF}function oF(e){return e.x}function sF(e){return e.y}var cF=10,lF=Math.PI*(3-Math.sqrt(5));function uF(e){var t,n=1,r=.001,i=1-r**(1/300),a=0,o=.6,s=new Map,c=XP(d),l=FP(`tick`,`end`),u=aF();e??=[];function d(){f(),l.call(`tick`,t),n<r&&(c.stop(),l.call(`end`,t))}function f(r){var c,l=e.length,u;r===void 0&&(r=1);for(var d=0;d<r;++d)for(n+=(a-n)*i,s.forEach(function(e){e(n)}),c=0;c<l;++c)u=e[c],u.fx==null?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),u.fy==null?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return t}function p(){for(var t=0,n=e.length,r;t<n;++t){if(r=e[t],r.index=t,r.fx!=null&&(r.x=r.fx),r.fy!=null&&(r.y=r.fy),isNaN(r.x)||isNaN(r.y)){var i=cF*Math.sqrt(.5+t),a=t*lF;r.x=i*Math.cos(a),r.y=i*Math.sin(a)}(isNaN(r.vx)||isNaN(r.vy))&&(r.vx=r.vy=0)}}function m(t){return t.initialize&&t.initialize(e,u),t}return p(),t={tick:f,restart:function(){return c.restart(d),t},stop:function(){return c.stop(),t},nodes:function(n){return arguments.length?(e=n,p(),s.forEach(m),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(i=+e,t):+i},alphaTarget:function(e){return arguments.length?(a=+e,t):a},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},randomSource:function(e){return arguments.length?(u=e,s.forEach(m),t):u},force:function(e,n){return arguments.length>1?(n==null?s.delete(e):s.set(e,m(n)),t):s.get(e)},find:function(t,n,r){var i=0,a=e.length,o,s,c,l,u;for(r==null?r=1/0:r*=r,i=0;i<a;++i)l=e[i],o=t-l.x,s=n-l.y,c=o*o+s*s,c<r&&(u=l,r=c);return u},on:function(e,n){return arguments.length>1?(l.on(e,n),t):l.on(e)}}}function dF(){var e,t,n,r,i=xP(-30),a,o=1,s=1/0,c=.81;function l(n){var i,a=e.length,o=cN(e,oF,sF).visitAfter(d);for(r=n,i=0;i<a;++i)t=e[i],o.visit(f)}function u(){if(e){var t,n=e.length,r;for(a=Array(n),t=0;t<n;++t)r=e[t],a[r.index]=+i(r,t,e)}}function d(e){var t=0,n,r,i=0,o,s,c;if(e.length){for(o=s=c=0;c<4;++c)(n=e[c])&&(r=Math.abs(n.value))&&(t+=n.value,i+=r,o+=r*n.x,s+=r*n.y);e.x=o/i,e.y=s/i}else{n=e,n.x=n.data.x,n.y=n.data.y;do t+=a[n.data.index];while(n=n.next)}e.value=t}function f(e,i,l,u){if(!e.value)return!0;var d=e.x-t.x,f=e.y-t.y,p=u-i,m=d*d+f*f;if(p*p/c<m)return m<s&&(d===0&&(d=SP(n),m+=d*d),f===0&&(f=SP(n),m+=f*f),m<o&&(m=Math.sqrt(o*m)),t.vx+=d*e.value*r/m,t.vy+=f*e.value*r/m),!0;if(!(e.length||m>=s)){(e.data!==t||e.next)&&(d===0&&(d=SP(n),m+=d*d),f===0&&(f=SP(n),m+=f*f),m<o&&(m=Math.sqrt(o*m)));do e.data!==t&&(p=a[e.data.index]*r/m,t.vx+=d*p,t.vy+=f*p);while(e=e.next)}}return l.initialize=function(t,r){e=t,n=r,u()},l.strength=function(e){return arguments.length?(i=typeof e==`function`?e:xP(+e),u(),l):i},l.distanceMin=function(e){return arguments.length?(o=e*e,l):Math.sqrt(o)},l.distanceMax=function(e){return arguments.length?(s=e*e,l):Math.sqrt(s)},l.theta=function(e){return arguments.length?(c=e*e,l):Math.sqrt(c)},l}function fF(e,t,n){var r,i=xP(.1),a,o;typeof e!=`function`&&(e=xP(+e)),t??=0,n??=0;function s(e){for(var i=0,s=r.length;i<s;++i){var c=r[i],l=c.x-t||1e-6,u=c.y-n||1e-6,d=Math.sqrt(l*l+u*u),f=(o[i]-d)*a[i]*e/d;c.vx+=l*f,c.vy+=u*f}}function c(){if(r){var t,n=r.length;for(a=Array(n),o=Array(n),t=0;t<n;++t)o[t]=+e(r[t],t,r),a[t]=isNaN(o[t])?0:+i(r[t],t,r)}}return s.initialize=function(e){r=e,c()},s.strength=function(e){return arguments.length?(i=typeof e==`function`?e:xP(+e),c(),s):i},s.radius=function(t){return arguments.length?(e=typeof t==`function`?t:xP(+t),c(),s):e},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(e){return arguments.length?(n=+e,s):n},s}function pF(e){var t=xP(.1),n,r,i;typeof e!=`function`&&(e=xP(e==null?0:+e));function a(e){for(var t=0,a=n.length,o;t<a;++t)o=n[t],o.vx+=(i[t]-o.x)*r[t]*e}function o(){if(n){var a,o=n.length;for(r=Array(o),i=Array(o),a=0;a<o;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return a.initialize=function(e){n=e,o()},a.strength=function(e){return arguments.length?(t=typeof e==`function`?e:xP(+e),o(),a):t},a.x=function(t){return arguments.length?(e=typeof t==`function`?t:xP(+t),o(),a):e},a}function mF(e){var t=xP(.1),n,r,i;typeof e!=`function`&&(e=xP(e==null?0:+e));function a(e){for(var t=0,a=n.length,o;t<a;++t)o=n[t],o.vy+=(i[t]-o.y)*r[t]*e}function o(){if(n){var a,o=n.length;for(r=Array(o),i=Array(o),a=0;a<o;++a)r[a]=isNaN(i[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return a.initialize=function(e){n=e,o()},a.strength=function(e){return arguments.length?(t=typeof e==`function`?e:xP(+e),o(),a):t},a.y=function(t){return arguments.length?(e=typeof t==`function`?t:xP(+t),o(),a):e},a}var hF=class{constructor(e){this.id=`d3-force`,this.config={inputNodeAttrs:[`x`,`y`,`vx`,`vy`,`fx`,`fy`],outputNodeAttrs:[`x`,`y`,`vx`,`vy`],simulationAttrs:[`alpha`,`alphaMin`,`alphaDecay`,`alphaTarget`,`velocityDecay`,`randomSource`]},this.forceMap={link:OP,manyBody:dF,center:bP,collide:TP,radial:fF,x:pF,y:mF},this.options={link:{id:e=>e.id},manyBody:{},center:{x:0,y:0}},this.context={options:{},assign:!1,nodes:[],edges:[]},Bu(this.options,e),this.options.forceSimulation&&(this.simulation=this.options.forceSimulation)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericLayout(!0,e,t)})}stop(){this.simulation.stop()}tick(e){return this.simulation.tick(e),this.getResult()}restart(){this.simulation.restart()}setFixedPosition(e,t){let n=this.context.nodes.find(t=>t.id===e);n&&t.forEach((e,t)=>{if(typeof e==`number`||e===null){let r=[`fx`,`fy`,`fz`][t];n[r]=e}})}getOptions(e){let t=Bu({},this.options,e);return t.collide&&t.collide?.radius===void 0&&(t.collide=t.collide||{},t.collide.radius=t.nodeSize??10),t.iterations===void 0&&(t.link&&t.link.iterations===void 0&&(t.iterations=t.link.iterations),t.collide&&t.collide.iterations===void 0&&(t.iterations=t.collide.iterations)),this.context.options=t,t}genericLayout(e,t,n){var r;return en(this,void 0,void 0,function*(){let i=this.getOptions(n),a=t.getAllNodes().map(({id:e,data:t})=>Object.assign(Object.assign({id:e},t),Yu(t.data,this.config.inputNodeAttrs))),o=t.getAllEdges().map(e=>Object.assign({},e));Object.assign(this.context,{assign:e,nodes:a,edges:o,graph:t});let s=new Promise(e=>{this.resolver=e}),c=this.setSimulation(i);return c.nodes(a),(r=c.force(`link`))==null||r.links(o),s})}getResult(){let{assign:e,nodes:t,edges:n,graph:r}=this.context,i=t.map(e=>({id:e.id,data:Object.assign(Object.assign({},e.data),Yu(e,this.config.outputNodeAttrs))})),a=n.map(({id:e,source:t,target:n,data:r})=>({id:e,source:typeof t==`object`?t.id:t,target:typeof n==`object`?n.id:n,data:r}));return e&&i.forEach(e=>r.mergeNodeData(e.id,e.data)),{nodes:i,edges:a}}initSimulation(){return uF()}setSimulation(e){let t=this.simulation||this.options.forceSimulation||this.initSimulation();return this.simulation||=t.on(`tick`,()=>e.onTick?.call(e,this.getResult())).on(`end`,()=>this.resolver?.call(this,this.getResult())),gF(t,this.config.simulationAttrs.map(t=>[t,e[t]])),Object.entries(this.forceMap).forEach(([n,r])=>{let i=n;if(e[n]){let n=t.force(i);n||(n=r(),t.force(i,n)),gF(n,Object.entries(e[i]))}else t.force(i,null)}),t}},gF=(e,t)=>t.reduce((t,[n,r])=>!t[n]||r===void 0?t:t[n].call(e,r),e),_F=r(((exports,t)=>{function n(){this.__data__=[],this.size=0}t.exports=n})),vF=r(((exports,t)=>{function n(e,t){return e===t||e!==e&&t!==t}t.exports=n})),yF=r(((exports,t)=>{var n=vF();function r(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}t.exports=r})),bF=r(((exports,t)=>{var n=yF(),r=Array.prototype.splice;function i(e){var t=this.__data__,i=n(t,e);if(i<0)return!1;var a=t.length-1;return i==a?t.pop():r.call(t,i,1),--this.size,!0}t.exports=i})),xF=r(((exports,t)=>{var n=yF();function r(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}t.exports=r})),SF=r(((exports,t)=>{var n=yF();function r(e){return n(this.__data__,e)>-1}t.exports=r})),CF=r(((exports,t)=>{var n=yF();function r(e,t){var r=this.__data__,i=n(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}t.exports=r})),wF=r(((exports,t)=>{var n=_F(),r=bF(),i=xF(),a=SF(),o=CF();function s(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=n,s.prototype.delete=r,s.prototype.get=i,s.prototype.has=a,s.prototype.set=o,t.exports=s})),TF=r(((exports,t)=>{var n=wF();function r(){this.__data__=new n,this.size=0}t.exports=r})),EF=r(((exports,t)=>{function n(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}t.exports=n})),DF=r(((exports,t)=>{function n(e){return this.__data__.get(e)}t.exports=n})),OF=r(((exports,t)=>{function n(e){return this.__data__.has(e)}t.exports=n})),kF=r(((exports,t)=>{t.exports=typeof global==`object`&&global&&global.Object===Object&&global})),AF=r(((exports,t)=>{var n=kF(),r=typeof self==`object`&&self&&self.Object===Object&&self;t.exports=n||r||Function(`return this`)()})),jF=r(((exports,t)=>{t.exports=AF().Symbol})),MF=r(((exports,t)=>{var n=jF(),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,o=n?n.toStringTag:void 0;function s(e){var t=i.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch{}var s=a.call(e);return r&&(t?e[o]=n:delete e[o]),s}t.exports=s})),NF=r(((exports,t)=>{var n=Object.prototype.toString;function r(e){return n.call(e)}t.exports=r})),PF=r(((exports,t)=>{var n=jF(),r=MF(),i=NF(),a=`[object Null]`,o=`[object Undefined]`,s=n?n.toStringTag:void 0;function c(e){return e==null?e===void 0?o:a:s&&s in Object(e)?r(e):i(e)}t.exports=c})),FF=r(((exports,t)=>{function n(e){var t=typeof e;return e!=null&&(t==`object`||t==`function`)}t.exports=n})),IF=r(((exports,t)=>{var n=PF(),r=FF(),i=`[object AsyncFunction]`,a=`[object Function]`,o=`[object GeneratorFunction]`,s=`[object Proxy]`;function c(e){if(!r(e))return!1;var t=n(e);return t==a||t==o||t==i||t==s}t.exports=c})),LF=r(((exports,t)=>{t.exports=AF()[`__core-js_shared__`]})),RF=r(((exports,t)=>{var n=LF(),r=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||``);return e?`Symbol(src)_1.`+e:``}();function i(e){return!!r&&r in e}t.exports=i})),zF=r(((exports,t)=>{var n=Function.prototype.toString;function r(e){if(e!=null){try{return n.call(e)}catch{}try{return e+``}catch{}}return``}t.exports=r})),BF=r(((exports,t)=>{var n=IF(),r=RF(),i=FF(),a=zF(),o=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,f=RegExp(`^`+u.call(d).replace(o,`\\$&`).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,`$1.*?`)+`$`);function p(e){return!i(e)||r(e)?!1:(n(e)?f:s).test(a(e))}t.exports=p})),VF=r(((exports,t)=>{function n(e,t){return e?.[t]}t.exports=n})),HF=r(((exports,t)=>{var n=BF(),r=VF();function i(e,t){var i=r(e,t);return n(i)?i:void 0}t.exports=i})),UF=r(((exports,t)=>{var n=HF(),r=AF();t.exports=n(r,`Map`)})),WF=r(((exports,t)=>{t.exports=HF()(Object,`create`)})),GF=r(((exports,t)=>{var n=WF();function r(){this.__data__=n?n(null):{},this.size=0}t.exports=r})),KF=r(((exports,t)=>{function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}t.exports=n})),qF=r(((exports,t)=>{var n=WF(),r=`__lodash_hash_undefined__`,i=Object.prototype.hasOwnProperty;function a(e){var t=this.__data__;if(n){var a=t[e];return a===r?void 0:a}return i.call(t,e)?t[e]:void 0}t.exports=a})),JF=r(((exports,t)=>{var n=WF(),r=Object.prototype.hasOwnProperty;function i(e){var t=this.__data__;return n?t[e]!==void 0:r.call(t,e)}t.exports=i})),YF=r(((exports,t)=>{var n=WF(),r=`__lodash_hash_undefined__`;function i(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=n&&t===void 0?r:t,this}t.exports=i})),XF=r(((exports,t)=>{var n=GF(),r=KF(),i=qF(),a=JF(),o=YF();function s(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=n,s.prototype.delete=r,s.prototype.get=i,s.prototype.has=a,s.prototype.set=o,t.exports=s})),ZF=r(((exports,t)=>{var n=XF(),r=wF(),i=UF();function a(){this.size=0,this.__data__={hash:new n,map:new(i||r),string:new n}}t.exports=a})),QF=r(((exports,t)=>{function n(e){var t=typeof e;return t==`string`||t==`number`||t==`symbol`||t==`boolean`?e!==`__proto__`:e===null}t.exports=n})),$F=r(((exports,t)=>{var n=QF();function r(e,t){var r=e.__data__;return n(t)?r[typeof t==`string`?`string`:`hash`]:r.map}t.exports=r})),eI=r(((exports,t)=>{var n=$F();function r(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}t.exports=r})),tI=r(((exports,t)=>{var n=$F();function r(e){return n(this,e).get(e)}t.exports=r})),nI=r(((exports,t)=>{var n=$F();function r(e){return n(this,e).has(e)}t.exports=r})),rI=r(((exports,t)=>{var n=$F();function r(e,t){var r=n(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}t.exports=r})),iI=r(((exports,t)=>{var n=ZF(),r=eI(),i=tI(),a=nI(),o=rI();function s(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=n,s.prototype.delete=r,s.prototype.get=i,s.prototype.has=a,s.prototype.set=o,t.exports=s})),aI=r(((exports,t)=>{var n=wF(),r=UF(),i=iI(),a=200;function o(e,t){var o=this.__data__;if(o instanceof n){var s=o.__data__;if(!r||s.length<a-1)return s.push([e,t]),this.size=++o.size,this;o=this.__data__=new i(s)}return o.set(e,t),this.size=o.size,this}t.exports=o})),oI=r(((exports,t)=>{var n=wF(),r=TF(),i=EF(),a=DF(),o=OF(),s=aI();function c(e){this.size=(this.__data__=new n(e)).size}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=o,c.prototype.set=s,t.exports=c})),sI=r(((exports,t)=>{function n(e,t){for(var n=-1,r=e==null?0:e.length;++n<r&&t(e[n],n,e)!==!1;);return e}t.exports=n})),cI=r(((exports,t)=>{var n=HF();t.exports=function(){try{var e=n(Object,`defineProperty`);return e({},``,{}),e}catch{}}()})),lI=r(((exports,t)=>{var n=cI();function r(e,t,r){t==`__proto__`&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}t.exports=r})),uI=r(((exports,t)=>{var n=lI(),r=vF(),i=Object.prototype.hasOwnProperty;function a(e,t,a){var o=e[t];(!(i.call(e,t)&&r(o,a))||a===void 0&&!(t in e))&&n(e,t,a)}t.exports=a})),dI=r(((exports,t)=>{var n=uI(),r=lI();function i(e,t,i,a){var o=!i;i||={};for(var s=-1,c=t.length;++s<c;){var l=t[s],u=a?a(i[l],e[l],l,i,e):void 0;u===void 0&&(u=e[l]),o?r(i,l,u):n(i,l,u)}return i}t.exports=i})),fI=r(((exports,t)=>{function n(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}t.exports=n})),pI=r(((exports,t)=>{function n(e){return typeof e==`object`&&!!e}t.exports=n})),mI=r(((exports,t)=>{var n=PF(),r=pI(),i=`[object Arguments]`;function a(e){return r(e)&&n(e)==i}t.exports=a})),hI=r(((exports,t)=>{var n=mI(),r=pI(),i=Object.prototype,a=i.hasOwnProperty,o=i.propertyIsEnumerable;t.exports=n(function(){return arguments}())?n:function(e){return r(e)&&a.call(e,`callee`)&&!o.call(e,`callee`)}})),gI=r(((exports,t)=>{t.exports=Array.isArray})),_I=r(((exports,t)=>{function n(){return!1}t.exports=n})),vI=r(((exports,t)=>{var n=AF(),r=_I(),i=typeof exports==`object`&&exports&&!exports.nodeType&&exports,a=i&&typeof t==`object`&&t&&!t.nodeType&&t,o=a&&a.exports===i?n.Buffer:void 0;t.exports=(o?o.isBuffer:void 0)||r})),yI=r(((exports,t)=>{var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function i(e,t){var i=typeof e;return t??=n,!!t&&(i==`number`||i!=`symbol`&&r.test(e))&&e>-1&&e%1==0&&e<t}t.exports=i})),bI=r(((exports,t)=>{var n=9007199254740991;function r(e){return typeof e==`number`&&e>-1&&e%1==0&&e<=n}t.exports=r})),xI=r(((exports,t)=>{var n=PF(),r=bI(),i=pI(),a=`[object Arguments]`,o=`[object Array]`,s=`[object Boolean]`,c=`[object Date]`,l=`[object Error]`,u=`[object Function]`,d=`[object Map]`,f=`[object Number]`,p=`[object Object]`,m=`[object RegExp]`,h=`[object Set]`,g=`[object String]`,_=`[object WeakMap]`,v=`[object ArrayBuffer]`,y=`[object DataView]`,b=`[object Float32Array]`,x=`[object Float64Array]`,S=`[object Int8Array]`,C=`[object Int16Array]`,w=`[object Int32Array]`,T=`[object Uint8Array]`,E=`[object Uint8ClampedArray]`,D=`[object Uint16Array]`,O=`[object Uint32Array]`,k={};k[b]=k[x]=k[S]=k[C]=k[w]=k[T]=k[E]=k[D]=k[O]=!0,k[a]=k[o]=k[v]=k[s]=k[y]=k[c]=k[l]=k[u]=k[d]=k[f]=k[p]=k[m]=k[h]=k[g]=k[_]=!1;function A(e){return i(e)&&r(e.length)&&!!k[n(e)]}t.exports=A})),SI=r(((exports,t)=>{function n(e){return function(t){return e(t)}}t.exports=n})),CI=r(((exports,t)=>{var n=kF(),r=typeof exports==`object`&&exports&&!exports.nodeType&&exports,i=r&&typeof t==`object`&&t&&!t.nodeType&&t,a=i&&i.exports===r&&n.process;t.exports=function(){try{return i&&i.require&&i.require(`util`).types||a&&a.binding&&a.binding(`util`)}catch{}}()})),wI=r(((exports,t)=>{var n=xI(),r=SI(),i=CI(),a=i&&i.isTypedArray;t.exports=a?r(a):n})),TI=r(((exports,t)=>{var n=fI(),r=hI(),i=gI(),a=vI(),o=yI(),s=wI(),c=Object.prototype.hasOwnProperty;function l(e,t){var l=i(e),u=!l&&r(e),d=!l&&!u&&a(e),f=!l&&!u&&!d&&s(e),p=l||u||d||f,m=p?n(e.length,String):[],h=m.length;for(var g in e)(t||c.call(e,g))&&!(p&&(g==`length`||d&&(g==`offset`||g==`parent`)||f&&(g==`buffer`||g==`byteLength`||g==`byteOffset`)||o(g,h)))&&m.push(g);return m}t.exports=l})),EI=r(((exports,t)=>{var n=Object.prototype;function r(e){var t=e&&e.constructor,r=typeof t==`function`&&t.prototype||n;return e===r}t.exports=r})),DI=r(((exports,t)=>{function n(e,t){return function(n){return e(t(n))}}t.exports=n})),OI=r(((exports,t)=>{t.exports=DI()(Object.keys,Object)})),kI=r(((exports,t)=>{var n=EI(),r=OI(),i=Object.prototype.hasOwnProperty;function a(e){if(!n(e))return r(e);var t=[];for(var a in Object(e))i.call(e,a)&&a!=`constructor`&&t.push(a);return t}t.exports=a})),AI=r(((exports,t)=>{var n=IF(),r=bI();function i(e){return e!=null&&r(e.length)&&!n(e)}t.exports=i})),jI=r(((exports,t)=>{var n=TI(),r=kI(),i=AI();function a(e){return i(e)?n(e):r(e)}t.exports=a})),MI=r(((exports,t)=>{var n=dI(),r=jI();function i(e,t){return e&&n(t,r(t),e)}t.exports=i})),NI=r(((exports,t)=>{function n(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}t.exports=n})),PI=r(((exports,t)=>{var n=FF(),r=EI(),i=NI(),a=Object.prototype.hasOwnProperty;function o(e){if(!n(e))return i(e);var t=r(e),o=[];for(var s in e)s==`constructor`&&(t||!a.call(e,s))||o.push(s);return o}t.exports=o})),FI=r(((exports,t)=>{var n=TI(),r=PI(),i=AI();function a(e){return i(e)?n(e,!0):r(e)}t.exports=a})),II=r(((exports,t)=>{var n=dI(),r=FI();function i(e,t){return e&&n(t,r(t),e)}t.exports=i})),LI=r(((exports,t)=>{var n=AF(),r=typeof exports==`object`&&exports&&!exports.nodeType&&exports,i=r&&typeof t==`object`&&t&&!t.nodeType&&t,a=i&&i.exports===r?n.Buffer:void 0,o=a?a.allocUnsafe:void 0;function s(e,t){if(t)return e.slice();var n=e.length,r=o?o(n):new e.constructor(n);return e.copy(r),r}t.exports=s})),RI=r(((exports,t)=>{function n(e,t){var n=-1,r=e.length;for(t||=Array(r);++n<r;)t[n]=e[n];return t}t.exports=n})),zI=r(((exports,t)=>{function n(e,t){for(var n=-1,r=e==null?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}t.exports=n})),BI=r(((exports,t)=>{function n(){return[]}t.exports=n})),VI=r(((exports,t)=>{var n=zI(),r=BI(),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols;t.exports=a?function(e){return e==null?[]:(e=Object(e),n(a(e),function(t){return i.call(e,t)}))}:r})),HI=r(((exports,t)=>{var n=dI(),r=VI();function i(e,t){return n(e,r(e),t)}t.exports=i})),UI=r(((exports,t)=>{function n(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}t.exports=n})),WI=r(((exports,t)=>{t.exports=DI()(Object.getPrototypeOf,Object)})),GI=r(((exports,t)=>{var n=UI(),r=WI(),i=VI(),a=BI();t.exports=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,i(e)),e=r(e);return t}:a})),KI=r(((exports,t)=>{var n=dI(),r=GI();function i(e,t){return n(e,r(e),t)}t.exports=i})),qI=r(((exports,t)=>{var n=UI(),r=gI();function i(e,t,i){var a=t(e);return r(e)?a:n(a,i(e))}t.exports=i})),JI=r(((exports,t)=>{var n=qI(),r=VI(),i=jI();function a(e){return n(e,i,r)}t.exports=a})),YI=r(((exports,t)=>{var n=qI(),r=GI(),i=FI();function a(e){return n(e,i,r)}t.exports=a})),XI=r(((exports,t)=>{var n=HF(),r=AF();t.exports=n(r,`DataView`)})),ZI=r(((exports,t)=>{var n=HF(),r=AF();t.exports=n(r,`Promise`)})),QI=r(((exports,t)=>{var n=HF(),r=AF();t.exports=n(r,`Set`)})),$I=r(((exports,t)=>{var n=HF(),r=AF();t.exports=n(r,`WeakMap`)})),eL=r(((exports,t)=>{var n=XI(),r=UF(),i=ZI(),a=QI(),o=$I(),s=PF(),c=zF(),l=`[object Map]`,u=`[object Object]`,d=`[object Promise]`,f=`[object Set]`,p=`[object WeakMap]`,m=`[object DataView]`,h=c(n),g=c(r),_=c(i),v=c(a),y=c(o),b=s;(n&&b(new n(new ArrayBuffer(1)))!=m||r&&b(new r)!=l||i&&b(i.resolve())!=d||a&&b(new a)!=f||o&&b(new o)!=p)&&(b=function(e){var t=s(e),n=t==u?e.constructor:void 0,r=n?c(n):``;if(r)switch(r){case h:return m;case g:return l;case _:return d;case v:return f;case y:return p}return t}),t.exports=b})),tL=r(((exports,t)=>{var n=Object.prototype.hasOwnProperty;function r(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]==`string`&&n.call(e,`index`)&&(r.index=e.index,r.input=e.input),r}t.exports=r})),nL=r(((exports,t)=>{t.exports=AF().Uint8Array})),rL=r(((exports,t)=>{var n=nL();function r(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}t.exports=r})),iL=r(((exports,t)=>{var n=rL();function r(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}t.exports=r})),aL=r(((exports,t)=>{var n=/\w*$/;function r(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}t.exports=r})),oL=r(((exports,t)=>{var n=jF(),r=n?n.prototype:void 0,i=r?r.valueOf:void 0;function a(e){return i?Object(i.call(e)):{}}t.exports=a})),sL=r(((exports,t)=>{var n=rL();function r(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}t.exports=r})),cL=r(((exports,t)=>{var n=rL(),r=iL(),i=aL(),a=oL(),o=sL(),s=`[object Boolean]`,c=`[object Date]`,l=`[object Map]`,u=`[object Number]`,d=`[object RegExp]`,f=`[object Set]`,p=`[object String]`,m=`[object Symbol]`,h=`[object ArrayBuffer]`,g=`[object DataView]`,_=`[object Float32Array]`,v=`[object Float64Array]`,y=`[object Int8Array]`,b=`[object Int16Array]`,x=`[object Int32Array]`,S=`[object Uint8Array]`,C=`[object Uint8ClampedArray]`,w=`[object Uint16Array]`,T=`[object Uint32Array]`;function E(e,t,E){var D=e.constructor;switch(t){case h:return n(e);case s:case c:return new D(+e);case g:return r(e,E);case _:case v:case y:case b:case x:case S:case C:case w:case T:return o(e,E);case l:return new D;case u:case p:return new D(e);case d:return i(e);case f:return new D;case m:return a(e)}}t.exports=E})),lL=r(((exports,t)=>{var n=FF(),r=Object.create;t.exports=function(){function e(){}return function(t){if(!n(t))return{};if(r)return r(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}()})),uL=r(((exports,t)=>{var n=lL(),r=WI(),i=EI();function a(e){return typeof e.constructor==`function`&&!i(e)?n(r(e)):{}}t.exports=a})),dL=r(((exports,t)=>{var n=eL(),r=pI(),i=`[object Map]`;function a(e){return r(e)&&n(e)==i}t.exports=a})),fL=r(((exports,t)=>{var n=dL(),r=SI(),i=CI(),a=i&&i.isMap;t.exports=a?r(a):n})),pL=r(((exports,t)=>{var n=eL(),r=pI(),i=`[object Set]`;function a(e){return r(e)&&n(e)==i}t.exports=a})),mL=r(((exports,t)=>{var n=pL(),r=SI(),i=CI(),a=i&&i.isSet;t.exports=a?r(a):n})),hL=r(((exports,t)=>{var n=oI(),r=sI(),i=uI(),a=MI(),o=II(),s=LI(),c=RI(),l=HI(),u=KI(),d=JI(),f=YI(),p=eL(),m=tL(),h=cL(),g=uL(),_=gI(),v=vI(),y=fL(),b=FF(),x=mL(),S=jI(),C=FI(),w=1,T=2,E=4,D=`[object Arguments]`,O=`[object Array]`,k=`[object Boolean]`,A=`[object Date]`,j=`[object Error]`,ee=`[object Function]`,te=`[object GeneratorFunction]`,M=`[object Map]`,ne=`[object Number]`,re=`[object Object]`,ie=`[object RegExp]`,ae=`[object Set]`,oe=`[object String]`,se=`[object Symbol]`,ce=`[object WeakMap]`,le=`[object ArrayBuffer]`,N=`[object DataView]`,ue=`[object Float32Array]`,de=`[object Float64Array]`,fe=`[object Int8Array]`,pe=`[object Int16Array]`,me=`[object Int32Array]`,he=`[object Uint8Array]`,ge=`[object Uint8ClampedArray]`,_e=`[object Uint16Array]`,ve=`[object Uint32Array]`,P={};P[D]=P[O]=P[le]=P[N]=P[k]=P[A]=P[ue]=P[de]=P[fe]=P[pe]=P[me]=P[M]=P[ne]=P[re]=P[ie]=P[ae]=P[oe]=P[se]=P[he]=P[ge]=P[_e]=P[ve]=!0,P[j]=P[ee]=P[ce]=!1;function ye(e,t,O,k,A,j){var M,ne=t&w,ie=t&T,ae=t&E;if(O&&(M=A?O(e,k,A,j):O(e)),M!==void 0)return M;if(!b(e))return e;var oe=_(e);if(oe){if(M=m(e),!ne)return c(e,M)}else{var se=p(e),ce=se==ee||se==te;if(v(e))return s(e,ne);if(se==re||se==D||ce&&!A){if(M=ie||ce?{}:g(e),!ne)return ie?u(e,o(M,e)):l(e,a(M,e))}else{if(!P[se])return A?e:{};M=h(e,se,ne)}}j||=new n;var le=j.get(e);if(le)return le;j.set(e,M),x(e)?e.forEach(function(n){M.add(ye(n,t,O,n,e,j))}):y(e)&&e.forEach(function(n,r){M.set(r,ye(n,t,O,r,e,j))});var N=oe?void 0:(ae?ie?f:d:ie?C:S)(e);return r(N||e,function(n,r){N&&(r=n,n=e[r]),i(M,r,ye(n,t,O,r,e,j))}),M}t.exports=ye})),gL=r(((exports,t)=>{var n=hL(),r=4;function i(e){return n(e,r)}t.exports=i})),_L=r(((exports,t)=>{function n(e){return function(){return e}}t.exports=n})),vL=r(((exports,t)=>{function n(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var c=o[e?s:++i];if(n(a[c],c,a)===!1)break}return t}}t.exports=n})),yL=r(((exports,t)=>{t.exports=vL()()})),bL=r(((exports,t)=>{var n=yL(),r=jI();function i(e,t){return e&&n(e,t,r)}t.exports=i})),xL=r(((exports,t)=>{var n=AI();function r(e,t){return function(r,i){if(r==null)return r;if(!n(r))return e(r,i);for(var a=r.length,o=t?a:-1,s=Object(r);(t?o--:++o<a)&&i(s[o],o,s)!==!1;);return r}}t.exports=r})),SL=r(((exports,t)=>{var n=bL();t.exports=xL()(n)})),CL=r(((exports,t)=>{function n(e){return e}t.exports=n})),wL=r(((exports,t)=>{var n=CL();function r(e){return typeof e==`function`?e:n}t.exports=r})),TL=r(((exports,t)=>{var n=sI(),r=SL(),i=wL(),a=gI();function o(e,t){return(a(e)?n:r)(e,i(t))}t.exports=o})),EL=r(((exports,t)=>{t.exports=TL()})),DL=r(((exports,t)=>{var n=SL();function r(e,t){var r=[];return n(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}t.exports=r})),OL=r(((exports,t)=>{var n=`__lodash_hash_undefined__`;function r(e){return this.__data__.set(e,n),this}t.exports=r})),kL=r(((exports,t)=>{function n(e){return this.__data__.has(e)}t.exports=n})),AL=r(((exports,t)=>{var n=iI(),r=OL(),i=kL();function a(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}a.prototype.add=a.prototype.push=r,a.prototype.has=i,t.exports=a})),jL=r(((exports,t)=>{function n(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}t.exports=n})),ML=r(((exports,t)=>{function n(e,t){return e.has(t)}t.exports=n})),NL=r(((exports,t)=>{var n=AL(),r=jL(),i=ML(),a=1,o=2;function s(e,t,s,c,l,u){var d=s&a,f=e.length,p=t.length;if(f!=p&&!(d&&p>f))return!1;var m=u.get(e),h=u.get(t);if(m&&h)return m==t&&h==e;var g=-1,_=!0,v=s&o?new n:void 0;for(u.set(e,t),u.set(t,e);++g<f;){var y=e[g],b=t[g];if(c)var x=d?c(b,y,g,t,e,u):c(y,b,g,e,t,u);if(x!==void 0){if(x)continue;_=!1;break}if(v){if(!r(t,function(e,t){if(!i(v,t)&&(y===e||l(y,e,s,c,u)))return v.push(t)})){_=!1;break}}else if(!(y===b||l(y,b,s,c,u))){_=!1;break}}return u.delete(e),u.delete(t),_}t.exports=s})),PL=r(((exports,t)=>{function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}t.exports=n})),FL=r(((exports,t)=>{function n(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}t.exports=n})),IL=r(((exports,t)=>{var n=jF(),r=nL(),i=vF(),a=NL(),o=PL(),s=FL(),c=1,l=2,u=`[object Boolean]`,d=`[object Date]`,f=`[object Error]`,p=`[object Map]`,m=`[object Number]`,h=`[object RegExp]`,g=`[object Set]`,_=`[object String]`,v=`[object Symbol]`,y=`[object ArrayBuffer]`,b=`[object DataView]`,x=n?n.prototype:void 0,S=x?x.valueOf:void 0;function C(e,t,n,x,C,w,T){switch(n){case b:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case y:return!(e.byteLength!=t.byteLength||!w(new r(e),new r(t)));case u:case d:case m:return i(+e,+t);case f:return e.name==t.name&&e.message==t.message;case h:case _:return e==t+``;case p:var E=o;case g:var D=x&c;if(E||=s,e.size!=t.size&&!D)return!1;var O=T.get(e);if(O)return O==t;x|=l,T.set(e,t);var k=a(E(e),E(t),x,C,w,T);return T.delete(e),k;case v:if(S)return S.call(e)==S.call(t)}return!1}t.exports=C})),LL=r(((exports,t)=>{var n=JI(),r=1,i=Object.prototype.hasOwnProperty;function a(e,t,a,o,s,c){var l=a&r,u=n(e),d=u.length,f=n(t),p=f.length;if(d!=p&&!l)return!1;for(var m=d;m--;){var h=u[m];if(!(l?h in t:i.call(t,h)))return!1}var g=c.get(e),_=c.get(t);if(g&&_)return g==t&&_==e;var v=!0;c.set(e,t),c.set(t,e);for(var y=l;++m<d;){h=u[m];var b=e[h],x=t[h];if(o)var S=l?o(x,b,h,t,e,c):o(b,x,h,e,t,c);if(!(S===void 0?b===x||s(b,x,a,o,c):S)){v=!1;break}y||=h==`constructor`}if(v&&!y){var C=e.constructor,w=t.constructor;C!=w&&`constructor`in e&&`constructor`in t&&!(typeof C==`function`&&C instanceof C&&typeof w==`function`&&w instanceof w)&&(v=!1)}return c.delete(e),c.delete(t),v}t.exports=a})),RL=r(((exports,t)=>{var n=oI(),r=NL(),i=IL(),a=LL(),o=eL(),s=gI(),c=vI(),l=wI(),u=1,d=`[object Arguments]`,f=`[object Array]`,p=`[object Object]`,m=Object.prototype.hasOwnProperty;function h(e,t,h,g,_,v){var y=s(e),b=s(t),x=y?f:o(e),S=b?f:o(t);x=x==d?p:x,S=S==d?p:S;var C=x==p,w=S==p,T=x==S;if(T&&c(e)){if(!c(t))return!1;y=!0,C=!1}if(T&&!C)return v||=new n,y||l(e)?r(e,t,h,g,_,v):i(e,t,x,h,g,_,v);if(!(h&u)){var E=C&&m.call(e,`__wrapped__`),D=w&&m.call(t,`__wrapped__`);if(E||D){var O=E?e.value():e,k=D?t.value():t;return v||=new n,_(O,k,h,g,v)}}return T?(v||=new n,a(e,t,h,g,_,v)):!1}t.exports=h})),zL=r(((exports,t)=>{var n=RL(),r=pI();function i(e,t,a,o,s){return e===t?!0:e==null||t==null||!r(e)&&!r(t)?e!==e&&t!==t:n(e,t,a,o,i,s)}t.exports=i})),BL=r(((exports,t)=>{var n=oI(),r=zL(),i=1,a=2;function o(e,t,o,s){var c=o.length,l=c,u=!s;if(e==null)return!l;for(e=Object(e);c--;){var d=o[c];if(u&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++c<l;){d=o[c];var f=d[0],p=e[f],m=d[1];if(u&&d[2]){if(p===void 0&&!(f in e))return!1}else{var h=new n;if(s)var g=s(p,m,f,e,t,h);if(!(g===void 0?r(m,p,i|a,s,h):g))return!1}}return!0}t.exports=o})),VL=r(((exports,t)=>{var n=FF();function r(e){return e===e&&!n(e)}t.exports=r})),HL=r(((exports,t)=>{var n=VL(),r=jI();function i(e){for(var t=r(e),i=t.length;i--;){var a=t[i],o=e[a];t[i]=[a,o,n(o)]}return t}t.exports=i})),UL=r(((exports,t)=>{function n(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}t.exports=n})),WL=r(((exports,t)=>{var n=BL(),r=HL(),i=UL();function a(e){var t=r(e);return t.length==1&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}t.exports=a})),GL=r(((exports,t)=>{var n=PF(),r=pI(),i=`[object Symbol]`;function a(e){return typeof e==`symbol`||r(e)&&n(e)==i}t.exports=a})),KL=r(((exports,t)=>{var n=gI(),r=GL(),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function o(e,t){if(n(e))return!1;var o=typeof e;return o==`number`||o==`symbol`||o==`boolean`||e==null||r(e)?!0:a.test(e)||!i.test(e)||t!=null&&e in Object(t)}t.exports=o})),qL=r(((exports,t)=>{var n=iI(),r=`Expected a function`;function i(e,t){if(typeof e!=`function`||t!=null&&typeof t!=`function`)throw TypeError(r);var a=function(){var n=arguments,r=t?t.apply(this,n):n[0],i=a.cache;if(i.has(r))return i.get(r);var o=e.apply(this,n);return a.cache=i.set(r,o)||i,o};return a.cache=new(i.Cache||n),a}i.Cache=n,t.exports=i})),JL=r(((exports,t)=>{var n=qL(),r=500;function i(e){var t=n(e,function(e){return i.size===r&&i.clear(),e}),i=t.cache;return t}t.exports=i})),YL=r(((exports,t)=>{var n=JL(),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g;t.exports=n(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(``),e.replace(r,function(e,n,r,a){t.push(r?a.replace(i,`$1`):n||e)}),t})})),XL=r(((exports,t)=>{function n(e,t){for(var n=-1,r=e==null?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}t.exports=n})),ZL=r(((exports,t)=>{var n=jF(),r=XL(),i=gI(),a=GL(),o=1/0,s=n?n.prototype:void 0,c=s?s.toString:void 0;function l(e){if(typeof e==`string`)return e;if(i(e))return r(e,l)+``;if(a(e))return c?c.call(e):``;var t=e+``;return t==`0`&&1/e==-o?`-0`:t}t.exports=l})),QL=r(((exports,t)=>{var n=ZL();function r(e){return e==null?``:n(e)}t.exports=r})),$L=r(((exports,t)=>{var n=gI(),r=KL(),i=YL(),a=QL();function o(e,t){return n(e)?e:r(e,t)?[e]:i(a(e))}t.exports=o})),eR=r(((exports,t)=>{var n=GL(),r=1/0;function i(e){if(typeof e==`string`||n(e))return e;var t=e+``;return t==`0`&&1/e==-r?`-0`:t}t.exports=i})),tR=r(((exports,t)=>{var n=$L(),r=eR();function i(e,t){t=n(t,e);for(var i=0,a=t.length;e!=null&&i<a;)e=e[r(t[i++])];return i&&i==a?e:void 0}t.exports=i})),nR=r(((exports,t)=>{var n=tR();function r(e,t,r){var i=e==null?void 0:n(e,t);return i===void 0?r:i}t.exports=r})),rR=r(((exports,t)=>{function n(e,t){return e!=null&&t in Object(e)}t.exports=n})),iR=r(((exports,t)=>{var n=$L(),r=hI(),i=gI(),a=yI(),o=bI(),s=eR();function c(e,t,c){t=n(t,e);for(var l=-1,u=t.length,d=!1;++l<u;){var f=s(t[l]);if(!(d=e!=null&&c(e,f)))break;e=e[f]}return d||++l!=u?d:(u=e==null?0:e.length,!!u&&o(u)&&a(f,u)&&(i(e)||r(e)))}t.exports=c})),aR=r(((exports,t)=>{var n=rR(),r=iR();function i(e,t){return e!=null&&r(e,t,n)}t.exports=i})),oR=r(((exports,t)=>{var n=zL(),r=nR(),i=aR(),a=KL(),o=VL(),s=UL(),c=eR(),l=1,u=2;function d(e,t){return a(e)&&o(t)?s(c(e),t):function(a){var o=r(a,e);return o===void 0&&o===t?i(a,e):n(t,o,l|u)}}t.exports=d})),sR=r(((exports,t)=>{function n(e){return function(t){return t?.[e]}}t.exports=n})),cR=r(((exports,t)=>{var n=tR();function r(e){return function(t){return n(t,e)}}t.exports=r})),lR=r(((exports,t)=>{var n=sR(),r=cR(),i=KL(),a=eR();function o(e){return i(e)?n(a(e)):r(e)}t.exports=o})),uR=r(((exports,t)=>{var n=WL(),r=oR(),i=CL(),a=gI(),o=lR();function s(e){return typeof e==`function`?e:e==null?i:typeof e==`object`?a(e)?r(e[0],e[1]):n(e):o(e)}t.exports=s})),dR=r(((exports,t)=>{var n=zI(),r=DL(),i=uR(),a=gI();function o(e,t){return(a(e)?n:r)(e,i(t,3))}t.exports=o})),fR=r(((exports,t)=>{var n=Object.prototype.hasOwnProperty;function r(e,t){return e!=null&&n.call(e,t)}t.exports=r})),pR=r(((exports,t)=>{var n=fR(),r=iR();function i(e,t){return e!=null&&r(e,t,n)}t.exports=i})),mR=r(((exports,t)=>{var n=kI(),r=eL(),i=hI(),a=gI(),o=AI(),s=vI(),c=EI(),l=wI(),u=`[object Map]`,d=`[object Set]`,f=Object.prototype.hasOwnProperty;function p(e){if(e==null)return!0;if(o(e)&&(a(e)||typeof e==`string`||typeof e.splice==`function`||s(e)||l(e)||i(e)))return!e.length;var t=r(e);if(t==u||t==d)return!e.size;if(c(e))return!n(e).length;for(var p in e)if(f.call(e,p))return!1;return!0}t.exports=p})),hR=r(((exports,t)=>{function n(e){return e===void 0}t.exports=n})),gR=r(((exports,t)=>{var n=SL(),r=AI();function i(e,t){var i=-1,a=r(e)?Array(e.length):[];return n(e,function(e,n,r){a[++i]=t(e,n,r)}),a}t.exports=i})),_R=r(((exports,t)=>{var n=XL(),r=uR(),i=gR(),a=gI();function o(e,t){return(a(e)?n:i)(e,r(t,3))}t.exports=o})),vR=r(((exports,t)=>{function n(e,t,n,r){var i=-1,a=e==null?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}t.exports=n})),yR=r(((exports,t)=>{function n(e,t,n,r,i){return i(e,function(e,i,a){n=r?(r=!1,e):t(n,e,i,a)}),n}t.exports=n})),bR=r(((exports,t)=>{var n=vR(),r=SL(),i=uR(),a=yR(),o=gI();function s(e,t,s){var c=o(e)?n:a,l=arguments.length<3;return c(e,i(t,4),s,l,r)}t.exports=s})),xR=r(((exports,t)=>{var n=PF(),r=gI(),i=pI(),a=`[object String]`;function o(e){return typeof e==`string`||!r(e)&&i(e)&&n(e)==a}t.exports=o})),SR=r(((exports,t)=>{t.exports=sR()(`length`)})),CR=r(((exports,t)=>{var n=`\\ud800-\\udfff`,r=`\\u0300-\\u036f`,i=`\\ufe20-\\ufe2f`,a=`\\u20d0-\\u20ff`,o=r+i+a,s=RegExp(`[\\u200d`+n+o+`\\ufe0e\\ufe0f]`);function c(e){return s.test(e)}t.exports=c})),wR=r(((exports,t)=>{var n=`\\ud800-\\udfff`,r=`\\u0300-\\u036f`,i=`\\ufe20-\\ufe2f`,a=`\\u20d0-\\u20ff`,o=r+i+a,s=`\\ufe0e\\ufe0f`,c=`[`+n+`]`,l=`[`+o+`]`,u=`\\ud83c[\\udffb-\\udfff]`,d=`(?:`+l+`|`+u+`)`,f=`[^`+n+`]`,p=`(?:\\ud83c[\\udde6-\\uddff]){2}`,m=`[\\ud800-\\udbff][\\udc00-\\udfff]`,h=`\\u200d`,g=d+`?`,_=`[`+s+`]?`,v=`(?:`+h+`(?:`+[f,p,m].join(`|`)+`)`+_+g+`)*`,y=_+g+v,b=`(?:`+[f+l+`?`,l,p,m,c].join(`|`)+`)`,x=RegExp(u+`(?=`+u+`)|`+b+y,`g`);function S(e){for(var t=x.lastIndex=0;x.test(e);)++t;return t}t.exports=S})),TR=r(((exports,t)=>{var n=SR(),r=CR(),i=wR();function a(e){return r(e)?i(e):n(e)}t.exports=a})),ER=r(((exports,t)=>{var n=kI(),r=eL(),i=AI(),a=xR(),o=TR(),s=`[object Map]`,c=`[object Set]`;function l(e){if(e==null)return 0;if(i(e))return a(e)?o(e):e.length;var t=r(e);return t==s||t==c?e.size:n(e).length}t.exports=l})),DR=r(((exports,t)=>{var n=sI(),r=lL(),i=bL(),a=uR(),o=WI(),s=gI(),c=vI(),l=IF(),u=FF(),d=wI();function f(e,t,f){var p=s(e),m=p||c(e)||d(e);if(t=a(t,4),f==null){var h=e&&e.constructor;f=m?p?new h:[]:u(e)&&l(h)?r(o(e)):{}}return(m?n:i)(e,function(e,n,r){return t(f,e,n,r)}),f}t.exports=f})),OR=r(((exports,t)=>{var n=jF(),r=hI(),i=gI(),a=n?n.isConcatSpreadable:void 0;function o(e){return i(e)||r(e)||!!(a&&e&&e[a])}t.exports=o})),kR=r(((exports,t)=>{var n=UI(),r=OR();function i(e,t,a,o,s){var c=-1,l=e.length;for(a||=r,s||=[];++c<l;){var u=e[c];t>0&&a(u)?t>1?i(u,t-1,a,o,s):n(s,u):o||(s[s.length]=u)}return s}t.exports=i})),AR=r(((exports,t)=>{function n(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}t.exports=n})),jR=r(((exports,t)=>{var n=AR(),r=Math.max;function i(e,t,i){return t=r(t===void 0?e.length-1:t,0),function(){for(var a=arguments,o=-1,s=r(a.length-t,0),c=Array(s);++o<s;)c[o]=a[t+o];o=-1;for(var l=Array(t+1);++o<t;)l[o]=a[o];return l[t]=i(c),n(e,this,l)}}t.exports=i})),MR=r(((exports,t)=>{var n=_L(),r=cI(),i=CL();t.exports=r?function(e,t){return r(e,`toString`,{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i})),NR=r(((exports,t)=>{var n=800,r=16,i=Date.now;function a(e){var t=0,a=0;return function(){var o=i(),s=r-(o-a);if(a=o,s>0){if(++t>=n)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}t.exports=a})),PR=r(((exports,t)=>{var n=MR();t.exports=NR()(n)})),FR=r(((exports,t)=>{var n=CL(),r=jR(),i=PR();function a(e,t){return i(r(e,t,n),e+``)}t.exports=a})),IR=r(((exports,t)=>{function n(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}t.exports=n})),LR=r(((exports,t)=>{function n(e){return e!==e}t.exports=n})),RR=r(((exports,t)=>{function n(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}t.exports=n})),zR=r(((exports,t)=>{var n=IR(),r=LR(),i=RR();function a(e,t,a){return t===t?i(e,t,a):n(e,r,a)}t.exports=a})),BR=r(((exports,t)=>{var n=zR();function r(e,t){return!!(e!=null&&e.length)&&n(e,t,0)>-1}t.exports=r})),VR=r(((exports,t)=>{function n(e,t,n){for(var r=-1,i=e==null?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}t.exports=n})),HR=r(((exports,t)=>{function n(){}t.exports=n})),UR=r(((exports,t)=>{var n=QI(),r=HR(),i=FL();t.exports=n&&1/i(new n([,-0]))[1]==1/0?function(e){return new n(e)}:r})),WR=r(((exports,t)=>{var n=AL(),r=BR(),i=VR(),a=ML(),o=UR(),s=FL(),c=200;function l(e,t,l){var u=-1,d=r,f=e.length,p=!0,m=[],h=m;if(l)p=!1,d=i;else if(f>=c){var g=t?null:o(e);if(g)return s(g);p=!1,d=a,h=new n}else h=t?[]:m;outer:for(;++u<f;){var _=e[u],v=t?t(_):_;if(_=l||_!==0?_:0,p&&v===v){for(var y=h.length;y--;)if(h[y]===v)continue outer;t&&h.push(v),m.push(_)}else d(h,v,l)||(h!==m&&h.push(v),m.push(_))}return m}t.exports=l})),GR=r(((exports,t)=>{var n=AI(),r=pI();function i(e){return r(e)&&n(e)}t.exports=i})),KR=r(((exports,t)=>{var n=kR(),r=FR(),i=WR(),a=GR();t.exports=r(function(e){return i(n(e,1,a,!0))})})),qR=r(((exports,t)=>{var n=XL();function r(e,t){return n(t,function(t){return e[t]})}t.exports=r})),JR=r(((exports,t)=>{var n=qR(),r=jI();function i(e){return e==null?[]:n(e,r(e))}t.exports=i})),YR=r(((exports,n)=>{var r;if(typeof e==`function`)try{r={clone:gL(),constant:_L(),each:EL(),filter:dR(),has:pR(),isArray:gI(),isEmpty:mR(),isFunction:IF(),isUndefined:hR(),keys:jI(),map:_R(),reduce:bR(),size:ER(),transform:DR(),union:KR(),values:JR()}}catch{}r||=window._,n.exports=r})),XR=r(((exports,t)=>{var n=YR();t.exports=o;var r=`\0`,i=`\0`,a=``;function o(e){this._isDirected=n.has(e,`directed`)?e.directed:!0,this._isMultigraph=n.has(e,`multigraph`)?e.multigraph:!1,this._isCompound=n.has(e,`compound`)?e.compound:!1,this._label=void 0,this._defaultNodeLabelFn=n.constant(void 0),this._defaultEdgeLabelFn=n.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[i]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}o.prototype._nodeCount=0,o.prototype._edgeCount=0,o.prototype.isDirected=function(){return this._isDirected},o.prototype.isMultigraph=function(){return this._isMultigraph},o.prototype.isCompound=function(){return this._isCompound},o.prototype.setGraph=function(e){return this._label=e,this},o.prototype.graph=function(){return this._label},o.prototype.setDefaultNodeLabel=function(e){return n.isFunction(e)||(e=n.constant(e)),this._defaultNodeLabelFn=e,this},o.prototype.nodeCount=function(){return this._nodeCount},o.prototype.nodes=function(){return n.keys(this._nodes)},o.prototype.sources=function(){var e=this;return n.filter(this.nodes(),function(t){return n.isEmpty(e._in[t])})},o.prototype.sinks=function(){var e=this;return n.filter(this.nodes(),function(t){return n.isEmpty(e._out[t])})},o.prototype.setNodes=function(e,t){var r=arguments,i=this;return n.each(e,function(e){r.length>1?i.setNode(e,t):i.setNode(e)}),this},o.prototype.setNode=function(e,t){return n.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=i,this._children[e]={},this._children[i][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},o.prototype.node=function(e){return this._nodes[e]},o.prototype.hasNode=function(e){return n.has(this._nodes,e)},o.prototype.removeNode=function(e){var t=this;if(n.has(this._nodes,e)){var r=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],n.each(this.children(e),function(e){t.setParent(e)}),delete this._children[e]),n.each(n.keys(this._in[e]),r),delete this._in[e],delete this._preds[e],n.each(n.keys(this._out[e]),r),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},o.prototype.setParent=function(e,t){if(!this._isCompound)throw Error(`Cannot set parent in a non-compound graph`);if(n.isUndefined(t))t=i;else{t+=``;for(var r=t;!n.isUndefined(r);r=this.parent(r))if(r===e)throw Error(`Setting `+t+` as parent of `+e+` would create a cycle`);this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},o.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},o.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==i)return t}},o.prototype.children=function(e){if(n.isUndefined(e)&&(e=i),this._isCompound){var t=this._children[e];if(t)return n.keys(t)}else if(e===i)return this.nodes();else if(this.hasNode(e))return[]},o.prototype.predecessors=function(e){var t=this._preds[e];if(t)return n.keys(t)},o.prototype.successors=function(e){var t=this._sucs[e];if(t)return n.keys(t)},o.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return n.union(t,this.successors(e))},o.prototype.isLeaf=function(e){return(this.isDirected()?this.successors(e):this.neighbors(e)).length===0},o.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var r=this;n.each(this._nodes,function(n,r){e(r)&&t.setNode(r,n)}),n.each(this._edgeObjs,function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,r.edge(e))});var i={};function a(e){var n=r.parent(e);return n===void 0||t.hasNode(n)?(i[e]=n,n):n in i?i[n]:a(n)}return this._isCompound&&n.each(t.nodes(),function(e){t.setParent(e,a(e))}),t},o.prototype.setDefaultEdgeLabel=function(e){return n.isFunction(e)||(e=n.constant(e)),this._defaultEdgeLabelFn=e,this},o.prototype.edgeCount=function(){return this._edgeCount},o.prototype.edges=function(){return n.values(this._edgeObjs)},o.prototype.setPath=function(e,t){var r=this,i=arguments;return n.reduce(e,function(e,n){return i.length>1?r.setEdge(e,n,t):r.setEdge(e,n),n}),this},o.prototype.setEdge=function(){var e,t,r,i,a=!1,o=arguments[0];typeof o==`object`&&o&&`v`in o?(e=o.v,t=o.w,r=o.name,arguments.length===2&&(i=arguments[1],a=!0)):(e=o,t=arguments[1],r=arguments[3],arguments.length>2&&(i=arguments[2],a=!0)),e=``+e,t=``+t,n.isUndefined(r)||(r=``+r);var c=l(this._isDirected,e,t,r);if(n.has(this._edgeLabels,c))return a&&(this._edgeLabels[c]=i),this;if(!n.isUndefined(r)&&!this._isMultigraph)throw Error(`Cannot set a named edge when isMultigraph = false`);this.setNode(e),this.setNode(t),this._edgeLabels[c]=a?i:this._defaultEdgeLabelFn(e,t,r);var d=u(this._isDirected,e,t,r);return e=d.v,t=d.w,Object.freeze(d),this._edgeObjs[c]=d,s(this._preds[t],e),s(this._sucs[e],t),this._in[t][c]=d,this._out[e][c]=d,this._edgeCount++,this},o.prototype.edge=function(e,t,n){var r=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return this._edgeLabels[r]},o.prototype.hasEdge=function(e,t,r){var i=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,r);return n.has(this._edgeLabels,i)},o.prototype.removeEdge=function(e,t,n){var r=arguments.length===1?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],c(this._preds[t],e),c(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},o.prototype.inEdges=function(e,t){var r=this._in[e];if(r){var i=n.values(r);return t?n.filter(i,function(e){return e.v===t}):i}},o.prototype.outEdges=function(e,t){var r=this._out[e];if(r){var i=n.values(r);return t?n.filter(i,function(e){return e.w===t}):i}},o.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))};function s(e,t){e[t]?e[t]++:e[t]=1}function c(e,t){--e[t]||delete e[t]}function l(e,t,i,o){var s=``+t,c=``+i;if(!e&&s>c){var l=s;s=c,c=l}return s+a+c+a+(n.isUndefined(o)?r:o)}function u(e,t,n,r){var i=``+t,a=``+n;if(!e&&i>a){var o=i;i=a,a=o}var s={v:i,w:a};return r&&(s.name=r),s}function d(e,t){return l(e,t.v,t.w,t.name)}})),ZR=r(((exports,t)=>{t.exports=`2.1.8`})),QR=r(((exports,t)=>{t.exports={Graph:XR(),version:ZR()}})),$R=r(((exports,t)=>{var n=YR(),r=XR();t.exports={write:i,read:s};function i(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:a(e),edges:o(e)};return n.isUndefined(e.graph())||(t.value=n.clone(e.graph())),t}function a(e){return n.map(e.nodes(),function(t){var r=e.node(t),i=e.parent(t),a={v:t};return n.isUndefined(r)||(a.value=r),n.isUndefined(i)||(a.parent=i),a})}function o(e){return n.map(e.edges(),function(t){var r=e.edge(t),i={v:t.v,w:t.w};return n.isUndefined(t.name)||(i.name=t.name),n.isUndefined(r)||(i.value=r),i})}function s(e){var t=new r(e.options).setGraph(e.value);return n.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),n.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}})),ez=r(((exports,t)=>{var n=YR();t.exports=r;function r(e){var t={},r=[],i;function a(r){n.has(t,r)||(t[r]=!0,i.push(r),n.each(e.successors(r),a),n.each(e.predecessors(r),a))}return n.each(e.nodes(),function(e){i=[],a(e),i.length&&r.push(i)}),r}})),tz=r(((exports,t)=>{var n=YR();t.exports=r;function r(){this._arr=[],this._keyIndices={}}r.prototype.size=function(){return this._arr.length},r.prototype.keys=function(){return this._arr.map(function(e){return e.key})},r.prototype.has=function(e){return n.has(this._keyIndices,e)},r.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==void 0)return this._arr[t].priority},r.prototype.min=function(){if(this.size()===0)throw Error(`Queue underflow`);return this._arr[0].key},r.prototype.add=function(e,t){var r=this._keyIndices;if(e=String(e),!n.has(r,e)){var i=this._arr,a=i.length;return r[e]=a,i.push({key:e,priority:t}),this._decrease(a),!0}return!1},r.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},r.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw Error(`New priority is greater than current priority. Key: `+e+` Old: `+this._arr[n].priority+` New: `+t);this._arr[n].priority=t,this._decrease(n)},r.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},r.prototype._decrease=function(e){for(var t=this._arr,n=t[e].priority,r;e!==0&&(r=e>>1,!(t[r].priority<n));)this._swap(e,r),e=r},r.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],a=n[t];n[e]=a,n[t]=i,r[a.key]=e,r[i.key]=t}})),nz=r(((exports,t)=>{var n=YR(),r=tz();t.exports=a;var i=n.constant(1);function a(e,t,n,r){return o(e,String(t),n||i,r||function(t){return e.outEdges(t)})}function o(e,t,n,i){var a={},o=new r,s,c,l=function(e){var t=e.v===s?e.w:e.v,r=a[t],i=n(e),l=c.distance+i;if(i<0)throw Error(`dijkstra does not allow negative edge weights. Bad edge: `+e+` Weight: `+i);l<r.distance&&(r.distance=l,r.predecessor=s,o.decrease(t,l))};for(e.nodes().forEach(function(e){var n=e===t?0:1/0;a[e]={distance:n},o.add(e,n)});o.size()>0&&(s=o.removeMin(),c=a[s],c.distance!==1/0);)i(s).forEach(l);return a}})),rz=r(((exports,t)=>{var n=nz(),r=YR();t.exports=i;function i(e,t,i){return r.transform(e.nodes(),function(r,a){r[a]=n(e,a,t,i)},{})}})),iz=r(((exports,t)=>{var n=YR();t.exports=r;function r(e){var t=0,r=[],i={},a=[];function o(s){var c=i[s]={onStack:!0,lowlink:t,index:t++};if(r.push(s),e.successors(s).forEach(function(e){n.has(i,e)?i[e].onStack&&(c.lowlink=Math.min(c.lowlink,i[e].index)):(o(e),c.lowlink=Math.min(c.lowlink,i[e].lowlink))}),c.lowlink===c.index){var l=[],u;do u=r.pop(),i[u].onStack=!1,l.push(u);while(s!==u);a.push(l)}}return e.nodes().forEach(function(e){n.has(i,e)||o(e)}),a}})),az=r(((exports,t)=>{var n=YR(),r=iz();t.exports=i;function i(e){return n.filter(r(e),function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}})),oz=r(((exports,t)=>{var n=YR();t.exports=i;var r=n.constant(1);function i(e,t,n){return a(e,t||r,n||function(t){return e.outEdges(t)})}function a(e,t,n){var r={},i=e.nodes();return i.forEach(function(e){r[e]={},r[e][e]={distance:0},i.forEach(function(t){e!==t&&(r[e][t]={distance:1/0})}),n(e).forEach(function(n){var i=n.v===e?n.w:n.v,a=t(n);r[e][i]={distance:a,predecessor:e}})}),i.forEach(function(e){var t=r[e];i.forEach(function(n){var a=r[n];i.forEach(function(n){var r=a[e],i=t[n],o=a[n],s=r.distance+i.distance;s<o.distance&&(o.distance=s,o.predecessor=i.predecessor)})})}),r}})),sz=r(((exports,t)=>{var n=YR();t.exports=r,r.CycleException=i;function r(e){var t={},r={},a=[];function o(s){if(n.has(r,s))throw new i;n.has(t,s)||(r[s]=!0,t[s]=!0,n.each(e.predecessors(s),o),delete r[s],a.push(s))}if(n.each(e.sinks(),o),n.size(t)!==e.nodeCount())throw new i;return a}function i(){}i.prototype=Error()})),cz=r(((exports,t)=>{var n=sz();t.exports=r;function r(e){try{n(e)}catch(e){if(e instanceof n.CycleException)return!1;throw e}return!0}})),lz=r(((exports,t)=>{var n=YR();t.exports=r;function r(e,t,r){n.isArray(t)||(t=[t]);var a=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],s={};return n.each(t,function(t){if(!e.hasNode(t))throw Error(`Graph does not have node: `+t);i(e,t,r===`post`,s,a,o)}),o}function i(e,t,r,a,o,s){n.has(a,t)||(a[t]=!0,r||s.push(t),n.each(o(t),function(t){i(e,t,r,a,o,s)}),r&&s.push(t))}})),uz=r(((exports,t)=>{var n=lz();t.exports=r;function r(e,t){return n(e,t,`post`)}})),dz=r(((exports,t)=>{var n=lz();t.exports=r;function r(e,t){return n(e,t,`pre`)}})),fz=r(((exports,t)=>{var n=YR(),r=XR(),i=tz();t.exports=a;function a(e,t){var a=new r,o={},s=new i,c;function l(e){var n=e.v===c?e.w:e.v,r=s.priority(n);if(r!==void 0){var i=t(e);i<r&&(o[n]=c,s.decrease(n,i))}}if(e.nodeCount()===0)return a;n.each(e.nodes(),function(e){s.add(e,1/0),a.setNode(e)}),s.decrease(e.nodes()[0],0);for(var u=!1;s.size()>0;){if(c=s.removeMin(),n.has(o,c))a.setEdge(c,o[c]);else if(u)throw Error(`Input graph is not connected: `+e);else u=!0;e.nodeEdges(c).forEach(l)}return a}})),pz=r(((exports,t)=>{t.exports={components:ez(),dijkstra:nz(),dijkstraAll:rz(),findCycles:az(),floydWarshall:oz(),isAcyclic:cz(),postorder:uz(),preorder:dz(),prim:fz(),tarjan:iz(),topsort:sz()}})),mz=r(((exports,t)=>{var n=QR();t.exports={Graph:n.Graph,json:$R(),alg:pz(),version:n.version}})),hz=r(((exports,n)=>{var r;if(typeof e==`function`)try{r=mz()}catch{}r||=window.graphlib,n.exports=r})),gz=r(((exports,t)=>{var n=hL(),r=1,i=4;function a(e){return n(e,r|i)}t.exports=a})),_z=r(((exports,t)=>{var n=vF(),r=AI(),i=yI(),a=FF();function o(e,t,o){if(!a(o))return!1;var s=typeof t;return(s==`number`?r(o)&&i(t,o.length):s==`string`&&t in o)?n(o[t],e):!1}t.exports=o})),vz=r(((exports,t)=>{var n=FR(),r=vF(),i=_z(),a=FI(),o=Object.prototype,s=o.hasOwnProperty;t.exports=n(function(e,t){e=Object(e);var n=-1,c=t.length,l=c>2?t[2]:void 0;for(l&&i(t[0],t[1],l)&&(c=1);++n<c;)for(var u=t[n],d=a(u),f=-1,p=d.length;++f<p;){var m=d[f],h=e[m];(h===void 0||r(h,o[m])&&!s.call(e,m))&&(e[m]=u[m])}return e})})),yz=r(((exports,t)=>{var n=uR(),r=AI(),i=jI();function a(e){return function(t,a,o){var s=Object(t);if(!r(t)){var c=n(a,3);t=i(t),a=function(e){return c(s[e],e,s)}}var l=e(t,a,o);return l>-1?s[c?t[l]:l]:void 0}}t.exports=a})),bz=r(((exports,t)=>{var n=/\s/;function r(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}t.exports=r})),xz=r(((exports,t)=>{var n=bz(),r=/^\s+/;function i(e){return e&&e.slice(0,n(e)+1).replace(r,``)}t.exports=i})),Sz=r(((exports,t)=>{var n=xz(),r=FF(),i=GL(),a=NaN,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;function u(e){if(typeof e==`number`)return e;if(i(e))return a;if(r(e)){var t=typeof e.valueOf==`function`?e.valueOf():e;e=r(t)?t+``:t}if(typeof e!=`string`)return e===0?e:+e;e=n(e);var u=s.test(e);return u||c.test(e)?l(e.slice(2),u?2:8):o.test(e)?a:+e}t.exports=u})),Cz=r(((exports,t)=>{var n=Sz(),r=1/0,i=17976931348623157e292;function a(e){return e?(e=n(e),e===r||e===-r?(e<0?-1:1)*i:e===e?e:0):e===0?e:0}t.exports=a})),wz=r(((exports,t)=>{var n=Cz();function r(e){var t=n(e),r=t%1;return t===t?r?t-r:t:0}t.exports=r})),Tz=r(((exports,t)=>{var n=IR(),r=uR(),i=wz(),a=Math.max;function o(e,t,o){var s=e==null?0:e.length;if(!s)return-1;var c=o==null?0:i(o);return c<0&&(c=a(s+c,0)),n(e,r(t,3),c)}t.exports=o})),Ez=r(((exports,t)=>{var n=yz(),r=Tz();t.exports=n(r)})),Dz=r(((exports,t)=>{var n=kR();function r(e){return e!=null&&e.length?n(e,1):[]}t.exports=r})),Oz=r(((exports,t)=>{var n=yL(),r=wL(),i=FI();function a(e,t){return e==null?e:n(e,r(t),i)}t.exports=a})),kz=r(((exports,t)=>{function n(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}t.exports=n})),Az=r(((exports,t)=>{var n=lI(),r=bL(),i=uR();function a(e,t){var a={};return t=i(t,3),r(e,function(e,r,i){n(a,r,t(e,r,i))}),a}t.exports=a})),jz=r(((exports,t)=>{var n=GL();function r(e,t,r){for(var i=-1,a=e.length;++i<a;){var o=e[i],s=t(o);if(s!=null&&(c===void 0?s===s&&!n(s):r(s,c)))var c=s,l=o}return l}t.exports=r})),Mz=r(((exports,t)=>{function n(e,t){return e>t}t.exports=n})),Nz=r(((exports,t)=>{var n=jz(),r=Mz(),i=CL();function a(e){return e&&e.length?n(e,i,r):void 0}t.exports=a})),Pz=r(((exports,t)=>{var n=lI(),r=vF();function i(e,t,i){(i!==void 0&&!r(e[t],i)||i===void 0&&!(t in e))&&n(e,t,i)}t.exports=i})),Fz=r(((exports,t)=>{var n=PF(),r=WI(),i=pI(),a=`[object Object]`,o=Function.prototype,s=Object.prototype,c=o.toString,l=s.hasOwnProperty,u=c.call(Object);function d(e){if(!i(e)||n(e)!=a)return!1;var t=r(e);if(t===null)return!0;var o=l.call(t,`constructor`)&&t.constructor;return typeof o==`function`&&o instanceof o&&c.call(o)==u}t.exports=d})),Iz=r(((exports,t)=>{function n(e,t){if(!(t===`constructor`&&typeof e[t]==`function`)&&t!=`__proto__`)return e[t]}t.exports=n})),Lz=r(((exports,t)=>{var n=dI(),r=FI();function i(e){return n(e,r(e))}t.exports=i})),Rz=r(((exports,t)=>{var n=Pz(),r=LI(),i=sL(),a=RI(),o=uL(),s=hI(),c=gI(),l=GR(),u=vI(),d=IF(),f=FF(),p=Fz(),m=wI(),h=Iz(),g=Lz();function _(e,t,_,v,y,b,x){var S=h(e,_),C=h(t,_),w=x.get(C);if(w){n(e,_,w);return}var T=b?b(S,C,_+``,e,t,x):void 0,E=T===void 0;if(E){var D=c(C),O=!D&&u(C),k=!D&&!O&&m(C);T=C,D||O||k?c(S)?T=S:l(S)?T=a(S):O?(E=!1,T=r(C,!0)):k?(E=!1,T=i(C,!0)):T=[]:p(C)||s(C)?(T=S,s(S)?T=g(S):(!f(S)||d(S))&&(T=o(C))):E=!1}E&&(x.set(C,T),y(T,C,v,b,x),x.delete(C)),n(e,_,T)}t.exports=_})),zz=r(((exports,t)=>{var n=oI(),r=Pz(),i=yL(),a=Rz(),o=FF(),s=FI(),c=Iz();function l(e,t,u,d,f){e!==t&&i(t,function(i,s){if(f||=new n,o(i))a(e,t,s,u,l,d,f);else{var p=d?d(c(e,s),i,s+``,e,t,f):void 0;p===void 0&&(p=i),r(e,s,p)}},s)}t.exports=l})),Bz=r(((exports,t)=>{var n=FR(),r=_z();function i(e){return n(function(t,n){var i=-1,a=n.length,o=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(o=e.length>3&&typeof o==`function`?(a--,o):void 0,s&&r(n[0],n[1],s)&&(o=a<3?void 0:o,a=1),t=Object(t);++i<a;){var c=n[i];c&&e(t,c,i,o)}return t})}t.exports=i})),Vz=r(((exports,t)=>{var n=zz();t.exports=Bz()(function(e,t,r){n(e,t,r)})})),Hz=r(((exports,t)=>{function n(e,t){return e<t}t.exports=n})),Uz=r(((exports,t)=>{var n=jz(),r=Hz(),i=CL();function a(e){return e&&e.length?n(e,i,r):void 0}t.exports=a})),Wz=r(((exports,t)=>{var n=jz(),r=uR(),i=Hz();function a(e,t){return e&&e.length?n(e,r(t,2),i):void 0}t.exports=a})),Gz=r(((exports,t)=>{var n=AF();t.exports=function(){return n.Date.now()}})),Kz=r(((exports,t)=>{var n=uI(),r=$L(),i=yI(),a=FF(),o=eR();function s(e,t,s,c){if(!a(e))return e;t=r(t,e);for(var l=-1,u=t.length,d=u-1,f=e;f!=null&&++l<u;){var p=o(t[l]),m=s;if(p===`__proto__`||p===`constructor`||p===`prototype`)return e;if(l!=d){var h=f[p];m=c?c(h,p,f):void 0,m===void 0&&(m=a(h)?h:i(t[l+1])?[]:{})}n(f,p,m),f=f[p]}return e}t.exports=s})),qz=r(((exports,t)=>{var n=tR(),r=Kz(),i=$L();function a(e,t,a){for(var o=-1,s=t.length,c={};++o<s;){var l=t[o],u=n(e,l);a(u,l)&&r(c,i(l,e),u)}return c}t.exports=a})),Jz=r(((exports,t)=>{var n=qz(),r=aR();function i(e,t){return n(e,t,function(t,n){return r(e,n)})}t.exports=i})),Yz=r(((exports,t)=>{var n=Dz(),r=jR(),i=PR();function a(e){return i(r(e,void 0,n),e+``)}t.exports=a})),Xz=r(((exports,t)=>{var n=Jz();t.exports=Yz()(function(e,t){return e==null?{}:n(e,t)})})),Zz=r(((exports,t)=>{var n=Math.ceil,r=Math.max;function i(e,t,i,a){for(var o=-1,s=r(n((t-e)/(i||1)),0),c=Array(s);s--;)c[a?s:++o]=e,e+=i;return c}t.exports=i})),Qz=r(((exports,t)=>{var n=Zz(),r=_z(),i=Cz();function a(e){return function(t,a,o){return o&&typeof o!=`number`&&r(t,a,o)&&(a=o=void 0),t=i(t),a===void 0?(a=t,t=0):a=i(a),o=o===void 0?t<a?1:-1:i(o),n(t,a,o,e)}}t.exports=a})),$z=r(((exports,t)=>{t.exports=Qz()()})),eB=r(((exports,t)=>{function n(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}t.exports=n})),tB=r(((exports,t)=>{var n=GL();function r(e,t){if(e!==t){var r=e!==void 0,i=e===null,a=e===e,o=n(e),s=t!==void 0,c=t===null,l=t===t,u=n(t);if(!c&&!u&&!o&&e>t||o&&s&&l&&!c&&!u||i&&s&&l||!r&&l||!a)return 1;if(!i&&!o&&!u&&e<t||u&&r&&a&&!i&&!o||c&&r&&a||!s&&a||!l)return-1}return 0}t.exports=r})),nB=r(((exports,t)=>{var n=tB();function r(e,t,r){for(var i=-1,a=e.criteria,o=t.criteria,s=a.length,c=r.length;++i<s;){var l=n(a[i],o[i]);if(l){if(i>=c)return l;var u=r[i];return l*(u==`desc`?-1:1)}}return e.index-t.index}t.exports=r})),rB=r(((exports,t)=>{var n=XL(),r=tR(),i=uR(),a=gR(),o=eB(),s=SI(),c=nB(),l=CL(),u=gI();function d(e,t,d){t=t.length?n(t,function(e){return u(e)?function(t){return r(t,e.length===1?e[0]:e)}:e}):[l];var f=-1;t=n(t,s(i));var p=a(e,function(e,r,i){return{criteria:n(t,function(t){return t(e)}),index:++f,value:e}});return o(p,function(e,t){return c(e,t,d)})}t.exports=d})),iB=r(((exports,t)=>{var n=kR(),r=rB(),i=FR(),a=_z();t.exports=i(function(e,t){if(e==null)return[];var i=t.length;return i>1&&a(e,t[0],t[1])?t=[]:i>2&&a(t[0],t[1],t[2])&&(t=[t[0]]),r(e,n(t,1),[])})})),aB=r(((exports,t)=>{var n=QL(),r=0;function i(e){var t=++r;return n(e)+t}t.exports=i})),oB=r(((exports,t)=>{function n(e,t,n){for(var r=-1,i=e.length,a=t.length,o={};++r<i;){var s=r<a?t[r]:void 0;n(o,e[r],s)}return o}t.exports=n})),sB=r(((exports,t)=>{var n=uI(),r=oB();function i(e,t){return r(e||[],t||[],n)}t.exports=i})),cB=r(((exports,n)=>{var r;if(typeof e==`function`)try{r={cloneDeep:gz(),constant:_L(),defaults:vz(),each:EL(),filter:dR(),find:Ez(),flatten:Dz(),forEach:TL(),forIn:Oz(),has:pR(),isUndefined:hR(),last:kz(),map:_R(),mapValues:Az(),max:Nz(),merge:Vz(),min:Uz(),minBy:Wz(),now:Gz(),pick:Xz(),range:$z(),reduce:bR(),sortBy:iB(),uniqueId:aB(),values:JR(),zipObject:sB()}}catch{}r||=window._,n.exports=r})),lB=r(((exports,t)=>{t.exports=n;function n(){var e={};e._next=e._prev=e,this._sentinel=e}n.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return r(t),t},n.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&r(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},n.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,i)),n=n._prev;return`[`+e.join(`, `)+`]`};function r(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function i(e,t){if(e!==`_next`&&e!==`_prev`)return t}})),uB=r(((exports,t)=>{var n=cB(),r=hz().Graph,i=lB();t.exports=o;var a=n.constant(1);function o(e,t){if(e.nodeCount()<=1)return[];var r=l(e,t||a),i=s(r.graph,r.buckets,r.zeroIdx);return n.flatten(n.map(i,function(t){return e.outEdges(t.v,t.w)}),!0)}function s(e,t,n){for(var r=[],i=t[t.length-1],a=t[0],o;e.nodeCount();){for(;o=a.dequeue();)c(e,t,n,o);for(;o=i.dequeue();)c(e,t,n,o);if(e.nodeCount()){for(var s=t.length-2;s>0;--s)if(o=t[s].dequeue(),o){r=r.concat(c(e,t,n,o,!0));break}}}return r}function c(e,t,r,i,a){var o=a?[]:void 0;return n.forEach(e.inEdges(i.v),function(n){var i=e.edge(n),s=e.node(n.v);a&&o.push({v:n.v,w:n.w}),s.out-=i,u(t,r,s)}),n.forEach(e.outEdges(i.v),function(n){var i=e.edge(n),a=n.w,o=e.node(a);o.in-=i,u(t,r,o)}),e.removeNode(i.v),o}function l(e,t){var a=new r,o=0,s=0;n.forEach(e.nodes(),function(e){a.setNode(e,{v:e,in:0,out:0})}),n.forEach(e.edges(),function(e){var n=a.edge(e.v,e.w)||0,r=t(e),i=n+r;a.setEdge(e.v,e.w,i),s=Math.max(s,a.node(e.v).out+=r),o=Math.max(o,a.node(e.w).in+=r)});var c=n.range(s+o+3).map(function(){return new i}),l=o+1;return n.forEach(a.nodes(),function(e){u(c,l,a.node(e))}),{graph:a,buckets:c,zeroIdx:l}}function u(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}})),dB=r(((exports,t)=>{var n=cB(),r=uB();t.exports={run:i,undo:o};function i(e){var t=e.graph().acyclicer===`greedy`?r(e,i(e)):a(e);n.forEach(t,function(t){var r=e.edge(t);e.removeEdge(t),r.forwardName=t.name,r.reversed=!0,e.setEdge(t.w,t.v,r,n.uniqueId(`rev`))});function i(e){return function(t){return e.edge(t).weight}}}function a(e){var t=[],r={},i={};function a(o){n.has(i,o)||(i[o]=!0,r[o]=!0,n.forEach(e.outEdges(o),function(e){n.has(r,e.w)?t.push(e):a(e.w)}),delete r[o])}return n.forEach(e.nodes(),a),t}function o(e){n.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}})),fB=r(((exports,t)=>{var n=cB(),r=hz().Graph;t.exports={addDummyNode:i,simplify:a,asNonCompoundGraph:o,successorWeights:s,predecessorWeights:c,intersectRect:l,buildLayerMatrix:u,normalizeRanks:d,removeEmptyRanks:f,addBorderNode:p,maxRank:m,partition:h,time:g,notime:_};function i(e,t,r,i){var a;do a=n.uniqueId(i);while(e.hasNode(a));return r.dummy=t,e.setNode(a,r),a}function a(e){var t=new r().setGraph(e.graph());return n.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),n.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function o(e){var t=new r({multigraph:e.isMultigraph()}).setGraph(e.graph());return n.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),n.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function s(e){var t=n.map(e.nodes(),function(t){var r={};return n.forEach(e.outEdges(t),function(t){r[t.w]=(r[t.w]||0)+e.edge(t).weight}),r});return n.zipObject(e.nodes(),t)}function c(e){var t=n.map(e.nodes(),function(t){var r={};return n.forEach(e.inEdges(t),function(t){r[t.v]=(r[t.v]||0)+e.edge(t).weight}),r});return n.zipObject(e.nodes(),t)}function l(e,t){var n=e.x,r=e.y,i=t.x-n,a=t.y-r,o=e.width/2,s=e.height/2;if(!i&&!a)throw Error(`Not possible to find intersection inside of the rectangle`);var c,l;return Math.abs(a)*o>Math.abs(i)*s?(a<0&&(s=-s),c=s*i/a,l=s):(i<0&&(o=-o),c=o,l=o*a/i),{x:n+c,y:r+l}}function u(e){var t=n.map(n.range(m(e)+1),function(){return[]});return n.forEach(e.nodes(),function(r){var i=e.node(r),a=i.rank;n.isUndefined(a)||(t[a][i.order]=r)}),t}function d(e){var t=n.min(n.map(e.nodes(),function(t){return e.node(t).rank}));n.forEach(e.nodes(),function(r){var i=e.node(r);n.has(i,`rank`)&&(i.rank-=t)})}function f(e){var t=n.min(n.map(e.nodes(),function(t){return e.node(t).rank})),r=[];n.forEach(e.nodes(),function(n){var i=e.node(n).rank-t;r[i]||(r[i]=[]),r[i].push(n)});var i=0,a=e.graph().nodeRankFactor;n.forEach(r,function(t,r){n.isUndefined(t)&&r%a!==0?--i:i&&n.forEach(t,function(t){e.node(t).rank+=i})})}function p(e,t,n,r){var a={width:0,height:0};return arguments.length>=4&&(a.rank=n,a.order=r),i(e,`border`,a,t)}function m(e){return n.max(n.map(e.nodes(),function(t){var r=e.node(t).rank;if(!n.isUndefined(r))return r}))}function h(e,t){var r={lhs:[],rhs:[]};return n.forEach(e,function(e){t(e)?r.lhs.push(e):r.rhs.push(e)}),r}function g(e,t){var r=n.now();try{return t()}finally{console.log(e+` time: `+(n.now()-r)+`ms`)}}function _(e,t){return t()}})),pB=r(((exports,t)=>{var n=cB(),r=fB();t.exports={run:i,undo:o};function i(e){e.graph().dummyChains=[],n.forEach(e.edges(),function(t){a(e,t)})}function a(e,t){var n=t.v,i=e.node(n).rank,a=t.w,o=e.node(a).rank,s=t.name,c=e.edge(t),l=c.labelRank;if(o!==i+1){e.removeEdge(t);var u,d,f;for(f=0,++i;i<o;++f,++i)c.points=[],d={width:0,height:0,edgeLabel:c,edgeObj:t,rank:i},u=r.addDummyNode(e,`edge`,d,`_d`),i===l&&(d.width=c.width,d.height=c.height,d.dummy=`edge-label`,d.labelpos=c.labelpos),e.setEdge(n,u,{weight:c.weight},s),f===0&&e.graph().dummyChains.push(u),n=u;e.setEdge(n,a,{weight:c.weight},s)}}function o(e){n.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;for(e.setEdge(n.edgeObj,r);n.dummy;)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy===`edge-label`&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}})),mB=r(((exports,t)=>{var n=cB();t.exports={longestPath:r,slack:i};function r(e){var t={};function r(i){var a=e.node(i);if(n.has(t,i))return a.rank;t[i]=!0;var o=n.min(n.map(e.outEdges(i),function(t){return r(t.w)-e.edge(t).minlen}));return(o===1/0||o==null)&&(o=0),a.rank=o}n.forEach(e.sources(),r)}function i(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}})),hB=r(((exports,t)=>{var n=cB(),r=hz().Graph,i=mB().slack;t.exports=a;function a(e){var t=new r({directed:!1}),n=e.nodes()[0],a=e.nodeCount();t.setNode(n,{});for(var l,u;o(t,e)<a;)l=s(t,e),u=t.hasNode(l.v)?i(e,l):-i(e,l),c(t,e,u);return t}function o(e,t){function r(a){n.forEach(t.nodeEdges(a),function(n){var o=n.v,s=a===o?n.w:o;!e.hasNode(s)&&!i(t,n)&&(e.setNode(s,{}),e.setEdge(a,s,{}),r(s))})}return n.forEach(e.nodes(),r),e.nodeCount()}function s(e,t){return n.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return i(t,n)})}function c(e,t,r){n.forEach(e.nodes(),function(e){t.node(e).rank+=r})}})),gB=r(((exports,t)=>{var n=cB(),r=hB(),i=mB().slack,a=mB().longestPath,o=hz().alg.preorder,s=hz().alg.postorder,c=fB().simplify;t.exports=l,l.initLowLimValues=p,l.initCutValues=u,l.calcCutValue=f,l.leaveEdge=h,l.enterEdge=g,l.exchangeEdges=_;function l(e){e=c(e),a(e);var t=r(e);p(t),u(t,e);for(var n,i;n=h(t);)i=g(t,e,n),_(t,e,n,i)}function u(e,t){var r=s(e,e.nodes());r=r.slice(0,r.length-1),n.forEach(r,function(n){d(e,t,n)})}function d(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=f(e,t,n)}function f(e,t,r){var i=e.node(r).parent,a=!0,o=t.edge(r,i),s=0;return o||=(a=!1,t.edge(i,r)),s=o.weight,n.forEach(t.nodeEdges(r),function(n){var o=n.v===r,c=o?n.w:n.v;if(c!==i){var l=o===a,u=t.edge(n).weight;if(s+=l?u:-u,y(e,r,c)){var d=e.edge(r,c).cutvalue;s+=l?-d:d}}}),s}function p(e,t){arguments.length<2&&(t=e.nodes()[0]),m(e,{},1,t)}function m(e,t,r,i,a){var o=r,s=e.node(i);return t[i]=!0,n.forEach(e.neighbors(i),function(a){n.has(t,a)||(r=m(e,t,r,a,i))}),s.low=o,s.lim=r++,a?s.parent=a:delete s.parent,r}function h(e){return n.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function g(e,t,r){var a=r.v,o=r.w;t.hasEdge(a,o)||(a=r.w,o=r.v);var s=e.node(a),c=e.node(o),l=s,u=!1;s.lim>c.lim&&(l=c,u=!0);var d=n.filter(t.edges(),function(t){return u===b(e,e.node(t.v),l)&&u!==b(e,e.node(t.w),l)});return n.minBy(d,function(e){return i(t,e)})}function _(e,t,n,r){var i=n.v,a=n.w;e.removeEdge(i,a),e.setEdge(r.v,r.w,{}),p(e),u(e,t),v(e,t)}function v(e,t){var r=n.find(e.nodes(),function(e){return!t.node(e).parent}),i=o(e,r);i=i.slice(1),n.forEach(i,function(n){var r=e.node(n).parent,i=t.edge(n,r),a=!1;i||(i=t.edge(r,n),a=!0),t.node(n).rank=t.node(r).rank+(a?i.minlen:-i.minlen)})}function y(e,t,n){return e.hasEdge(t,n)}function b(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}})),_B=r(((exports,t)=>{var n=mB().longestPath,r=hB(),i=gB();t.exports=a;function a(e){switch(e.graph().ranker){case`network-simplex`:c(e);break;case`tight-tree`:s(e);break;case`longest-path`:o(e);break;default:c(e)}}var o=n;function s(e){n(e),r(e)}function c(e){i(e)}})),vB=r(((exports,t)=>{var n=cB();t.exports=r;function r(e){var t=a(e);n.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),a=r.edgeObj,o=i(e,t,a.v,a.w),s=o.path,c=o.lca,l=0,u=s[l],d=!0;n!==a.w;){if(r=e.node(n),d){for(;(u=s[l])!==c&&e.node(u).maxRank<r.rank;)l++;u===c&&(d=!1)}if(!d){for(;l<s.length-1&&e.node(u=s[l+1]).minRank<=r.rank;)l++;u=s[l]}e.setParent(n,u),n=e.successors(n)[0]}})}function i(e,t,n,r){var i=[],a=[],o=Math.min(t[n].low,t[r].low),s=Math.max(t[n].lim,t[r].lim),c=n,l;do c=e.parent(c),i.push(c);while(c&&(t[c].low>o||s>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)a.push(c);return{path:i.concat(a.reverse()),lca:l}}function a(e){var t={},r=0;function i(a){var o=r;n.forEach(e.children(a),i),t[a]={low:o,lim:r++}}return n.forEach(e.children(),i),t}})),yB=r(((exports,t)=>{var n=cB(),r=fB();t.exports={run:i,cleanup:c};function i(e){var t=r.addDummyNode(e,`root`,{},`_root`),i=o(e),c=n.max(n.values(i))-1,l=2*c+1;e.graph().nestingRoot=t,n.forEach(e.edges(),function(t){e.edge(t).minlen*=l});var u=s(e)+1;n.forEach(e.children(),function(n){a(e,t,l,u,c,i,n)}),e.graph().nodeRankFactor=l}function a(e,t,i,o,s,c,l){var u=e.children(l);if(!u.length){l!==t&&e.setEdge(t,l,{weight:0,minlen:i});return}var d=r.addBorderNode(e,`_bt`),f=r.addBorderNode(e,`_bb`),p=e.node(l);e.setParent(d,l),p.borderTop=d,e.setParent(f,l),p.borderBottom=f,n.forEach(u,function(n){a(e,t,i,o,s,c,n);var r=e.node(n),u=r.borderTop?r.borderTop:n,p=r.borderBottom?r.borderBottom:n,m=r.borderTop?o:2*o,h=u===p?s-c[l]+1:1;e.setEdge(d,u,{weight:m,minlen:h,nestingEdge:!0}),e.setEdge(p,f,{weight:m,minlen:h,nestingEdge:!0})}),e.parent(l)||e.setEdge(t,d,{weight:0,minlen:s+c[l]})}function o(e){var t={};function r(i,a){var o=e.children(i);o&&o.length&&n.forEach(o,function(e){r(e,a+1)}),t[i]=a}return n.forEach(e.children(),function(e){r(e,1)}),t}function s(e){return n.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function c(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,n.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}})),bB=r(((exports,t)=>{var n=cB(),r=fB();t.exports=i;function i(e){function t(r){var i=e.children(r),o=e.node(r);if(i.length&&n.forEach(i,t),n.has(o,`minRank`)){o.borderLeft=[],o.borderRight=[];for(var s=o.minRank,c=o.maxRank+1;s<c;++s)a(e,`borderLeft`,`_bl`,r,o,s),a(e,`borderRight`,`_br`,r,o,s)}}n.forEach(e.children(),t)}function a(e,t,n,i,a,o){var s={width:0,height:0,rank:o,borderType:t},c=a[t][o-1],l=r.addDummyNode(e,`border`,s,n);a[t][o]=l,e.setParent(l,i),c&&e.setEdge(c,l,{weight:1})}})),xB=r(((exports,t)=>{var n=cB();t.exports={adjust:r,undo:i};function r(e){var t=e.graph().rankdir.toLowerCase();(t===`lr`||t===`rl`)&&a(e)}function i(e){var t=e.graph().rankdir.toLowerCase();(t===`bt`||t===`rl`)&&s(e),(t===`lr`||t===`rl`)&&(l(e),a(e))}function a(e){n.forEach(e.nodes(),function(t){o(e.node(t))}),n.forEach(e.edges(),function(t){o(e.edge(t))})}function o(e){var t=e.width;e.width=e.height,e.height=t}function s(e){n.forEach(e.nodes(),function(t){c(e.node(t))}),n.forEach(e.edges(),function(t){var r=e.edge(t);n.forEach(r.points,c),n.has(r,`y`)&&c(r)})}function c(e){e.y=-e.y}function l(e){n.forEach(e.nodes(),function(t){u(e.node(t))}),n.forEach(e.edges(),function(t){var r=e.edge(t);n.forEach(r.points,u),n.has(r,`x`)&&u(r)})}function u(e){var t=e.x;e.x=e.y,e.y=t}})),SB=r(((exports,t)=>{var n=cB();t.exports=r;function r(e){var t={},r=n.filter(e.nodes(),function(t){return!e.children(t).length}),i=n.max(n.map(r,function(t){return e.node(t).rank})),a=n.map(n.range(i+1),function(){return[]});function o(r){if(!n.has(t,r)){t[r]=!0;var i=e.node(r);a[i.rank].push(r),n.forEach(e.successors(r),o)}}var s=n.sortBy(r,function(t){return e.node(t).rank});return n.forEach(s,o),a}})),CB=r(((exports,t)=>{var n=cB();t.exports=r;function r(e,t){for(var n=0,r=1;r<t.length;++r)n+=i(e,t[r-1],t[r]);return n}function i(e,t,r){for(var i=n.zipObject(r,n.map(r,function(e,t){return t})),a=n.flatten(n.map(t,function(t){return n.sortBy(n.map(e.outEdges(t),function(t){return{pos:i[t.w],weight:e.edge(t).weight}}),`pos`)}),!0),o=1;o<r.length;)o<<=1;var s=2*o-1;--o;var c=n.map(Array(s),function(){return 0}),l=0;return n.forEach(a.forEach(function(e){var t=e.pos+o;c[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=c[t+1]),t=t-1>>1,c[t]+=e.weight;l+=e.weight*n})),l}})),wB=r(((exports,t)=>{var n=cB();t.exports=r;function r(e,t){return n.map(t,function(t){var r=e.inEdges(t);if(r.length){var i=n.reduce(r,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:t}})}})),TB=r(((exports,t)=>{var n=cB();t.exports=r;function r(e,t){var r={};n.forEach(e,function(e,t){var i=r[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};n.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight)}),n.forEach(t.edges(),function(e){var t=r[e.v],i=r[e.w];!n.isUndefined(t)&&!n.isUndefined(i)&&(i.indegree++,t.out.push(r[e.w]))});var a=n.filter(r,function(e){return!e.indegree});return i(a)}function i(e){var t=[];function r(e){return function(t){t.merged||(n.isUndefined(t.barycenter)||n.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&a(e,t)}}function i(t){return function(n){n.in.push(t),--n.indegree===0&&e.push(n)}}for(;e.length;){var o=e.pop();t.push(o),n.forEach(o.in.reverse(),r(o)),n.forEach(o.out,i(o))}return n.map(n.filter(t,function(e){return!e.merged}),function(e){return n.pick(e,[`vs`,`i`,`barycenter`,`weight`])})}function a(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}})),EB=r(((exports,t)=>{var n=cB(),r=fB();t.exports=i;function i(e,t){var i=r.partition(e,function(e){return n.has(e,`barycenter`)}),s=i.lhs,c=n.sortBy(i.rhs,function(e){return-e.i}),l=[],u=0,d=0,f=0;s.sort(o(!!t)),f=a(l,c,f),n.forEach(s,function(e){f+=e.vs.length,l.push(e.vs),u+=e.barycenter*e.weight,d+=e.weight,f=a(l,c,f)});var p={vs:n.flatten(l,!0)};return d&&(p.barycenter=u/d,p.weight=d),p}function a(e,t,r){for(var i;t.length&&(i=n.last(t)).i<=r;)t.pop(),e.push(i.vs),r++;return r}function o(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}})),DB=r(((exports,t)=>{var n=cB(),r=wB(),i=TB(),a=EB();t.exports=o;function o(e,t,l,u){var d=e.children(t),f=e.node(t),p=f?f.borderLeft:void 0,m=f?f.borderRight:void 0,h={};p&&(d=n.filter(d,function(e){return e!==p&&e!==m}));var g=r(e,d);n.forEach(g,function(t){if(e.children(t.v).length){var r=o(e,t.v,l,u);h[t.v]=r,n.has(r,`barycenter`)&&c(t,r)}});var _=i(g,l);s(_,h);var v=a(_,u);if(p&&(v.vs=n.flatten([p,v.vs,m],!0),e.predecessors(p).length)){var y=e.node(e.predecessors(p)[0]),b=e.node(e.predecessors(m)[0]);n.has(v,`barycenter`)||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+y.order+b.order)/(v.weight+2),v.weight+=2}return v}function s(e,t){n.forEach(e,function(e){e.vs=n.flatten(e.vs.map(function(e){return t[e]?t[e].vs:e}),!0)})}function c(e,t){n.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}})),OB=r(((exports,t)=>{var n=cB(),r=hz().Graph;t.exports=i;function i(e,t,i){var o=a(e),s=new r({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(t){return e.node(t)});return n.forEach(e.nodes(),function(r){var a=e.node(r),c=e.parent(r);(a.rank===t||a.minRank<=t&&t<=a.maxRank)&&(s.setNode(r),s.setParent(r,c||o),n.forEach(e[i](r),function(t){var i=t.v===r?t.w:t.v,a=s.edge(i,r),o=n.isUndefined(a)?0:a.weight;s.setEdge(i,r,{weight:e.edge(t).weight+o})}),n.has(a,`minRank`)&&s.setNode(r,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]}))}),s}function a(e){for(var t;e.hasNode(t=n.uniqueId(`_root`)););return t}})),kB=r(((exports,t)=>{var n=cB();t.exports=r;function r(e,t,r){var i={},a;n.forEach(r,function(n){for(var r=e.parent(n),o,s;r;){if(o=e.parent(r),o?(s=i[o],i[o]=r):(s=a,a=r),s&&s!==r){t.setEdge(s,r);return}r=o}})}})),AB=r(((exports,t)=>{var n=cB(),r=SB(),i=CB(),a=DB(),o=OB(),s=kB(),c=hz().Graph,l=fB();t.exports=u;function u(e){var t=l.maxRank(e),a=d(e,n.range(1,t+1),`inEdges`),o=d(e,n.range(t-1,-1,-1),`outEdges`),s=r(e);p(e,s);for(var c=1/0,u,m=0,h=0;h<4;++m,++h){f(m%2?a:o,m%4>=2),s=l.buildLayerMatrix(e);var g=i(e,s);g<c&&(h=0,u=n.cloneDeep(s),c=g)}p(e,u)}function d(e,t,r){return n.map(t,function(t){return o(e,t,r)})}function f(e,t){var r=new c;n.forEach(e,function(e){var i=e.graph().root,o=a(e,i,r,t);n.forEach(o.vs,function(t,n){e.node(t).order=n}),s(e,r,o.vs)})}function p(e,t){n.forEach(t,function(t){n.forEach(t,function(t,n){e.node(t).order=n})})}})),jB=r(((exports,t)=>{var n=cB(),r=hz().Graph,i=fB();t.exports={positionX:g,findType1Conflicts:a,findType2Conflicts:o,addConflict:c,hasConflict:l,verticalAlignment:u,horizontalCompaction:d,alignCoordinates:m,findSmallestWidthAlignment:p,balance:h};function a(e,t){var r={};function i(t,i){var a=0,o=0,l=t.length,u=n.last(i);return n.forEach(i,function(t,d){var f=s(e,t),p=f?e.node(f).order:l;(f||t===u)&&(n.forEach(i.slice(o,d+1),function(t){n.forEach(e.predecessors(t),function(n){var i=e.node(n),o=i.order;(o<a||p<o)&&!(i.dummy&&e.node(t).dummy)&&c(r,n,t)})}),o=d+1,a=p)}),i}return n.reduce(t,i),r}function o(e,t){var r={};function i(t,i,a,o,s){var l;n.forEach(n.range(i,a),function(i){l=t[i],e.node(l).dummy&&n.forEach(e.predecessors(l),function(t){var n=e.node(t);n.dummy&&(n.order<o||n.order>s)&&c(r,t,l)})})}function a(t,r){var a=-1,o,s=0;return n.forEach(r,function(n,c){if(e.node(n).dummy===`border`){var l=e.predecessors(n);l.length&&(o=e.node(l[0]).order,i(r,s,c,a,o),s=c,a=o)}i(r,s,r.length,o,t.length)}),r}return n.reduce(t,a),r}function s(e,t){if(e.node(t).dummy)return n.find(e.predecessors(t),function(t){return e.node(t).dummy})}function c(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function l(e,t,r){if(t>r){var i=t;t=r,r=i}return n.has(e[t],r)}function u(e,t,r,i){var a={},o={},s={};return n.forEach(t,function(e){n.forEach(e,function(e,t){a[e]=e,o[e]=e,s[e]=t})}),n.forEach(t,function(e){var t=-1;n.forEach(e,function(e){var c=i(e);if(c.length){c=n.sortBy(c,function(e){return s[e]});for(var u=(c.length-1)/2,d=Math.floor(u),f=Math.ceil(u);d<=f;++d){var p=c[d];o[e]===e&&t<s[p]&&!l(r,e,p)&&(o[p]=e,o[e]=a[e]=a[p],t=s[p])}}})}),{root:a,align:o}}function d(e,t,r,i,a){var o={},s=f(e,t,r,a),c=a?`borderLeft`:`borderRight`;function l(e,t){for(var n=s.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}function u(e){o[e]=s.inEdges(e).reduce(function(e,t){return Math.max(e,o[t.v]+s.edge(t))},0)}function d(t){var n=s.outEdges(t).reduce(function(e,t){return Math.min(e,o[t.w]-s.edge(t))},1/0),r=e.node(t);n!==1/0&&r.borderType!==c&&(o[t]=Math.max(o[t],n))}return l(u,s.predecessors.bind(s)),l(d,s.successors.bind(s)),n.forEach(i,function(e){o[e]=o[r[e]]}),o}function f(e,t,i,a){var o=new r,s=e.graph(),c=_(s.nodesep,s.edgesep,a);return n.forEach(t,function(t){var r;n.forEach(t,function(t){var n=i[t];if(o.setNode(n),r){var a=i[r],s=o.edge(a,n);o.setEdge(a,n,Math.max(c(e,t,r),s||0))}r=t})}),o}function p(e,t){return n.minBy(n.values(t),function(t){var r=-1/0,i=1/0;return n.forIn(t,function(t,n){var a=v(e,n)/2;r=Math.max(t+a,r),i=Math.min(t-a,i)}),r-i})}function m(e,t){var r=n.values(t),i=n.min(r),a=n.max(r);n.forEach([`u`,`d`],function(r){n.forEach([`l`,`r`],function(o){var s=r+o,c=e[s],l;if(c!==t){var u=n.values(c);l=o===`l`?i-n.min(u):a-n.max(u),l&&(e[s]=n.mapValues(c,function(e){return e+l}))}})})}function h(e,t){return n.mapValues(e.ul,function(r,i){if(t)return e[t.toLowerCase()][i];var a=n.sortBy(n.map(e,i));return(a[1]+a[2])/2})}function g(e){var t=i.buildLayerMatrix(e),r=n.merge(a(e,t),o(e,t)),s={},c;n.forEach([`u`,`d`],function(i){c=i===`u`?t:n.values(t).reverse(),n.forEach([`l`,`r`],function(t){t===`r`&&(c=n.map(c,function(e){return n.values(e).reverse()}));var a=(i===`u`?e.predecessors:e.successors).bind(e),o=u(e,c,r,a),l=d(e,c,o.root,o.align,t===`r`);t===`r`&&(l=n.mapValues(l,function(e){return-e})),s[i+t]=l})});var l=p(e,s);return m(s,l),h(s,e.graph().align)}function _(e,t,r){return function(i,a,o){var s=i.node(a),c=i.node(o),l=0,u;if(l+=s.width/2,n.has(s,`labelpos`))switch(s.labelpos.toLowerCase()){case`l`:u=-s.width/2;break;case`r`:u=s.width/2;break}if(u&&(l+=r?u:-u),u=0,l+=(s.dummy?t:e)/2,l+=(c.dummy?t:e)/2,l+=c.width/2,n.has(c,`labelpos`))switch(c.labelpos.toLowerCase()){case`l`:u=c.width/2;break;case`r`:u=-c.width/2;break}return u&&(l+=r?u:-u),u=0,l}}function v(e,t){return e.node(t).width}})),MB=r(((exports,t)=>{var n=cB(),r=fB(),i=jB().positionX;t.exports=a;function a(e){e=r.asNonCompoundGraph(e),o(e),n.forEach(i(e),function(t,n){e.node(n).x=t})}function o(e){var t=r.buildLayerMatrix(e),i=e.graph().ranksep,a=0;n.forEach(t,function(t){var r=n.max(n.map(t,function(t){return e.node(t).height}));n.forEach(t,function(t){e.node(t).y=a+r/2}),a+=r+i})}})),NB=r(((exports,t)=>{var n=cB(),r=dB(),i=pB(),a=_B(),o=fB().normalizeRanks,s=vB(),c=fB().removeEmptyRanks,l=yB(),u=bB(),d=xB(),f=AB(),p=MB(),m=fB(),h=hz().Graph;t.exports=g;function g(e,t){var n=t&&t.debugTiming?m.time:m.notime;n(`layout`,function(){var t=n(`  buildLayoutGraph`,function(){return D(e)});n(`  runLayout`,function(){_(t,n)}),n(`  updateInputGraph`,function(){v(e,t)})})}function _(e,t){t(`    makeSpaceForEdgeLabels`,function(){O(e)}),t(`    removeSelfEdges`,function(){ie(e)}),t(`    acyclic`,function(){r.run(e)}),t(`    nestingGraph.run`,function(){l.run(e)}),t(`    rank`,function(){a(m.asNonCompoundGraph(e))}),t(`    injectEdgeLabelProxies`,function(){k(e)}),t(`    removeEmptyRanks`,function(){c(e)}),t(`    nestingGraph.cleanup`,function(){l.cleanup(e)}),t(`    normalizeRanks`,function(){o(e)}),t(`    assignRankMinMax`,function(){A(e)}),t(`    removeEdgeLabelProxies`,function(){j(e)}),t(`    normalize.run`,function(){i.run(e)}),t(`    parentDummyChains`,function(){s(e)}),t(`    addBorderSegments`,function(){u(e)}),t(`    order`,function(){f(e)}),t(`    insertSelfEdges`,function(){ae(e)}),t(`    adjustCoordinateSystem`,function(){d.adjust(e)}),t(`    position`,function(){p(e)}),t(`    positionSelfEdges`,function(){oe(e)}),t(`    removeBorderNodes`,function(){re(e)}),t(`    normalize.undo`,function(){i.undo(e)}),t(`    fixupEdgeLabelCoords`,function(){M(e)}),t(`    undoCoordinateSystem`,function(){d.undo(e)}),t(`    translateGraph`,function(){ee(e)}),t(`    assignNodeIntersects`,function(){te(e)}),t(`    reversePoints`,function(){ne(e)}),t(`    acyclic.undo`,function(){r.undo(e)})}function v(e,t){n.forEach(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),n.forEach(e.edges(),function(r){var i=e.edge(r),a=t.edge(r);i.points=a.points,n.has(a,`x`)&&(i.x=a.x,i.y=a.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var y=[`nodesep`,`edgesep`,`ranksep`,`marginx`,`marginy`],b={ranksep:50,edgesep:20,nodesep:50,rankdir:`tb`},x=[`acyclicer`,`ranker`,`rankdir`,`align`],S=[`width`,`height`],C={width:0,height:0},w=[`minlen`,`weight`,`width`,`height`,`labeloffset`],T={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:`r`},E=[`labelpos`];function D(e){var t=new h({multigraph:!0,compound:!0}),r=ce(e.graph());return t.setGraph(n.merge({},b,se(r,y),n.pick(r,x))),n.forEach(e.nodes(),function(r){var i=ce(e.node(r));t.setNode(r,n.defaults(se(i,S),C)),t.setParent(r,e.parent(r))}),n.forEach(e.edges(),function(r){var i=ce(e.edge(r));t.setEdge(r,n.merge({},T,se(i,w),n.pick(i,E)))}),t}function O(e){var t=e.graph();t.ranksep/=2,n.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!==`c`&&(t.rankdir===`TB`||t.rankdir===`BT`?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function k(e){n.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};m.addDummyNode(e,`edge-proxy`,i,`_ep`)}})}function A(e){var t=0;n.forEach(e.nodes(),function(r){var i=e.node(r);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=n.max(t,i.maxRank))}),e.graph().maxRank=t}function j(e){n.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy===`edge-proxy`&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function ee(e){var t=1/0,r=0,i=1/0,a=0,o=e.graph(),s=o.marginx||0,c=o.marginy||0;function l(e){var n=e.x,o=e.y,s=e.width,c=e.height;t=Math.min(t,n-s/2),r=Math.max(r,n+s/2),i=Math.min(i,o-c/2),a=Math.max(a,o+c/2)}n.forEach(e.nodes(),function(t){l(e.node(t))}),n.forEach(e.edges(),function(t){var r=e.edge(t);n.has(r,`x`)&&l(r)}),t-=s,i-=c,n.forEach(e.nodes(),function(n){var r=e.node(n);r.x-=t,r.y-=i}),n.forEach(e.edges(),function(r){var a=e.edge(r);n.forEach(a.points,function(e){e.x-=t,e.y-=i}),n.has(a,`x`)&&(a.x-=t),n.has(a,`y`)&&(a.y-=i)}),o.width=r-t+s,o.height=a-i+c}function te(e){n.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),a,o;n.points?(a=n.points[0],o=n.points[n.points.length-1]):(n.points=[],a=i,o=r),n.points.unshift(m.intersectRect(r,a)),n.points.push(m.intersectRect(i,o))})}function M(e){n.forEach(e.edges(),function(t){var r=e.edge(t);if(n.has(r,`x`))switch((r.labelpos===`l`||r.labelpos===`r`)&&(r.width-=r.labeloffset),r.labelpos){case`l`:r.x-=r.width/2+r.labeloffset;break;case`r`:r.x+=r.width/2+r.labeloffset;break}})}function ne(e){n.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function re(e){n.forEach(e.nodes(),function(t){if(e.children(t).length){var r=e.node(t),i=e.node(r.borderTop),a=e.node(r.borderBottom),o=e.node(n.last(r.borderLeft)),s=e.node(n.last(r.borderRight));r.width=Math.abs(s.x-o.x),r.height=Math.abs(a.y-i.y),r.x=o.x+r.width/2,r.y=i.y+r.height/2}}),n.forEach(e.nodes(),function(t){e.node(t).dummy===`border`&&e.removeNode(t)})}function ie(e){n.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||=[],n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function ae(e){var t=m.buildLayerMatrix(e);n.forEach(t,function(t){var r=0;n.forEach(t,function(t,i){var a=e.node(t);a.order=i+r,n.forEach(a.selfEdges,function(t){m.addDummyNode(e,`selfedge`,{width:t.label.width,height:t.label.height,rank:a.rank,order:i+ ++r,e:t.e,label:t.label},`_se`)}),delete a.selfEdges})})}function oe(e){n.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy===`selfedge`){var r=e.node(n.e.v),i=r.x+r.width/2,a=r.y,o=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:a-s},{x:i+5*o/6,y:a-s},{x:i+o,y:a},{x:i+5*o/6,y:a+s},{x:i+2*o/3,y:a+s}],n.label.x=n.x,n.label.y=n.y}})}function se(e,t){return n.mapValues(n.pick(e,t),Number)}function ce(e){var t={};return n.forEach(e,function(e,n){t[n.toLowerCase()]=e}),t}})),PB=r(((exports,t)=>{var n=cB(),r=fB(),i=hz().Graph;t.exports={debugOrdering:a};function a(e){var t=r.buildLayerMatrix(e),a=new i({compound:!0,multigraph:!0}).setGraph({});return n.forEach(e.nodes(),function(t){a.setNode(t,{label:t}),a.setParent(t,`layer`+e.node(t).rank)}),n.forEach(e.edges(),function(e){a.setEdge(e.v,e.w,{},e.name)}),n.forEach(t,function(e,t){var r=`layer`+t;a.setNode(r,{rank:`same`}),n.reduce(e,function(e,t){return a.setEdge(e,t,{style:`invis`}),t})}),a}})),FB=r(((exports,t)=>{t.exports=`0.8.5`})),IB=t(r(((exports,t)=>{t.exports={graphlib:hz(),layout:NB(),debug:PB(),util:{time:fB().time,notime:fB().notime},version:FB()}}))()),LB=class e{constructor(t){this.id=`dagre`,this.options={},Object.assign(this.options,e.defaultOptions,t)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericDagreLayout(!1,e,Object.assign(Object.assign({},this.options),t))})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericDagreLayout(!0,e,Object.assign(Object.assign({},this.options),t))})}genericDagreLayout(e,t,n){return en(this,void 0,void 0,function*(){let{nodeSize:r}=n,i=new IB.graphlib.Graph;i.setGraph(n),i.setDefaultEdgeLabel(()=>({}));let a=t.getAllNodes(),o=t.getAllEdges();[...a,...o].some(({id:e})=>G(e))&&console.error(`Dagre layout only support string id, it will convert number to string.`),t.getAllNodes().forEach(e=>{let{id:t}=e,n=Object.assign({},e.data);if(r!==void 0){let[t,i]=kM(W(r)?r(e):r);Object.assign(n,{width:t,height:i})}i.setNode(t.toString(),n)}),t.getAllEdges().forEach(({id:e,source:t,target:n})=>{i.setEdge(t.toString(),n.toString(),{id:e})}),IB.default.layout(i);let s={nodes:[],edges:[]};return i.nodes().forEach(n=>{let r=i.node(n);s.nodes.push({id:n,data:r}),e&&t.mergeNodeData(n,r)}),i.edges().forEach(n=>{let r=i.edge(n),{id:a}=r,o=$t(r,[`id`]),{v:c,w:l}=n;s.edges.push({id:a,source:c,target:l,data:o}),e&&t.mergeEdgeData(a,o)}),s})}};LB.defaultOptions={};var RB=class e{constructor(e){this.id=e.id||0,this.rx=e.rx,this.ry=e.ry,this.fx=0,this.fy=0,this.mass=e.mass,this.degree=e.degree,this.g=e.g||0}distanceTo(e){let t=this.rx-e.rx,n=this.ry-e.ry;return Math.hypot(t,n)}setPos(e,t){this.rx=e,this.ry=t}resetForce(){this.fx=0,this.fy=0}addForce(e){let t=e.rx-this.rx,n=e.ry-this.ry,r=Math.hypot(t,n);r=r<1e-4?1e-4:r;let i=this.g*(this.degree+1)*(e.degree+1)/r;this.fx+=i*t/r,this.fy+=i*n/r}in(e){return e.contains(this.rx,this.ry)}add(t){let n=this.mass+t.mass,r=(this.rx*this.mass+t.rx*t.mass)/n,i=(this.ry*this.mass+t.ry*t.mass)/n,a=this.degree+t.degree;return new e({rx:r,ry:i,mass:n,degree:a})}},zB=class e{constructor(e){this.xmid=e.xmid,this.ymid=e.ymid,this.length=e.length,this.massCenter=e.massCenter||[0,0],this.mass=e.mass||1}getLength(){return this.length}contains(e,t){let n=this.length/2;return e<=this.xmid+n&&e>=this.xmid-n&&t<=this.ymid+n&&t>=this.ymid-n}NW(){let t=this.xmid-this.length/4,n=this.ymid+this.length/4,r=this.length/2;return new e({xmid:t,ymid:n,length:r})}NE(){let t=this.xmid+this.length/4,n=this.ymid+this.length/4,r=this.length/2;return new e({xmid:t,ymid:n,length:r})}SW(){let t=this.xmid-this.length/4,n=this.ymid-this.length/4,r=this.length/2;return new e({xmid:t,ymid:n,length:r})}SE(){let t=this.xmid+this.length/4,n=this.ymid-this.length/4,r=this.length/2;return new e({xmid:t,ymid:n,length:r})}},BB=class e{constructor(e){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,e!=null&&(this.quad=e)}insert(t){if(this.body==null){this.body=t;return}this._isExternal()?(this.quad&&(this.NW=new e(this.quad.NW()),this.NE=new e(this.quad.NE()),this.SW=new e(this.quad.SW()),this.SE=new e(this.quad.SE())),this._putBody(this.body),this._putBody(t),this.body=this.body.add(t)):(this.body=this.body.add(t),this._putBody(t))}_putBody(e){this.quad&&(e.in(this.quad.NW())&&this.NW?this.NW.insert(e):e.in(this.quad.NE())&&this.NE?this.NE.insert(e):e.in(this.quad.SW())&&this.SW?this.SW.insert(e):e.in(this.quad.SE())&&this.SE&&this.SE.insert(e))}_isExternal(){return this.NW==null&&this.NE==null&&this.SW==null&&this.SE==null}updateForce(e){if(!(this.body==null||e===this.body))if(this._isExternal())e.addForce(this.body);else{let t=this.quad?this.quad.getLength():0,n=this.body.distanceTo(e);t/n<this.theta?e.addForce(this.body):(this.NW&&this.NW.updateForce(e),this.NE&&this.NE.updateForce(e),this.SW&&this.SW.updateForce(e),this.SE&&this.SE.updateForce(e))}}},VB={center:[0,0],width:300,height:300,kr:5,kg:1,mode:`normal`,preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},HB=class{constructor(e={}){this.options=e,this.id=`forceAtlas2`,this.options=Object.assign(Object.assign({},VB),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericForceAtlas2Layout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericForceAtlas2Layout(!0,e,t)})}genericForceAtlas2Layout(e,t,n){return en(this,void 0,void 0,function*(){let r=t.getAllEdges(),i=t.getAllNodes(),a=this.formatOptions(n,i.length),{width:o,height:s,prune:c,maxIteration:l,nodeSize:u,center:d}=a;if(!i?.length||i.length===1)return IM(t,e,d);let f=i.map(e=>OM(e,[o,s])),p=r.filter(e=>{let{source:t,target:n}=e;return t!==n}),m=new bk({nodes:f,edges:p}),h=this.getSizes(m,u);if(this.run(m,t,l,h,e,a),c){for(let e=0;e<p.length;e+=1){let{source:t,target:n}=p[e],r=m.getDegree(t),i=m.getDegree(t);if(r<=1){let e=m.getNode(n);m.mergeNodeData(t,{x:e.data.x,y:e.data.y})}else if(i<=1){let e=m.getNode(t);m.mergeNodeData(n,{x:e.data.x,y:e.data.y})}}let n=Object.assign(Object.assign({},a),{prune:!1,barnesHut:!1});this.run(m,t,100,h,e,n)}return{nodes:f,edges:r}})}getSizes(e,t){let n=e.getAllNodes(),r={};for(let e=0;e<n.length;e+=1){let i=n[e];r[i.id]=MM(t,void 0)(i)}return r}formatOptions(e={},t){let n=Object.assign(Object.assign({},this.options),e),{center:r,width:i,height:a,barnesHut:o,prune:s,maxIteration:c,kr:l,kg:u}=n;return n.width=!i&&typeof window<`u`?window.innerWidth:i,n.height=!a&&typeof window<`u`?window.innerHeight:a,n.center=r||[n.width/2,n.height/2],o===void 0&&t>250&&(n.barnesHut=!0),s===void 0&&t>100&&(n.prune=!0),c===0&&!s?(n.maxIteration=250,t<=200&&t>100?n.maxIteration=1e3:t>200&&(n.maxIteration=1200)):c===0&&s&&(n.maxIteration=100,t<=200&&t>100?n.maxIteration=500:t>200&&(n.maxIteration=950)),l||(n.kr=50,t>100&&t<=500?n.kr=20:t>500&&(n.kr=1)),u||(n.kg=20,t>100&&t<=500?n.kg=10:t>500&&(n.kg=1)),n}run(e,t,n,r,i,a){let{kr:o,barnesHut:s,onTick:c}=a,l=e.getAllNodes(),u=0,d=n,f={},p={},m={};for(let t=0;t<l.length;t+=1){let{data:n,id:r}=l[t];if(f[r]=[0,0],s){let i={id:t,rx:n.x,ry:n.y,mass:1,g:o,degree:e.getDegree(r)};m[r]=new RB(i)}}for(;d>0;)u=this.oneStep(e,{iter:d,preventOverlapIters:50,krPrime:100,sg:u,forces:f,preForces:p,bodies:m,sizes:r},a),d--,c?.({nodes:l,edges:t.getAllEdges()});return e}oneStep(e,t,n){let{iter:r,preventOverlapIters:i,krPrime:a,sg:o,preForces:s,bodies:c,sizes:l}=t,{forces:u}=t,{preventOverlap:d,barnesHut:f}=n,p=e.getAllNodes();for(let e=0;e<p.length;e+=1){let{id:t}=p[e];s[t]=[...u[t]],u[t]=[0,0]}return u=this.getAttrForces(e,r,i,l,u,n),u=f&&(d&&r>i||!d)?this.getOptRepGraForces(e,u,c,n):this.getRepGraForces(e,r,i,u,a,l,n),this.updatePos(e,u,s,o,n)}getAttrForces(e,t,n,r,i,a){let{preventOverlap:o,dissuadeHubs:s,mode:c,prune:l}=a,u=e.getAllEdges();for(let a=0;a<u.length;a+=1){let{source:d,target:f}=u[a],p=e.getNode(d),m=e.getNode(f),h=e.getDegree(d),g=e.getDegree(f);if(l&&(h<=1||g<=1))continue;let _=[m.data.x-p.data.x,m.data.y-p.data.y],v=Math.hypot(_[0],_[1]);v=v<1e-4?1e-4:v,_[0]/=v,_[1]/=v,o&&t<n&&(v=v-r[d]-r[f]);let y=v,b=y;c===`linlog`&&(y=Math.log(1+v),b=y),s&&(y=v/h,b=v/g),o&&t<n&&v<=0?(y=0,b=0):o&&t<n&&v>0&&(y=v,b=v),i[d][0]+=y*_[0],i[f][0]-=b*_[0],i[d][1]+=y*_[1],i[f][1]-=b*_[1]}return i}getOptRepGraForces(e,t,n,r){let{kg:i,center:a,prune:o}=r,s=e.getAllNodes(),c=s.length,l=9e10,u=-9e10,d=9e10,f=-9e10;for(let t=0;t<c;t+=1){let{id:r,data:i}=s[t];o&&e.getDegree(r)<=1||(n[r].setPos(i.x,i.y),i.x>=u&&(u=i.x),i.x<=l&&(l=i.x),i.y>=f&&(f=i.y),i.y<=d&&(d=i.y))}let p=Math.max(u-l,f-d),m={xmid:(u+l)/2,ymid:(f+d)/2,length:p,massCenter:a,mass:c},h=new zB(m),g=new BB(h);for(let t=0;t<c;t+=1){let{id:r}=s[t];o&&e.getDegree(r)<=1||n[r].in(h)&&g.insert(n[r])}for(let r=0;r<c;r+=1){let{id:c,data:l}=s[r],u=e.getDegree(c);if(o&&u<=1)continue;n[c].resetForce(),g.updateForce(n[c]),t[c][0]-=n[c].fx,t[c][1]-=n[c].fy;let d=[l.x-a[0],l.y-a[1]],f=Math.hypot(d[0],d[1]);f=f<1e-4?1e-4:f,d[0]/=f,d[1]/=f;let p=i*(u+1);t[c][0]-=p*d[0],t[c][1]-=p*d[1]}return t}getRepGraForces(e,t,n,r,i,a,o){let{preventOverlap:s,kr:c,kg:l,center:u,prune:d}=o,f=e.getAllNodes(),p=f.length;for(let o=0;o<p;o+=1){let m=f[o],h=e.getDegree(m.id);for(let l=o+1;l<p;l+=1){let o=f[l],u=e.getDegree(o.id);if(d&&(h<=1||u<=1))continue;let p=[o.data.x-m.data.x,o.data.y-m.data.y],g=Math.hypot(p[0],p[1]);g=g<1e-4?1e-4:g,p[0]/=g,p[1]/=g,s&&t<n&&(g=g-a[m.id]-a[o.id]);let _=c*(h+1)*(u+1)/g;s&&t<n&&g<0?_=i*(h+1)*(u+1):s&&t<n&&g===0?_=0:s&&t<n&&g>0&&(_=c*(h+1)*(u+1)/g),r[m.id][0]-=_*p[0],r[o.id][0]+=_*p[0],r[m.id][1]-=_*p[1],r[o.id][1]+=_*p[1]}let g=[m.data.x-u[0],m.data.y-u[1]],_=Math.hypot(g[0],g[1]);g[0]/=_,g[1]/=_;let v=l*(h+1);r[m.id][0]-=v*g[0],r[m.id][1]-=v*g[1]}return r}updatePos(e,t,n,r,i){let{ks:a,tao:o,prune:s,ksmax:c}=i,l=e.getAllNodes(),u=l.length,d=[],f=[],p=0,m=0,h=r;for(let r=0;r<u;r+=1){let{id:i}=l[r],a=e.getDegree(i);if(s&&a<=1)continue;let o=[t[i][0]-n[i][0],t[i][1]-n[i][1]],c=Math.hypot(o[0],o[1]),u=[t[i][0]+n[i][0],t[i][1]+n[i][1]],h=Math.hypot(u[0],u[1]);d[r]=c,f[r]=h/2,p+=(a+1)*d[r],m+=(a+1)*f[r]}let g=h;h=o*m/p,g!==0&&(h=h>1.5*g?1.5*g:h);for(let n=0;n<u;n+=1){let{id:r,data:i}=l[n],o=e.getDegree(r);if(s&&o<=1||G(i.fx)&&G(i.fy))continue;let u=a*h/(1+h*Math.sqrt(d[n])),f=Math.hypot(t[r][0],t[r][1]);f=f<1e-4?1e-4:f;let p=c/f;u=u>p?p:u;let m=u*t[r][0],g=u*t[r][1];e.mergeNodeData(r,{x:i.x+m,y:i.y+g})}return h}},UB={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:`cluster`},WB=800,GB=class{constructor(e={}){this.options=e,this.id=`fruchterman`,this.timeInterval=0,this.running=!1,this.options=Object.assign(Object.assign({},UB),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericFruchtermanLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericFruchtermanLayout(!0,e,t)})}stop(){this.timeInterval&&typeof window<`u`&&window.clearInterval(this.timeInterval),this.running=!1}tick(e=this.options.maxIteration||1){if(this.lastResult)return this.lastResult;for(let t=0;t<e;t++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);let t={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&t.nodes.forEach(e=>this.lastGraph.mergeNodeData(e.id,{x:e.data.x,y:e.data.y,z:this.options.dimensions===3?e.data.z:void 0})),t}genericFruchtermanLayout(e,t,n){return en(this,void 0,void 0,function*(){if(this.running)return;let r=this.formatOptions(n),{dimensions:i,width:a,height:o,center:s,clustering:c,nodeClusterBy:l,maxIteration:u,onTick:d}=r,f=t.getAllNodes(),p=t.getAllEdges();if(!f?.length){let e={nodes:[],edges:p};return this.lastResult=e,e}if(f.length===1){e&&t.mergeNodeData(f[0].id,{x:s[0],y:s[1],z:i===3?s[2]:void 0});let n={nodes:[Object.assign(Object.assign({},f[0]),{data:Object.assign(Object.assign({},f[0].data),{x:s[0],y:s[1],z:i===3?s[2]:void 0})})],edges:p};return this.lastResult=n,n}let m=f.map(e=>OM(e,[a,o])),h=new bk({nodes:m,edges:p}),g={};if(c&&m.forEach(e=>{let t=e.data[l];g[t]||(g[t]={name:t,cx:0,cy:0,count:0})}),this.lastLayoutNodes=m,this.lastLayoutEdges=p,this.lastAssign=e,this.lastGraph=h,this.lastOptions=r,this.lastClusterMap=g,typeof window>`u`)return;let _=0;return new Promise(n=>{this.timeInterval=window.setInterval(()=>{if(!this.running){n({nodes:m,edges:p});return}this.runOneStep(h,g,r),e&&m.forEach(({id:e,data:n})=>t.mergeNodeData(e,{x:n.x,y:n.y,z:i===3?n.z:void 0})),d?.({nodes:m,edges:p}),_++,_>=u&&(window.clearInterval(this.timeInterval),n({nodes:m,edges:p}))},0),this.running=!0})})}formatOptions(e={}){let t=Object.assign(Object.assign({},this.options),e),{clustering:n,nodeClusterBy:r}=t,{center:i,width:a,height:o}=t;return t.width=!a&&typeof window<`u`?window.innerWidth:a,t.height=!o&&typeof window<`u`?window.innerHeight:o,t.center=i||[t.width/2,t.height/2],t.clustering=n&&!!r,t}runOneStep(e,t,n){let{dimensions:r,height:i,width:a,gravity:o,center:s,speed:c,clustering:l,nodeClusterBy:u,clusterGravity:d}=n,f=i*a,p=Math.sqrt(f)/10,m=e.getAllNodes(),h=f/(m.length+1),g=Math.sqrt(h),_={};if(this.applyCalculate(e,_,g,h),l){for(let e in t)t[e].cx=0,t[e].cy=0,t[e].count=0;for(let e in m.forEach(e=>{let{data:n}=e,r=t[n[u]];G(n.x)&&(r.cx+=n.x),G(n.y)&&(r.cy+=n.y),r.count++}),t)t[e].cx/=t[e].count,t[e].cy/=t[e].count;let e=d||o;m.forEach((n,r)=>{let{id:i,data:a}=n;if(!G(a.x)||!G(a.y))return;let o=t[a[u]],s=Math.sqrt((a.x-o.cx)*(a.x-o.cx)+(a.y-o.cy)*(a.y-o.cy)),c=g*e;_[i].x-=c*(a.x-o.cx)/s,_[i].y-=c*(a.y-o.cy)/s})}m.forEach((e,t)=>{let{id:n,data:i}=e;if(!G(i.x)||!G(i.y))return;let a=.01*g*o;_[n].x-=a*(i.x-s[0]),_[n].y-=a*(i.y-s[1]),r===3&&(_[n].z-=a*(i.z-s[2]))}),m.forEach((t,n)=>{let{id:i,data:a}=t;if(G(a.fx)&&G(a.fy)){a.x=a.fx,a.y=a.fy,r===3&&(a.z=a.fz);return}if(!G(a.x)||!G(a.y))return;let o=Math.sqrt(_[i].x*_[i].x+_[i].y*_[i].y+(r===3?_[i].z*_[i].z:0));if(o>0){let t=Math.min(p*(c/WB),o);e.mergeNodeData(i,{x:a.x+_[i].x/o*t,y:a.y+_[i].y/o*t,z:r===3?a.z+_[i].z/o*t:void 0})}})}applyCalculate(e,t,n,r){this.calRepulsive(e,t,r),this.calAttractive(e,t,n)}calRepulsive(e,t,n){let r=e.getAllNodes();r.forEach(({data:e,id:i},a)=>{t[i]={x:0,y:0,z:0},r.forEach(({data:r,id:o},s)=>{if(a<=s||!G(e.x)||!G(r.x)||!G(e.y)||!G(r.y))return;let c=e.x-r.x,l=e.y-r.y,u=this.options.dimensions===3?e.z-r.z:0,d=c*c+l*l+u*u;d===0&&(d=1,c=.01,l=.01,u=.01);let f=n/d,p=c*f,m=l*f,h=u*f;t[i].x+=p,t[i].y+=m,t[o].x-=p,t[o].y-=m,this.options.dimensions===3&&(t[i].z+=h,t[o].z-=h)})})}calAttractive(e,t,n){e.getAllEdges().forEach(r=>{let{source:i,target:a}=r;if(!i||!a||i===a)return;let{data:o}=e.getNode(i),{data:s}=e.getNode(a);if(!G(s.x)||!G(o.x)||!G(s.y)||!G(o.y))return;let c=s.x-o.x,l=s.y-o.y,u=this.options.dimensions===3?s.z-o.z:0,d=Math.sqrt(c*c+l*l+u*u)/n,f=c*d,p=l*d,m=u*d;t[i].x+=f,t[i].y+=p,t[a].x-=f,t[a].y-=p,this.options.dimensions===3&&(t[i].z+=m,t[a].z-=m)})}},KB={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:`degree`,nodeSize:30,width:300,height:300},qB=class{constructor(e={}){this.options=e,this.id=`grid`,this.options=Object.assign(Object.assign({},KB),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericGridLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericGridLayout(!0,e,t)})}genericGridLayout(e,t,n){return en(this,void 0,void 0,function*(){let r=Object.assign(Object.assign({},this.options),n),{begin:i=[0,0],condense:a,preventOverlapPadding:o,preventOverlap:s,rows:c,cols:l,nodeSpacing:u,nodeSize:d,width:f,height:p,position:m}=r,{sortBy:h}=r,g=t.getAllNodes(),_=t.getAllEdges(),v=g?.length;if(!v||v===1)return IM(t,e,i);let y=g.map(e=>OM(e));h!==`id`&&(!ru(h)||y[0].data[h]===void 0)&&(h=`degree`),h===`degree`?y.sort((e,n)=>t.getDegree(n.id,`both`)-t.getDegree(e.id,`both`)):h===`id`?y.sort((e,t)=>G(t.id)&&G(e.id)?t.id-e.id:`${e.id}`.localeCompare(`${t.id}`)):y.sort((e,t)=>t.data[h]-e.data[h]);let b=!f&&typeof window<`u`?window.innerWidth:f,x=!p&&typeof window<`u`?window.innerHeight:p,S=v,C={rows:c,cols:l};if(c!=null&&l!=null)C.rows=c,C.cols=l;else if(c!=null&&l==null)C.rows=c,C.cols=Math.ceil(S/C.rows);else if(c==null&&l!=null)C.cols=l,C.rows=Math.ceil(S/C.cols);else{let e=Math.sqrt(S*x/b);C.rows=Math.round(e),C.cols=Math.round(b/x*e)}if(C.rows=Math.max(C.rows,1),C.cols=Math.max(C.cols,1),C.cols*C.rows>S){let e=JB(C),t=YB(C);(e-1)*t>=S?JB(C,e-1):(t-1)*e>=S&&YB(C,t-1)}else for(;C.cols*C.rows<S;){let e=JB(C),t=YB(C);(t+1)*e>=S?YB(C,t+1):JB(C,e+1)}let w=a?0:b/C.cols,T=a?0:x/C.rows;if(s||u){let e=AM(10,u),n=jM(30,d,!1);y.forEach(r=>{(!r.data.x||!r.data.y)&&(r.data.x=0,r.data.y=0);let i=t.getNode(r.id),[a,s]=kM(n(i)||30),c=e===void 0?o:e(r),l=a+c,u=s+c;w=Math.max(w,l),T=Math.max(T,u)})}let E={},D={row:0,col:0},O={};for(let e=0;e<y.length;e++){let n=y[e],r;if(m&&(r=m(t.getNode(n.id))),r&&(r.row!==void 0||r.col!==void 0)){let e={row:r.row,col:r.col};if(e.col===void 0)for(e.col=0;XB(E,e);)e.col++;else if(e.row===void 0)for(e.row=0;XB(E,e);)e.row++;O[n.id]=e,ZB(E,e)}$B(n,i,w,T,O,C,D,E)}let k={nodes:y,edges:_};return e&&y.forEach(e=>{t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})}),k})}},JB=(e,t)=>{let n,r=e.rows||5,i=e.cols||5;return t==null?n=Math.min(r,i):Math.min(r,i)===e.rows?e.rows=t:e.cols=t,n},YB=(e,t)=>{let n,r=e.rows||5,i=e.cols||5;return t==null?n=Math.max(r,i):Math.max(r,i)===e.rows?e.rows=t:e.cols=t,n},XB=(e,t)=>e[`c-${t.row}-${t.col}`]||!1,ZB=(e,t)=>e[`c-${t.row}-${t.col}`]=!0,QB=(e,t)=>{let n=e.cols||5;t.col++,t.col>=n&&(t.col=0,t.row++)},$B=(e,t,n,r,i,a,o,s)=>{let c,l,u=i[e.id];if(u)c=u.col*n+n/2+t[0],l=u.row*r+r/2+t[1];else{for(;XB(s,o);)QB(a,o);c=o.col*n+n/2+t[0],l=o.row*r+r/2+t[1],ZB(s,o),QB(a,o)}e.data.x=c,e.data.y=l};const eV=(e,t,n)=>{try{let n=lP.mul(lP.pow(t,2),-.5),r=n.mean(`row`),i=n.mean(`column`),a=n.mean();n.add(a).subRowVector(r).subColumnVector(i);let o=new uP(n),s=lP.sqrt(o.diagonalMatrix).diagonal();return o.leftSingularVectors.toJSON().map(t=>lP.mul([t],[s]).toJSON()[0].splice(0,e))}catch{let e=[];for(let r=0;r<t.length;r++){let t=Math.random()*n,r=Math.random()*n;e.push([t,r])}return e}};var tV=800,nV={iterations:10,height:10,width:10,speed:100,gravity:10,k:5};const rV=(e,t)=>{let{positions:n,iterations:r,width:i,k:a,speed:o=100,strictRadial:s,focusIdx:c,radii:l=[],nodeSizeFunc:u}=Object.assign(Object.assign({},nV),t),d=e.getAllNodes(),f=[],p=i/10;for(let e=0;e<r;e++)n.forEach((e,t)=>{f[t]={x:0,y:0}}),iV(d,n,f,a,l,u),aV(n,f,o,s,c,p,i,l);return n};var iV=(e,t,n,r,i,a)=>{t.forEach((o,s)=>{n[s]={x:0,y:0},t.forEach((t,c)=>{if(s===c||i[s]!==i[c])return;let l=o.x-t.x,u=o.y-t.y,d=Math.sqrt(l*l+u*u);if(d===0){d=1;let e=s>c?1:-1;l=.01*e,u=.01*e}if(d<a(e[s])/2+a(e[c])/2){let e=r*r/d;n[s].x+=l/d*e,n[s].y+=u/d*e}})})},aV=(e,t,n,r,i,a,o,s)=>{let c=a||o/10;return r&&t.forEach((t,n)=>{let r=e[n].x-e[i].x,a=e[n].y-e[i].y,o=Math.sqrt(r*r+a*a),s=a/o,c=-r/o,l=Math.sqrt(t.x*t.x+t.y*t.y),u=Math.acos((s*t.x+c*t.y)/l);u>Math.PI/2&&(u-=Math.PI/2,s*=-1,c*=-1);let d=Math.cos(u)*l;t.x=s*d,t.y=c*d}),e.forEach((a,o)=>{if(o===i)return;let l=Math.sqrt(t[o].x*t[o].x+t[o].y*t[o].y);if(l>0&&o!==i){let u=Math.min(c*(n/tV),l);if(a.x+=t[o].x/l*u,a.y+=t[o].y/l*u,r){let t=a.x-e[i].x,n=a.y-e[i].y,r=Math.sqrt(t*t+n*n);t=t/r*s[o],n=n/r*s[o],a.x=e[i].x+t,a.y=e[i].y+n}}}),e},oV={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},sV=class{constructor(e={}){this.options=e,this.id=`radial`,this.options=Object.assign(Object.assign({},oV),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericRadialLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericRadialLayout(!0,e,t)})}genericRadialLayout(e,t,n){return en(this,void 0,void 0,function*(){let{width:r,height:i,center:a,focusNode:o,unitRadius:s,nodeSize:c,nodeSpacing:l,strictRadial:u,preventOverlap:d,maxPreventOverlapIteration:f,sortBy:p,linkDistance:m=50,sortStrength:h=10,maxIteration:g=1e3}=Object.assign(Object.assign({},this.options),n),_=t.getAllNodes(),v=t.getAllEdges(),y=!r&&typeof window<`u`?window.innerWidth:r,b=!i&&typeof window<`u`?window.innerHeight:i,x=a||[y/2,b/2];if(!_?.length||_.length===1)return IM(t,e,x);let S=_[0];if(ru(o)){for(let e=0;e<_.length;e++)if(_[e].id===o){S=_[e];break}}else S=o||_[0];let C=uV(_,S.id),w=SM({nodes:_,edges:v},!1),T=xM(w),E=fV(T,C);dV(T,C,E+1);let D=T[C],O=y-x[0]>x[0]?x[0]:y-x[0],k=b-x[1]>x[1]?x[1]:b-x[1];O===0&&(O=y/2),k===0&&(k=b/2);let A=Math.min(O,k),j=Math.max(...D),ee=[],te=s||A/j;D.forEach((e,t)=>{ee[t]=e*te});let M=cV(_,T,m,ee,te,p,h),ne=lV(M),re=eV(m,M,m),ie=re.map(([e,t])=>({x:(isNaN(e)?Math.random()*m:e)-re[C][0],y:(isNaN(t)?Math.random()*m:t)-re[C][1]}));this.run(g,ie,ne,M,ee,C);let ae;if(d){ae=MM(c,l);let e={nodes:_,nodeSizeFunc:ae,positions:ie,radii:ee,height:b,width:y,strictRadial:!!u,focusIdx:C,iterations:f||200,k:ie.length/4.5};ie=rV(t,e)}let oe=[];return ie.forEach((e,t)=>{let n=OM(_[t]);n.data.x=e.x+x[0],n.data.y=e.y+x[1],oe.push(n)}),e&&oe.forEach(e=>t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})),{nodes:oe,edges:v}})}run(e,t,n,r,i,a){for(let o=0;o<=e;o++){let s=o/e;this.oneIteration(s,t,i,r,n,a)}}oneIteration(e,t,n,r,i,a){let o=1-e;t.forEach((s,c)=>{let l=TM(s,{x:0,y:0}),u=l===0?0:1/l;if(c===a)return;let d=0,f=0,p=0;t.forEach((e,t)=>{if(c===t)return;let n=TM(s,e),a=n===0?0:1/n,o=r[t][c];p+=i[c][t],d+=i[c][t]*(e.x+o*(s.x-e.x)*a),f+=i[c][t]*(e.y+o*(s.y-e.y)*a)});let m=n[c]===0?0:1/n[c];p*=o,p+=e*m*m,d*=o,d+=e*m*s.x*u,s.x=d/p,f*=o,f+=e*m*s.y*u,s.y=f/p})}},cV=(e,t,n,r,i,a,o)=>{if(!e)return[];let s=[];if(t){let c={};t.forEach((t,l)=>{let u=[];t.forEach((t,s)=>{if(l===s)u.push(0);else if(r[l]===r[s])if(a===`data`)u.push(t*(Math.abs(l-s)*o)/(r[l]/i));else if(a){let n,d;if(c[e[l].id])n=c[e[l].id];else{let t=(a===`id`?e[l].id:e[l].data?.[a])||0;n=ru(t)?t.charCodeAt(0):t,c[e[l].id]=n}if(c[e[s].id])d=c[e[s].id];else{let t=(a===`id`?e[s].id:e[s].data?.[a])||0;d=ru(t)?t.charCodeAt(0):t,c[e[s].id]=d}u.push(t*(Math.abs(n-d)*o)/(r[l]/i))}else u.push(t*n/(r[l]/i));else{let e=(n+i)/2;u.push(t*e)}}),s.push(u)})}return s},lV=e=>{let t=e.length,n=e[0].length,r=[];for(let i=0;i<t;i++){let t=[];for(let r=0;r<n;r++)e[i][r]===0?t.push(0):t.push(1/(e[i][r]*e[i][r]));r.push(t)}return r},uV=(e,t)=>{let n=-1;return e.forEach((e,r)=>{e.id===t&&(n=r)}),Math.max(n,0)},dV=(e,t,n)=>{let r=e.length;for(let i=0;i<r;i++)if(e[t][i]===1/0){e[t][i]=n,e[i][t]=n;for(let a=0;a<r;a++)e[i][a]!==1/0&&e[t][a]===1/0&&(e[t][a]=n+e[i][a],e[a][t]=n+e[i][a])}for(let n=0;n<r;n++)if(n!==t){for(let i=0;i<r;i++)if(e[n][i]===1/0){let r=Math.abs(e[t][n]-e[t][i]);r=r===0?1:r,e[n][i]=r}}},fV=(e,t)=>{let n=0;for(let r=0;r<e[t].length;r++)e[t][r]!==1/0&&(n=e[t][r]>n?e[t][r]:n);return n},pV={center:[0,0],width:300,height:300},mV=class{constructor(e={}){this.options=e,this.id=`random`,this.options=Object.assign(Object.assign({},pV),e)}execute(e,t){return en(this,void 0,void 0,function*(){return this.genericRandomLayout(!1,e,t)})}assign(e,t){return en(this,void 0,void 0,function*(){yield this.genericRandomLayout(!0,e,t)})}genericRandomLayout(e,t,n){return en(this,void 0,void 0,function*(){let{center:r,width:i,height:a}=Object.assign(Object.assign({},this.options),n),o=t.getAllNodes(),s=.9,c=!i&&typeof window<`u`?window.innerWidth:i,l=!a&&typeof window<`u`?window.innerHeight:a,u=r||[c/2,l/2],d=[];return o&&o.forEach(e=>{d.push({id:e.id,data:{x:(Math.random()-.5)*s*c+u[0],y:(Math.random()-.5)*s*l+u[1]}})}),e&&d.forEach(e=>t.mergeNodeData(e.id,{x:e.data.x,y:e.data.y})),{nodes:d,edges:t.getAllEdges()}})}},hV=Symbol(`Comlink.proxy`),gV=Symbol(`Comlink.endpoint`),_V=Symbol(`Comlink.releaseProxy`),vV=Symbol(`Comlink.finalizer`),yV=Symbol(`Comlink.thrown`),bV=e=>typeof e==`object`&&!!e||typeof e==`function`,xV=new Map([[`proxy`,{canHandle:e=>bV(e)&&e[hV],serialize(e){let{port1:t,port2:n}=new MessageChannel;return CV(e,t),[n,[n]]},deserialize(e){return e.start(),EV(e)}}],[`throw`,{canHandle:e=>bV(e)&&yV in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(Error(e.value.message),e.value):e.value}}]]);function SV(e,t){for(let n of e)if(t===n||n===`*`||n instanceof RegExp&&n.test(t))return!0;return!1}function CV(e,t=globalThis,n=[`*`]){t.addEventListener(`message`,function r(i){if(!i||!i.data)return;if(!SV(n,i.origin)){console.warn(`Invalid origin '${i.origin}' for comlink proxy`);return}let{id:a,type:o,path:s}=Object.assign({path:[]},i.data),c=(i.data.argumentList||[]).map(BV),l;try{let t=s.slice(0,-1).reduce((e,t)=>e[t],e),n=s.reduce((e,t)=>e[t],e);switch(o){case`GET`:l=n;break;case`SET`:t[s.slice(-1)[0]]=BV(i.data.value),l=!0;break;case`APPLY`:l=n.apply(t,c);break;case`CONSTRUCT`:{let e=new n(...c);l=RV(e)}break;case`ENDPOINT`:{let{port1:t,port2:n}=new MessageChannel;CV(e,n),l=LV(t,[t])}break;case`RELEASE`:l=void 0;break;default:return}}catch(e){l={value:e,[yV]:0}}Promise.resolve(l).catch(e=>({value:e,[yV]:0})).then(n=>{let[i,s]=zV(n);t.postMessage(Object.assign(Object.assign({},i),{id:a}),s),o===`RELEASE`&&(t.removeEventListener(`message`,r),TV(t),vV in e&&typeof e[vV]==`function`&&e[vV]())}).catch(e=>{let[n,r]=zV({value:TypeError(`Unserializable return value`),[yV]:0});t.postMessage(Object.assign(Object.assign({},n),{id:a}),r)})}),t.start&&t.start()}function wV(e){return e.constructor.name===`MessagePort`}function TV(e){wV(e)&&e.close()}function EV(e,t){let n=new Map;return e.addEventListener(`message`,function(e){let{data:t}=e;if(!t||!t.id)return;let r=n.get(t.id);if(r)try{r(t)}finally{n.delete(t.id)}}),NV(e,n,[],t)}function DV(e){if(e)throw Error(`Proxy has been released and is not useable`)}function OV(e){return VV(e,new Map,{type:`RELEASE`}).then(()=>{TV(e)})}var kV=new WeakMap,AV=`FinalizationRegistry`in globalThis&&new FinalizationRegistry(e=>{let t=(kV.get(e)||0)-1;kV.set(e,t),t===0&&OV(e)});function jV(e,t){let n=(kV.get(t)||0)+1;kV.set(t,n),AV&&AV.register(e,t,e)}function MV(e){AV&&AV.unregister(e)}function NV(e,t,n=[],r=function(){}){let i=!1,a=new Proxy(r,{get(r,o){if(DV(i),o===_V)return()=>{MV(a),OV(e),t.clear(),i=!0};if(o===`then`){if(n.length===0)return{then:()=>a};let r=VV(e,t,{type:`GET`,path:n.map(e=>e.toString())}).then(BV);return r.then.bind(r)}return NV(e,t,[...n,o])},set(r,a,o){DV(i);let[s,c]=zV(o);return VV(e,t,{type:`SET`,path:[...n,a].map(e=>e.toString()),value:s},c).then(BV)},apply(r,a,o){DV(i);let s=n[n.length-1];if(s===gV)return VV(e,t,{type:`ENDPOINT`}).then(BV);if(s===`bind`)return NV(e,t,n.slice(0,-1));let[c,l]=FV(o);return VV(e,t,{type:`APPLY`,path:n.map(e=>e.toString()),argumentList:c},l).then(BV)},construct(r,a){DV(i);let[o,s]=FV(a);return VV(e,t,{type:`CONSTRUCT`,path:n.map(e=>e.toString()),argumentList:o},s).then(BV)}});return jV(a,e),a}function PV(e){return Array.prototype.concat.apply([],e)}function FV(e){let t=e.map(zV);return[t.map(e=>e[0]),PV(t.map(e=>e[1]))]}var IV=new WeakMap;function LV(e,t){return IV.set(e,t),e}function RV(e){return Object.assign(e,{[hV]:!0})}function zV(e){for(let[t,n]of xV)if(n.canHandle(e)){let[r,i]=n.serialize(e);return[{type:`HANDLER`,name:t,value:r},i]}return[{type:`RAW`,value:e},IV.get(e)||[]]}function BV(e){switch(e.type){case`HANDLER`:return xV.get(e.name).deserialize(e.value);case`RAW`:return e.value}}function VV(e,t,n,r){return new Promise(i=>{let a=HV();t.set(a,i),e.start&&e.start(),e.postMessage(Object.assign({id:a},n),r)})}function HV(){return[,,,,].fill(0).map(()=>Math.floor(Math.random()*(2**53-1)).toString(16)).join(`-`)}var UV=class extends hk{constructor(e,t,n){super(),this.graph=e,this.layout=t,this.options=n,this.spawnWorker()}spawnWorker(){this.proxy=EV(new Worker(new URL(`/dialog-editor/assets/worker-el3X_6lQ.js`,``+import.meta.url),{type:`module`})),this.running&&(this.running=!1,this.execute())}execute(){return en(this,void 0,void 0,function*(){if(this.running)return this;this.running=!0;let e=this.layout.options,{onTick:t}=e,n=$t(e,[`onTick`]),r={};Object.keys(n).forEach(e=>{W(n[e])||(r[e]=n[e])});let i={layout:{id:this.layout.id,options:r,iterations:this.options?.iterations},nodes:this.graph.getAllNodes(),edges:this.graph.getAllEdges()},a=new Float32Array([0]),[o]=yield this.proxy.calculateLayout(i,[a]);return o})}stop(){return this.running=!1,this.proxy.stopLayout(),this}kill(){this.proxy[_V]()}isRunning(){return this.running}},WV=t(Uk()),GV=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},KV=class e extends xk{constructor(){super(...arguments),this.id=`fishbone`}getRoot(){let e=this.context.model.getRootsData();if(!(Uu(e)||e.length>2))return e[0]}formatSize(e){let t=typeof e==`function`?e:()=>e;return e=>Xw(t(e))}doLayout(e,t){let{hGap:n,getRibSep:r,vGap:i,nodeSize:a,height:o}=t,{model:s}=this.context,c=this.formatSize(a),l=c(e)[0]+r(e),u=(e,t=0)=>{var r;return t+=n*((e.children||[]).length+1),(r=e.children)==null||r.forEach(e=>{var n;(n=s.getNodeLikeDatum(e).children)==null||n.forEach(e=>{let n=s.getNodeLikeDatum(e);t=u(n,t)})}),t},d=e=>{if(e.depth===1)return l;let t=s.getParentData(e.id,`tree`);if(YV(e)){let r=s.getParentData(t.id,`tree`),a=m(e)-m(r);return d(t)+a*n/i}else{let n=(t.children||[]).indexOf(e.id),r=s.getNodeData((t.children||[]).slice(n));return f(t)-r.reduce((e,t)=>e+u(t),0)-c(t)[0]/2}},f=Iu(e=>{if(JV(e))return c(e)[0]/2;let t=s.getParentData(e.id,`tree`);if(YV(e))return d(e)+u(e)+c(e)[0]/2;{let r=m(e)-m(t),a=n/i;return d(e)+r*a}},e=>e.id),p=e=>m(s.getParentData(e,`tree`)),m=Iu(e=>{if(JV(e))return o/2;if(YV(e)){let t=s.getParentData(e.id,`tree`),n=t.children.indexOf(e.id);if(n===0)return p(t.id)+i;let r=s.getNodeLikeDatum(t.children[n-1]);if(Uu(r.children))return m(r)+i;let a=s.getDescendantsData(r.id);return Math.max(...a.map(e=>YV(e)?p(e.id):m(e)))+i}else{if(Uu(e.children))return p(e.id)+i;let t=s.getNodeLikeDatum(e.children.slice(-1)[0]);if(Uu(t.children))return m(t)+i;let n=s.getDescendantsData(e.id).slice(-1)[0];return(YV(n)?p(n.id):m(n))+i}},e=>e.id),h=0,g={nodes:[],edges:[]},_=e=>{var t;(t=e.children)==null||t.forEach(e=>_(s.getNodeLikeDatum(e)));let n=m(e),i=f(e);if(g.nodes.push({id:e.id,x:i,y:n}),JV(e))return;let a=s.getRelatedEdgesData(e.id,`in`)[0],o=[d(e),YV(e)?n:p(e.id)];g.edges.push({id:Q(a),controlPoints:[o],relatedNodeId:e.id}),h=Math.max(h,i+r(e)),e.depth===1&&(l=h)};return _(e),g}placeAlterative(e,t){let n=(t.children||[]).filter((e,t)=>t%2!=0);if(n.length===0)return e;let{model:r}=this.context,i=e.nodes.find(e=>e.id===t.id).y,a=e=>{let t=r.getAncestorsData(e,`tree`);if(Uu(t))return!1;let i=t.length===1?e:t[t.length-2].id;return n.includes(i)};e.nodes.forEach(e=>{a(e.id)&&(e.y=2*i-e.y)}),e.edges.forEach(e=>{a(e.relatedNodeId)&&(e.controlPoints=e.controlPoints.map(e=>[e[0],2*i-e[1]]))})}rightToLeft(e,t){return e.nodes.forEach(e=>e.x=t.width-e.x),e.edges.forEach(e=>{e.controlPoints=e.controlPoints.map(e=>[t.width-e[0],e[1]])}),e}execute(t,n){return GV(this,void 0,void 0,function*(){let r=Object.assign(Object.assign(Object.assign({},e.defaultOptions),this.options),n),{direction:i,nodeSize:a}=r,o=this.getRoot();if(!o)return t;let s=this.formatSize(a);r.vGap||=Math.max(...(t.nodes||[]).map(e=>s(e)[1])),r.hGap||=Math.max(...(t.nodes||[]).map(e=>s(e)[0]));let c=this.doLayout(o,r);this.placeAlterative(c,o),i===`RL`&&(c=this.rightToLeft(c,r));let{model:l}=this.context,u=[],d=[];return c.nodes.forEach(e=>{let{id:t,x:n,y:r}=e,i=l.getNodeLikeDatum(t);u.push(qV(i,{x:n,y:r}))}),c.edges.forEach(e=>{let{id:t,controlPoints:n}=e,r=l.getEdgeDatum(t);d.push(qV(r,{controlPoints:n}))}),{nodes:u,edges:d}})}};KV.defaultOptions={direction:`RL`,getRibSep:()=>60};var qV=(e,t)=>Object.assign(Object.assign({},e),{style:Object.assign(Object.assign({},e.style||{}),t)}),JV=e=>e.depth===0,YV=e=>(e.depth||=0)%2==0,XV=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},ZV=class e extends xk{constructor(){super(...arguments),this.id=`snake`}formatSize(e,t){let n=typeof t==`function`?t:(()=>t);return e.reduce((e,t)=>{let[r,i]=Xw(n(t))||[0,0];return[Math.max(e[0],r),Math.max(e[1],i)]},[0,0])}validate(e){let{nodes:t=[],edges:n=[]}=e,r={},i={},a={};t.forEach(e=>{r[e.id]=0,i[e.id]=0,a[e.id]=[]}),n.forEach(e=>{r[e.target]++,i[e.source]++,a[e.source].push(e.target)});let o=new Set,s=e=>{o.has(e)||(o.add(e),a[e].forEach(s))};if(s(t[0].id),o.size!==t.length)return!1;let c=t.filter(e=>r[e.id]===0),l=t.filter(e=>i[e.id]===0);return!(c.length!==1||l.length!==1||t.filter(e=>r[e.id]===1&&i[e.id]===1).length!==t.length-2)}execute(t,n){return XV(this,void 0,void 0,function*(){if(!this.validate(t))return t;let{nodeSize:r,padding:i,sortBy:a,cols:o,colGap:s,rowGap:c,clockwise:l,width:u,height:d}=Object.assign({},e.defaultOptions,this.options,n),[f,p,m,h]=CS(i),g=this.formatSize(t.nodes||[],r),_=Math.ceil((t.nodes||[]).length/o),v=s||(u-h-p-o*g[0])/(o-1),y=c||(d-f-m-_*g[1])/(_-1);return(y===1/0||y<0)&&(y=0),(v===1/0||v<0)&&(v=0),{nodes:((a?t.nodes?.sort(a):QV(t))||[]).map((e,t)=>{let n=Math.floor(t/o),r=t%o,i=l?n%2==0?r:o-1-r:n%2==0?o-1-r:r,a=h+i*(g[0]+v)+g[0]/2,s=f+n*(g[1]+y)+g[1]/2;return{id:e.id,style:{x:a,y:s}}})}})}};ZV.defaultOptions={padding:0,cols:5,clockwise:!0};function QV(e){let{nodes:t=[],edges:n=[]}=e,r={},i={};t.forEach(e=>{r[e.id]=0,i[e.id]=[]}),n.forEach(e=>{r[e.target]++,i[e.source].push(e.target)});let a=[],o=[];for(t.forEach(e=>{r[e.id]===0&&a.push(e.id)});a.length>0;){let e=a.shift(),n=t.find(t=>t.id===e);o.push(n),i[e].forEach(e=>{r[e]--,r[e]===0&&a.push(e)})}return o}const $V=[`rgb(158, 1, 66)`,`rgb(213, 62, 79)`,`rgb(244, 109, 67)`,`rgb(253, 174, 97)`,`rgb(254, 224, 139)`,`rgb(255, 255, 191)`,`rgb(230, 245, 152)`,`rgb(171, 221, 164)`,`rgb(102, 194, 165)`,`rgb(50, 136, 189)`,`rgb(94, 79, 162)`],eH=[`rgb(78, 121, 167)`,`rgb(242, 142, 44)`,`rgb(225, 87, 89)`,`rgb(118, 183, 178)`,`rgb(89, 161, 79)`,`rgb(237, 201, 73)`,`rgb(175, 122, 161)`,`rgb(255, 157, 167)`,`rgb(156, 117, 95)`,`rgb(186, 176, 171)`],tH=[`rgb(255, 245, 235)`,`rgb(254, 230, 206)`,`rgb(253, 208, 162)`,`rgb(253, 174, 107)`,`rgb(253, 141, 60)`,`rgb(241, 105, 19)`,`rgb(217, 72, 1)`,`rgb(166, 54, 3)`,`rgb(127, 39, 4)`],nH=[`rgb(247, 252, 245)`,`rgb(229, 245, 224)`,`rgb(199, 233, 192)`,`rgb(161, 217, 155)`,`rgb(116, 196, 118)`,`rgb(65, 171, 93)`,`rgb(35, 139, 69)`,`rgb(0, 109, 44)`,`rgb(0, 68, 27)`],rH=[`rgb(247, 251, 255)`,`rgb(222, 235, 247)`,`rgb(198, 219, 239)`,`rgb(158, 202, 225)`,`rgb(107, 174, 214)`,`rgb(66, 146, 198)`,`rgb(33, 113, 181)`,`rgb(8, 81, 156)`,`rgb(8, 48, 107)`];var iH=class extends IC{};function aH(e,t=!0,n){let r=document.createElement(`div`);return r.setAttribute(`class`,`g6-${e}`),Object.assign(r.style,{position:`absolute`,display:`block`}),t&&Object.assign(r.style,{position:`unset`,gridArea:`1 / 1 / 2 / 2`,inset:`0px`,height:`100%`,width:`100%`,overflow:`hidden`,pointerEvents:`none`}),n&&Object.assign(r.style,n),r}function oH(e,t=`div`,n={},r=``,i=document.body){let a=document.getElementById(e);a&&a.remove();let o=document.createElement(t);return o.innerHTML=r,o.id=e,Object.assign(o.style,n),i.appendChild(o),o}var sH=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},cH=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.$element=aH(`background`),this.context.canvas.getContainer().prepend(this.$element),this.update(n)}update(e){let t=Object.create(null,{update:{get:()=>super.update}});return sH(this,void 0,void 0,function*(){t.update.call(this,e),Object.assign(this.$element.style,Xu(this.options,[`key`,`type`]))})}destroy(){super.destroy(),this.$element.remove()}};cH.defaultOptions={transition:`background 0.5s`,backgroundSize:`cover`,zIndex:`-1`};function lH(e,t,n,r,i,a){let o=e,s=t,c=n-o,l=r-s,u=i-o,d=a-s,f=u*c+d*l,p=0;f<=0?p=0:(u=c-u,d=l-d,f=u*c+d*l,p=f<=0?0:f*f/(c*c+l*l));let m=u*u+d*d-p;return m<0?0:m}function uH(e,t,n,r){return(e-n)*(e-n)+(t-r)*(t-r)}function dH(e,t,n,r,i){return uH(e,t,n,r)<i*i}function fH(e){if(!Number.isFinite(e))return e=>e;if(e===0)return Math.round;let t=10**e;return e=>Math.round(e*t)/t}function pH(e){let t=Math.min(e.x1,e.x2),n=Math.max(e.x1,e.x2),r=Math.min(e.y1,e.y2),i=Math.max(e.y1,e.y2);return{x:t,y:r,x2:n,y2:i,width:n-t,height:i-r}}var mH=class e{constructor(e,t,n,r){this.x1=e,this.y1=t,this.x2=n,this.y2=r}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}draw(e){e.moveTo(this.x1,this.y1),e.lineTo(this.x2,this.y2)}toString(){return`Line(from=(${this.x1},${this.y1}),to=(${this.x2},${this.y2}))`}static from(t){return new e(t.x1,t.y1,t.x2,t.y2)}cuts(e,t){if(this.y1===this.y2||t<this.y1&&t<=this.y2||t>this.y1&&t>=this.y2||e>this.x1&&e>=this.x2)return!1;if(e<this.x1&&e<=this.x2)return!0;let n=this.x1+(t-this.y1)*(this.x2-this.x1)/(this.y2-this.y1);return e<=n}distSquare(e,t){return lH(this.x1,this.y1,this.x2,this.y2,e,t)}ptClose(e,t,n){if(this.x1<this.x2){if(e<this.x1-n||e>this.x2+n)return!1}else if(e<this.x2-n||e>this.x1+n)return!1;if(this.y1<this.y2){if(t<this.y1-n||t>this.y2+n)return!1}else if(t<this.y2-n||t>this.y1+n)return!1;return!0}},hH;(function(e){e[e.POINT=1]=`POINT`,e[e.PARALLEL=2]=`PARALLEL`,e[e.COINCIDENT=3]=`COINCIDENT`,e[e.NONE=4]=`NONE`})(hH||={});var gH=class{constructor(e,t=0,n=0){this.state=e,this.x=t,this.y=n}};function _H(e,t){let n=(t.x2-t.x1)*(e.y1-t.y1)-(t.y2-t.y1)*(e.x1-t.x1),r=(e.x2-e.x1)*(e.y1-t.y1)-(e.y2-e.y1)*(e.x1-t.x1),i=(t.y2-t.y1)*(e.x2-e.x1)-(t.x2-t.x1)*(e.y2-e.y1);if(i){let t=n/i,a=r/i;return 0<=t&&t<=1&&0<=a&&a<=1?new gH(hH.POINT,e.x1+t*(e.x2-e.x1),e.y1+t*(e.y2-e.y1)):new gH(hH.NONE)}return new gH(n===0||r===0?hH.COINCIDENT:hH.PARALLEL)}function vH(e,t){let n=(t.x2-t.x1)*(e.y1-t.y1)-(t.y2-t.y1)*(e.x1-t.x1),r=(e.x2-e.x1)*(e.y1-t.y1)-(e.y2-e.y1)*(e.x1-t.x1),i=(t.y2-t.y1)*(e.x2-e.x1)-(t.x2-t.x1)*(e.y2-e.y1);if(i){let e=n/i,t=r/i;if(0<=e&&e<=1&&0<=t&&t<=1)return e}return 1/0}function yH(e,t){function n(e,n,r,i){let a=vH(t,new mH(e,n,r,i));return a=Math.abs(a-.5),a>=0&&a<=1?1:0}let r=n(e.x,e.y,e.x2,e.y);return r+=n(e.x,e.y,e.x,e.y2),r>1||(r+=n(e.x,e.y2,e.x2,e.y2),r>1)?!0:(r+=n(e.x2,e.y,e.x2,e.y2),r>0)}var bH;(function(e){e[e.LEFT=0]=`LEFT`,e[e.TOP=1]=`TOP`,e[e.RIGHT=2]=`RIGHT`,e[e.BOTTOM=3]=`BOTTOM`})(bH||={});function xH(e,t,n){let r=new Set;return e.width<=0?(r.add(bH.LEFT),r.add(bH.RIGHT)):t<e.x?r.add(bH.LEFT):t>e.x+e.width&&r.add(bH.RIGHT),e.height<=0?(r.add(bH.TOP),r.add(bH.BOTTOM)):n<e.y?r.add(bH.TOP):n>e.y+e.height&&r.add(bH.BOTTOM),r}function SH(e,t){let n=t.x1,r=t.y1,i=t.x2,a=t.y2,o=Array.from(xH(e,i,a));if(o.length===0)return!0;let s=xH(e,n,r);for(;s.size!==0;){for(let e of o)if(s.has(e))return!1;if(s.has(bH.RIGHT)||s.has(bH.LEFT)){let t=e.x;s.has(bH.RIGHT)&&(t+=e.width),r+=(t-n)*(a-r)/(i-n),n=t}else{let t=e.y;s.has(bH.BOTTOM)&&(t+=e.height),n+=(t-r)*(i-n)/(a-r),r=t}s=xH(e,n,r)}return!0}function CH(e,t){let n=1/0,r=0;function i(e,i,a,o){let s=vH(t,new mH(e,i,a,o));s=Math.abs(s-.5),s>=0&&s<=1&&(r++,s<n&&(n=s))}return i(e.x,e.y,e.x2,e.y),i(e.x,e.y,e.x,e.y2),r>1||(i(e.x,e.y2,e.x2,e.y2),r>1)?n:(i(e.x2,e.y,e.x2,e.y2),r===0?-1:n)}function wH(e,t){let n=0,r=_H(e,new mH(t.x,t.y,t.x2,t.y));n+=r.state===hH.POINT?1:0;let i=_H(e,new mH(t.x,t.y,t.x,t.y2));n+=i.state===hH.POINT?1:0;let a=_H(e,new mH(t.x,t.y2,t.x2,t.y2));n+=a.state===hH.POINT?1:0;let o=_H(e,new mH(t.x2,t.y,t.x2,t.y2));return n+=o.state===hH.POINT?1:0,{top:r,left:i,bottom:a,right:o,count:n}}var TH=class e{constructor(e,t,n,r){this.x=e,this.y=t,this.width=n,this.height=r}get x2(){return this.x+this.width}get y2(){return this.y+this.height}get cx(){return this.x+this.width/2}get cy(){return this.y+this.height/2}get radius(){return Math.max(this.width,this.height)/2}static from(t){return new e(t.x,t.y,t.width,t.height)}equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height}clone(){return new e(this.x,this.y,this.width,this.height)}add(e){let t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x2,e.x+e.width),i=Math.max(this.y2,e.y+e.height);this.x=t,this.y=n,this.width=r-t,this.height=i-n}addPoint(e){let t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x2,e.x),i=Math.max(this.y2,e.y);this.x=t,this.y=n,this.width=r-t,this.height=i-n}toString(){return`Rectangle[x=${this.x}, y=${this.y}, w=${this.width}, h=${this.height}]`}draw(e){e.rect(this.x,this.y,this.width,this.height)}containsPt(e,t){return e>=this.x&&e<=this.x2&&t>=this.y&&t<=this.y2}get area(){return this.width*this.height}intersects(e){return this.area<=0||e.width<=0||e.height<=0?!1:e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x2&&e.y<this.y2}distSquare(e,t){if(this.containsPt(e,t))return 0;let n=xH(this,e,t);return n.has(bH.TOP)?n.has(bH.LEFT)?uH(e,t,this.x,this.y):n.has(bH.RIGHT)?uH(e,t,this.x2,this.y):(this.y-t)*(this.y-t):n.has(bH.BOTTOM)?n.has(bH.LEFT)?uH(e,t,this.x,this.y2):n.has(bH.RIGHT)?uH(e,t,this.x2,this.y2):(t-this.y2)*(t-this.y2):n.has(bH.LEFT)?(this.x-e)*(this.x-e):n.has(bH.RIGHT)?(e-this.x2)*(e-this.x2):0}};function EH(e){if(e.length===0)return null;let t=e[0],n=new TH(t.x,t.y,0,0);for(let t of e)n.addPoint(t);return n}var DH=class e{constructor(e,t,n){this.cx=e,this.cy=t,this.radius=n}get x(){return this.cx-this.radius}get x2(){return this.cx+this.radius}get width(){return this.radius*2}get y(){return this.cy-this.radius}get y2(){return this.cy+this.radius}get height(){return this.radius*2}static from(t){return new e(t.cx,t.cy,t.radius)}containsPt(e,t){return uH(this.cx,this.cy,e,t)<this.radius*this.radius}distSquare(e,t){let n=uH(this.cx,this.cy,e,t);if(n<this.radius*this.radius)return 0;let r=Math.sqrt(n)-this.radius;return r*r}draw(e){e.ellipse(this.cx,this.cy,this.radius,this.radius,0,0,Math.PI*2)}},OH=class e{constructor(e,t=0,n=0,r=0,i=0,a=10,o=10,s=new Float32Array(Math.max(0,a*o)).fill(0)){this.pixelGroup=e,this.i=t,this.j=n,this.pixelX=r,this.pixelY=i,this.width=a,this.height=o,this.area=s}createSub(t,n){return new e(this.pixelGroup,t.x,t.y,n.x,n.y,t.width,t.height)}static fromPixelRegion(t,n){return new e(n,0,0,t.x,t.y,Math.ceil(t.width/n),Math.ceil(t.height/n))}copy(t,n){return new e(this.pixelGroup,this.scaleX(n.x),this.scaleY(n.y),n.x,n.y,t.width,t.height,t.area)}boundX(e){return e<this.i?this.i:e>=this.width?this.width-1:e}boundY(e){return e<this.j?this.j:e>=this.height?this.height-1:e}scaleX(e){return this.boundX(Math.floor((e-this.pixelX)/this.pixelGroup))}scaleY(e){return this.boundY(Math.floor((e-this.pixelY)/this.pixelGroup))}scale(e){let t=this.scaleX(e.x),n=this.scaleY(e.y),r=this.boundX(Math.ceil((e.x+e.width-this.pixelX)/this.pixelGroup)),i=this.boundY(Math.ceil((e.y+e.height-this.pixelY)/this.pixelGroup)),a=r-t,o=i-n;return new TH(t,n,a,o)}invertScaleX(e){return Math.round(e*this.pixelGroup+this.pixelX)}invertScaleY(e){return Math.round(e*this.pixelGroup+this.pixelY)}addPadding(e,t){let n=Math.ceil(t/this.pixelGroup),r=this.boundX(e.x-n),i=this.boundY(e.y-n),a=this.boundX(e.x2+n),o=this.boundY(e.y2+n),s=a-r,c=o-i;return new TH(r,i,s,c)}get(e,t){return e<0||t<0||e>=this.width||t>=this.height?NaN:this.area[e+t*this.width]}inc(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]+=n)}set(e,t,n){e<0||t<0||e>=this.width||t>=this.height||(this.area[e+t*this.width]=n)}incArea(e,t){if(e.width<=0||e.height<=0||t===0)return;let n=this.width,r=e.width,i=Math.max(0,e.i),a=Math.max(0,e.j),o=Math.min(e.i+e.width,n),s=Math.min(e.j+e.height,this.height);if(!(s<=0||o<=0||i>=n||s>=this.height))for(let c=a;c<s;c++){let a=(c-e.j)*r,s=c*n;for(let n=i;n<o;n++){let r=e.area[n-e.i+a];r!==0&&(this.area[n+s]+=t*r)}}}fill(e){this.area.fill(e)}fillArea(e,t){let n=e.x+e.y*this.width;for(let r=0;r<e.height;r++){let i=n+r*this.width;this.area.fill(t,i,i+e.width)}}fillHorizontalLine(e,t,n,r){let i=e+t*this.width;this.area.fill(r,i,i+n)}fillVerticalLine(e,t,n,r){let i=e+t*this.width;for(let e=0;e<n;e++)this.area[i+e*this.width]=r}clear(){this.area.fill(0)}toString(){let e=``;for(let t=0;t<this.height;t++){let n=t*this.width;for(let t=0;t<this.width;t++){let r=this.area[n+t];e+=r.toFixed(1).padStart(6),e+=` `}e+=`
`}return e}draw(e,t=!0){if(this.width<=0||this.height<=0)return;e.save(),t&&e.translate(this.pixelX,this.pixelY);let n=this.area.reduce((e,t)=>Math.min(e,t),1/0),r=this.area.reduce((e,t)=>Math.max(e,t),-1/0),i=e=>(e-n)/(r-n);e.scale(this.pixelGroup,this.pixelGroup);for(let t=0;t<this.width;t++)for(let n=0;n<this.height;n++){let r=this.area[t+n*this.width];e.fillStyle=`rgba(0, 0, 0, ${i(r)})`,e.fillRect(t,n,1,1)}e.restore()}drawThreshold(e,t,n=!0){if(!(this.width<=0||this.height<=0)){e.save(),n&&e.translate(this.pixelX,this.pixelY),e.scale(this.pixelGroup,this.pixelGroup);for(let n=0;n<this.width;n++)for(let r=0;r<this.height;r++)e.fillStyle=this.area[n+r*this.width]>t?`black`:`white`,e.fillRect(n,r,1,1);e.restore()}}};function kH(e,t){let n=e=>({x:e.x-t,y:e.y-t,width:e.width+2*t,height:e.height+2*t});return Array.isArray(e)?e.map(n):n(e)}function AH(e,t,n){return jH(Object.assign(pH(e),{distSquare:(t,n)=>lH(e.x1,e.y1,e.x2,e.y2,t,n)}),t,n)}function jH(e,t,n){let r=kH(e,n),i=t.scale(r),a=t.createSub(i,r);return MH(a,t,n,(t,n)=>e.distSquare(t,n)),a}function MH(e,t,n,r){let i=n*n;for(let a=0;a<e.height;a++)for(let o=0;o<e.width;o++){let s=t.invertScaleX(e.i+o),c=t.invertScaleY(e.j+a),l=r(s,c);if(l===0){e.set(o,a,i);continue}if(l<i){let t=n-Math.sqrt(l);e.set(o,a,t*t)}}return e}function NH(e,t,n){let r=t.scale(e),i=t.addPadding(r,n),a=t.createSub(i,{x:e.x-n,y:e.y-n}),o=r.x-i.x,s=r.y-i.y,c=i.x2-r.x2,l=i.y2-r.y2,u=i.width-o-c,d=i.height-s-l,f=n*n;a.fillArea({x:o,y:s,width:u+1,height:d+1},f);let p=[0],m=Math.max(s,o,c,l);{let i=t.invertScaleX(r.x+r.width/2);for(let a=1;a<m;a++){let o=t.invertScaleY(r.y-a),s=e.distSquare(i,o);if(s<f){let e=n-Math.sqrt(s);p.push(e*e)}else break}}let h=[],g=Math.max(o,c),_=Math.max(s,c);for(let i=1;i<g;i++){let a=t.invertScaleX(r.x-i),o=[];for(let i=1;i<_;i++){let s=t.invertScaleY(r.y-i),c=e.distSquare(a,s);if(c<f){let e=n-Math.sqrt(c);o.push(e*e)}else o.push(0)}h.push(o)}for(let e=1;e<Math.min(s,p.length);e++){let t=p[e];a.fillHorizontalLine(o,s-e,u+1,t)}for(let e=1;e<Math.min(l,p.length);e++){let t=p[e];a.fillHorizontalLine(o,s+d+e,u+1,t)}for(let e=1;e<Math.min(o,p.length);e++){let t=p[e];a.fillVerticalLine(o-e,s,d+1,t)}for(let e=1;e<Math.min(l,p.length);e++){let t=p[e];a.fillVerticalLine(o+u+e,s,d+1,t)}for(let e=1;e<o;e++){let t=h[e-1],n=o-e;for(let e=1;e<s;e++)a.set(n,s-e,t[e-1]);for(let e=1;e<l;e++)a.set(n,s+d+e,t[e-1])}for(let e=1;e<c;e++){let t=h[e-1],n=o+u+e;for(let e=1;e<s;e++)a.set(n,s-e,t[e-1]);for(let e=1;e<l;e++)a.set(n,s+d+e,t[e-1])}return a}function PH(e,t){return{x:e,y:t}}function FH(e,t,n,r){if(e.length===0)return[];let i=BH(e);return i.map((e,a)=>{let o=i.slice(0,a);return IH(t,e,o,n,r)}).flat()}function IH(e,t,n,r,i){let a=PH(t.cx,t.cy),o=zH(a,n,e);if(o==null)return[];let s=new mH(a.x,a.y,o.cx,o.cy),c=LH(s,e,r,i);return RH(c,e)}function LH(e,t,n,r){let i=[],a=[];a.push(e);let o=!0;for(let e=0;e<n&&o;e++)for(o=!1;!o&&a.length>0;){let e=a.pop(),n=UH(t,e),s=n?wH(e,n):null;if(!n||!s||s.count!==2){o||i.push(e);continue}let c=r,l=GH(n,c,s,!0),u=HH(l,a)||HH(l,i),d=VH(l,t);for(;!u&&d&&c>=1;)c/=1.5,l=GH(n,c,s,!0),u=HH(l,a)||HH(l,i),d=VH(l,t);if(l&&!u&&!d&&(a.push(new mH(e.x1,e.y1,l.x,l.y)),a.push(new mH(l.x,l.y,e.x2,e.y2)),o=!0),o)continue;c=r,l=GH(n,c,s,!1);let f=HH(l,a)||HH(l,i);for(d=VH(l,t);!f&&d&&c>=1;)c/=1.5,l=GH(n,c,s,!1),f=HH(l,a)||HH(l,i),d=VH(l,t);l&&!f&&(a.push(new mH(e.x1,e.y1,l.x,l.y)),a.push(new mH(l.x,l.y,e.x2,e.y2)),o=!0),o||i.push(e)}for(;a.length>0;)i.push(a.pop());return i}function RH(e,t){let n=[];for(;e.length>0;){let r=e.pop();if(e.length===0){n.push(r);break}let i=e.pop(),a=new mH(r.x1,r.y1,i.x2,i.y2);UH(t,a)?(n.push(r),e.push(i)):e.push(a)}return n}function zH(e,t,n){let r=1/0;return t.reduce((t,i)=>{let a=uH(e.x,e.y,i.cx,i.cy);if(a>r)return t;let o=new mH(e.x,e.y,i.cx,i.cy),s=WH(n,o);return a*(s+1)*(s+1)<r&&(t=i,r=a*(s+1)*(s+1)),t},null)}function BH(e){if(e.length<2)return e;let t=0,n=0;return e.forEach(e=>{t+=e.cx,n+=e.cy}),t/=e.length,n/=e.length,e.map(e=>{let r=t-e.cx,i=n-e.cy,a=r*r+i*i;return[e,a]}).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function VH(e,t){return t.some(t=>t.containsPt(e.x,e.y))}function HH(e,t){return t.some(t=>!!(dH(t.x1,t.y1,e.x,e.y,.001)||dH(t.x2,t.y2,e.x,e.y,.001)))}function UH(e,t){let n=1/0,r=null;for(let i of e){if(!SH(i,t))continue;let e=CH(i,t);e>=0&&e<n&&(r=i,n=e)}return r}function WH(e,t){return e.reduce((e,n)=>SH(n,t)&&yH(n,t)?e+1:e,0)}function GH(e,t,n,r){let i=n.top,a=n.left,o=n.bottom,s=n.right;if(r){if(a.state===hH.POINT){if(i.state===hH.POINT)return PH(e.x-t,e.y-t);if(o.state===hH.POINT)return PH(e.x-t,e.y2+t);let n=e.width*e.height;return e.width*((a.y-e.y+(s.y-e.y))*.5)<n*.5?a.y>s.y?PH(e.x-t,e.y-t):PH(e.x2+t,e.y-t):a.y<s.y?PH(e.x-t,e.y2+t):PH(e.x2+t,e.y2+t)}if(s.state===hH.POINT){if(i.state===hH.POINT)return PH(e.x2+t,e.y-t);if(o.state===hH.POINT)return PH(e.x2+t,e.y2+t)}let n=e.height*e.width;return e.height*((i.x-e.x+(s.x-e.x))*.5)<n*.5?i.x>o.x?PH(e.x-t,e.y-t):PH(e.x-t,e.y2+t):i.x<o.x?PH(e.x2+t,e.y-t):PH(e.x2+t,e.y2+t)}if(a.state===hH.POINT){if(i.state===hH.POINT)return PH(e.x2+t,e.y2+t);if(o.state===hH.POINT)return PH(e.x2+t,e.y-t);let n=e.height*e.width;return e.width*((a.y-e.y+(s.y-e.y))*.5)<n*.5?a.y>s.y?PH(e.x2+t,e.y2+t):PH(e.x-t,e.y2+t):a.y<s.y?PH(e.x2+t,e.y-t):PH(e.x-t,e.y-t)}if(s.state===hH.POINT){if(i.state===hH.POINT)return PH(e.x-t,e.y2+t);if(o.state===hH.POINT)return PH(e.x-t,e.y-t)}let c=e.height*e.width;return e.height*((i.x-e.x+(s.x-e.x))*.5)<c*.5?i.x>o.x?PH(e.x2+t,e.y2+t):PH(e.x2+t,e.y-t):i.x<o.x?PH(e.x-t,e.y2+t):PH(e.x-t,e.y-t)}function KH(e,t,n,r){if(!(e.closed?n<e.length:n<e.length-1))return!1;let i=e.get(t),a=e.get(n+1);for(let o=t+1;o<=n;o++){let t=e.get(o);if(lH(i.x,i.y,a.x,a.y,t.x,t.y)>r)return!1}return!0}function qH(e=0){return t=>{if(e<0||t.length<3)return t;let n=[],r=0,i=e*e;for(;r<t.length;){let e=r+1;for(;KH(t,r,e,i);)e++;n.push(t.get(r)),r=e}return new ZH(n)}}function JH(e,t){switch(e){case-2:return(((-t+3)*t-3)*t+1)/6;case-1:return((3*t-6)*t*t+4)/6;case 0:return(((-3*t+3)*t+3)*t+1)/6;case 1:return t*t*t/6;default:throw Error(`unknown error`)}}function YH(e=6){function t(e,t,n){let r=0,i=0;for(let a=-2;a<=1;a++){let o=e.get(t+a),s=JH(a,n);r+=s*o.x,i+=s*o.y}return{x:r,y:i}}return n=>{if(n.length<3)return n;let r=[],i=n.closed,a=n.length+3-1+(i?0:2);r.push(t(n,2-(i?0:2),0));for(let o=2-(i?0:2);o<a;o++)for(let i=1;i<=e;i++)r.push(t(n,o,i/e));return new ZH(r)}}function XH(e=8){return t=>{let n=e,r=t.length;if(n>1)for(r=Math.floor(t.length/n);r<3&&n>1;)--n,r=Math.floor(t.length/n);let i=[];for(let e=0,a=0;a<r;a++,e+=n)i.push(t.get(e));return new ZH(i)}}var ZH=class{constructor(e=[],t=!0){this.points=e,this.closed=t}get(e){let t=e,n=this.points.length;return e<0?this.closed?this.get(e+n):this.points[0]:e>=n?this.closed?this.get(e-n):this.points[n-1]:this.points[t]}get length(){return this.points.length}toString(e=1/0){let t=this.points;if(t.length===0)return``;let n=typeof e==`function`?e:fH(e),r=`M`;for(let e of t)r+=`${n(e.x)},${n(e.y)} L`;return r=r.slice(0,-1),this.closed&&(r+=` Z`),r}draw(e){let t=this.points;if(t.length!==0){e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let n of t)e.lineTo(n.x,n.y);this.closed&&e.closePath()}}sample(e){return XH(e)(this)}simplify(e){return qH(e)(this)}bSplines(e){return YH(e)(this)}apply(e){return e(this)}containsElements(e){let t=EH(this.points);return t?e.every(e=>t.containsPt(e.cx,e.cy)&&this.withinArea(e.cx,e.cy)):!1}withinArea(e,t){if(this.length===0)return!1;let n=0,r=this.points[0],i=new mH(r.x,r.y,r.x,r.y);for(let r=1;r<this.points.length;r++){let a=this.points[r];i.x1=i.x2,i.y1=i.y2,i.x2=a.x,i.y2=a.y,i.cuts(e,t)&&n++}return i.x1=i.x2,i.y1=i.y2,i.x2=r.x,i.y2=r.y,i.cuts(e,t)&&n++,n%2==1}},QH=class{constructor(e=0){this.count=0,this.arr=[],this.set=new Set,this.arr.length=e}add(e){this.set.add(`${e.x}x${e.y}`),this.arr[this.count++]=e}contains(e){return this.set.has(`${e.x}x${e.y}`)}isFirst(e){if(this.count===0)return!1;let t=this.arr[0];return t!=null&&t.x===e.x&&t.y===e.y}path(){return new ZH(this.arr.slice(0,this.count))}clear(){this.set.clear(),this.count=0}get(e){return this.arr[e]}get length(){return this.count}},$H=0,eU=1,tU=2,nU=3;function rU(e,t){let n=(Math.floor(e.width)+Math.floor(e.height))*2,r=new QH(n);function i(n,r,i,a){let o=e.get(n,r);return Number.isNaN(o)?NaN:o>t?i+a:i}function a(e,t){let n=$H;return n=i(e,t,n,1),n=i(e+1,t,n,2),n=i(e,t+1,n,4),n=i(e+1,t+1,n,8),Number.isNaN(n)?-1:n}let o=eU;function s(t,n){let i=t,s=n,c=e.invertScaleX(i),l=e.invertScaleY(s);for(let t=0;t<e.width*e.height;t++){let t={x:c,y:l};if(r.contains(t)){if(r.isFirst(t))return!0}else r.add(t);let n=a(i,s);switch(n){case-1:return!0;case 0:case 3:case 2:case 7:o=tU;break;case 12:case 14:case 4:o=nU;break;case 6:o=o===$H?nU:tU;break;case 1:case 13:case 5:o=$H;break;case 9:o=o===tU?$H:eU;break;case 10:case 8:case 11:o=eU;break;default:return console.warn(`Marching squares invalid state: `+n),!0}switch(o){case $H:s--,l-=e.pixelGroup;break;case eU:s++,l+=e.pixelGroup;break;case nU:i--,c-=e.pixelGroup;break;case tU:i++,c+=e.pixelGroup;break;default:return console.warn(`Marching squares invalid state: `+n),!0}}return!0}for(let n=0;n<e.width;n++)for(let i=0;i<e.height;i++){if(e.get(n,i)<=t)continue;let o=a(n,i);if(!(o<0||o===15)&&s(n,i))return r.path()}return null}var iU={maxRoutingIterations:100,maxMarchingIterations:20,pixelGroup:4,edgeR0:10,edgeR1:20,nodeR0:15,nodeR1:50,morphBuffer:10,threshold:1,memberInfluenceFactor:1,edgeInfluenceFactor:1,nonMemberInfluenceFactor:-.8,virtualEdges:!0};function aU(e){return e!=null&&typeof e.radius==`number`}function oU(e,t){if(aU(e)!==aU(t))return!1;if(aU(e)){let n=t;return e.cx===n.cx&&e.cy===n.cy&&e.radius===n.radius}let n=t;return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}var sU;(function(e){e[e.MEMBERS=0]=`MEMBERS`,e[e.NON_MEMBERS=1]=`NON_MEMBERS`,e[e.EDGES=2]=`EDGES`})(sU||={});var cU=class{constructor(e={}){this.dirty=new Set,this.members=[],this.nonMembers=[],this.virtualEdges=[],this.edges=[],this.activeRegion=new TH(0,0,0,0),this.potentialArea=new OH(1,0,0,0,0,0,0),this.o=Object.assign({},iU,e)}pushMember(...e){if(e.length!==0){this.dirty.add(sU.MEMBERS);for(let t of e)this.members.push({raw:t,obj:aU(t)?DH.from(t):TH.from(t),area:null})}}removeMember(e){let t=this.members.findIndex(t=>oU(t.raw,e));return t<0?!1:(this.members.splice(t,1),this.dirty.add(sU.MEMBERS),!0)}removeNonMember(e){let t=this.nonMembers.findIndex(t=>oU(t.raw,e));return t<0?!1:(this.nonMembers.splice(t,1),this.dirty.add(sU.NON_MEMBERS),!0)}removeEdge(e){let t=this.edges.findIndex(t=>t.obj.equals(e));return t<0?!1:(this.edges.splice(t,1),this.dirty.add(sU.NON_MEMBERS),!0)}pushNonMember(...e){if(e.length!==0){this.dirty.add(sU.NON_MEMBERS);for(let t of e)this.nonMembers.push({raw:t,obj:aU(t)?DH.from(t):TH.from(t),area:null})}}pushEdge(...e){if(e.length!==0){this.dirty.add(sU.EDGES);for(let t of e)this.edges.push({raw:t,obj:mH.from(t),area:null})}}update(){let e=this.dirty.has(sU.MEMBERS),t=this.dirty.has(sU.NON_MEMBERS),n=this.dirty.has(sU.EDGES);this.dirty.clear();let r=this.members.map(e=>e.obj);if(this.o.virtualEdges&&(e||t)){let e=this.nonMembers.map(e=>e.obj),t=FH(r,e,this.o.maxRoutingIterations,this.o.morphBuffer),i=new Map(this.virtualEdges.map(e=>[e.obj.toString(),e.area]));this.virtualEdges=t.map(e=>({raw:e,obj:e,area:i.get(e.toString())??null})),n=!0}let i=!1;if(e||n){let e=this.virtualEdges.concat(this.edges).map(e=>e.obj),t=uU(r,e),n=Math.max(this.o.edgeR1,this.o.nodeR1)+this.o.morphBuffer,a=TH.from(kH(t,n));a.equals(this.activeRegion)||(i=!0,this.activeRegion=a)}if(i){let e=Math.ceil(this.activeRegion.width/this.o.pixelGroup),t=Math.ceil(this.activeRegion.height/this.o.pixelGroup);this.activeRegion.x!==this.potentialArea.pixelX||this.activeRegion.y!==this.potentialArea.pixelY?(this.potentialArea=OH.fromPixelRegion(this.activeRegion,this.o.pixelGroup),this.members.forEach(e=>e.area=null),this.nonMembers.forEach(e=>e.area=null),this.edges.forEach(e=>e.area=null),this.virtualEdges.forEach(e=>e.area=null)):(e!==this.potentialArea.width||t!==this.potentialArea.height)&&(this.potentialArea=OH.fromPixelRegion(this.activeRegion,this.o.pixelGroup))}let a=new Map,o=e=>{if(e.area){let t=`${e.obj.width}x${e.obj.height}x${e.obj instanceof TH?`R`:`C`}`;a.set(t,e.area)}},s=e=>{if(e.area)return;let t=`${e.obj.width}x${e.obj.height}x${e.obj instanceof TH?`R`:`C`}`;if(a.has(t)){let n=a.get(t);e.area=this.potentialArea.copy(n,{x:e.obj.x-this.o.nodeR1,y:e.obj.y-this.o.nodeR1});return}let n=e.obj instanceof TH?NH(e.obj,this.potentialArea,this.o.nodeR1):jH(e.obj,this.potentialArea,this.o.nodeR1);e.area=n,a.set(t,n)};this.members.forEach(o),this.nonMembers.forEach(o),this.members.forEach(s),this.nonMembers.forEach(e=>{this.activeRegion.intersects(e.obj)?s(e):e.area=null}),this.edges.forEach(e=>{e.area||=AH(e.obj,this.potentialArea,this.o.edgeR1)}),this.virtualEdges.forEach(e=>{e.area||=AH(e.obj,this.potentialArea,this.o.edgeR1)})}drawMembers(e){for(let t of this.members)t.obj.draw(e)}drawNonMembers(e){for(let t of this.nonMembers)t.obj.draw(e)}drawEdges(e){for(let t of this.edges)t.obj.draw(e)}drawPotentialArea(e,t=!0){this.potentialArea.draw(e,t)}compute(){if(this.members.length===0)return new ZH([]);this.dirty.size>0&&this.update();let{o:e,potentialArea:t}=this,n=this.members.map(e=>e.area),r=this.virtualEdges.concat(this.edges).map(e=>e.area),i=this.nonMembers.filter(e=>e.area!=null).map(e=>e.area),a=this.members.map(e=>e.obj);return lU(t,n,r,i,e=>e.containsElements(a),e)}};function lU(e,t,n,r,i,a={}){let o=Object.assign({},iU,a),s=o.threshold,c=o.memberInfluenceFactor,l=o.edgeInfluenceFactor,u=o.nonMemberInfluenceFactor,d=(o.nodeR0-o.nodeR1)*(o.nodeR0-o.nodeR1),f=(o.edgeR0-o.edgeR1)*(o.edgeR0-o.edgeR1);for(let a=0;a<o.maxMarchingIterations;a++){if(e.clear(),c!==0){let n=c/d;for(let r of t)e.incArea(r,n)}if(l!==0){let t=l/f;for(let r of n)e.incArea(r,t)}if(u!==0){let t=u/d;for(let n of r)e.incArea(n,t)}let p=rU(e,s);if(p&&i(p))return p;if(s*=.95,a<=o.maxMarchingIterations*.5)c*=1.2,l*=1.2;else if(u!==0&&r.length>0)u*=.8;else break}return new ZH([])}function uU(e,t){if(e.length===0)return new TH(0,0,0,0);let n=TH.from(e[0]);for(let t of e)n.add(t);for(let e of t)n.add(pH(e));return n}var dU=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},fU=class e extends iH{constructor(t,n){super(t,Bu({},e.defaultOptions,n)),this.members=new Map,this.avoidMembers=new Map,this.bubbleSetOptions={},this.drawBubbleSets=()=>{let{style:e,bubbleSetOptions:t}=this.parseOptions();Gu(this.bubbleSetOptions,t)||this.init(),this.bubbleSetOptions=Object.assign({},t);let n=Object.assign(Object.assign({},e),{d:this.getPath()});this.shape?this.shape.update(n):(this.shape=new xT({style:n}),this.context.canvas.appendChild(this.shape))},this.updateBubbleSetsPath=e=>{if(!this.shape)return;let t=Q(e.data);[...this.options.members,...this.options.avoidMembers].includes(t)&&this.shape.update(Object.assign(Object.assign({},this.parseOptions().style),{d:this.getPath(t)}))},this.getPath=e=>{let{graph:t}=this.context,n=this.options.members,r=[...this.members.keys()],i=this.options.avoidMembers,a=[...this.avoidMembers.keys()];if(!e&&Gu(n,r)&&Gu(i,a))return this.path;let{enter:o=[],exit:s=[]}=MC(r,n,e=>e),{enter:c=[],exit:l=[]}=MC(a,i,e=>e);e&&(s.push(e),o.push(e));let u=(e,n,r)=>{e.forEach(e=>{let i=r?this.members:this.avoidMembers,a=r?`pushMember`:`pushNonMember`,o=r?`removeMember`:`removeNonMember`;if(n){let n;t.getElementType(e)===`edge`?([n]=mU(t,e),this.bubbleSets.pushEdge(n)):([n]=pU(t,e),this.bubbleSets[a](n)),i.set(e,n)}else{let n=i.get(e);n&&(t.getElementType(e)===`edge`?this.bubbleSets.removeEdge(n):this.bubbleSets[o](n),i.delete(e))}})};u(s,!1,!0),u(o,!0,!0),u(l,!1,!1),u(c,!0,!1);let d=this.bubbleSets.compute().sample(8).simplify(0).bSplines().simplify(0);return this.path=vT(d.points.map(lw)),this.path},this.bindEvents(),this.bubbleSets=new cU(this.options)}bindEvents(){this.context.graph.on(Z.AFTER_RENDER,this.drawBubbleSets),this.context.graph.on(Z.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath)}init(){this.bubbleSets=new cU(this.options),this.members=new Map,this.avoidMembers=new Map}parseOptions(){let e=this.options,{type:t,key:n,members:r,avoidMembers:i}=e,a=dU(e,[`type`,`key`,`members`,`avoidMembers`]),o=Object.keys(a).reduce((e,t)=>(t in iU?e.bubbleSetOptions[t]=a[t]:e.style[t]=a[t],e),{style:{},bubbleSetOptions:{}});return Object.assign({type:t,key:n,members:r,avoidMembers:i},o)}addMember(e){let t=Array.isArray(e)?e:[e];t.some(e=>this.options.avoidMembers.includes(e))&&(this.options.avoidMembers=this.options.avoidMembers.filter(e=>!t.includes(e))),this.options.members=[...new Set([...this.options.members,...t])],this.drawBubbleSets()}removeMember(e){let t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(e=>!t.includes(e)),this.drawBubbleSets()}updateMember(e){this.options.members=W(e)?e(this.options.members):e,this.drawBubbleSets()}getMember(){return this.options.members}addAvoidMember(e){let t=Array.isArray(e)?e:[e];t.some(e=>this.options.members.includes(e))&&(this.options.members=this.options.members.filter(e=>!t.includes(e))),this.options.avoidMembers=[...new Set([...this.options.avoidMembers,...t])],this.drawBubbleSets()}removeAvoidMember(e){let t=Array.isArray(e)?e:[e];this.options.avoidMembers.some(e=>t.includes(e))&&(this.options.avoidMembers=this.options.avoidMembers.filter(e=>!t.includes(e)),this.drawBubbleSets())}updateAvoidMember(e){this.options.avoidMembers=Array.isArray(e)?e:[e],this.drawBubbleSets()}getAvoidMember(){return this.options.avoidMembers}destroy(){this.context.graph.off(Z.AFTER_RENDER,this.drawBubbleSets),this.context.graph.off(Z.AFTER_ELEMENT_UPDATE,this.updateBubbleSetsPath),this.shape.destroy(),super.destroy()}};fU.defaultOptions=Object.assign({members:[],avoidMembers:[],fill:`lightblue`,fillOpacity:.2,stroke:`blue`,strokeOpacity:.2},iU);var pU=(e,t)=>(Array.isArray(t)?t:[t]).map(t=>{let n=e.getElementRenderBounds(t);return new TH(n.min[0],n.min[1],TS(n),ES(n))}),mU=(e,t)=>(Array.isArray(t)?t:[t]).map(t=>{let n=e.getEdgeData(t),r=e.getElementPosition(n.source),i=e.getElementPosition(n.target);return mH.from({x1:r[0],y1:r[1],x2:i[0],y2:i[1]})});function hU(e){return`
    <ul class="g6-contextmenu-ul">
      ${e.map(e=>`<li  class="g6-contextmenu-li" value="${e.value}">${e.name}</li>`).join(``)}
    </ul>
  `}var gU=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},_U=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.targetElement=null,this.onTriggerEvent=e=>{var t;(t=e.preventDefault)==null||t.call(e),this.show(e)},this.onMenuItemClick=e=>{let{onClick:t,trigger:n}=this.options;if(e.target instanceof HTMLElement&&e.target.className.includes(`g6-contextmenu-li`)){let n=e.target.getAttribute(`value`);t?.(n,e.target,this.targetElement),this.hide()}n!==`click`&&this.hide()},this.initElement(),this.update(n)}initElement(){this.$element=aH(`contextmenu`,!1,{zIndex:`99`});let{className:e}=this.options;e&&this.$element.classList.add(e),this.context.canvas.getContainer().appendChild(this.$element),oH(`g6-contextmenu-css`,`style`,{},`
  .g6-contextmenu {
    font-size: 12px;
    background-color: rgba(255, 255, 255, 0.96);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: rgba(0, 0, 0, 0.12) 0px 6px 12px 0px;
    transition: visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1) 0s, left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s;
  }

  .g6-contextmenu-ul {
    max-width: 256px;
    min-width: 96px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .g6-contextmenu-li {
    padding: 8px 12px;
    cursor: pointer;
    user-select: none;
  }

  .g6-contextmenu-li:hover {
    background-color: #f5f5f5;
    cursor: pointer;
  }
`,document.head)}show(e){return gU(this,void 0,void 0,function*(){let{enable:t,offset:n}=this.options;if(typeof t==`function`&&!t(e)||!t){this.hide();return}let r=yield this.getDOMContent(e);r instanceof HTMLElement?(this.$element.innerHTML=``,this.$element.appendChild(r)):this.$element.innerHTML=r;let i=this.context.graph.getCanvas().getContainer().getBoundingClientRect();this.$element.style.left=`${e.client.x-i.left+n[0]}px`,this.$element.style.top=`${e.client.y-i.top+n[1]}px`,this.$element.style.display=`block`,this.targetElement=e.target})}hide(){this.$element.style.display=`none`,this.targetElement=null}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.unbindEvents(),super.destroy(),this.$element.remove()}getDOMContent(e){return gU(this,void 0,void 0,function*(){let{getContent:t,getItems:n}=this.options;return n?hU(yield n(e)):yield t(e)})}bindEvents(){let{graph:e}=this.context,{trigger:t}=this.options;e.on(`canvas:${t}`,this.onTriggerEvent),e.on(`node:${t}`,this.onTriggerEvent),e.on(`edge:${t}`,this.onTriggerEvent),e.on(`combo:${t}`,this.onTriggerEvent),document.addEventListener(`click`,this.onMenuItemClick)}unbindEvents(){let{graph:e}=this.context,{trigger:t}=this.options;e.off(`canvas:${t}`,this.onTriggerEvent),e.off(`node:${t}`,this.onTriggerEvent),e.off(`edge:${t}`,this.onTriggerEvent),e.off(`combo:${t}`,this.onTriggerEvent),document.removeEventListener(`click`,this.onMenuItemClick)}};_U.defaultOptions={trigger:`contextmenu`,offset:[4,4],loadingContent:`<div class="g6-contextmenu-loading">Loading...</div>`,getContent:()=>`It is a empty context menu.`,enable:()=>!0};var vU=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.edgeBundles={},this.edgePoints={},this.onBundle=()=>{let{model:e,element:t}=this.context,n=e.getEdgeData();this.divideEdges(this.options.divisions);let{cycles:r,iterRate:i,divRate:a}=this.options,{lambda:o,divisions:s,iterations:c}=this.options;for(let e=0;e<r;e++){for(let e=0;e<c;e++){let e={};n.forEach(t=>{var n;if(t.source===t.target)return;let r=Q(t);e[r]=this.getEdgeForces(t,s,o);for(let t=0;t<s+1;t++)(n=this.edgePoints)[r]||(n[r]=[]),this.edgePoints[r][t]=BC(this.edgePoints[r][t],e[r][t])})}o/=2,s*=a,c*=i,this.divideEdges(s)}n.forEach(e=>{let n=Q(e);t.getElement(n)?.update({d:HD(this.edgePoints[n])})})},this.bindEvents()}get nodeMap(){let e=this.context.model.getNodeData();return Object.fromEntries(e.map(e=>[Q(e),$C(aw(e))]))}divideEdges(e){this.context.model.getEdgeData().forEach(t=>{var n;let r=Q(t);(n=this.edgePoints)[r]||(n[r]=[]);let i=this.nodeMap[t.source],a=this.nodeMap[t.target];if(e===1)this.edgePoints[r].push(i),this.edgePoints[r].push(UC(BC(i,a),2)),this.edgePoints[r].push(a);else{let t=(this.edgePoints[r].length===0?qC(i,a):TU(this.edgePoints[r]))/(e+1),n=t,o=[i];for(let e=1;e<this.edgePoints[r].length;e++){let i=this.edgePoints[r][e-1],a=this.edgePoints[r][e],s=qC(a,i);for(;s>n;){let e=n/s,r=BC(i,HC(VC(a,i),e));o.push(r),s-=n,n=t}n-=s}o.push(a),this.edgePoints[r]=o}})}getVectorPosition(e){let t=this.nodeMap[e.source],n=this.nodeMap[e.target],[r,i]=VC(n,t),a=qC(t,n);return{source:t,target:n,vx:r,vy:i,length:a}}measureEdgeCompatibility(e,t){let n=this.getVectorPosition(e),r=this.getVectorPosition(t),i=yU(n,r),a=bU(n,r),o=xU(n,r),s=wU(n,r);return i*a*o*s}getEdgeBundles(){let e={},t=this.options.bundleThreshold,n=this.context.model.getEdgeData();return n.forEach((r,i)=>{n.forEach((n,a)=>{var o,s;a<=i||this.measureEdgeCompatibility(r,n)>=t&&(e[o=Q(r)]||(e[o]=[]),e[Q(r)].push(n),e[s=Q(n)]||(e[s]=[]),e[Q(n)].push(r))})}),e}getSpringForce(e,t){let{pre:n,cur:r,next:i}=e;return HC(VC(BC(n,i),HC(r,2)),t)}getElectrostaticForce(e,t){Uu(this.edgeBundles)&&(this.edgeBundles=this.getEdgeBundles());let n=this.edgeBundles[Q(t)],r=[0,0];return n?.forEach(n=>{let i=this.edgePoints[Q(n)][e],a=this.edgePoints[Q(t)][e],o=VC(i,a),s=qC(i,a);r=BC(r,HC(o,1/s))}),r}getEdgeForces(e,t,n){let r=this.nodeMap[e.source],i=this.nodeMap[e.target],a=this.options.K/(qC(r,i)*(t+1)),o=[[0,0]],s=Q(e);for(let r=1;r<t;r++){let t=this.getSpringForce({pre:this.edgePoints[s][r-1],cur:this.edgePoints[s][r],next:this.edgePoints[s][r+1]||[0,0]},a),i=this.getElectrostaticForce(r,e);o.push(HC(BC(t,i),n))}return o.push([0,0]),o}bindEvents(){let{graph:e}=this.context;e.on(Z.AFTER_RENDER,this.onBundle)}unbindEvents(){let{graph:e}=this.context;e.off(Z.AFTER_RENDER,this.onBundle)}destroy(){this.unbindEvents(),super.destroy()}};vU.defaultOptions={K:.1,lambda:.1,divisions:1,divRate:2,cycles:6,iterations:90,iterRate:2/3,bundleThreshold:.6};var yU=(e,t)=>Math.abs(WC([e.vx,e.vy],[t.vx,t.vy])/(e.length*t.length)),bU=(e,t)=>{let n=(e.length+t.length)/2;return 2/(n/Math.min(e.length,t.length)+Math.max(e.length,t.length)/n)},xU=(e,t)=>{let n=(e.length+t.length)/2,r=UC(BC(e.source,e.target),2),i=UC(BC(t.source,t.target),2);return n/(n+qC(r,i))},SU=(e,t)=>{if(t.source[0]===t.target[0])return[t.source[0],e[1]];if(t.source[1]===t.target[1])return[e[0],t.source[1]];let n=(t.source[1]-t.target[1])/(t.source[0]-t.target[0]),r=(n*n*t.source[0]+n*(e[1]-t.source[1])+e[0])/(n*n+1),i=n*(r-t.source[0])+t.source[1];return[r,i]},CU=(e,t)=>{let n=SU(t.source,e),r=SU(t.target,e),i=UC(BC(n,r),2),a=UC(BC(e.source,e.target),2);return qC(n,r)===0?0:Math.max(0,1-2*qC(a,i)/qC(n,r))},wU=(e,t)=>Math.min(CU(e,t),CU(t,e)),TU=e=>{let t=0;for(let n=1;n<e.length;n++)t+=qC(e[n],e[n-1]);return t},EU={fill:`#fff`,fillOpacity:1,lineWidth:1,stroke:`#000`,strokeOpacity:.8,zIndex:-1/0},DU=.05,OU=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.shapes=new Map,this.r=this.options.r,this.onEdgeFilter=e=>{if(this.options.trigger===`drag`&&this.isLensOn)return;let t=lw(e.canvas);this.renderLens(t),this.renderFocusElements()},this.renderLens=e=>{let t=Object.assign({},EU,this.options.style);this.isLensOn||(this.lens=new PT({style:t}),this.canvas.appendChild(this.lens)),Object.assign(t,uw(e),{size:this.r*2}),this.lens.update(t)},this.getFilterData=()=>{let{filter:e}=this.options,{model:t}=this.context,n=t.getData();if(!e)return n;let{nodes:r,edges:i,combos:a}=n;return{nodes:r.filter(t=>e(Q(t),`node`)),edges:i.filter(t=>e(Q(t),`edge`)),combos:a.filter(t=>e(Q(t),`combo`))}},this.getFocusElements=e=>{let{nodes:t,edges:n}=this.getFilterData(),r=t.filter(t=>qC(aw(t),e)<this.r),i=r.map(e=>Q(e)),a=n.filter(e=>{let{source:t,target:n}=e,r=i.includes(t),a=i.includes(n);switch(this.options.nodeType){case`both`:return r&&a;case`either`:return r!==a;case`source`:return r&&!a;case`target`:return!r&&a;default:return!1}});return{nodes:r,edges:a}},this.renderFocusElements=()=>{let{element:e,graph:t}=this.context;if(!this.isLensOn)return;let n=this.lens.getCenter(),{nodes:r,edges:i}=this.getFocusElements(n),a=new Set,o=n=>{let r=Q(n);a.add(r);let i=e.getElement(r);if(!i)return;let o=this.shapes.get(r)||i.cloneNode();o.setPosition(i.getPosition()),o.id=i.id,this.shapes.has(r)?Object.entries(i.attributes).forEach(([e,t])=>{o.style[e]!==t&&(o.style[e]=t)}):(this.canvas.appendChild(o),this.shapes.set(r,o));let s=t.getElementType(r),c=this.getElementStyle(s,n);o.update(c)};r.forEach(o),i.forEach(o),this.shapes.forEach((e,t)=>{a.has(t)||(e.destroy(),this.shapes.delete(t))})},this.scaleRByWheel=e=>{this.options.preventDefault&&e.preventDefault();let{clientX:t,clientY:n,deltaX:r,deltaY:i}=e,{graph:a,canvas:o}=this.context,s=a.getCanvasByClient([t,n]),c=this.lens?.getCenter();if(!this.isLensOn||qC(s,c)>this.r)return;let{maxR:l,minR:u}=this.options,d=r+i>0?1/(1-DU):1-DU,f=Math.min(...o.getSize())/2;this.r=Math.max(u||0,Math.min(l||f,this.r*d)),this.renderLens(c),this.renderFocusElements()},this.isLensDragging=!1,this.onDragStart=e=>{let t=lw(e.canvas),n=this.lens?.getCenter();!this.isLensOn||qC(t,n)>this.r||(this.isLensDragging=!0)},this.onDrag=e=>{if(!this.isLensDragging)return;let t=lw(e.canvas);this.renderLens(t),this.renderFocusElements()},this.onDragEnd=()=>{this.isLensDragging=!1},this.bindEvents()}get canvas(){return this.context.canvas.getLayer(`transient`)}get isLensOn(){return this.lens&&!this.lens.destroyed}getElementStyle(e,t){let n=e===`node`?this.options.nodeStyle:this.options.edgeStyle;return typeof n==`function`?n(t):n}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;let{graph:t}=this.context,{trigger:n,scaleRBy:r}=this.options,i=t.getCanvas().getLayer();[`click`,`drag`].includes(n)&&i.addEventListener(X.CLICK,this.onEdgeFilter),n===`pointermove`?i.addEventListener(X.POINTER_MOVE,this.onEdgeFilter):n===`drag`&&(i.addEventListener(X.DRAG_START,this.onDragStart),i.addEventListener(X.DRAG,this.onDrag),i.addEventListener(X.DRAG_END,this.onDragEnd)),r===`wheel`&&((e=this.graphDom)==null||e.addEventListener(X.WHEEL,this.scaleRByWheel,{passive:!1}))}unbindEvents(){var e;let{graph:t}=this.context,{trigger:n,scaleRBy:r}=this.options,i=t.getCanvas().getLayer();[`click`,`drag`].includes(n)&&i.removeEventListener(X.CLICK,this.onEdgeFilter),n===`pointermove`?i.removeEventListener(X.POINTER_MOVE,this.onEdgeFilter):n===`drag`&&(i.removeEventListener(X.DRAG_START,this.onDragStart),i.removeEventListener(X.DRAG,this.onDrag),i.removeEventListener(X.DRAG_END,this.onDragEnd)),r===`wheel`&&((e=this.graphDom)==null||e.removeEventListener(X.WHEEL,this.scaleRByWheel))}update(e){this.unbindEvents(),super.update(e),this.r=e.r??this.r,this.bindEvents()}destroy(){this.unbindEvents(),this.isLensOn&&this.lens.destroy(),this.shapes.forEach((e,t)=>{e.destroy(),this.shapes.delete(t)}),super.destroy()}};OU.defaultOptions={trigger:`pointermove`,r:60,nodeType:`both`,filter:()=>!0,style:{lineWidth:2},nodeStyle:{label:!1},edgeStyle:{label:!0},scaleRBy:`wheel`,preventDefault:!0};var kU={fill:`#ccc`,fillOpacity:.1,lineWidth:2,stroke:`#000`,strokeOpacity:.8,labelFontSize:12},AU=.05,jU=.1,MU=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.r=this.options.r,this.d=this.options.d,this.onCreateFisheye=e=>{if(this.options.trigger===`drag`&&this.isLensOn)return;let t=lw(e.canvas);this.onMagnify(t)},this.onMagnify=e=>{e.some(isNaN)||(this.renderLens(e),this.renderFocusElements())},this.renderLens=e=>{let t=Object.assign({},kU,this.options.style);this.isLensOn||(this.lens=new PT({style:t}),this.canvas.appendChild(this.lens)),Object.assign(t,uw(e),{size:this.r*2,label:this.options.showDPercent,labelText:this.getDPercent()}),this.lens.update(t)},this.getDPercent=()=>{let{minD:e,maxD:t}=this.options;return`${Math.round((this.d-e)/(t-e)*100)}%`},this.prevMagnifiedStyleMap=new Map,this.prevOriginStyleMap=new Map,this.renderFocusElements=()=>{if(!this.isLensOn)return;let{graph:e}=this.context,t=this.lens.getCenter(),n=(this.d+1)*this.r,r=new Map,i=new Map;e.getNodeData().forEach(a=>{let o=aw(a),s=qC(o,t);if(s>this.r)return;let c=n*s/(this.d*s+this.r),[l,u]=o,[d,f]=t,p=(l-d)/s,m=(u-f)/s,h=[d+c*p,f+c*m],g=Q(a),_=this.getNodeStyle(a),v=Yu(e.getElementRenderStyle(g),Object.keys(_));r.set(g,Object.assign(Object.assign({},uw(h)),_)),i.set(g,Object.assign(Object.assign({},uw(o)),v))}),this.updateStyle(r,i)},this.getNodeStyle=e=>{let{nodeStyle:t}=this.options;return typeof t==`function`?t(e):t},this.updateStyle=(e,t)=>{let{graph:n,element:r}=this.context,{enter:i,exit:a,keep:o}=MC(Array.from(this.prevMagnifiedStyleMap.keys()),Array.from(e.keys()),e=>e),s=new Set,c=(e,t)=>{r.getElement(e)?.update(t),n.getRelatedEdgesData(e).forEach(e=>{s.add(Q(e))})};[...i,...o].forEach(t=>{c(t,e.get(t))}),a.forEach(e=>{c(e,this.prevOriginStyleMap.get(e)),this.prevOriginStyleMap.delete(e)}),s.forEach(e=>{r.getElement(e)?.update({})}),this.prevMagnifiedStyleMap=e,t.forEach((e,t)=>{this.prevOriginStyleMap.has(t)||this.prevOriginStyleMap.set(t,e)})},this.isWheelValid=e=>{if(this.options.preventDefault&&e.preventDefault(),!this.isLensOn)return!1;let{clientX:t,clientY:n}=e,r=this.context.graph.getCanvasByClient([t,n]),i=this.lens.getCenter();return!(qC(r,i)>this.r)},this.scaleR=e=>{let{maxR:t,minR:n}=this.options,r=e?1/(1-AU):1-AU,i=Math.min(...this.context.canvas.getSize())/2;this.r=Math.max(n||0,Math.min(t||i,this.r*r))},this.scaleD=e=>{let{maxD:t,minD:n}=this.options,r=e?this.d+jU:this.d-jU;this.d=Math.max(n,Math.min(t,r))},this.scaleRByWheel=e=>{if(!this.isWheelValid(e))return;let{deltaX:t,deltaY:n}=e;this.scaleR(t+n>0);let r=this.lens.getCenter();this.onMagnify(r)},this.scaleDByWheel=e=>{if(!this.isWheelValid(e))return;let{deltaX:t,deltaY:n}=e;this.scaleD(t+n>0);let r=this.lens.getCenter();this.onMagnify(r)},this.isDragValid=e=>{if(this.options.preventDefault&&e.preventDefault(),!this.isLensOn)return!1;let t=lw(e.canvas),n=this.lens.getCenter();return!(qC(t,n)>this.r)},this.isLensDragging=!1,this.onDragStart=e=>{this.isDragValid(e)&&(this.isLensDragging=!0)},this.onDrag=e=>{if(!this.isLensDragging)return;let t=lw(e.canvas);this.onMagnify(t)},this.onDragEnd=()=>{this.isLensDragging=!1},this.scaleRByDrag=e=>{if(!this.isLensDragging)return;let{dx:t,dy:n}=e;this.scaleR(t-n>0);let r=this.lens.getCenter();this.onMagnify(r)},this.scaleDByDrag=e=>{if(!this.isLensDragging)return;let{dx:t,dy:n}=e;this.scaleD(t-n>0);let r=this.lens.getCenter();this.onMagnify(r)},this.bindEvents()}get canvas(){return this.context.canvas.getLayer(`transient`)}get isLensOn(){return this.lens&&!this.lens.destroyed}get graphDom(){return this.context.graph.getCanvas().getContextService().getDomElement()}bindEvents(){var e;let{graph:t}=this.context,{trigger:n,scaleRBy:r,scaleDBy:i}=this.options,a=t.getCanvas().getLayer();if([`click`,`drag`].includes(n)&&a.addEventListener(X.CLICK,this.onCreateFisheye),n===`pointermove`&&a.addEventListener(X.POINTER_MOVE,this.onCreateFisheye),n===`drag`||r===`drag`||i===`drag`){a.addEventListener(X.DRAG_START,this.onDragStart),a.addEventListener(X.DRAG_END,this.onDragEnd);let e=n===`drag`?this.onDrag:r===`drag`?this.scaleRByDrag:this.scaleDByDrag;a.addEventListener(X.DRAG,e)}if(r===`wheel`||i===`wheel`){let t=r===`wheel`?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)==null||e.addEventListener(X.WHEEL,t,{passive:!1})}}unbindEvents(){var e;let{graph:t}=this.context,{trigger:n,scaleRBy:r,scaleDBy:i}=this.options,a=t.getCanvas().getLayer();if([`click`,`drag`].includes(n)&&a.removeEventListener(X.CLICK,this.onCreateFisheye),n===`pointermove`&&a.removeEventListener(X.POINTER_MOVE,this.onCreateFisheye),n===`drag`||r===`drag`||i===`drag`){a.removeEventListener(X.DRAG_START,this.onDragStart),a.removeEventListener(X.DRAG_END,this.onDragEnd);let e=n===`drag`?this.onDrag:r===`drag`?this.scaleRByDrag:this.scaleDByDrag;a.removeEventListener(X.DRAG,e)}if(r===`wheel`||i===`wheel`){let t=r===`wheel`?this.scaleRByWheel:this.scaleDByWheel;(e=this.graphDom)==null||e.removeEventListener(X.WHEEL,t)}}update(e){this.unbindEvents(),super.update(e),this.r=e.r??this.r,this.d=e.d??this.d,this.bindEvents()}destroy(){var e;this.unbindEvents(),this.isLensOn&&((e=this.lens)==null||e.destroy()),this.prevMagnifiedStyleMap.clear(),this.prevOriginStyleMap.clear(),super.destroy()}};MU.defaultOptions={trigger:`pointermove`,r:120,d:1.5,maxD:5,minD:0,showDPercent:!0,style:{},nodeStyle:{label:!0},preventDefault:!0};var NU=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.$el=this.context.canvas.getContainer(),this.graphSize=[0,0],this.onFullscreenChange=()=>{var e,t,n,r;let i=!!document.fullscreenElement;this.options.autoFit&&this.setGraphSize(i),i?(t=(e=this.options).onEnter)==null||t.call(e):(r=(n=this.options).onExit)==null||r.call(n)},this.shortcut=new jw(t.graph),this.bindEvents(),this.style=document.createElement(`style`),document.head.appendChild(this.style),this.style.innerHTML=`
      :not(:root):fullscreen::backdrop {
        background: transparent;
      }
    `}bindEvents(){this.unbindEvents(),this.shortcut.unbindAll();let{request:e=[],exit:t=[]}=this.options.trigger;this.shortcut.bind(e,this.request),this.shortcut.bind(t,this.exit),[`webkitfullscreenchange`,`mozfullscreenchange`,`fullscreenchange`,`MSFullscreenChange`].forEach(e=>{document.addEventListener(e,this.onFullscreenChange,!1)})}unbindEvents(){this.shortcut.unbindAll(),[`webkitfullscreenchange`,`mozfullscreenchange`,`fullscreenchange`,`MSFullscreenChange`].forEach(e=>{document.removeEventListener(e,this.onFullscreenChange,!1)})}setGraphSize(e=!0){let t,n;e?(t=globalThis.screen?.width||0,n=globalThis.screen?.height||0,this.graphSize=this.context.graph.getSize()):[t,n]=this.graphSize,this.context.graph.setSize(t,n),this.context.graph.render()}request(){document.fullscreenElement||!PU()||this.$el.requestFullscreen().catch(e=>{eS.warn(`Error attempting to enable full-screen: ${e.message} (${e.name})`)})}exit(){document.fullscreenElement&&document.exitFullscreen()}update(e){this.unbindEvents(),super.update(e),this.bindEvents()}destroy(){this.exit(),this.style.remove(),super.destroy()}};NU.defaultOptions={trigger:{},autoFit:!0};function PU(){return document.fullscreenEnabled||Reflect.get(document,`webkitFullscreenEnabled`)||Reflect.get(document,`mozFullscreenEnabled`)||Reflect.get(document,`msFullscreenEnabled`)}var FU=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.$element=aH(`grid-line`,!0),this.offset=[0,0],this.currentScale=1,this.followZoom=e=>{let{data:{scale:t,origin:n}}=e;if(!t)return;let r=this.currentScale;this.currentScale=t;let i=t/r,a=HC(n||this.context.graph.getCanvasCenter(),1-i),o=this.baseSize*t,s=HC(this.offset,i),c=QC(s,o),l=BC(c,a);this.$element.style.backgroundSize=`${o}px ${o}px`,this.$element.style.backgroundPosition=`${l[0]}px ${l[1]}px`,this.offset=QC(l,o)},this.followTranslate=e=>{if(!this.options.follow)return;let{data:{translate:t}}=e;t&&this.updateOffset(t)},this.onTransform=e=>{let t=this.parseFollow(this.options.follow);t.zoom&&this.followZoom(e),t.translate&&this.followTranslate(e)},this.context.canvas.getContainer().prepend(this.$element),this.baseSize=this.options.size,this.updateStyle(),this.bindEvents()}update(e){super.update(e),e.size!==void 0&&(this.baseSize=e.size),this.updateStyle()}bindEvents(){let{graph:e}=this.context;e.on(Z.AFTER_TRANSFORM,this.onTransform)}updateStyle(){let{stroke:e,lineWidth:t,border:n,borderLineWidth:r,borderStroke:i,borderStyle:a}=this.options,o=this.baseSize*this.currentScale;Object.assign(this.$element.style,{border:n?`${r}px ${a} ${i}`:`none`,backgroundImage:`linear-gradient(${e} ${t}px, transparent ${t}px), linear-gradient(90deg, ${e} ${t}px, transparent ${t}px)`,backgroundSize:`${o}px ${o}px`,backgroundRepeat:`repeat`})}updateOffset(e){let t=this.baseSize*this.currentScale;this.offset=QC(BC(this.offset,e),t),this.$element.style.backgroundPosition=`${this.offset[0]}px ${this.offset[1]}px`}parseFollow(e){return xu(e)?{translate:e,zoom:e}:{translate:e?.translate??!1,zoom:e?.zoom??!1}}destroy(){this.context.graph.off(Z.AFTER_TRANSFORM,this.onTransform),this.$element.remove(),super.destroy()}};FU.defaultOptions={border:!0,borderLineWidth:1,borderStroke:`#eee`,borderStyle:`solid`,lineWidth:1,size:20,stroke:`#eee`};function IU(e){let t={Added:new Map,Updated:new Map,Removed:new Map};return e.forEach(e=>{let{type:n,value:r}=e,i=Q(r);if(n===`NodeAdded`||n===`EdgeAdded`||n===`ComboAdded`)t.Added.set(i,e);else if(n===`NodeUpdated`||n===`EdgeUpdated`||n===`ComboUpdated`)if(t.Added.has(i))t.Added.set(i,{type:n.replace(`Updated`,`Added`),value:r});else if(t.Updated.has(i)){let{original:e}=t.Updated.get(i);t.Updated.set(i,{type:n,value:r,original:e})}else t.Removed.has(i)||t.Updated.set(i,e);else (n===`NodeRemoved`||n===`EdgeRemoved`||n===`ComboRemoved`)&&(t.Added.has(i)?t.Added.delete(i):(t.Updated.has(i)&&t.Updated.delete(i),t.Removed.set(i,e)))}),[...Array.from(t.Added.values()),...Array.from(t.Updated.values()),...Array.from(t.Removed.values())]}function LU(e){let{NodeAdded:t=[],NodeUpdated:n=[],NodeRemoved:r=[],EdgeAdded:i=[],EdgeUpdated:a=[],EdgeRemoved:o=[],ComboAdded:s=[],ComboUpdated:c=[],ComboRemoved:l=[]}=su(e,e=>e.type);return{add:{nodes:t,edges:i,combos:s},update:{nodes:n,edges:a,combos:c},remove:{nodes:r,edges:o,combos:l}}}function RU(e,t){for(let n in e)Kl(e[n])&&!Array.isArray(e[n])&&e[n]!==null?(t[n]||(t[n]={}),RU(e[n],t[n])):t[n]===void 0&&(t[n]=iS(n))}function zU(e,t=!1,n){let r={animation:t,current:{add:{},update:{},remove:{}},original:{add:{},update:{},remove:{}}},{add:i,update:a,remove:o}=LU(IU(e));return[`nodes`,`edges`,`combos`].forEach(e=>{a[e]&&a[e].forEach(t=>{var i,a;let o=Object.assign({},t.value),s=Object.assign({},t.original);if(n){let e=n.graph.getElementType(Q(t.original)),r=e===`edge`?`stroke`:`fill`,i=n.element.getElementComputedStyle(e,t.original);s=Object.assign(Object.assign({},t.original),{style:Object.assign({[r]:i[r]},t.original.style)})}RU(o,s),(i=r.current.update)[e]||(i[e]=[]),r.current.update[e].push(o),(a=r.original.update)[e]||(a[e]=[]),r.original.update[e].push(s)}),i[e]&&i[e].forEach(t=>{var n,i;let a=Object.assign({},t.value);(n=r.current.add)[e]||(n[e]=[]),r.current.add[e].push(a),(i=r.original.remove)[e]||(i[e]=[]),r.original.remove[e].push(a)}),o[e]&&o[e].forEach(t=>{var n,i;let a=Object.assign({},t.value);(n=r.current.remove)[e]||(n[e]=[]),r.current.remove[e].push(a),(i=r.original.add)[e]||(i[e]=[]),r.original.add[e].push(a)})}),r}var BU=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.batchChanges=null,this.batchAnimation=!1,this.undoStack=[],this.redoStack=[],this.freezed=!1,this.executeCommand=(e,t=!0)=>{var n,r,i;this.freezed=!0,(r=(n=this.options).executeCommand)==null||r.call(n,e);let a=t?e.original:e.current;this.context.graph.addData(a.add),this.context.graph.updateData(a.update),this.context.graph.removeData(CC(a.remove,!1)),(i=this.context.element)==null||i.draw({silence:!0,animation:e.animation}),this.freezed=!1},this.addCommand=e=>{if(!this.freezed){if(e.type===Z.AFTER_DRAW){let{dataChanges:t=[],animation:n=!0}=e.data;if(this.context.batch?.isBatching){if(!this.batchChanges)return;this.batchChanges.push(t),this.batchAnimation&&=n;return}this.batchChanges=[t],this.batchAnimation=n}this.undoStackPush(zU(this.batchChanges.flat(),this.batchAnimation,this.context)),this.notify(Gx.ADD,this.undoStack[this.undoStack.length-1])}},this.initBatchCommand=e=>{let{initiate:t}=e.data;this.batchAnimation=!1,t?this.batchChanges=[]:this.undoStack.pop()||(this.batchChanges=null)},this.emitter=new hk;let{graph:r}=this.context;r.on(Z.AFTER_DRAW,this.addCommand),r.on(Z.BATCH_START,this.initBatchCommand),r.on(Z.BATCH_END,this.addCommand)}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){var e,t,n;let r=this.undoStack.pop();if(r){if(this.executeCommand(r),(e=this.options).beforeAddCommand?.call(e,r,!1)===!1)return;this.redoStack.push(r),(n=(t=this.options).afterAddCommand)==null||n.call(t,r,!1),this.notify(Gx.UNDO,r)}return this}redo(){let e=this.redoStack.pop();return e&&(this.executeCommand(e,!1),this.undoStackPush(e),this.notify(Gx.REDO,e)),this}undoAndCancel(){let e=this.undoStack.pop();return e&&(this.executeCommand(e,!1),this.redoStack=[],this.notify(Gx.CANCEL,e)),this}undoStackPush(e){var t,n,r;let{stackSize:i}=this.options;i!==0&&this.undoStack.length>=i&&this.undoStack.shift(),(t=this.options).beforeAddCommand?.call(t,e,!0)!==!1&&(this.undoStack.push(e),(r=(n=this.options).afterAddCommand)==null||r.call(n,e,!0))}clear(){this.undoStack=[],this.redoStack=[],this.batchChanges=null,this.batchAnimation=!1,this.notify(Gx.CLEAR,null)}notify(e,t){this.emitter.emit(e,{cmd:t}),this.emitter.emit(Gx.CHANGE,{cmd:t})}on(e,t){this.emitter.on(e,t)}destroy(){let{graph:e}=this.context;e.off(Z.AFTER_DRAW,this.addCommand),e.off(Z.BATCH_START,this.initBatchCommand),e.off(Z.BATCH_END,this.addCommand),this.emitter.off(),super.destroy(),this.undoStack=[],this.redoStack=[]}};BU.defaultOptions={stackSize:0};const VU={toXy(e,t){if(!t)return[...e];let n=t[0].slice(1),r=t[1].slice(1);return e.map(e=>[e[n],e[r]])},fromXy(e,t){if(!t)return[...e];let n=t[0].slice(1),r=t[1].slice(1);return e.map(([e,t])=>({[n]:e,[r]:t}))}};var HU=class{constructor(e,t){this._cells=[],this._cellSize=t,this._reverseCellSize=1/t;for(let t of e){let e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]);this._cells[e]||(this._cells[e]=[]),this._cells[e][n]||(this._cells[e][n]=[]),this._cells[e][n].push(t)}}cellPoints(e,t){return this._cells[e]?.[t]||[]}rangePoints(e){let t=this.coordToCellNum(e[0]),n=this.coordToCellNum(e[1]),r=this.coordToCellNum(e[2]),i=this.coordToCellNum(e[3]),a=[];for(let e=t;e<=r;e++)for(let t=n;t<=i;t++){let n=this.cellPoints(e,t);for(let e of n)a.push(e)}return a}removePoint(e){let t=this.coordToCellNum(e[0]),n=this.coordToCellNum(e[1]),r=this._cells[t][n],i=r.findIndex(([t,n])=>t===e[0]&&n===e[1]);return i>-1&&r.splice(i,1),r}trunc(e){return Math.trunc(e)}coordToCellNum(e){return this.trunc(e*this._reverseCellSize)}extendBbox(e,t){return[e[0]-t*this._cellSize,e[1]-t*this._cellSize,e[2]+t*this._cellSize,e[3]+t*this._cellSize]}};function UU(e,t){return new HU(e,t)}var WU=+(2**27+1);function GU(e,t,n){let r=e*t,i=WU*e,a=i-e,o=i-a,s=e-o,c=WU*t,l=c-t,u=c-l,d=t-u,f=r-o*u-s*u-o*d,p=s*d-f;return n?(n[0]=p,n[1]=r,n):[p,r]}function KU(e,t,n){let r=e+t,i=r-e,a=r-i,o=t-i,s=e-a;return n?(n[0]=s+o,n[1]=r,n):[s+o,r]}function qU(e,t){let n=e.length;if(n===1){let n=GU(e[0],t);return n[0]?n:[n[1]]}let r=Array(2*n),i=[.1,.1],a=[.1,.1],o=0;GU(e[0],t,i),i[0]&&(r[o++]=i[0]);for(let s=1;s<n;++s){GU(e[s],t,a);let n=i[1];KU(n,a[0],i),i[0]&&(r[o++]=i[0]);let c=a[1],l=i[1],u=c+l,d=u-c,f=l-d;i[1]=u,f&&(r[o++]=f)}return i[1]&&(r[o++]=i[1]),o===0&&(r[o++]=0),r.length=o,r}function JU(e,t){let n=e+t,r=n-e,i=n-r,a=t-r,o=e-i+a;return o?[o,n]:[n]}function YU(e,t){let n=e.length|0,r=t.length|0;if(n===1&&r===1)return JU(e[0],-t[0]);let i=n+r,a=Array(i),o=0,s=0,c=0,l=Math.abs,u=e[s],d=l(u),f=-t[c],p=l(f),m,h;d<p?(h=u,s+=1,s<n&&(u=e[s],d=l(u))):(h=f,c+=1,c<r&&(f=-t[c],p=l(f))),s<n&&d<p||c>=r?(m=u,s+=1,s<n&&(u=e[s],d=l(u))):(m=f,c+=1,c<r&&(f=-t[c],p=l(f)));let g=m+h,_=g-m,v=h-_,y=v,b=g,x,S,C,w,T;for(;s<n&&c<r;)d<p?(m=u,s+=1,s<n&&(u=e[s],d=l(u))):(m=f,c+=1,c<r&&(f=-t[c],p=l(f))),h=y,g=m+h,_=g-m,v=h-_,v&&(a[o++]=v),x=b+g,S=x-b,C=x-S,w=g-S,T=b-C,y=T+w,b=x;for(;s<n;)m=u,h=y,g=m+h,_=g-m,v=h-_,v&&(a[o++]=v),x=b+g,S=x-b,C=x-S,w=g-S,T=b-C,y=T+w,b=x,s+=1,s<n&&(u=e[s]);for(;c<r;)m=f,h=y,g=m+h,_=g-m,v=h-_,v&&(a[o++]=v),x=b+g,S=x-b,C=x-S,w=g-S,T=b-C,y=T+w,b=x,c+=1,c<r&&(f=-t[c]);return y&&(a[o++]=y),b&&(a[o++]=b),o||(a[o++]=0),a.length=o,a}function XU(e,t){let n=e+t,r=n-e,i=n-r,a=t-r,o=e-i+a;return o?[o,n]:[n]}function ZU(e,t){let n=e.length|0,r=t.length|0;if(n===1&&r===1)return XU(e[0],t[0]);let i=n+r,a=Array(i),o=0,s=0,c=0,l=Math.abs,u=e[s],d=l(u),f=t[c],p=l(f),m,h;d<p?(h=u,s+=1,s<n&&(u=e[s],d=l(u))):(h=f,c+=1,c<r&&(f=t[c],p=l(f))),s<n&&d<p||c>=r?(m=u,s+=1,s<n&&(u=e[s],d=l(u))):(m=f,c+=1,c<r&&(f=t[c],p=l(f)));let g=m+h,_=g-m,v=h-_,y=v,b=g,x,S,C,w,T;for(;s<n&&c<r;)d<p?(m=u,s+=1,s<n&&(u=e[s],d=l(u))):(m=f,c+=1,c<r&&(f=t[c],p=l(f))),h=y,g=m+h,_=g-m,v=h-_,v&&(a[o++]=v),x=b+g,S=x-b,C=x-S,w=g-S,T=b-C,y=T+w,b=x;for(;s<n;)m=u,h=y,g=m+h,_=g-m,v=h-_,v&&(a[o++]=v),x=b+g,S=x-b,C=x-S,w=g-S,T=b-C,y=T+w,b=x,s+=1,s<n&&(u=e[s]);for(;c<r;)m=f,h=y,g=m+h,_=g-m,v=h-_,v&&(a[o++]=v),x=b+g,S=x-b,C=x-S,w=g-S,T=b-C,y=T+w,b=x,c+=1,c<r&&(f=t[c]);return y&&(a[o++]=y),b&&(a[o++]=b),o||(a[o++]=0),a.length=o,a}var QU=5,$U=11102230246251565e-32,eW=(3+16*$U)*$U,tW=(7+56*$U)*$U;function nW(e,t,n,r){return function(n,i,a){let o=e(e(t(i[1],a[0]),t(-a[1],i[0])),e(t(n[1],i[0]),t(-i[1],n[0]))),s=e(t(n[1],a[0]),t(-a[1],n[0])),c=r(o,s);return c[c.length-1]}}function rW(e,t,n,r){return function(i,a,o,s){let c=e(e(n(e(t(o[1],s[0]),t(-s[1],o[0])),a[2]),e(n(e(t(a[1],s[0]),t(-s[1],a[0])),-o[2]),n(e(t(a[1],o[0]),t(-o[1],a[0])),s[2]))),e(n(e(t(a[1],s[0]),t(-s[1],a[0])),i[2]),e(n(e(t(i[1],s[0]),t(-s[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),s[2])))),l=e(e(n(e(t(o[1],s[0]),t(-s[1],o[0])),i[2]),e(n(e(t(i[1],s[0]),t(-s[1],i[0])),-o[2]),n(e(t(i[1],o[0]),t(-o[1],i[0])),s[2]))),e(n(e(t(a[1],o[0]),t(-o[1],a[0])),i[2]),e(n(e(t(i[1],o[0]),t(-o[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),o[2])))),u=r(c,l);return u[u.length-1]}}function iW(e,t,n,r){return function(i,a,o,s,c){let l=e(e(e(n(e(n(e(t(s[1],c[0]),t(-c[1],s[0])),o[2]),e(n(e(t(o[1],c[0]),t(-c[1],o[0])),-s[2]),n(e(t(o[1],s[0]),t(-s[1],o[0])),c[2]))),a[3]),e(n(e(n(e(t(s[1],c[0]),t(-c[1],s[0])),a[2]),e(n(e(t(a[1],c[0]),t(-c[1],a[0])),-s[2]),n(e(t(a[1],s[0]),t(-s[1],a[0])),c[2]))),-o[3]),n(e(n(e(t(o[1],c[0]),t(-c[1],o[0])),a[2]),e(n(e(t(a[1],c[0]),t(-c[1],a[0])),-o[2]),n(e(t(a[1],o[0]),t(-o[1],a[0])),c[2]))),s[3]))),e(n(e(n(e(t(o[1],s[0]),t(-s[1],o[0])),a[2]),e(n(e(t(a[1],s[0]),t(-s[1],a[0])),-o[2]),n(e(t(a[1],o[0]),t(-o[1],a[0])),s[2]))),-c[3]),e(n(e(n(e(t(s[1],c[0]),t(-c[1],s[0])),a[2]),e(n(e(t(a[1],c[0]),t(-c[1],a[0])),-s[2]),n(e(t(a[1],s[0]),t(-s[1],a[0])),c[2]))),i[3]),n(e(n(e(t(s[1],c[0]),t(-c[1],s[0])),i[2]),e(n(e(t(i[1],c[0]),t(-c[1],i[0])),-s[2]),n(e(t(i[1],s[0]),t(-s[1],i[0])),c[2]))),-a[3])))),e(e(n(e(n(e(t(a[1],c[0]),t(-c[1],a[0])),i[2]),e(n(e(t(i[1],c[0]),t(-c[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),c[2]))),s[3]),e(n(e(n(e(t(a[1],s[0]),t(-s[1],a[0])),i[2]),e(n(e(t(i[1],s[0]),t(-s[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),s[2]))),-c[3]),n(e(n(e(t(o[1],s[0]),t(-s[1],o[0])),a[2]),e(n(e(t(a[1],s[0]),t(-s[1],a[0])),-o[2]),n(e(t(a[1],o[0]),t(-o[1],a[0])),s[2]))),i[3]))),e(n(e(n(e(t(o[1],s[0]),t(-s[1],o[0])),i[2]),e(n(e(t(i[1],s[0]),t(-s[1],i[0])),-o[2]),n(e(t(i[1],o[0]),t(-o[1],i[0])),s[2]))),-a[3]),e(n(e(n(e(t(a[1],s[0]),t(-s[1],a[0])),i[2]),e(n(e(t(i[1],s[0]),t(-s[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),s[2]))),o[3]),n(e(n(e(t(a[1],o[0]),t(-o[1],a[0])),i[2]),e(n(e(t(i[1],o[0]),t(-o[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),o[2]))),-s[3]))))),u=e(e(e(n(e(n(e(t(s[1],c[0]),t(-c[1],s[0])),o[2]),e(n(e(t(o[1],c[0]),t(-c[1],o[0])),-s[2]),n(e(t(o[1],s[0]),t(-s[1],o[0])),c[2]))),i[3]),n(e(n(e(t(s[1],c[0]),t(-c[1],s[0])),i[2]),e(n(e(t(i[1],c[0]),t(-c[1],i[0])),-s[2]),n(e(t(i[1],s[0]),t(-s[1],i[0])),c[2]))),-o[3])),e(n(e(n(e(t(o[1],c[0]),t(-c[1],o[0])),i[2]),e(n(e(t(i[1],c[0]),t(-c[1],i[0])),-o[2]),n(e(t(i[1],o[0]),t(-o[1],i[0])),c[2]))),s[3]),n(e(n(e(t(o[1],s[0]),t(-s[1],o[0])),i[2]),e(n(e(t(i[1],s[0]),t(-s[1],i[0])),-o[2]),n(e(t(i[1],o[0]),t(-o[1],i[0])),s[2]))),-c[3]))),e(e(n(e(n(e(t(o[1],c[0]),t(-c[1],o[0])),a[2]),e(n(e(t(a[1],c[0]),t(-c[1],a[0])),-o[2]),n(e(t(a[1],o[0]),t(-o[1],a[0])),c[2]))),i[3]),n(e(n(e(t(o[1],c[0]),t(-c[1],o[0])),i[2]),e(n(e(t(i[1],c[0]),t(-c[1],i[0])),-o[2]),n(e(t(i[1],o[0]),t(-o[1],i[0])),c[2]))),-a[3])),e(n(e(n(e(t(a[1],c[0]),t(-c[1],a[0])),i[2]),e(n(e(t(i[1],c[0]),t(-c[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),c[2]))),o[3]),n(e(n(e(t(a[1],o[0]),t(-o[1],a[0])),i[2]),e(n(e(t(i[1],o[0]),t(-o[1],i[0])),-a[2]),n(e(t(i[1],a[0]),t(-a[1],i[0])),o[2]))),-c[3])))),d=r(l,u);return d[d.length-1]}}function aW(e){return(e===3?nW:e===4?rW:iW)(ZU,GU,qU,YU)}var oW=aW(3),sW=aW(4),cW=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,n){let r=(e[1]-n[1])*(t[0]-n[0]),i=(e[0]-n[0])*(t[1]-n[1]),a=r-i,o;if(r>0){if(i<=0)return a;o=r+i}else if(r<0){if(i>=0)return a;o=-(r+i)}else return a;let s=eW*o;return a>=s||a<=-s?a:oW(e,t,n)},function(e,t,n,r){let i=e[0]-r[0],a=t[0]-r[0],o=n[0]-r[0],s=e[1]-r[1],c=t[1]-r[1],l=n[1]-r[1],u=e[2]-r[2],d=t[2]-r[2],f=n[2]-r[2],p=a*l,m=o*c,h=o*s,g=i*l,_=i*c,v=a*s,y=u*(p-m)+d*(h-g)+f*(_-v),b=(Math.abs(p)+Math.abs(m))*Math.abs(u)+(Math.abs(h)+Math.abs(g))*Math.abs(d)+(Math.abs(_)+Math.abs(v))*Math.abs(f),x=tW*b;return y>x||-y>x?y:sW(e,t,n,r)}];function lW(e){let t=cW[e.length];return t||=cW[e.length]=aW(e.length),t.apply(void 0,...e)}function uW(e,t,n,r,i,a,o){return function(...t){switch(t.length){case 0:case 1:return 0;case 2:return r(t[0],t[1]);case 3:return i(t[0],t[1],t[2]);case 4:return a(t[0],t[1],t[2],t[3]);case 5:return o(t[0],t[1],t[2],t[3],t[4])}return e(t)}}function dW(){for(;cW.length<=QU;)cW.push(aW(cW.length));let e=uW(void 0,lW,...cW);for(let t=0;t<=QU;++t)e[t]=cW[t];return e}var fW=dW(),pW=fW[3];function mW(e){let t=e.length;if(t<3){let n=Array(t);for(let e=0;e<t;++e)n[e]=e;return t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:n}let n=Array(t);for(let e=0;e<t;++e)n[e]=e;n.sort((t,n)=>e[t][0]-e[n][0]||e[t][1]-e[n][1]);let r=[n[0],n[1]],i=[n[0],n[1]];for(let a=2;a<t;++a){let t=n[a],o=e[t],s=r.length;for(;s>1&&pW(e[r[s-2]],e[r[s-1]],o)<=0;)--s,r.pop();for(r.push(t),s=i.length;s>1&&pW(e[i[s-2]],e[i[s-1]],o)>=0;)--s,i.pop();i.push(t)}let a=Array(i.length+r.length-2),o=0;for(let e=0,t=r.length;e<t;++e)a[o++]=r[e];for(let e=i.length-2;e>0;--e)a[o++]=i[e];return a}function hW(e,t,n,r){for(let i=0;i<2;++i){let a=e[i],o=t[i],[s,c]=[Math.min(a,o),Math.max(a,o)],l=n[i],u=r[i],[d,f]=[Math.min(l,u),Math.max(l,u)];if(f<s||c<d)return!1}return!0}function gW(e,t,n,r){let i=fW(e,n,r),a=fW(t,n,r);if(i>0&&a>0||i<0&&a<0)return!1;let o=fW(n,e,t),s=fW(r,e,t);return o>0&&s>0||o<0&&s<0?!1:i===0&&a===0&&o===0&&s===0?hW(e,t,n,r):!0}function _W(e){let t=[e[0]],n=e[0];for(let r=1;r<e.length;r++){let i=e[r];(n[0]!==i[0]||n[1]!==i[1])&&t.push(i),n=i}return t}function vW(e){return e.sort(function(e,t){return e[0]-t[0]||e[1]-t[1]})}function yW(e,t){return(t[0]-e[0])**2+(t[1]-e[1])**2}function bW(e,t,n){let r=[t[0]-e[0],t[1]-e[1]],i=[n[0]-e[0],n[1]-e[1]],a=yW(e,t),o=yW(e,n);return(r[0]*i[0]+r[1]*i[1])/Math.sqrt(a*o)}function xW(e,t){for(let n=0;n<t.length-1;n++){let r=[t[n],t[n+1]];if(!(e[0][0]===r[0][0]&&e[0][1]===r[0][1]||e[0][0]===r[1][0]&&e[0][1]===r[1][1])&&gW(e[0],e[1],r[0],r[1]))return!0}return!1}function SW(e){let t=1/0,n=1/0,r=-1/0,i=-1/0;for(let a=e.length-1;a>=0;a--)e[a][0]<t&&(t=e[a][0]),e[a][1]<n&&(n=e[a][1]),e[a][0]>r&&(r=e[a][0]),e[a][1]>i&&(i=e[a][1]);return[r-t,i-n]}function CW(e){return[Math.min(e[0][0],e[1][0]),Math.min(e[0][1],e[1][1]),Math.max(e[0][0],e[1][0]),Math.max(e[0][1],e[1][1])]}function wW(e,t,n){let r=null,i=DW,a=DW,o,s;for(let c=0;c<t.length;c++)o=bW(e[0],e[1],t[c]),s=bW(e[1],e[0],t[c]),o>i&&s>a&&!xW([e[0],t[c]],n)&&!xW([e[1],t[c]],n)&&(i=o,a=s,r=t[c]);return r}function TW(e,t,n,r,i){let a=!1;for(let o=0;o<e.length-1;o++){let s=[e[o],e[o+1]],c=s[0][0]+`,`+s[0][1]+`,`+s[1][0]+`,`+s[1][1];if(yW(s[0],s[1])<t||i.has(c))continue;let l=0,u=CW(s),d,f,p;do u=r.extendBbox(u,l),d=u[2]-u[0],f=u[3]-u[1],p=wW(s,r.rangePoints(u),e),l++;while(p===null&&(n[0]>d||n[1]>f));d>=n[0]&&f>=n[1]&&i.add(c),p!==null&&(e.splice(o+1,0,p),r.removePoint(p),a=!0)}return a?TW(e,t,n,r,i):e}function EW(e,t,n){let r=t||20,i=_W(vW(VU.toXy(e,n)));if(i.length<4){let e=i.concat([i[0]]);return n?VU.fromXy(e,n):e}let a=SW(i),o=[a[0]*OW,a[1]*OW],s=mW(i).reverse().map(e=>i[e]);s.push(s[0]);let c=i.filter(function(e){return s.indexOf(e)<0}),l=Math.ceil(1/(i.length/(a[0]*a[1]))),u=TW(s,r**2,o,UU(c,l),new Set);return n?VU.fromXy(u,n):u}var DW=Math.cos(90/(180/Math.PI)),OW=.6;function kW(e,t,n){if(e.length===1)return AW(e[0],t,n);if(e.length===2)return jW(e,t,n);if(e.length===3){let[r,i,a]=Dw(e);if(gw(r,i,a))return jW([r,a],t,n)}switch(n){case`smooth`:return NW(e,t);case`sharp`:return PW(e,t);case`rounded`:default:return MW(e,t)}}var AW=(e,t,n)=>{if(n===`sharp`)return[[`M`,e[0]-t,e[1]-t],[`L`,e[0]+t,e[1]-t],[`L`,e[0]+t,e[1]+t],[`L`,e[0]-t,e[1]+t],[`Z`]];let r=[t,t,0,0,0];return[[`M`,e[0],e[1]-t],[`A`,...r,e[0],e[1]+t],[`A`,...r,e[0],e[1]-t]]},jW=(e,t,n)=>{let r=[t,t,0,0,0],i=n===`sharp`?BC(e[0],KC(YC(VC(e[0],e[1])),t)):e[0],a=n===`sharp`?BC(e[1],KC(YC(VC(e[1],e[0])),t)):e[1],o=KC(YC(ZC(VC(i,a),!1)),t),s=KC(o,-1),c=BC(i,o),l=BC(a,o),u=BC(a,s),d=BC(i,s);return n===`sharp`?[[`M`,c[0],c[1]],[`L`,l[0],l[1]],[`L`,u[0],u[1]],[`L`,d[0],d[1]],[`Z`]]:[[`M`,c[0],c[1]],[`L`,l[0],l[1]],[`A`,...r,u[0],u[1]],[`L`,d[0],d[1]],[`A`,...r,c[0],c[1]]]},MW=(e,t)=>{let n=Dw(e).map((n,r)=>{let i=(r-2+e.length)%e.length,a=(r-1+e.length)%e.length,o=(r+1)%e.length,s=e[i],c=e[a],l=e[o],u=VC(s,c),d=VC(c,n),f=VC(n,l),p=(e,t)=>XC(e,t,!0)<Math.PI,m=p(u,d),h=p(d,f),g=e=>KC(YC(ZC(e,!1)),t),_=g(d);return[{p:$C(m?BC(c,g(u)):BC(c,_)),concave:m&&c},{p:$C(h?BC(n,g(f)):BC(n,_)),concave:h&&n}]}),r=[t,t,0,0,0],i=n.findIndex((e,t)=>!n[(t-1+n.length)%n.length][0].concave&&!n[(t-1+n.length)%n.length][1].concave&&!e[0].concave&&!e[0].concave&&!e[1].concave),a=n.slice(i).concat(n.slice(0,i)),o=[];return a.flatMap((e,t)=>{let i=[],s=a[n.length-1];return t===0&&i.push([`M`,...s[1].p]),e[0].concave?o.push(e[0].p,e[1].p):i.push([`A`,...r,...e[0].p]),e[1].concave?o.unshift(e[1].p):i.push([`L`,...e[1].p]),o.length===3&&(i.pop(),i.push([`C`,...o.flat()]),o=[]),i})},NW=(e,t)=>{let n=Dw(e).map((t,n)=>{let r=e[(n+1)%e.length];return{p:t,v:YC(VC(r,t))}});return n.forEach((r,i)=>{let a=i>0?i-1:e.length-1,o=n[a].v,s=YC(BC(o,KC(r.v,XC(o,r.v,!0)<Math.PI?1:-1)));r.p=BC(r.p,KC(s,t))}),vT(n.map(e=>e.p))},PW=(e,t)=>{let n=e.map((n,r)=>{let i=e[r===0?e.length-1:r-1],a=ew(KC(YC(ZC(VC(i,n),!1)),t));return[BC(i,a),BC(n,a)]}).flat();return n.map((e,t)=>{if(t%2==0)return null;let r=[n[(t-1)%n.length],n[t%n.length]],i=[n[(t+1)%n.length],n[(t+2)%n.length]];return rw(r,i,!0)}).filter(Boolean).map((e,t)=>[t===0?`M`:`L`,e[0],e[1]]).concat([[`Z`]])},FW=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},IW=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.hullMemberIds=[],this.drawHull=()=>{if(!this.shape)this.shape=new xT({style:this.getHullStyle()}),this.context.canvas.appendChild(this.shape);else{let e=!Gu(this.optionsCache,this.options);this.shape.update(this.getHullStyle(e))}this.optionsCache=Object.assign({},this.options)},this.updateHullPath=e=>{this.shape&&this.options.members.includes(Q(e.data))&&this.shape.update({d:this.getHullPath(!0)})},this.getHullPath=(e=!1)=>{let{graph:t}=this.context,n=this.getMember();if(n.length===0)return``;let r=n.map(e=>t.getNodeData(e)),i=EW(r.map(aw),this.options.concavity).slice(1).reverse(),a=i.flatMap(e=>r.filter(t=>Gu(aw(t),e)).map(Q));return Gu(a,this.hullMemberIds)&&!e?this.path:(this.hullMemberIds=a,this.path=kW(i,this.getPadding(),this.options.corner),this.path)},this.bindEvents()}bindEvents(){this.context.graph.on(Z.AFTER_RENDER,this.drawHull),this.context.graph.on(Z.AFTER_ELEMENT_UPDATE,this.updateHullPath)}unbindEvents(){this.context.graph.off(Z.AFTER_RENDER,this.drawHull),this.context.graph.off(Z.AFTER_ELEMENT_UPDATE,this.updateHullPath)}getHullStyle(e){let t=this.options,{members:n,padding:r,corner:i}=t,a=FW(t,[`members`,`padding`,`corner`]);return Object.assign(Object.assign({},a),{d:this.getHullPath(e)})}getPadding(){let{graph:e}=this.context;return this.hullMemberIds.reduce((t,n)=>{let{halfExtents:r}=e.getElementRenderBounds(n),i=Math.max(r[0],r[1]);return Math.max(t,i)},0)+this.options.padding}addMember(e){let t=Array.isArray(e)?e:[e];this.options.members=[...new Set([...this.options.members,...t])],this.shape.update({d:this.getHullPath()})}removeMember(e){let t=Array.isArray(e)?e:[e];this.options.members=this.options.members.filter(e=>!t.includes(e)),t.some(e=>this.hullMemberIds.includes(e))&&this.shape.update({d:this.getHullPath()})}updateMember(e){this.options.members=W(e)?e(this.options.members):e,this.shape.update(this.getHullStyle(!0))}getMember(){return this.options.members}destroy(){this.unbindEvents(),this.shape.destroy(),this.hullMemberIds=[],super.destroy()}};IW.defaultOptions={members:[],padding:10,corner:`rounded`,concavity:1/0,fill:`lightblue`,fillOpacity:.2,labelOpacity:1,stroke:`blue`,strokeOpacity:.2};function LW(e,t){t(e),e.children&&e.children.forEach(function(e){e&&LW(e,t)})}function RW(e){BW(e,!0)}function zW(e){BW(e,!1)}function BW(e,t){var n=t?`visible`:`hidden`;LW(e,function(e){e.attr(`visibility`,n)})}var VW=function(e){Qt(t,e);function t(){var t=[...arguments],n=e.apply(this,z([],R(t),!1))||this;return n.isMutationObserved=!0,n.addEventListener(Nv.INSERTED,function(){zW(n)}),n}return t}(Ny);function HW(e){var t=e.appendChild(new VW({class:`offscreen`}));return zW(t),t}function UW(e){for(var t=e;t;){if(t.className===`offscreen`)return!0;t=t.parent}return!1}var WW=function(e){Qt(t,e);function t(t){t===void 0&&(t={});var n=t.style,r=$t(t,[`style`]);return e.call(this,L({style:L({text:``,fill:`black`,fontFamily:`sans-serif`,fontSize:16,fontStyle:`normal`,fontVariant:`normal`,fontWeight:`normal`,lineWidth:1,textAlign:`start`,textBaseline:`middle`},n)},r))||this}return Object.defineProperty(t.prototype,`offscreenGroup`,{get:function(){return this._offscreen||=HW(this),this._offscreen},enumerable:!1,configurable:!0}),t.prototype.disconnectedCallback=function(){var e;(e=this._offscreen)==null||e.destroy()},t}(qy);function GW(e){return e*Math.PI/180}function KW(e){return Number((e*180/Math.PI).toPrecision(5))}var qW=function(){function e(e,t,n,r){e===void 0&&(e=0),t===void 0&&(t=0),n===void 0&&(n=0),r===void 0&&(r=0),this.x=0,this.y=0,this.width=0,this.height=0,this.x=e,this.y=t,this.width=n,this.height=r}return Object.defineProperty(e.prototype,`bottom`,{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`left`,{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`right`,{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`top`,{get:function(){return this.y},enumerable:!1,configurable:!0}),e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,right:this.right,bottom:this.bottom,left:this.left}},e.prototype.isPointIn=function(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom},e}();function JW(e,t){return W(e)?e.apply(void 0,z([],R(t),!1)):e}var YW=function(e,t){var n=function(e){return`${t}-${e}`},r=Object.fromEntries(Object.entries(e).map(function(e){var t=R(e,2),r=t[0],i=t[1],a=n(i);return[r,{name:a,class:`.${a}`,id:`#${a}`,toString:function(){return a}}]}));return Object.assign(r,{prefix:n}),r},XW=5,ZW=function(e,t,n,r){n===void 0&&(n=0),r===void 0&&(r=XW),Object.entries(t).forEach(function(i){var a=R(i,2),o=a[0],s=a[1],c=e;Object.prototype.hasOwnProperty.call(t,o)&&(s?Ql(s)?(Ql(e[o])||(c[o]={}),n<r?ZW(e[o],s,n+1,r):c[o]=t[o]):Gl(s)?(c[o]=[],c[o]=c[o].concat(s)):c[o]=s:c[o]=s)})},QW=function(e){for(var t=[...arguments].slice(1),n=0;n<t.length;n+=1)ZW(e,t[n]);return e},$W=function(e){return e!==void 0&&e!=null&&!Number.isNaN(e)},eG,tG,nG=Iu(function(e,t){var n=t.fontSize,r=t.fontFamily,i=t.fontWeight,a=t.fontStyle,o=t.fontVariant;return tG?tG(e,n):(eG||=Y.offscreenCanvasCreator.getOrCreateContext(void 0),eG.font=[a,o,i,`${n}px`,r].join(` `),eG.measureText(e).width)},function(e,t){return[e,Object.values(t||rG(e)).join()].join(``)},4096),rG=function(e){var t=e.style.fontFamily||`sans-serif`,n=e.style.fontWeight||`normal`,r=e.style.fontStyle||`normal`,i=e.style.fontVariant,a=e.style.fontSize;return a=typeof a==`object`?a.value:a,{fontSize:a,fontFamily:t,fontWeight:n,fontStyle:r,fontVariant:i}};function iG(e){return e.nodeName===`text`?e:e.nodeName===`g`&&e.children.length===1&&e.children[0].nodeName===`text`?e.children[0]:null}function aG(e,t){var n=iG(e);n&&n.attr(t)}function oG(e,t,n){n===void 0&&(n=`...`),aG(e,{wordWrap:!0,wordWrapWidth:t,maxLines:1,textOverflow:n})}function sG(e,t,n,r){n===void 0&&(n=2),r===void 0&&(r=`top`),aG(e,{wordWrap:!0,wordWrapWidth:t,maxLines:n,textBaseline:r})}function cG(e){var t=e.canvas,n=e.touches,r=e.offsetX,i=e.offsetY;if(t){var a=t.x,o=t.y;return[a,o]}if(n){var s=n[0],c=s.clientX,l=s.clientY;return[c,l]}return r&&i?[r,i]:[0,0]}function lG(e){return typeof e==`function`?e():ru(e)||G(e)?new WW({style:{text:String(e)}}):e}function uG(e,t){return typeof e==`function`?e():ru(e)||G(e)?new Fy({style:L(L({},t),{innerHTML:String(e)})}):e}function dG(e,t){return e.reduce(function(e,n){return(e[n[t]]=e[n[t]]||[]).push(n),e},{})}function fG(e,t,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=function(e){e.node().removeChildren()}),e?n(t):(r&&i(t),null)}function pG(e,t,n,r,i){return r===void 0&&(r=!0),i===void 0&&(i=!1),r&&e===t||i&&e===n?!0:e>t&&e<n}var mG=function(e,t){return function(n){return e*(1-n)+t*n}};function hG(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0;return function(i){var a=Array(r),o=Array(n),s=0;for(s=0;s<r;++s)a[s]=_G(e[s],t[s]);for(;s<n;++s)o[s]=t[s];for(s=0;s<r;++s)o[s]=a[s](i);return o}}function gG(e,t){e===void 0&&(e={}),t===void 0&&(t={});var n={},r={};return Object.entries(t).forEach(function(t){var i=R(t,2),a=i[0],o=i[1];a in e?n[a]=_G(e[a],o):r[a]=o}),function(e){return Object.entries(n).forEach(function(t){var n=R(t,2),i=n[0],a=n[1];return r[i]=a(e)}),r}}function _G(e,t){return typeof e==`number`&&typeof t==`number`?mG(e,t):Array.isArray(e)&&Array.isArray(t)?hG(e,t):typeof e==`object`&&typeof t==`object`?gG(e,t):(function(t){return e})}function vG(e,t,n,r){if(!r)return e.attr(`__keyframe_data__`,n),null;var i=r.duration,a=i===void 0?0:i,o=_G(t,n),s=Math.ceil(a/16),c=Array(s).fill(0).map(function(e,t,n){return{__keyframe_data__:o(t/(n.length-1))}});return e.animate(c,L({fill:`both`},r))}function yG(e,t){return[e[0]*t,e[1]*t]}function bG(e,t){return[e[0]+t[0],e[1]+t[1]]}function xG(e,t){return[e[0]-t[0],e[1]-t[1]]}function SG(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1])]}function CG(e,t){return[Math.max(e[0],t[0]),Math.max(e[1],t[1])]}function wG(e,t){return Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2)}function TG(e){if(e[0]===0&&e[1]===0)return[0,0];var t=Math.sqrt(e[0]**2+e[1]**2);return[e[0]/t,e[1]/t]}function EG(e,t){return t?[e[1],-e[0]]:[-e[1],e[0]]}function DG(e,t){return+e.toPrecision(t)}function OG(e,t){var n={},r=Array.isArray(t)?t:[t];for(var i in e)r.includes(i)||(n[i]=e[i]);return n}function kG(e,t,n,r){var i,a=[],o=!!r,s,c,l=[1/0,1/0],u=[-1/0,-1/0],d,f,p;if(o){i=R(r,2),l=i[0],u=i[1];for(var m=0,h=e.length;m<h;m+=1){var g=e[m];l=SG(l,g),u=CG(u,g)}}for(var m=0,_=e.length;m<_;m+=1){var g=e[m];if(m===0&&!n)p=g;else if(m===_-1&&!n)f=g,a.push(p),a.push(f);else{var v=[m?m-1:_-1,m-1][n?0:1];s=e[v],c=e[n?(m+1)%_:m+1];var y=[0,0];y=xG(c,s),y=yG(y,t);var b=wG(g,s),x=wG(g,c),S=b+x;S!==0&&(b/=S,x/=S);var C=yG(y,-b),w=yG(y,x);f=bG(g,C),d=bG(g,w),d=SG(d,CG(c,g)),d=CG(d,SG(c,g)),C=xG(d,g),C=yG(C,-b/x),f=bG(g,C),f=SG(f,CG(s,g)),f=CG(f,SG(s,g)),w=xG(g,f),w=yG(w,x/b),d=bG(g,w),o&&(f=CG(f,l),f=SG(f,u),d=CG(d,l),d=SG(d,u)),a.push(p),a.push(f),p=d}}return n&&a.push(a.shift()),a}function AG(e,t,n){var r;t===void 0&&(t=!1),n===void 0&&(n=[[0,0],[1,1]]);for(var i=!!t,a=[],o=0,s=e.length;o<s;o+=2)a.push([e[o],e[o+1]]);for(var c=kG(a,.4,i,n),l=a.length,u=[],d,f,p,o=0;o<l-1;o+=1)d=c[o*2],f=c[o*2+1],p=a[o+1],u.push([`C`,d[0],d[1],f[0],f[1],p[0],p[1]]);return i&&(d=c[l],f=c[l+1],r=R(a,1),p=r[0],u.push([`C`,d[0],d[1],f[0],f[1],p[0],p[1]])),u}var jG=`$el.cx.cy.d.dx.dy.fill.fillOpacity.filter.fontFamily.fontSize.fontStyle.fontVariant.fontWeight.height.img.increasedLineWidthForHitTesting.innerHTML.isBillboard.billboardRotation.isSizeAttenuation.isClosed.isOverflowing.leading.letterSpacing.lineDash.lineHeight.lineWidth.markerEnd.markerEndOffset.markerMid.markerStart.markerStartOffset.maxLines.metrics.miterLimit.offsetX.offsetY.opacity.path.points.r.radius.rx.ry.shadowColor.src.stroke.strokeOpacity.text.textAlign.textBaseline.textDecorationColor.textDecorationLine.textDecorationStyle.textOverflow.textPath.textPathSide.textPathStartOffset.transform.transformOrigin.visibility.width.wordWrap.wordWrapWidth.x.x1.x2.y.y1.y2.z1.z2.zIndex`.split(`.`);function MG(e){return jG.includes(e)}function NG(e){var t={};for(var n in e)MG(n)&&(t[n]=e[n]);return t}function PG(e,t){if(e.length<=t)return e;for(var n=Math.floor(e.length/t),r=[],i=0;i<e.length;i+=n)r.push(e[i]);return r}function FG(e,t,n){n===void 0&&(n=!1);var r=e.getBBox(),i=r.width,a=r.height,o=t/Math.max(i,a);return n&&(e.style.transform=`scale(${o})`),o}function IG(e,t){var n=new Map;return e.forEach(function(e){var r=t(e);n.has(r)||n.set(r,[]),n.get(r).push(e)}),n}function LG(e){throw Error(e)}var RG=function(){function e(e,n,r,i,a,o,s){e===void 0&&(e=null),n===void 0&&(n=null),r===void 0&&(r=null),i===void 0&&(i=null),a===void 0&&(a=[null,null,null,null,null]),o===void 0&&(o=[]),s===void 0&&(s=[]),t.add(this),this._elements=Array.from(e),this._data=n,this._parent=r,this._document=i,this._enter=a[0],this._update=a[1],this._exit=a[2],this._merge=a[3],this._split=a[4],this._transitions=o,this._facetElements=s}e.prototype.selectAll=function(e){var t=typeof e==`string`?this._parent.querySelectorAll(e):e;return new n(t,null,this._elements[0],this._document)},e.prototype.selectFacetAll=function(e){var t=typeof e==`string`?this._parent.querySelectorAll(e):e;return new n(this._elements,null,this._parent,this._document,void 0,void 0,t)},e.prototype.select=function(e){var t=typeof e==`string`?this._parent.querySelectorAll(e)[0]||null:e;return new n([t],null,t,this._document)},e.prototype.append=function(e){var t=this,r=typeof e==`function`?e:function(){return t.createElement(e)},i=[];if(this._data!==null){for(var a=0;a<this._data.length;a++){var o=this._data[a],s=R(Array.isArray(o)?o:[o,null],2),c=s[0],l=s[1],u=r(c,a);u.__data__=c,l!==null&&(u.__fromElements__=l),this._parent.appendChild(u),i.push(u)}return new n(i,null,this._parent,this._document)}for(var a=0;a<this._elements.length;a++){var d=this._elements[a],c=d.__data__,u=r(c,a);d.appendChild(u),i.push(u)}return new n(i,null,i[0],this._document)},e.prototype.maybeAppend=function(e,n){var i=rn(this,t,`m`,r).call(this,e[0]===`#`?e:`#${e}`,n);return i.attr(`id`,e),i},e.prototype.maybeAppendByClassName=function(e,n){var i=e.toString(),a=rn(this,t,`m`,r).call(this,i[0]===`.`?i:`.${i}`,n);return a.attr(`className`,i),a},e.prototype.maybeAppendByName=function(e,n){var i=rn(this,t,`m`,r).call(this,`[name="${e}"]`,n);return i.attr(`name`,e),i},e.prototype.data=function(e,t,r){var i,a;t===void 0&&(t=function(e){return e}),r===void 0&&(r=function(){return null});for(var o=[],s=[],c=new Set(this._elements),l=[],u=new Set,d=new Map(this._elements.map(function(e,n){return[t(e.__data__,n),e]})),f=new Map(this._facetElements.map(function(e,n){return[t(e.__data__,n),e]})),p=IG(this._elements,function(e){return r(e.__data__)}),m=0;m<e.length;m++){var h=e[m],g=t(h,m),_=r(h,m);if(d.has(g)){var v=d.get(g);v.__data__=h,v.__facet__=!1,s.push(v),c.delete(v),d.delete(g)}else if(f.has(g)){var v=f.get(g);v.__data__=h,v.__facet__=!0,s.push(v),f.delete(g)}else if(p.has(g)){var y=p.get(g);l.push([h,y]);try{for(var b=(i=void 0,tn(y)),x=b.next();!x.done;x=b.next()){var v=x.value;c.delete(v)}}catch(e){i={error:e}}finally{try{x&&!x.done&&(a=b.return)&&a.call(b)}finally{if(i)throw i.error}}p.delete(g)}else if(d.has(_)){var v=d.get(_);v.__toData__?v.__toData__.push(h):v.__toData__=[h],u.add(v),c.delete(v)}else o.push(h)}var S=[new n([],o,this._parent,this._document),new n(s,null,this._parent,this._document),new n(c,null,this._parent,this._document),new n([],l,this._parent,this._document),new n(u,null,this._parent,this._document)];return new n(this._elements,null,this._parent,this._document,S)},e.prototype.merge=function(e){var t=z(z([],R(this._elements),!1),R(e._elements),!1),r=z(z([],R(this._transitions),!1),R(e._transitions),!1);return new n(t,null,this._parent,this._document,void 0,r)},e.prototype.createElement=function(e){if(this._document)return this._document.createElement(e,{});var t=n.registry[e];return t?new t:LG(`Unknown node type: ${e}`)},e.prototype.join=function(e,t,n,r,i){e===void 0&&(e=function(e){return e}),t===void 0&&(t=function(e){return e}),n===void 0&&(n=function(e){return e.remove()}),r===void 0&&(r=function(e){return e}),i===void 0&&(i=function(e){return e.remove()});var a=e(this._enter),o=t(this._update),s=n(this._exit),c=r(this._merge),l=i(this._split);return o.merge(a).merge(s).merge(c).merge(l)},e.prototype.remove=function(){for(var e=function(e){var n=t._elements[e],r=t._transitions[e];r?r.then(function(){return n.remove()}):n.remove()},t=this,r=0;r<this._elements.length;r++)e(r);return new n([],null,this._parent,this._document,void 0,this._transitions)},e.prototype.each=function(e){for(var t=0;t<this._elements.length;t++){var n=this._elements[t],r=n.__data__;e.call(n,r,t)}return this},e.prototype.attr=function(e,t){var n=typeof t==`function`?t:function(){return t};return this.each(function(r,i){t!==void 0&&(this[e]=n.call(this,r,i))})},e.prototype.style=function(e,t,n){n===void 0&&(n=!0);var r=typeof t!=`function`||!n?function(){return t}:t;return this.each(function(n,i){t!==void 0&&(this.style[e]=r.call(this,n,i))})},e.prototype.styles=function(e,t){return e===void 0&&(e={}),t===void 0&&(t=!0),this.each(function(n,r){var i=this;Object.entries(e).forEach(function(e){var a=R(e,2),o=a[0],s=a[1],c=typeof s!=`function`||!t?function(){return s}:s;s!==void 0&&i.attr(o,c.call(i,n,r))})})},e.prototype.update=function(e,t){t===void 0&&(t=!0);var n=typeof e!=`function`||!t?function(){return e}:e;return this.each(function(t,r){e&&this.update&&this.update(n.call(this,t,r))})},e.prototype.maybeUpdate=function(e,t){t===void 0&&(t=!0);var n=typeof e!=`function`||!t?function(){return e}:e;return this.each(function(t,r){e&&this.update&&this.update(n.call(this,t,r))})},e.prototype.transition=function(e){this._transitions;var t=Array(this._elements.length);return this.each(function(n,r){t[r]=e.call(this,n,r)}),this._transitions=$l(t),this},e.prototype.on=function(e,t){return this.each(function(){this.addEventListener(e,t)}),this},e.prototype.call=function(e){var t=[...arguments].slice(1);return e.call.apply(e,z([this._parent,this],R(t),!1)),this},e.prototype.node=function(){return this._elements[0]},e.prototype.nodes=function(){return this._elements},e.prototype.transitions=function(){return this._transitions.filter(function(e){return!!e})},e.prototype.parent=function(){return this._parent};var t,n=e,r;return t=new WeakSet,r=function(e,t){var r=this._elements[0],i=r.querySelector(e);if(i)return new n([i],null,this._parent,this._document);var a=typeof t==`string`?this.createElement(t):t();return r.appendChild(a),new n([a],null,this._parent,this._document)},e.registry={g:Ny,rect:Gy,circle:Oy,path:By,text:WW,ellipse:jy,image:Iy,line:Ry,polygon:Hy,polyline:Wy,html:Fy},e}();function $(e){return new RG([e],null,e,e.ownerDocument)}function zG(e,t,n){return e.querySelector(t)?$(e).select(t):$(e).append(n)}function BG(e){if(G(e))return[e,e,e,e];if(Gl(e)){var t=e.length;if(t===1)return[e[0],e[0],e[0],e[0]];if(t===2)return[e[0],e[1],e[0],e[1]];if(t===3)return[e[0],e[1],e[2],e[1]];if(t===4)return e}return[0,0,0,0]}function VG(e){var t=e.getLocalBounds(),n=t.min,r=t.max,i=R([n,r],2),a=R(i[0],2),o=a[0],s=a[1],c=R(i[1],2),l=c[0],u=c[1];return{x:o,y:s,width:l-o,height:u-s,left:o,bottom:u,top:s,right:l}}function HG(e,t){var n=R(e,2),r=n[0],i=n[1],a=R(t,2),o=a[0],s=a[1];return r!==o&&i===s}function UG(e,t){var n,r,i=t.attributes;try{for(var a=tn(Object.entries(i)),o=a.next();!o.done;o=a.next()){var s=R(o.value,2),c=s[0],l=s[1];c!==`id`&&c!==`className`&&e.attr(c,l)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}function WG(e){return e.toString().charAt(0).toUpperCase()+e.toString().slice(1)}function GG(e){return e.toString().charAt(0).toLowerCase()+e.toString().slice(1)}function KG(e,t){return`${t}${WG(e)}`}function qG(e,t,n){n===void 0&&(n=!0);var r=t||e.match(/^([a-z][a-z0-9]+)/)?.[0]||``,i=e.replace(RegExp(`^(${r})`),``);return n?GG(i):i}function JG(e,t){Object.entries(t).forEach(function(t){var n=R(t,2),r=n[0],i=n[1];z([e],R(e.querySelectorAll(r)),!1).filter(function(e){return e.matches(r)}).forEach(function(e){if(e){var t=e;t.style.cssText+=Object.entries(i).reduce(function(e,t){return`${e}${t.join(`:`)};`},``)}})})}var YG=function(e,t){if(!e?.startsWith(t))return!1;var n=e[t.length];return n>=`A`&&n<=`Z`};function XG(e,t,n){n===void 0&&(n=!1);var r={};return Object.entries(e).forEach(function(e){var i=R(e,2),a=i[0],o=i[1];if(!(a===`className`||a===`class`)){if(YG(a,`show`)&&YG(qG(a,`show`),t)!==n)a===KG(t,`show`)?r[a]=o:r[a.replace(new RegExp(WG(t)),``)]=o;else if(!YG(a,`show`)&&YG(a,t)!==n){var s=qG(a,t);s===`filter`&&typeof o==`function`||(r[s]=o)}}}),r}function ZG(e,t){return Object.entries(e).reduce(function(e,n){var r=R(n,2),i=r[0],a=r[1];return i.startsWith(`show`)?e[`show${t}${i.slice(4)}`]=a:e[`${t}${WG(i)}`]=a,e},{})}function QG(e,t){t===void 0&&(t=[`x`,`y`,`class`,`className`]);var n=[`transform`,`transformOrigin`,`anchor`,`visibility`,`pointerEvents`,`zIndex`,`cursor`,`clipPath`,`clipPathTargets`,`offsetPath`,`offsetPathTargets`,`offsetDistance`,`draggable`,`droppable`],r={},i={};return Object.entries(e).forEach(function(e){var a=R(e,2),o=a[0],s=a[1];t.includes(o)||(n.indexOf(o)===-1?r[o]=s:i[o]=s)}),[r,i]}function $G(e,t){var n={YYYY:e.getFullYear(),MM:e.getMonth()+1,DD:e.getDate(),HH:e.getHours(),mm:e.getMinutes(),ss:e.getSeconds()},r=t;return Object.keys(n).forEach(function(e){var t=n[e];r=r.replace(e,e===`YYYY`?`${t}`:`${t}`.padStart(2,`0`))}),r}function eK(e,t,n){var r=e.getBBox(),i=r.width,a=r.height,o=R([t,n].map(function(e,t){return e.includes(`%`)?parseFloat(e.match(/[+-]?([0-9]*[.])?[0-9]+/)?.[0]||`0`)/100*(t===0?i:a):e}),2),s=o[0],c=o[1];return[s,c]}function tK(e,t){if(t)try{var n=t.replace(/translate\(([+-]*[\d]+[%]*),[ ]*([+-]*[\d]+[%]*)\)/g,function(t,n,r){return`translate(${eK(e,n,r)})`});e.attr(`transform`,n)}catch{}}function nK(e){return e[0]?.map(function(t,n){return e.map(function(e){return e[n]})})||[]}var rK=function(e,t){if(t==null){e.innerHTML=``;return}e.replaceChildren?Array.isArray(t)?e.replaceChildren.apply(e,z([],R(t),!1)):e.replaceChildren(t):(e.innerHTML=``,Array.isArray(t)?t.forEach(function(t){return e.appendChild(t)}):e.appendChild(t))};function iK(e){return/\S+-\S+/g.test(e)?e.split(`-`).map(function(e){return e[0]}):e.length>2?[e[0]]:e.split(``)}var aK=function(e){var t=new DOMParser().parseFromString(e,`text/html`).body.firstElementChild;if(console.log(t?.getClientRects(),11),!t)return 0;var n=t.getAttribute(`style`)||``,r=Object.fromEntries(n.split(`;`).map(function(e){return e.trim()}).filter(function(e){return e.includes(`:`)}).map(function(e){var t=R(e.split(`:`).map(function(e){return e.trim()}),2),n=t[0],r=t[1];return[n.toLowerCase(),r]})),i=function(e){if(!e)return 0;var t=e.match(/([\d.]+)px/);return t?parseFloat(t[1]):0};if(r.height)return i(r.height);var a=i(r[`font-size`])||16,o=r[`line-height`],s=!o||o===`normal`?1.2*a:o.endsWith(`px`)?i(o):/^[\d.]+$/.test(o)?parseFloat(o)*a:a,c=i(r[`padding-top`]),l=i(r[`padding-bottom`]);if(r.padding){var u=r.padding.split(/\s+/).map(i);u.length===1||u.length===2?(c=u[0],l=u[0]):(u.length===3||u.length===4)&&(c=u[0],l=u[2])}var d=i(r[`border-top-width`]),f=i(r[`border-bottom-width`]);if(r.border){var p=r.border.match(/([\d.]+)px/);p&&(d=parseFloat(p[1]),f=parseFloat(p[1]))}if(r[`border-width`]){var u=r[`border-width`].split(/\s+/).map(i);u.length===1||u.length===2?(d=u[0],f=u[0]):(u.length===3||u.length===4)&&(d=u[0],f=u[2])}return s+c+l+d+f};function oK(){BW(this,this.attributes.visibility!==`hidden`)}var sK=function(e){Qt(t,e);function t(t,n){n===void 0&&(n={});var r=e.call(this,QW({},{style:n},t))||this;return r.initialized=!1,r._defaultOptions=n,r}return Object.defineProperty(t.prototype,`offscreenGroup`,{get:function(){return this._offscreen||=HW(this),this._offscreen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`defaultOptions`,{get:function(){return this._defaultOptions},enumerable:!1,configurable:!0}),t.prototype.connectedCallback=function(){this.render(this.attributes,this),this.bindEvents(this.attributes,this),this.initialized=!0},t.prototype.disconnectedCallback=function(){var e;(e=this._offscreen)==null||e.destroy()},t.prototype.attributeChangedCallback=function(e){e===`visibility`&&oK.call(this)},t.prototype.update=function(e,t){return this.attr(QW({},this.attributes,e||{})),this.render?.call(this,this.attributes,this,t)},t.prototype.clear=function(){this.removeChildren()},t.prototype.bindEvents=function(e,t){},t.prototype.getSubShapeStyle=function(e){return e.x,e.y,e.transform,e.transformOrigin,e.class,e.className,e.zIndex,$t(e,[`x`,`y`,`transform`,`transformOrigin`,`class`,`className`,`zIndex`])},t}(Ay),cK=function(e,t,n){return[[`M`,e-n,t],[`A`,n,n,0,1,0,e+n,t],[`A`,n,n,0,1,0,e-n,t],[`Z`]]},lK=cK,uK=function(e,t,n){return[[`M`,e-n,t-n],[`L`,e+n,t-n],[`L`,e+n,t+n],[`L`,e-n,t+n],[`Z`]]},dK=function(e,t,n){return[[`M`,e-n,t],[`L`,e,t-n],[`L`,e+n,t],[`L`,e,t+n],[`Z`]]},fK=function(e,t,n){var r=n*Math.sin(1/3*Math.PI);return[[`M`,e-n,t+r],[`L`,e,t-r],[`L`,e+n,t+r],[`Z`]]},pK=function(e,t,n){var r=n*Math.sin(1/3*Math.PI);return[[`M`,e-n,t-r],[`L`,e+n,t-r],[`L`,e,t+r],[`Z`]]},mK=function(e,t,n){var r=n/2*Math.sqrt(3);return[[`M`,e,t-n],[`L`,e+r,t-n/2],[`L`,e+r,t+n/2],[`L`,e,t+n],[`L`,e-r,t+n/2],[`L`,e-r,t-n/2],[`Z`]]},hK=function(e,t,n){var r=n-1.5;return[[`M`,e-n,t-r],[`L`,e+n,t+r],[`L`,e+n,t-r],[`L`,e-n,t+r],[`Z`]]},gK=function(e,t,n){return[[`M`,e,t+n],[`L`,e,t-n]]},_K=function(e,t,n){return[[`M`,e-n,t-n],[`L`,e+n,t+n],[`M`,e+n,t-n],[`L`,e-n,t+n]]},vK=function(e,t,n){return[[`M`,e-n/2,t-n],[`L`,e+n/2,t-n],[`M`,e,t-n],[`L`,e,t+n],[`M`,e-n/2,t+n],[`L`,e+n/2,t+n]]},yK=function(e,t,n){return[[`M`,e-n,t],[`L`,e+n,t],[`M`,e,t-n],[`L`,e,t+n]]},bK=function(e,t,n){return[[`M`,e-n,t],[`L`,e+n,t]]},xK=function(e,t,n){return[[`M`,e-n,t],[`L`,e+n,t]]},SK=xK,CK=function(e,t,n){return[[`M`,e-n,t],[`A`,n/2,n/2,0,1,1,e,t],[`A`,n/2,n/2,0,1,0,e+n,t]]},wK=function(e,t,n){return[[`M`,e-n-1,t-2.5],[`L`,e,t-2.5],[`L`,e,t+2.5],[`L`,e+n+1,t+2.5]]},TK=function(e,t,n){return[[`M`,e-n-1,t+2.5],[`L`,e,t+2.5],[`L`,e,t-2.5],[`L`,e+n+1,t-2.5]]},EK=function(e,t,n){return[[`M`,e-(n+1),t+2.5],[`L`,e-n/2,t+2.5],[`L`,e-n/2,t-2.5],[`L`,e+n/2,t-2.5],[`L`,e+n/2,t+2.5],[`L`,e+n+1,t+2.5]]};function DK(e,t){return[[`M`,e-5,t+2.5],[`L`,e-5,t],[`L`,e,t],[`L`,e,t-3],[`L`,e,t+3],[`L`,e+6.5,t+3]]}var OK=function(e,t,n){return[[`M`,e-n,t-n],[`L`,e+n,t],[`L`,e-n,t+n],[`Z`]]},kK=function(e,t,n){var r=n,i=n*.2,a=n*.7;return[[`M`,e-r,t],[`A`,r,r,0,1,0,e+r,t],[`A`,r,r,0,1,0,e-r,t],[`Z`],[`M`,e-a,t],[`L`,e-i,t],[`M`,e+i,t],[`L`,e+a,t],[`M`,e,t-a],[`L`,e,t-i],[`M`,e,t+i],[`L`,e,t+a]]};function AK(e){var t=`default`;if(Kl(e)&&e instanceof Image)t=`image`;else if(W(e))t=`symbol`;else if(ru(e)){var n=RegExp(`data:(image|text)`);t=e.match(n)?`base64`:/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)?`url`:`symbol`}return t}function jK(e){var t=AK(e);return[`base64`,`url`,`image`].includes(t)?`image`:e&&t===`symbol`?`path`:null}var MK=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(e,n){var r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a,s=this.getSubShapeStyle(e),c=s.symbol,l=s.size,u=l===void 0?16:l,d=$t(s,[`symbol`,`size`]),f=jK(c);fG(!!f,$(n),function(e){e.maybeAppendByClassName(`marker`,f).attr(`className`,`marker ${f}-marker`).call(function(e){if(f===`image`){var n=u*2;e.styles({img:c,width:n,height:n,x:i-u,y:o-u})}else{var n=u/2,r=W(c)?c:t.getSymbol(c);e.styles(L({d:r?.(i,o,n)},d))}})})},t.MARKER_SYMBOL_MAP=new Map,t.registerSymbol=function(e,n){t.MARKER_SYMBOL_MAP.set(e,n)},t.getSymbol=function(e){return t.MARKER_SYMBOL_MAP.get(e)},t.getSymbols=function(){return Array.from(t.MARKER_SYMBOL_MAP.keys())},t}(sK);MK.registerSymbol(`cross`,_K),MK.registerSymbol(`hyphen`,bK),MK.registerSymbol(`line`,gK),MK.registerSymbol(`plus`,yK),MK.registerSymbol(`tick`,vK),MK.registerSymbol(`circle`,cK),MK.registerSymbol(`point`,lK),MK.registerSymbol(`bowtie`,hK),MK.registerSymbol(`hexagon`,mK),MK.registerSymbol(`square`,uK),MK.registerSymbol(`diamond`,dK),MK.registerSymbol(`triangle`,fK),MK.registerSymbol(`triangle-down`,pK),MK.registerSymbol(`line`,gK),MK.registerSymbol(`dot`,xK),MK.registerSymbol(`dash`,SK),MK.registerSymbol(`smooth`,CK),MK.registerSymbol(`hv`,wK),MK.registerSymbol(`vh`,TK),MK.registerSymbol(`hvh`,EK),MK.registerSymbol(`vhv`,DK),MK.registerSymbol(`focus`,kK);function NK(e,...t){return t.reduce((e,t)=>n=>e(t(n)),e)}function PK(e,t){return t-e?n=>(n-e)/(t-e):e=>.5}function FK(e,t){let n=t<e?t:e,r=e>t?e:t;return e=>Math.min(Math.max(n,e),r)}function IK(e,t,n,r,i){let a=n||0,o=r||e.length,s=i||(e=>e);for(;a<o;){let n=Math.floor((a+o)/2);s(e[n])>t?o=n:a=n+1}return a}var LK=Math.sqrt(50),RK=Math.sqrt(10),zK=Math.sqrt(2);function BK(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/10**i;return i>=0?(a>=LK?10:a>=RK?5:a>=zK?2:1)*10**i:-(10**-i)/(a>=LK?10:a>=RK?5:a>=zK?2:1)}const VK=(e,t,n=5)=>{let r=[e,t],i=0,a=r.length-1,o=r[i],s=r[a],c;return s<o&&([o,s]=[s,o],[i,a]=[a,i]),c=BK(o,s,n),c>0?(o=Math.floor(o/c)*c,s=Math.ceil(s/c)*c,c=BK(o,s,n)):c<0&&(o=Math.ceil(o*c)/c,s=Math.floor(s*c)/c,c=BK(o,s,n)),c>0?(r[i]=Math.floor(o/c)*c,r[a]=Math.ceil(s/c)*c):c<0&&(r[i]=Math.ceil(o*c)/c,r[a]=Math.floor(s*c)/c),r};function HK(e){return!Eu(e)&&!Cu(e)&&!Number.isNaN(e)}var UK=t(Vn());function WK(e,t,n){let r=n;return r<0&&(r+=1),r>1&&--r,r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function GK(e){let t=e[0]/360,n=e[1]/100,r=e[2]/100,i=e[3];if(n===0)return[r*255,r*255,r*255,i];let a=r<.5?r*(1+n):r+n-r*n,o=2*r-a,s=WK(o,a,t+1/3),c=WK(o,a,t),l=WK(o,a,t-1/3);return[s*255,c*255,l*255,i]}function KK(e){let t=UK.default.get(e);if(!t)return null;let{model:n,value:r}=t;return n===`rgb`?r:n===`hsl`?GK(r):null}const qK=(e,t)=>n=>e*(1-n)+t*n,JK=(e,t)=>{let n=KK(e),r=KK(t);return n===null||r===null?n?()=>e:()=>t:e=>{let t=[,,,,];for(let i=0;i<4;i+=1){let a=n[i],o=r[i];t[i]=a*(1-e)+o*e}let[i,a,o,s]=t;return`rgba(${Math.round(i)}, ${Math.round(a)}, ${Math.round(o)}, ${s})`}},YK=(e,t)=>typeof e==`number`&&typeof t==`number`?qK(e,t):typeof e==`string`&&typeof t==`string`?JK(e,t):()=>e,XK=(e,t)=>{let n=qK(e,t);return e=>Math.round(n(e))};function ZK({map:e,initKey:t},n){let r=t(n);return e.has(r)?e.get(r):n}function QK({map:e,initKey:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function $K({map:e,initKey:t},n){let r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function eq(e){return typeof e==`object`?e.valueOf():e}var tq=class extends Map{constructor(e){if(super(),this.map=new Map,this.initKey=eq,e!==null)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(ZK({map:this.map,initKey:this.initKey},e))}has(e){return super.has(ZK({map:this.map,initKey:this.initKey},e))}set(e,t){return super.set(QK({map:this.map,initKey:this.initKey},e),t)}delete(e){return super.delete($K({map:this.map,initKey:this.initKey},e))}},nq=class{constructor(e){this.options=Bu({},this.getDefaultOptions()),this.update(e)}getOptions(){return this.options}update(e={}){this.options=Bu({},this.options,e),this.rescale(e)}rescale(e){}};const rq=Symbol(`defaultUnknown`);function iq(e,t,n){for(let r=0;r<t.length;r+=1)e.has(t[r])||e.set(n(t[r]),r)}function aq(e){let{value:t,from:n,to:r,mapper:i,notFoundReturn:a}=e,o=i.get(t);if(o===void 0){if(a!==rq)return a;o=n.push(t)-1,i.set(t,o)}return r[o%r.length]}function oq(e){return e instanceof Date?e=>`${e}`:typeof e==`object`?e=>JSON.stringify(e):e=>e}var sq=class e extends nq{getDefaultOptions(){return{domain:[],range:[],unknown:rq}}constructor(e){super(e)}map(e){return this.domainIndexMap.size===0&&iq(this.domainIndexMap,this.getDomain(),this.domainKey),aq({value:this.domainKey(e),mapper:this.domainIndexMap,from:this.getDomain(),to:this.getRange(),notFoundReturn:this.options.unknown})}invert(e){return this.rangeIndexMap.size===0&&iq(this.rangeIndexMap,this.getRange(),this.rangeKey),aq({value:this.rangeKey(e),mapper:this.rangeIndexMap,from:this.getRange(),to:this.getDomain(),notFoundReturn:this.options.unknown})}rescale(e){let[t]=this.options.domain,[n]=this.options.range;if(this.domainKey=oq(t),this.rangeKey=oq(n),!this.rangeIndexMap){this.rangeIndexMap=new Map,this.domainIndexMap=new Map;return}(!e||e.range)&&this.rangeIndexMap.clear(),(!e||e.domain||e.compare)&&(this.domainIndexMap.clear(),this.sortedDomain=void 0)}clone(){return new e(this.options)}getRange(){return this.options.range}getDomain(){if(this.sortedDomain)return this.sortedDomain;let{domain:e,compare:t}=this.options;return this.sortedDomain=t?[...e].sort(t):e,this.sortedDomain}};function cq(e){let t=Math.min(...e);return e.map(e=>e/t)}function lq(e,t){let n=e.length,r=t-n;return r>0?[...e,...Array(r).fill(1)]:r<0?e.slice(0,t):e}function uq(e){return Math.round(e*0xe8d4a51000)/0xe8d4a51000}function dq(e){let{domain:t,range:n,paddingOuter:r,paddingInner:i,flex:a,round:o,align:s}=e,c=t.length,l=lq(a,c),[u,d]=n,f=d-u,p=2/c*r+1-1/c*i,m=f/p,h=m*i/c,g=m-c*h,_=cq(l),v=_.reduce((e,t)=>e+t),y=g/v,b=new tq(t.map((e,t)=>{let n=_[t]*y;return[e,o?Math.floor(n):n]})),x=new tq(t.map((e,t)=>{let n=_[t]*y+h;return[e,o?Math.floor(n):n]})),S=Array.from(x.values()).reduce((e,t)=>e+t),C=(f-(S-S/c*i))*s,w=u+C,T=o?Math.round(w):w,E=Array(c);for(let e=0;e<c;e+=1){E[e]=uq(T);let n=t[e];T+=x.get(n)}return{valueBandWidth:b,valueStep:x,adjustedRange:E}}function fq(e){let{domain:t}=e,n=t.length;if(n===0)return{valueBandWidth:void 0,valueStep:void 0,adjustedRange:[]};if(e.flex?.length)return dq(e);let{range:r,paddingOuter:i,paddingInner:a,round:o,align:s}=e,c,l,u=r[0],d=r[1]-u,f=i*2,p=n-a;c=d/Math.max(1,f+p),o&&(c=Math.floor(c)),u+=(d-c*(n-a))*s,l=c*(1-a),o&&(u=Math.round(u),l=Math.round(l));let m=Array(n).fill(0).map((e,t)=>u+t*c);return{valueStep:c,valueBandWidth:l,adjustedRange:m}}var pq=class e extends sq{getDefaultOptions(){return{domain:[],range:[0,1],align:.5,round:!1,paddingInner:0,paddingOuter:0,padding:0,unknown:rq,flex:[]}}constructor(e){super(e)}clone(){return new e(this.options)}getStep(e){return this.valueStep===void 0?1:typeof this.valueStep==`number`?this.valueStep:e===void 0?Array.from(this.valueStep.values())[0]:this.valueStep.get(e)}getBandWidth(e){return this.valueBandWidth===void 0?1:typeof this.valueBandWidth==`number`?this.valueBandWidth:e===void 0?Array.from(this.valueBandWidth.values())[0]:this.valueBandWidth.get(e)}getRange(){return this.adjustedRange}getPaddingInner(){let{padding:e,paddingInner:t}=this.options;return e>0?e:t}getPaddingOuter(){let{padding:e,paddingOuter:t}=this.options;return e>0?e:t}rescale(){super.rescale();let{align:e,domain:t,range:n,round:r,flex:i}=this.options,{adjustedRange:a,valueBandWidth:o,valueStep:s}=fq({align:e,range:n,round:r,flex:i,paddingInner:this.getPaddingInner(),paddingOuter:this.getPaddingOuter(),domain:t});this.valueStep=s,this.valueBandWidth=o,this.adjustedRange=a}};const mq=(e,t,n)=>{let r,i,a=e,o=t;if(a===o&&n>0)return[a];let s=BK(a,o,n);if(s===0||!Number.isFinite(s))return[];if(s>0){a=Math.ceil(a/s),o=Math.floor(o/s),i=Array(r=Math.ceil(o-a+1));for(let e=0;e<r;e+=1)i[e]=(a+e)*s}else{s=-s,a=Math.ceil(a*s),o=Math.floor(o*s),i=Array(r=Math.ceil(o-a+1));for(let e=0;e<r;e+=1)i[e]=(a+e)/s}return i};var hq=(e,t,n)=>{let[r,i]=e,[a,o]=t,s,c;return r<i?(s=PK(r,i),c=n(a,o)):(s=PK(i,r),c=n(o,a)),NK(c,s)},gq=(e,t,n)=>{let r=Math.min(e.length,t.length)-1,i=Array(r),a=Array(r),o=e[0]>e[r],s=o?[...e].reverse():e,c=o?[...t].reverse():t;for(let e=0;e<r;e+=1)i[e]=PK(s[e],s[e+1]),a[e]=n(c[e],c[e+1]);return t=>{let n=IK(e,t,1,r)-1,o=i[n],s=a[n];return NK(s,o)(t)}},_q=(e,t,n,r)=>(Math.min(e.length,t.length)>2?gq:hq)(e,t,r?XK:n),vq=class extends nq{getDefaultOptions(){return{domain:[0,1],range:[0,1],nice:!1,clamp:!1,round:!1,interpolate:qK,tickCount:5}}map(e){return HK(e)?this.output(e):this.options.unknown}invert(e){return HK(e)?this.input(e):this.options.unknown}nice(){if(!this.options.nice)return;let[e,t,n,...r]=this.getTickMethodOptions();this.options.domain=this.chooseNice()(e,t,n,...r)}getTicks(){let{tickMethod:e}=this.options,[t,n,r,...i]=this.getTickMethodOptions();return e(t,n,r,...i)}getTickMethodOptions(){let{domain:e,tickCount:t}=this.options,n=e[0],r=e[e.length-1];return[n,r,t]}chooseNice(){return VK}rescale(){this.nice();let[e,t]=this.chooseTransforms();this.composeOutput(e,this.chooseClamp(e)),this.composeInput(e,t,this.chooseClamp(t))}chooseClamp(e){let{clamp:t,range:n}=this.options,r=this.options.domain.map(e),i=Math.min(r.length,n.length);return t?FK(r[0],r[i-1]):td}composeOutput(e,t){let{domain:n,range:r,round:i,interpolate:a}=this.options,o=_q(n.map(e),r,a,i);this.output=NK(o,t,e)}composeInput(e,t,n){let{domain:r,range:i}=this.options,a=_q(i,r.map(e),qK);this.input=NK(t,n,a)}},yq=class e extends vq{getDefaultOptions(){return{domain:[0,1],range:[0,1],unknown:void 0,nice:!1,clamp:!1,round:!1,interpolate:YK,tickMethod:mq,tickCount:5}}chooseTransforms(){return[td,td]}clone(){return new e(this.options)}},bq=function(e){Qt(t,e);function t(t){var n=this,r=t.style,i=$t(t,[`style`]);return n=e.call(this,Bu({},{type:`column`},L({style:r},i)))||this,n.columnsGroup=new Ny({name:`columns`}),n.appendChild(n.columnsGroup),n.render(),n}return t.prototype.render=function(){var e=this.attributes,t=e.columns,n=e.x,r=e.y;this.columnsGroup.style.transform=`translate(${n}, ${r})`,$(this.columnsGroup).selectAll(`.column`).data(t.flat()).join(function(e){return e.append(`rect`).attr(`className`,`column`).each(function(e){this.attr(e)})},function(e){return e.each(function(e){this.attr(e)})},function(e){return e.remove()})},t.prototype.update=function(e){this.attr(QW({},this.attributes,e)),this.render()},t.prototype.clear=function(){this.removeChildren()},t}(Dy),xq=function(e){Qt(t,e);function t(t){var n=this,r=t.style,i=$t(t,[`style`]);return n=e.call(this,Bu({},{type:`lines`},L({style:r},i)))||this,n.linesGroup=n.appendChild(new Ny),n.areasGroup=n.appendChild(new Ny),n.render(),n}return t.prototype.render=function(){var e=this.attributes,t=e.lines,n=e.areas,r=e.x,i=e.y;this.style.transform=`translate(${r}, ${i})`,t&&this.renderLines(t),n&&this.renderAreas(n)},t.prototype.clear=function(){this.linesGroup.removeChildren(),this.areasGroup.removeChildren()},t.prototype.update=function(e){this.attr(QW({},this.attributes,e)),this.render()},t.prototype.renderLines=function(e){$(this.linesGroup).selectAll(`.line`).data(e).join(function(e){return e.append(`path`).attr(`className`,`line`).each(function(e){this.attr(e)})},function(e){return e.each(function(e){this.attr(e)})},function(e){return e.remove()})},t.prototype.renderAreas=function(e){$(this.linesGroup).selectAll(`.area`).data(e).join(function(e){return e.append(`path`).attr(`className`,`area`).each(function(e){this.attr(e)})},function(e){return e.each(function(e){this.style(e)})},function(e){return e.remove()})},t}(Dy);function Sq(e,t){var n,r=t.x,i=t.y,a=R(i.getOptions().range||[0,0],2),o=a[0],s=a[1];return s>o&&(n=R([o,s],2),s=n[0],o=n[1]),e.map(function(e){return e.map(function(e,t){return[r.map(t),cu(i.map(e),s,o)]})})}function Cq(e,t){t===void 0&&(t=!1);var n=t?e.length-1:0,r=e.map(function(e,t){return z([t===n?`M`:`L`],R(e),!1)});return t?r.reverse():r}function wq(e,t){if(t===void 0&&(t=!1),e.length<=2)return Cq(e);for(var n=[],r=e.length,i=0;i<r;i+=1){var a=t?e[r-i-1]:e[i];Gu(a,n.slice(-2))||n.push.apply(n,z([],R(a),!1))}var o=AG(n,!1);return t?o.unshift(z([`M`],R(e[r-1]),!1)):o.unshift(z([`M`],R(e[0]),!1)),o}function Tq(e,t,n){var r=ju(e);return r.push([`L`,t,n],[`L`,0,n],[`Z`]),r}function Eq(e,t,n,r){return e.map(function(e){return Tq(t?wq(e):Cq(e),n,r)})}function Dq(e,t,n){for(var r=[],i=e.length-1;i>=0;--i){var a=e[i],o=Cq(a),s=void 0;if(i===0)s=Tq(o,t,n);else{var c=e[i-1],l=Cq(c,!0);l[0][0]=`L`,s=z(z(z([],R(o),!1),R(l),!1),[[`Z`]],!1)}r.push(s)}return r}function Oq(e,t,n){for(var r=[],i=e.length-1;i>=0;--i){var a=e[i],o=wq(a),s=void 0;if(i===0)s=Tq(o,t,n);else{var c=e[i-1],l=wq(c,!0),u=a[0];l[0][0]=`L`,s=z(z(z([],R(o),!1),R(l),!1),[z([`M`],R(u),!1),[`Z`]],!1)}r.push(s)}return r}function kq(e){return e.length===0?[0,0]:[tu(fu(e,function(e){return tu(e)||0})),eu(du(e,function(e){return eu(e)||0}))]}function Aq(e){for(var t=ju(e),n=t[0].length,r=R([Array(n).fill(0),Array(n).fill(0)],2),i=r[0],a=r[1],o=0;o<t.length;o+=1)for(var s=t[o],c=0;c<n;c+=1)s[c]>=0?(s[c]+=i[c],i[c]=s[c]):(s[c]+=a[c],a[c]=s[c]);return t}var jq=function(e){Qt(t,e);function t(t){return e.call(this,t,{type:`line`,x:0,y:0,width:200,height:20,isStack:!1,color:[`#83daad`,`#edbf45`,`#d2cef9`,`#e290b3`,`#6f63f4`],smooth:!0,lineLineWidth:1,areaOpacity:0,isGroup:!1,columnLineWidth:1,columnStroke:`#fff`,scale:1,spacing:0})||this}return Object.defineProperty(t.prototype,`rawData`,{get:function(){var e=this.attributes.data;if(!e||e?.length===0)return[[]];var t=ju(e);return G(t[0])?[t]:t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`data`,{get:function(){return this.attributes.isStack?Aq(this.rawData):this.rawData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`scales`,{get:function(){return this.createScales(this.data)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`baseline`,{get:function(){var e=this.scales.y,t=R(e.getOptions().domain||[0,0],2),n=t[0],r=t[1];return r<0?e.map(r):e.map(n<0?0:n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`containerShape`,{get:function(){var e=this.attributes,t=e.width,n=e.height;return{width:t,height:n}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`linesStyle`,{get:function(){var e=this,t=this.attributes,n=t.type,r=t.isStack,i=t.smooth;if(n!==`line`)throw Error(`linesStyle can only be used in line type`);var a=XG(this.attributes,`area`),o=XG(this.attributes,`line`),s=this.containerShape.width,c=this.data;if(c[0].length===0)return{lines:[],areas:[]};var l=this.scales,u=l.x,d=l.y,f=Sq(c,{type:`line`,x:u,y:d}),p=[];if(a){var m=this.baseline;p=r?i?Oq(f,s,m):Dq(f,s,m):Eq(f,i,s,m)}return{lines:f.map(function(t,n){return L({stroke:e.getColor(n),d:i?wq(t):Cq(t)},o)}),areas:p.map(function(t,n){return L({d:t,fill:e.getColor(n)},a)})}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`columnsStyle`,{get:function(){var e=this,t=XG(this.attributes,`column`),n=this.attributes,r=n.isStack,i=n.type,a=n.scale;if(i!==`column`)throw Error(`columnsStyle can only be used in column type`);var o=this.containerShape.height,s=this.rawData;if(!s)return{columns:[]};r&&(s=Aq(s));var c=this.createScales(s),l=c.x,u=c.y,d=R(kq(s),2),f=d[0],p=d[1],m=new yq({domain:[0,p-(f>0?0:f)],range:[0,o*a]}),h=l.getBandWidth(),g=this.rawData;return{columns:s.map(function(n,i){return n.map(function(n,a){var o=h/s.length;return L(L({fill:e.getColor(i)},t),r?function(){return{x:l.map(a),y:u.map(n),width:h,height:m.map(g[i][a])}}():function(){return{x:l.map(a)+o*i,y:n>=0?u.map(n):u.map(0),width:o,height:m.map(Math.abs(n))}}())})})}},enumerable:!1,configurable:!0}),t.prototype.render=function(e,t){zG(t,`.container`,`rect`).attr(`className`,`container`).node();var n=e.type,r=e.x,i=e.y,a=`spark${n}`,o=L({x:r,y:i},n===`line`?this.linesStyle:this.columnsStyle);$(t).selectAll(`.spark`).data([n]).join(function(e){return e.append(function(e){return e===`line`?new xq({className:a,style:o}):new bq({className:a,style:o})}).attr(`className`,`spark ${a}`)},function(e){return e.update(o)},function(e){return e.remove()})},t.prototype.getColor=function(e){var t=this.attributes.color;return Gl(t)?t[e%t.length]:W(t)?t.call(null,e):t},t.prototype.createScales=function(e){var t=this.attributes,n=t.type,r=t.scale,i=t.range,a=i===void 0?[]:i,o=t.spacing,s=this.containerShape,c=s.width,l=s.height,u=R(kq(e),2),d=u[0],f=u[1],p=new yq({domain:[a[0]??d,a[1]??f],range:[l,l*(1-r)]});return n===`line`?{type:n,x:new yq({domain:[0,e[0].length-1],range:[0,c]}),y:p}:{type:n,x:new pq({domain:e[0].map(function(e,t){return t}),range:[0,c],paddingInner:o,paddingOuter:o/2,align:.5}),y:p}},t.tag=`sparkline`,t}(sK);function Mq(e){return typeof e==`boolean`?!1:`enter`in e&&`update`in e&&`exit`in e}function Nq(e){if(!e)return{enter:!1,update:!1,exit:!1};var t=[`enter`,`update`,`exit`],n=Object.fromEntries(Object.entries(e).filter(function(e){var n=R(e,1),r=n[0];return!t.includes(r)}));return Object.fromEntries(t.map(function(t){return Mq(e)?e[t]===!1?[t,!1]:[t,L(L({},e[t]),n)]:[t,n]}))}function Pq(e,t){e?e.finished.then(t):t()}function Fq(e,t){e.length===0?t():Promise.all(e.map(function(e){return e?.finished})).then(t)}function Iq(e,t){`update`in e?e.update(t):e.attr(t)}function Lq(e,t,n){if(t.length===0)return null;if(!n){var r=t.slice(-1)[0];return Iq(e,{style:r}),null}return e.animate(t,n)}function Rq(e,t){return!(e.nodeName!==`text`||t.nodeName!==`text`||e.attributes.text!==t.attributes.text)}function zq(e,t,n,r){if(r===void 0&&(r=`destroy`),Rq(e,t))return e.remove(),[null];var i=function(){r===`destroy`?e.destroy():r===`hide`&&zW(e),t.isVisible()&&RW(t)};if(!n)return i(),[null];var a=n.duration,o=a===void 0?0:a,s=n.delay,c=s===void 0?0:s,l=Math.ceil(o/2),u=o/4,d=R(e.getGeometryBounds().center,2),f=d[0],p=d[1],m=R(t.getGeometryBounds().center,2),h=m[0],g=m[1],_=R([(f+h)/2-f,(p+g)/2-p],2),v=_[0],y=_[1],b=e.style.opacity,x=b===void 0?1:b,S=t.style.opacity,C=S===void 0?1:S,w=e.style.transform||``,T=t.style.transform||``,E=e.animate([{opacity:x,transform:`translate(0, 0) ${w}`},{opacity:0,transform:`translate(${v}, ${y}) ${w}`}],L(L({fill:`both`},n),{duration:c+l+u})),D=t.animate([{opacity:0,transform:`translate(${-v}, ${-y}) ${T}`,offset:.01},{opacity:C,transform:`translate(0, 0) ${T}`}],L(L({fill:`both`},n),{duration:l+u,delay:c+l-u}));return Pq(D,i),[E,D]}function Bq(e,t,n){var r={},i={};return Object.entries(t).forEach(function(t){var n=R(t,2),a=n[0],o=n[1];if(!Wl(o)){var s=e.style[a]||e.parsedStyle[a]||0;s!==o&&(r[a]=s,i[a]=o)}}),n?Lq(e,[r,i],L({fill:`both`},n)):(Iq(e,i),null)}function Vq(e,t){return e.style.opacity||(e.style.opacity=1),Bq(e,{opacity:0},t)}var Hq={fill:`#fff`,lineWidth:1,radius:2,size:10,stroke:`#bfbfbf`,strokeOpacity:1,zIndex:0},Uq={fill:`#000`,fillOpacity:.45,fontSize:12,textAlign:`center`,textBaseline:`middle`,zIndex:1},Wq={x:0,y:0,orientation:`horizontal`,showLabel:!0,type:`start`},Gq=YW({foreground:`foreground`,handle:`handle`,selection:`selection`,sparkline:`sparkline`,sparklineGroup:`sparkline-group`,track:`track`,brushArea:`brush-area`},`slider`),Kq=YW({labelGroup:`label-group`,label:`label`,iconGroup:`icon-group`,icon:`icon`,iconRect:`icon-rect`,iconLine:`icon-line`},`handle`),qq=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(e,t){var n=e.x,r=e.y,i=e.size,a=i===void 0?10:i,o=e.radius,s=o===void 0?a/4:o,c=e.orientation,l=$t(e,[`x`,`y`,`size`,`radius`,`orientation`]),u=a,d=u*2.4,f=$(t).maybeAppendByClassName(Kq.iconRect,`rect`).styles(L(L({},l),{width:u,height:d,radius:s,x:n-u/2,y:r-d/2,transformOrigin:`center`})),p=n+1/3*u-u/2,m=n+2/3*u-u/2,h=r+1/4*d-d/2,g=r+3/4*d-d/2;f.maybeAppendByClassName(`${Kq.iconLine}-1`,`line`).styles(L({x1:p,x2:p,y1:h,y2:g},l)),f.maybeAppendByClassName(`${Kq.iconLine}-2`,`line`).styles(L({x1:m,x2:m,y1:h,y2:g},l)),c===`vertical`&&(f.node().style.transform=`rotate(90)`)},t}(sK),Jq=function(e){Qt(t,e);function t(t){return e.call(this,t,Wq)||this}return t.prototype.renderLabel=function(e){var t=this,n=this.attributes,r=n.x,i=n.y,a=n.showLabel,o=XG(this.attributes,`label`),s=o.x,c=s===void 0?0:s,l=o.y,u=l===void 0?0:l,d=o.transform,f=o.transformOrigin,p=$t(o,[`x`,`y`,`transform`,`transformOrigin`]),m=R(QG(p,[]),2),h=m[0],g=m[1],_=$(e).maybeAppendByClassName(Kq.labelGroup,`g`).styles(g),v=L(L({},Uq),h),y=v.text,b=$t(v,[`text`]);fG(!!a,_,function(e){t.label=e.maybeAppendByClassName(Kq.label,`text`).styles(L(L({},b),{x:r+c,y:i+u,transform:d,transformOrigin:f,text:`${y}`})),t.label.on(`mousedown`,function(e){e.stopPropagation()}),t.label.on(`touchstart`,function(e){e.stopPropagation()})})},t.prototype.renderIcon=function(e){var t=this.attributes,n=t.x,r=t.y,i=t.orientation,a=t.type,o=L(L({x:n,y:r,orientation:i},Hq),XG(this.attributes,`icon`)),s=this.attributes.iconShape,c=s===void 0?function(){return new qq({style:o})}:s;$(e).maybeAppendByClassName(Kq.iconGroup,`g`).selectAll(Kq.icon.class).data([c]).join(function(e){return e.append(typeof c==`string`?c:function(){return c(a)}).attr(`className`,Kq.icon.name)},function(e){return e.update(o)},function(e){return e.remove()})},t.prototype.render=function(e,t){this.renderIcon(t),this.renderLabel(t)},t}(sK),Yq=function(e){Qt(t,e);function t(t){var n=e.call(this,t,L(L(L({x:0,y:0,animate:{duration:100,fill:`both`},brushable:!0,formatter:function(e){return e.toString()},handleSpacing:2,orientation:`horizontal`,padding:0,autoFitLabel:!0,scrollable:!0,selectionFill:`#5B8FF9`,selectionFillOpacity:.45,selectionZIndex:2,showHandle:!0,showLabel:!0,slidable:!0,trackFill:`#416180`,trackLength:200,trackOpacity:.05,trackSize:20,trackZIndex:-1,values:[0,1],type:`range`,selectionType:`select`,handleIconOffset:0},ZG(Wq,`handle`)),ZG(Hq,`handleIcon`)),ZG(Uq,`handleLabel`)))||this;return n.range=[0,1],n.onDragStart=function(e){return function(t){t.stopPropagation(),n.target=e,n.prevPos=n.getOrientVal(cG(t));var r=n.availableSpace,i=r.x,a=r.y,o=n.getBBox(),s=o.x,c=o.y;n.selectionStartPos=n.getRatio(n.prevPos-n.getOrientVal([i,a])-n.getOrientVal([+s,+c])),n.selectionWidth=0,document.addEventListener(`pointermove`,n.onDragging),document.addEventListener(`pointerup`,n.onDragEnd)}},n.onDragging=function(e){var t=n.attributes,r=t.slidable,i=t.brushable,a=t.type;e.stopPropagation();var o=n.getOrientVal(cG(e)),s=o-n.prevPos;if(s){var c=n.getRatio(s);switch(n.target){case`start`:r&&n.setValuesOffset(c);break;case`end`:r&&n.setValuesOffset(0,c);break;case`selection`:r&&n.setValuesOffset(c,c);break;case`track`:if(!i)return;n.selectionWidth+=c,a===`range`?n.innerSetValues([n.selectionStartPos,n.selectionStartPos+n.selectionWidth].sort(),!0):n.innerSetValues([0,n.selectionStartPos+n.selectionWidth],!0);break;default:break}n.prevPos=o}},n.onDragEnd=function(){document.removeEventListener(`pointermove`,n.onDragging),document.removeEventListener(`pointermove`,n.onDragging),document.removeEventListener(`pointerup`,n.onDragEnd),n.target=``,n.updateHandlesPosition(!1)},n.onValueChange=function(e){var t=n.attributes,r=t.onChange,i=t.type,a=i===`range`?e:e[1],o=i===`range`?n.getValues():n.getValues()[1],s=new Cv(`valuechange`,{detail:{oldValue:a,value:o}});n.dispatchEvent(s),r?.(o)},n.selectionStartPos=0,n.selectionWidth=0,n.prevPos=0,n.target=``,n}return Object.defineProperty(t.prototype,`values`,{get:function(){return this.attributes.values},set:function(e){this.attributes.values=this.clampValues(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`sparklineStyle`,{get:function(){if(this.attributes.orientation!==`horizontal`)return null;var e=XG(this.attributes,`sparkline`);return L(L({zIndex:0},this.availableSpace),e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`shape`,{get:function(){var e=this.attributes,t=e.trackLength,n=e.trackSize,r=R(this.getOrientVal([[t,n],[n,t]]),2),i=r[0],a=r[1];return{width:i,height:a}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`availableSpace`,{get:function(){var e=this.attributes;e.x,e.y;var t=e.padding,n=R(BG(t),4),r=n[0],i=n[1],a=n[2],o=n[3],s=this.shape,c=s.width,l=s.height;return{x:o,y:r,width:c-(o+i),height:l-(r+a)}},enumerable:!1,configurable:!0}),t.prototype.getValues=function(){return this.values},t.prototype.setValues=function(e,t){e===void 0&&(e=[0,0]),t===void 0&&(t=!1),this.attributes.values=e;var n=t===!1?!1:this.attributes.animate;this.updateSelectionArea(n),this.updateHandlesPosition(n)},t.prototype.updateSelectionArea=function(e){var t=this.calcSelectionArea();this.foregroundGroup.selectAll(Gq.selection.class).each(function(n,r){Bq(this,t[r],e)})},t.prototype.updateHandlesPosition=function(e){this.attributes.showHandle&&(this.startHandle&&Bq(this.startHandle,this.getHandleStyle(`start`),e),this.endHandle&&Bq(this.endHandle,this.getHandleStyle(`end`),e))},t.prototype.innerSetValues=function(e,t){e===void 0&&(e=[0,0]),t===void 0&&(t=!1);var n=this.values,r=this.clampValues(e);this.attributes.values=r,this.setValues(r),t&&this.onValueChange(n)},t.prototype.renderTrack=function(e){var t=this.attributes,n=t.x,r=t.y,i=XG(this.attributes,`track`);this.trackShape=$(e).maybeAppendByClassName(Gq.track,`rect`).styles(L(L({x:n,y:r},this.shape),i))},t.prototype.renderBrushArea=function(e){var t=this.attributes,n=t.x,r=t.y,i=t.brushable;this.brushArea=$(e).maybeAppendByClassName(Gq.brushArea,`rect`).styles(L({x:n,y:r,fill:`transparent`,cursor:i?`crosshair`:`default`},this.shape))},t.prototype.renderSparkline=function(e){var t=this,n=this.attributes,r=n.x,i=n.y,a=n.orientation,o=$(e).maybeAppendByClassName(Gq.sparklineGroup,`g`);fG(a===`horizontal`,o,function(e){var n=L(L({},t.sparklineStyle),{x:r,y:i});e.maybeAppendByClassName(Gq.sparkline,function(){return new jq({style:n})}).update(n)})},t.prototype.renderHandles=function(){var e=this,t,n=this.attributes,r=n.showHandle,i=n.type===`range`?[`start`,`end`]:[`end`],a=r?i:[],o=this;(t=this.foregroundGroup)==null||t.selectAll(Gq.handle.class).data(a.map(function(e){return{type:e}}),function(e){return e.type}).join(function(t){return t.append(function(t){var n=t.type;return new Jq({style:e.getHandleStyle(n)})}).each(function(e){var t=e.type;this.attr(`class`,`${Gq.handle.name} ${t}-handle`);var n=`${t}Handle`;o[n]=this,this.addEventListener(`pointerdown`,o.onDragStart(t))})},function(e){return e.each(function(e){var t=e.type;this.update(o.getHandleStyle(t))})},function(e){return e.each(function(e){var t=`${e.type}Handle`;o[t]=void 0}).remove()})},t.prototype.renderSelection=function(e){var t=this.attributes,n=t.x,r=t.y,i=t.type,a=t.selectionType;this.foregroundGroup=$(e).maybeAppendByClassName(Gq.foreground,`g`);var o=XG(this.attributes,`selection`),s=function(e){return e.style(`visibility`,function(e){return e.show?`visible`:`hidden`}).style(`cursor`,function(e){return a===`select`?`grab`:a===`invert`?`crosshair`:`default`}).styles(L(L({},o),{transform:`translate(${n}, ${r})`}))},c=this;this.foregroundGroup.selectAll(Gq.selection.class).data(i===`value`?[]:this.calcSelectionArea().map(function(e,t){return{style:L({},e),index:t,show:a===`select`?t===1:t!==1}}),function(e){return e.index}).join(function(e){return e.append(`rect`).attr(`className`,Gq.selection.name).call(s).each(function(e,t){var n=this;t===1?(c.selectionShape=$(this),this.on(`pointerdown`,function(e){n.attr(`cursor`,`grabbing`),c.onDragStart(`selection`)(e)}),c.dispatchCustomEvent(this,`pointerenter`,`selectionMouseenter`),c.dispatchCustomEvent(this,`pointerleave`,`selectionMouseleave`),c.dispatchCustomEvent(this,`click`,`selectionClick`),this.addEventListener(`pointerdown`,function(){n.attr(`cursor`,`grabbing`)}),this.addEventListener(`pointerup`,function(){n.attr(`cursor`,`pointer`)}),this.addEventListener(`pointerover`,function(){n.attr(`cursor`,`pointer`)})):this.on(`pointerdown`,c.onDragStart(`track`))})},function(e){return e.call(s)},function(e){return e.remove()}),this.updateSelectionArea(!1),this.renderHandles()},t.prototype.render=function(e,t){this.renderTrack(t),this.renderSparkline(t),this.renderBrushArea(t),this.renderSelection(t)},t.prototype.clampValues=function(e,t){var n;t===void 0&&(t=4);var r=R(this.range,2),i=r[0],a=r[1],o=R(this.getValues().map(function(e){return DG(e,t)}),2),s=o[0],c=o[1],l=R(((Array.isArray(e)?e:[s,e??c])||[s,c]).map(function(e){return DG(e,t)}),2),u=l[0],d=l[1];if(this.attributes.type===`value`)return[0,cu(d,i,a)];u>d&&(n=R([d,u],2),u=n[0],d=n[1]);var f=d-u;return f>a-i?[i,a]:u<i?s===i&&c===d?[i,d]:[i,f+i]:d>a?c===a&&s===u?[u,a]:[a-f,a]:[u,d]},t.prototype.calcSelectionArea=function(e){var t=R(this.clampValues(e),2),n=t[0],r=t[1],i=this.availableSpace,a=i.x,o=i.y,s=i.width,c=i.height;return this.getOrientVal([[{y:o,height:c,x:a,width:n*s},{y:o,height:c,x:n*s+a,width:(r-n)*s},{y:o,height:c,x:r*s,width:(1-r)*s}],[{x:a,width:s,y:o,height:n*c},{x:a,width:s,y:n*c+o,height:(r-n)*c},{x:a,width:s,y:r*c,height:(1-r)*c}]])},t.prototype.calcHandlePosition=function(e){var t=this.attributes.handleIconOffset,n=this.availableSpace,r=n.x,i=n.y,a=n.width,o=n.height,s=R(this.clampValues(),2),c=s[0],l=s[1],u=e===`start`?-t:t,d=(e===`start`?c:l)*this.getOrientVal([a,o])+u;return{x:r+this.getOrientVal([d,a/2]),y:i+this.getOrientVal([o/2,d])}},t.prototype.inferTextStyle=function(e){return this.attributes.orientation===`horizontal`?{}:e===`start`?{transformOrigin:`left center`,transform:`rotate(90)`,textAlign:`start`}:e===`end`?{transformOrigin:`right center`,transform:`rotate(90)`,textAlign:`end`}:{}},t.prototype.calcHandleText=function(e){var t,n=this.attributes,r=n.type,i=n.orientation,a=n.formatter,o=n.autoFitLabel,s=XG(this.attributes,`handle`),c=XG(s,`label`),l=s.spacing,u=this.getHandleSize(),d=this.clampValues(),f=e===`start`?d[0]:d[1],p=a(f),m=new WW({style:L(L(L({},c),this.inferTextStyle(e)),{text:p})}),h=m.getBBox(),g=h.width,_=h.height;if(m.destroy(),!o){if(r===`value`)return{text:p,x:0,y:-_-l};var v=l+u+(i===`horizontal`?g/2:0);return t={text:p},t[i===`horizontal`?`x`:`y`]=e===`start`?-v:v,t}var y=0,b=0,x=this.availableSpace,S=x.width,C=x.height,w=this.calcSelectionArea()[1],T=w.x,E=w.y,D=w.width,O=w.height,k=l+u;if(i===`horizontal`){var A=k+g/2;y=e===`start`?T-k-g>0?-A:A:S-T-D-k>g?A:-A}else{var j=k,ee=_+k;b=e===`start`?E-u>_?-ee:j:C-(E+O)-u>_?ee:-j}return{x:y,y:b,text:p}},t.prototype.getHandleLabelStyle=function(e){var t=XG(this.attributes,`handleLabel`);return L(L(L({},t),this.calcHandleText(e)),this.inferTextStyle(e))},t.prototype.getHandleIconStyle=function(){var e=this.attributes.handleIconShape,t=XG(this.attributes,`handleIcon`),n=this.getOrientVal([`ew-resize`,`ns-resize`]),r=this.getHandleSize();return L({cursor:n,shape:e,size:r},t)},t.prototype.getHandleStyle=function(e){var t=this.attributes,n=t.x,r=t.y,i=t.showLabel,a=t.showLabelOnInteraction,o=t.orientation,s=this.calcHandlePosition(e),c=s.x,l=s.y,u=this.calcHandleText(e),d=i;return!i&&a&&(d=!!this.target),L(L(L({},ZG(this.getHandleIconStyle(),`icon`)),ZG(L(L({},this.getHandleLabelStyle(e)),u),`label`)),{transform:`translate(${c+n}, ${l+r})`,orientation:o,showLabel:d,type:e,zIndex:3})},t.prototype.getHandleSize=function(){var e=this.attributes,t=e.handleIconSize,n=e.width,r=e.height;return t||Math.floor((this.getOrientVal([+r,+n])+4)/2.4)},t.prototype.getOrientVal=function(e){var t=R(e,2),n=t[0],r=t[1];return this.attributes.orientation===`horizontal`?n:r},t.prototype.setValuesOffset=function(e,t){t===void 0&&(t=0);var n=this.attributes.type,r=R(this.getValues(),2),i=r[0],a=r[1],o=[i+(n===`range`?e:0),a+t].sort();this.innerSetValues(o,!0)},t.prototype.getRatio=function(e){var t=this.availableSpace,n=t.width,r=t.height;return e/this.getOrientVal([n,r])},t.prototype.dispatchCustomEvent=function(e,t,n){var r=this;e.on(t,function(e){e.stopPropagation(),r.dispatchEvent(new Cv(n,{detail:e}))})},t.prototype.bindEvents=function(){this.addEventListener(`wheel`,this.onScroll);var e=this.brushArea;this.dispatchCustomEvent(e,`click`,`trackClick`),this.dispatchCustomEvent(e,`pointerenter`,`trackMouseenter`),this.dispatchCustomEvent(e,`pointerleave`,`trackMouseleave`),e.on(`pointerdown`,this.onDragStart(`track`))},t.prototype.onScroll=function(e){if(this.attributes.scrollable){var t=e.deltaX,n=e.deltaY||t,r=this.getRatio(n);this.setValuesOffset(r,r)}},t.tag=`slider`,t}(sK),Xq={data:[],animate:{enter:!1,update:{duration:100,easing:`ease-in-out-sine`,fill:`both`},exit:{duration:100,fill:`both`}},showArrow:!0,showGrid:!0,showLabel:!0,showLine:!0,showTick:!0,showTitle:!0,showTrunc:!1,dataThreshold:100,lineLineWidth:1,lineStroke:`black`,crossPadding:10,titleFill:`black`,titleFontSize:12,titlePosition:`lb`,titleSpacing:0,titleTextAlign:`center`,titleTextBaseline:`middle`,lineArrow:function(){return new By({style:{d:[[`M`,10,10],[`L`,-10,0],[`L`,10,-10],[`L`,0,0],[`L`,10,10],[`Z`]],fill:`black`,transformOrigin:`center`}})},labelAlign:`parallel`,labelDirection:`positive`,labelFontSize:12,labelSpacing:0,gridConnect:`line`,gridControlAngles:[],gridDirection:`positive`,gridLength:0,gridType:`segment`,lineArrowOffset:15,lineArrowSize:10,tickDirection:`positive`,tickLength:5,tickLineWidth:1,tickStroke:`black`,labelOverlap:[]};Bu({},Xq,{style:{type:`arc`}}),Bu({},Xq,{style:{}});var Zq=YW({mainGroup:`main-group`,gridGroup:`grid-group`,grid:`grid`,lineGroup:`line-group`,line:`line`,tickGroup:`tick-group`,tick:`tick`,tickItem:`tick-item`,labelGroup:`label-group`,label:`label`,labelItem:`label-item`,titleGroup:`title-group`,title:`title`,lineFirst:`line-first`,lineSecond:`line-second`},`axis`),Qq=YW({lineGroup:`line-group`,line:`line`,regionGroup:`region-group`,region:`region`},`grid`);function $q(e){return e.reduce(function(e,t,n){return e.push(z([n===0?`M`:`L`],R(t),!1)),e},[])}function eJ(e,t,n){var r=t.connect,i=r===void 0?`line`:r,a=t.center;if(i===`line`)return $q(e);if(!a)return[];var o=wG(e[0],a),s=n?0:1;return e.reduce(function(e,t,n){return n===0?e.push(z([`M`],R(t),!1)):e.push(z([`A`,o,o,0,0,s],R(t),!1)),e},[])}function tJ(e,t,n){return t.type===`surround`?eJ(e,t,n):$q(e)}function nJ(e,t,n){var r=n.type,i=n.connect,a=n.center,o=n.closed?[[`Z`]]:[],s=R([tJ(e,n),tJ(t.slice().reverse(),n,!0)],2),c=s[0],l=s[1],u=R([e[0],t.slice(-1)[0]],2),d=u[0],f=u[1],p=function(e,t){return[c,e,l,t,o].flat()};if(i===`line`||r===`surround`)return p([z([`L`],R(f),!1)],[z([`L`],R(d),!1)]);if(!a)throw Error(`Arc grid need to specified center`);var m=R([wG(f,a),wG(d,a)],2),h=m[0],g=m[1];return p([z([`A`,h,h,0,0,1],R(f),!1),z([`L`],R(f),!1)],[z([`A`,g,g,0,0,0],R(d),!1),z([`L`],R(d),!1)])}function rJ(e,t,n,r){var i=n.animate,a=n.isBillboard,o=t.map(function(e,t){return{id:e.id||`grid-line-${t}`,d:tJ(e.points,n)}});return e.selectAll(Qq.line.class).data(o,function(e){return e.id}).join(function(e){return e.append(`path`).each(function(e,t){var n=JW(NG(L({d:e.d},r)),[e,t,o]);this.attr(L({class:Qq.line.name,stroke:`#D9D9D9`,lineWidth:1,lineDash:[4,4],isBillboard:a},n))})},function(e){return e.transition(function(e,t){var n=JW(NG(L({d:e.d},r)),[e,t,o]);return Bq(this,n,i.update)})},function(e){return e.transition(function(){var e=this,t=Vq(this,i.exit);return Pq(t,function(){return e.remove()}),t})}).transitions()}function iJ(e,t,n){var r=n.animate,i=n.connect,a=n.areaFill;if(t.length<2||!a||!i)return[];for(var o=Array.isArray(a)?a:[a,`transparent`],s=function(e){return o[e%o.length]},c=[],l=0;l<t.length-1;l++){var u=R([t[l].points,t[l+1].points],2),d=u[0],f=u[1],p=nJ(d,f,n);c.push({d:p,fill:s(l)})}return e.selectAll(Qq.region.class).data(c,function(e,t){return t}).join(function(e){return e.append(`path`).each(function(e,t){var n=JW(e,[e,t,c]);this.attr(n)}).attr(`className`,Qq.region.name)},function(e){return e.transition(function(e,t){var n=JW(e,[e,t,c]);return Bq(this,n,r.update)})},function(e){return e.transition(function(){var e=this,t=Vq(this,r.exit);return Pq(t,function(){return e.remove()}),t})}).transitions()}function aJ(e){var t=e.data,n=t===void 0?[]:t;return e.closed?n.map(function(e){var t=e.points,n=R(t,1),r=n[0];return L(L({},e),{points:z(z([],R(t),!1),[r],!1)})}):n}var oJ=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(e,t){e.type,e.center,e.areaFill,e.closed;var n=$t(e,[`type`,`center`,`areaFill`,`closed`]),r=aJ(e),i=$(t).maybeAppendByClassName(Qq.lineGroup,`g`),a=$(t).maybeAppendByClassName(Qq.regionGroup,`g`),o=rJ(i,r,e,n),s=iJ(a,r,e);return z(z([],R(o),!1),R(s),!1)},t}(sK);function sJ(e,t){return Object.fromEntries(Object.entries(e).map(function(e){var n=R(e,2),r=n[0],i=n[1];return[r,JW(i,t)]}))}function cJ(e,t){return t&&W(t)?e.filter(t):e}function lJ(e,t){var n=t.startAngle;return(t.endAngle-n)*e+n}function uJ(e,t){if(t.type===`linear`){var n=R(t.startPos,2),r=n[0],i=n[1],a=R(t.endPos,2),o=a[0],s=a[1],c=R([o-r,s-i],2),l=c[0],u=c[1];return TG([l,u])}var d=GW(lJ(e,t));return[-Math.sin(d),Math.cos(d)]}function dJ(e,t,n){var r=uJ(e,n);return EG(r,t!==`positive`)}function fJ(e,t){return dJ(e,t.labelDirection,t)}function pJ(e,t){var n=R(t.startPos,2),r=n[0],i=n[1],a=R(t.endPos,2),o=a[0],s=a[1],c=R([o-r,s-i],2),l=c[0],u=c[1];return[r+l*e,i+u*e]}function mJ(e,t){var n=t.radius,r=R(t.center,2),i=r[0],a=r[1],o=GW(lJ(e,t));return[i+n*Math.cos(o),a+n*Math.sin(o)]}function hJ(e,t){return t.type===`linear`?pJ(e,t):mJ(e,t)}function gJ(e){return uJ(0,e)[1]===0}function _J(e){return uJ(0,e)[0]===0}function vJ(e,t){return t-e===360}function yJ(e,t,n,r,i){var a=t-e,o=R([i,i],2),s=o[0],c=o[1],l=R([GW(e),GW(t)],2),u=l[0],d=l[1],f=function(e){return[n+i*Math.cos(e),r+i*Math.sin(e)]},p=R(f(u),2),m=p[0],h=p[1],g=R(f(d),2),_=g[0],v=g[1];if(vJ(e,t)){var y=(d+u)/2,b=R(f(y),2),x=b[0],S=b[1];return[[`M`,m,h],[`A`,s,c,0,1,0,x,S],[`A`,s,c,0,1,0,_,v]]}return`M${m},${h},A${s},${c},0,${a>180?1:0},${e>t?0:1},${_},${v}`}function bJ(e){var t=e.attributes,n=t.startAngle,r=t.endAngle,i=t.center,a=t.radius;return z(z([n,r],R(i),!1),[a],!1)}function xJ(e,t,n,r){var i=t.startAngle,a=t.endAngle,o=t.center,s=t.radius;return e.selectAll(Zq.line.class).data([{d:yJ.apply(void 0,z(z([i,a],R(o),!1),[s],!1))}],function(e,t){return t}).join(function(e){return e.append(`path`).attr(`className`,Zq.line.name).styles(t).styles({d:function(e){return e.d}})},function(e){return e.transition(function(){var e=this,t=vG(this,bJ(this),z(z([i,a],R(o),!1),[s],!1),r.update);if(t){var n=function(){var t=Ku(e.attributes,`__keyframe_data__`);e.style.d=yJ.apply(void 0,z([],R(t),!1))};t.onframe=n,t.onfinish=n}return t}).styles(t)},function(e){return e.remove()}).styles(n).transitions()}function SJ(e,t){t.truncRange,t.truncShape,t.lineExtension}function CJ(e,t,n){n===void 0&&(n=[0,0]);var r=R([e,t,n],3),i=R(r[0],2),a=i[0],o=i[1],s=R(r[1],2),c=s[0],l=s[1],u=R(r[2],2),d=u[0],f=u[1],p=R([c-a,l-o],2),m=p[0],h=p[1],g=Math.sqrt(m**2+h**2),_=R([-d/g,f/g],2),v=_[0],y=_[1];return[v*m,v*h,y*m,y*h]}function wJ(e){var t=R(e,2),n=R(t[0],2),r=n[0],i=n[1],a=R(t[1],2),o=a[0],s=a[1];return{x1:r,y1:i,x2:o,y2:s}}function TJ(e,t,n,r){var i=t.showTrunc,a=t.startPos,o=t.endPos,s=t.truncRange,c=t.lineExtension,l=R([a,o],2),u=R(l[0],2),d=u[0],f=u[1],p=R(l[1],2),m=p[0],h=p[1],g=R(c?CJ(a,o,c):[,,,,].fill(0),4),_=g[0],v=g[1],y=g[2],b=g[3],x=function(t){return e.selectAll(Zq.line.class).data(t,function(e,t){return t}).join(function(e){return e.append(`line`).attr(`className`,function(e){return`${Zq.line.name} ${e.className}`}).styles(n).transition(function(e){return Bq(this,wJ(e.line),!1)})},function(e){return e.styles(n).transition(function(e){var t=e.line;return Bq(this,wJ(t),r.update)})},function(e){return e.remove()}).transitions()};if(!i||!s)return x([{line:[[d+_,f+v],[m+y,h+b]],className:Zq.line.name}]);var S=R(s,2),C=S[0],w=S[1],T=m-d,E=h-f,D=R([d+T*C,f+E*C],2),O=D[0],k=D[1],A=R([d+T*w,f+E*w],2),j=A[0],ee=A[1],te=x([{line:[[d+_,f+v],[O,k]],className:Zq.lineFirst.name},{line:[[j,ee],[m+y,h+b]],className:Zq.lineSecond.name}]);return SJ(e,t),te}function EJ(e,t,n,r){var i=n.showArrow,a=n.showTrunc,o=n.lineArrow,s=n.lineArrowOffset,c=n.lineArrowSize,l=t===`arc`?e.select(Zq.line.class):a?e.select(Zq.lineSecond.class):e.select(Zq.line.class);if(!i||!o||n.type===`arc`&&vJ(n.startAngle,n.endAngle)){var u=l.node();u&&(u.style.markerEnd=void 0);return}var d=lG(o);d.attr(r),FG(d,c,!0),l.style(`markerEnd`,d).style(`markerEndOffset`,-s)}function DJ(e,t,n){var r=t.type,i,a=XG(t,`line`);return i=r===`linear`?TJ(e,t,OG(a,`arrow`),n):xJ(e,t,OG(a,`arrow`),n),EJ(e,r,t,a),i}function OJ(e,t){return dJ(e,t.gridDirection,t)}function kJ(e){var t=e.type,n=e.gridCenter;return t===`linear`?n:n||e.center}function AJ(e,t){var n=t.gridLength;return e.map(function(e,r){var i=e.value,a=R(hJ(i,t),2),o=a[0],s=a[1],c=R(yG(OJ(i,t),n),2),l=c[0],u=c[1];return{id:r,points:[[o,s],[o+l,s+u]]}})}function jJ(e,t){var n=t.gridControlAngles,r=kJ(t);if(!r)throw Error(`grid center is not provide`);if(e.length<2)throw Error(`Invalid grid data`);if(!n||n.length===0)throw Error(`Invalid gridControlAngles`);var i=R(r,2),a=i[0],o=i[1];return e.map(function(e,r){var i=e.value,s=R(hJ(i,t),2),c=s[0],l=s[1],u=R([c-a,l-o],2),d=u[0],f=u[1],p=[];return n.forEach(function(e){var t=GW(e),n=R([Math.cos(t),Math.sin(t)],2),r=n[0],i=n[1],s=d*r-f*i+a,c=d*i+f*r+o;p.push([s,c])}),{points:p,id:r}})}function MJ(e,t,n,r){var i=XG(n,`grid`),a=i.type,o=i.areaFill,s=kJ(n),c=cJ(t,n.gridFilter),l=a===`segment`?AJ(c,n):jJ(c,n),u=L(L({},i),{center:s,areaFill:W(o)?c.map(function(e,t){return JW(o,[e,t,c])}):o,animate:r,data:l});return e.selectAll(Zq.grid.class).data([1]).join(function(e){return e.append(function(){return new oJ({style:u})}).attr(`className`,Zq.grid.name)},function(e){return e.transition(function(){return this.update(u)})},function(e){return e.remove()}).transitions()}var NJ=function(){function e(e,t,n,r){this.set(e,t,n,r)}return Object.defineProperty(e.prototype,`left`,{get:function(){return this.x1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`top`,{get:function(){return this.y1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`right`,{get:function(){return this.x2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`bottom`,{get:function(){return this.y2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`width`,{get:function(){return this.defined(`x2`)&&this.defined(`x1`)?this.x2-this.x1:void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,`height`,{get:function(){return this.defined(`y2`)&&this.defined(`y1`)?this.y2-this.y1:void 0},enumerable:!1,configurable:!0}),e.prototype.rotatedPoints=function(e,t,n){var r=this,i=r.x1,a=r.y1,o=r.x2,s=r.y2,c=Math.cos(e),l=Math.sin(e),u=t-t*c+n*l,d=n-t*l-n*c;return[[c*i-l*s+u,l*i+c*s+d],[c*o-l*s+u,l*o+c*s+d],[c*i-l*a+u,l*i+c*a+d],[c*o-l*a+u,l*o+c*a+d]]},e.prototype.set=function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},e.prototype.defined=function(e){return this[e]!==Number.MAX_VALUE&&this[e]!==-Number.MAX_VALUE},e}();function PJ(e,t){var n=e.getEulerAngles()||0;e.setEulerAngles(0);var r=e.getBounds(),i=R(r.min,2),a=i[0],o=i[1],s=R(r.max,2),c=s[0],l=s[1],u=e.getBBox(),d=u.width,f=u.height,p=0,m=0,h=a,g=o,_=iG(e);if(_){f-=1.5;var v=_.style.textAlign,y=_.style.textBaseline;v===`center`?h=(a+c)/2:(v===`right`||v===`end`)&&(h=c),y===`middle`?g=(o+l)/2:y===`bottom`&&(g=l)}var b=R(BG(t),4),x=b[0],S=x===void 0?0:x,C=b[1],w=C===void 0?0:C,T=b[2],E=T===void 0?S:T,D=b[3],O=D===void 0?w:D,k=new NJ((p+=a)-O,(m+=o)-S,p+d+w,m+f+E);return e.setEulerAngles(n),k.rotatedPoints(GW(n),h,g)}function FJ(e,t){return t[0]<=Math.max(e[0][0],e[1][0])&&t[0]<=Math.min(e[0][0],e[1][0])&&t[1]<=Math.max(e[0][1],e[1][1])&&t[1]<=Math.min(e[0][1],e[1][1])}function IJ(e,t,n){var r=(t[1]-e[1])*(n[0]-t[0])-(t[0]-e[0])*(n[1]-t[1]);return r===0?0:r<0?2:1}function LJ(e,t){var n=IJ(e[0],e[1],t[0]),r=IJ(e[0],e[1],t[1]),i=IJ(t[0],t[1],e[0]),a=IJ(t[0],t[1],e[1]);return!!(n!==r&&i!==a||n===0&&FJ(e,t[0])||r===0&&FJ(e,t[1])||i===0&&FJ(t,e[0])||a===0&&FJ(t,e[1]))}function RJ(e,t){var n=e.length;if(n<3)return!1;var r=[t,[9999,t[1]]],i=0,a=0;do{var o=[e[a],e[(a+1)%n]];if(LJ(o,r)){if(IJ(o[0],t,o[1])===0)return FJ(o,t);i++}a=(a+1)%n}while(a!==0);return!!(i&1)}function zJ(e,t){return t.every(function(t){return RJ(e,t)})}function BJ(e,t,n){var r=e.x1,i=e.x2,a=e.y1,o=e.y2,s=[[r,a],[i,a],[i,o],[r,o]],c=PJ(t,n);return zJ(s,c)}function VJ(e,t){var n=R(e,4),r=n[0],i=n[1],a=n[2],o=n[3],s=R(t,4),c=s[0],l=s[1],u=s[2],d=s[3],f=a-r,p=o-i,m=u-c,h=d-l,g=f*h-m*p;if(g===0)return!1;var _=g>0,v=r-c,y=i-l,b=f*y-p*v;if(b<0===_)return!1;var x=m*y-h*v;return!(x<0===_||b>g===_||x>g===_)}function HJ(e,t){return[[e[0],e[1],e[2],e[3]],[e[2],e[3],e[4],e[5]],[e[4],e[5],e[6],e[7]],[e[6],e[7],e[0],e[1]]].some(function(e){return VJ(t,e)})}function UJ(e,t,n){var r,i,a=PJ(e,n).flat(1),o=PJ(t,n).flat(1),s=[[a[0],a[1],a[2],a[3]],[a[0],a[1],a[4],a[5]],[a[4],a[5],a[6],a[7]],[a[2],a[3],a[6],a[7]]];try{for(var c=tn(s),l=c.next();!l.done;l=c.next()){var u=l.value;if(HJ(o,u))return!0}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}return!1}function WJ(e,t){var n=e.type,r=e.labelDirection,i=e.crossSize;if(!i)return!1;if(n===`arc`){var a=e.center,o=e.radius,s=R(a,2),c=s[0],l=s[1],u=r===`negative`?0:i,d=-o-u,f=o+u,p=R(BG(t),4),m=p[0],h=p[1],g=p[2],_=p[3];return new NJ(c+d-_,l+d-m,c+f+h,l+f+g)}var v=R(e.startPos,2),y=v[0],b=v[1],x=R(e.endPos,2),S=x[0],C=x[1],w=R(_J(e)?[-t,0,t,0]:[0,t,0,-t],4),T=w[0],E=w[1],D=w[2],O=w[3],k=fJ(0,e),A=yG(k,i),j=new NJ(y,b,S,C);return j.x1+=O,j.y1+=T,j.x2+=E+A[0],j.y2+=D+A[1],j}function GJ(e,t,n){var r,i,a=t.crossPadding,o=new Set,s=null,c=WJ(t,a),l=function(e){return c?BJ(c,e):!0},u=function(e,t){return!e||!e.firstChild?!0:!UJ(e.firstChild,t.firstChild,BG(n))};try{for(var d=tn(e),f=d.next();!f.done;f=d.next()){var p=f.value;l(p)?!s||u(s,p)?s=p:(o.add(s),o.add(p)):o.add(p)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}return Array.from(o)}function KJ(e,t){return t===void 0&&(t={}),Wl(e)?0:typeof e==`number`?e:Math.floor(nG(e,t))}function qJ(e,t,n,r){if(!(e.length<=0)){var i=t.suffix,a=i===void 0?`...`:i,o=t.minLength,s=t.maxLength,c=s===void 0?1/0:s,l=t.step,u=l===void 0?` `:l,d=t.margin,f=d===void 0?[0,0,0,0]:d,p=rG(r.getTextShape(e[0])),m=KJ(u,p),h=o?KJ(o,p):m,g=KJ(c,p);(Wl(g)||g===1/0)&&(g=Math.max.apply(null,e.map(function(e){return e.getBBox().width})));var _=e.slice(),v=R(f,4);v[0],v[1],v[2],v[3];for(var y=function(t){if(_.forEach(function(e){r.ellipsis(r.getTextShape(e),t,a)}),_=GJ(e,n,f),_.length<1)return{value:void 0}},b=g;b>h+m;b-=m){var x=y(b);if(typeof x==`object`)return x.value}}}var JJ={parity:function(e,t){var n=t.seq,r=n===void 0?2:n;return e.filter(function(e,t){return t%r?(zW(e),!1):!0})}},YJ=function(e){return e.filter($W)};function XJ(e,t,n,r){var i=e.length,a=t.keepHeader,o=t.keepTail;if(!(i<=1||i===2&&a&&o)){var s=JJ.parity,c=function(e){return e.forEach(r.show),e},l=2,u=e.slice(),d=e.slice(),f=Math.min.apply(Math,z([1],R(e.map(function(e){return e.getBBox().width})),!1));if(n.type===`linear`&&(gJ(n)||_J(n))){var p=VG(e[0]).left,m=VG(e[i-1]).right,h=Math.abs(m-p)||1;l=Math.max(Math.floor(i*f/h),l)}var g,_;for(a&&(g=u.splice(0,1)[0]),o&&(_=u.splice(-1,1)[0],u.reverse()),c(u);l<e.length&&GJ(YJ(_?z(z([_],R(d),!1),[g],!1):z([g],R(d),!1)),n,t?.margin).length;){if(_&&!g&&l%2==0){var v=u.splice(0,1);v.forEach(r.hide)}else if(_&&g){var v=u.splice(0,1);v.forEach(r.hide)}d=s(c(u),{seq:l}),l++}}}function ZJ(e,t,n,r){var i,a,o=t.optionalAngles,s=o===void 0?[0,45,90]:o,c=t.margin,l=t.recoverWhenFailed,u=l===void 0?!0:l,d=e.map(function(e){return e.getLocalEulerAngles()}),f=function(){return GJ(e,n,c).length<1},p=function(t){return e.forEach(function(e,n){var i=Array.isArray(t)?t[n]:t;r.rotate(e,+i)})};try{for(var m=tn(s),h=m.next();!h.done;h=m.next()){var g=h.value;if(p(g),f())return}}catch(e){i={error:e}}finally{try{h&&!h.done&&(a=m.return)&&a.call(m)}finally{if(i)throw i.error}}u&&p(d)}function QJ(e){var t=e.type,n=e.labelDirection;return t===`linear`&&gJ(e)?n===`negative`?`bottom`:`top`:`middle`}function $J(e,t,n,r,i){var a=t.maxLines,o=a===void 0?3:a,s=t.recoverWhenFailed,c=s===void 0?!0:s,l=t.margin,u=l===void 0?[0,0,0,0]:l,d=JW(t.wordWrapWidth??50,[i]),f=e.map(function(e){return e.attr(`maxLines`)||1}),p=Math.min.apply(Math,z([],R(f),!1)),m=function(){return GJ(e,n,u).length<1},h=QJ(n),g=function(t){return e.forEach(function(e,n){var i=Array.isArray(t)?t[n]:t;r.wrap(e,d,i,h)})};if(!(p>o)){if(n.type===`linear`&&gJ(n)){if(g(o),m())return}else for(var _=p;_<=o;_++)if(g(_),m())return;c&&g(f)}}var eY=new Map([[`hide`,XJ],[`rotate`,ZJ],[`ellipsis`,qJ],[`wrap`,$J]]);function tY(e,t,n){return t.labelOverlap.length<1?!1:n===`hide`?!UW(e[0]):n===`rotate`?!e.some(function(e){return!!e.attr(`transform`)?.includes(`rotate`)}):n===`ellipsis`||n===`wrap`?e.filter(function(e){return e.querySelector(`text`)}).length>=1:!0}function nY(e,t,n,r){var i=t.labelOverlap,a=i===void 0?[]:i;a.length&&a.forEach(function(i){var a=i.type,o=eY.get(a);tY(e,t,a)&&o?.(e,i,t,r,n)})}function rY(){var e=[...arguments],t=function(e){return e===`positive`?-1:1};return e.reduce(function(e,n){return e*t(n)},1)}function iY(e){for(var t=e;t<0;)t+=360;return Math.round(t%360)}function aY(e,t){var n=R(e,2),r=n[0],i=n[1],a=R(t,2),o=a[0],s=a[1],c=R([r*o+i*s,r*s-i*o],2),l=c[0],u=c[1];return Math.atan2(u,l)}function oY(e){var t=(e+360)%180;return pG(t,-90,90)||(t+=180),t}function sY(e,t,n){var r=n.labelAlign;if(t.style.transform?.includes(`rotate`))return t.getLocalEulerAngles();var i=0,a=fJ(e.value,n),o=uJ(e.value,n);return r===`horizontal`?0:(i=r===`perpendicular`?aY([1,0],a):aY([o[0]<0?-1:1,0],o),oY(KW(i)))}function cY(e,t,n){var r=n.type,i=n.labelAlign,a=fJ(e,n),o=iY(t),s=iY(KW(aY([1,0],a))),c=`center`,l=`middle`;return r===`linear`?[90,270].includes(s)&&o===0?(c=`center`,l=a[1]===1?`top`:`bottom`):!(s%180)&&[90,270].includes(o)?c=`center`:s===0?(pG(o,0,90,!1,!0)||pG(o,0,90)||pG(o,270,360))&&(c=`start`):s===90?pG(o,0,90,!1,!0)?c=`start`:(pG(o,90,180)||pG(o,270,360))&&(c=`end`):s===270?pG(o,0,90,!1,!0)?c=`end`:(pG(o,90,180)||pG(o,270,360))&&(c=`start`):s===180&&(o===90?c=`start`:(pG(o,0,90)||pG(o,270,360))&&(c=`end`)):i===`parallel`?l=pG(s,0,180,!0)?`top`:`bottom`:i===`horizontal`?pG(s,90,270,!1)?c=`end`:(pG(s,270,360,!1)||pG(s,0,90))&&(c=`start`):i===`perpendicular`&&(c=pG(s,90,270)?`end`:`start`),{textAlign:c,textBaseline:l}}function lY(e,t,n){t.setLocalEulerAngles(e);var r=t.__data__.value,i=cY(r,e,n),a=t.querySelector(Zq.labelItem.class);a&&pY(a,i)}function uY(e,t,n){var r=n.showTick,i=n.tickLength,a=n.tickDirection,o=n.labelDirection,s=n.labelSpacing,c=t.indexOf(e),l=JW(s,[e,c,t]),u=R([fJ(e.value,n),rY(o,a)],2),d=u[0],f=u[1]===1?JW(r?i:0,[e,c,t]):0,p=R(bG(yG(d,l+f),hJ(e.value,n)),2),m=p[0],h=p[1];return{x:m,y:h}}function dY(e,t,n,r){var i=r.labelFormatter;return W(i)?function(){return lG(JW(i,[e,t,n,fJ(e.value,r)]))}:function(){return lG(e.label||``)}}function fY(e,t,n,r){var i=r.labelRender,a=(Ku(r,`endPos.0`,400)-Ku(r,`startPos.0`,0))/n.length,o=W(i)?JW(i,[e,t,n,fJ(e.value,r)]):e.label||``,s=aK(o)||30;return function(){return uG(o,{width:a,height:s})}}function pY(e,t){[`text`,`html`].includes(e.nodeName)&&e.attr(t)}function mY(e,t){nY(this.node().childNodes,e,t,{hide:zW,show:RW,rotate:function(t,n){lY(+n,t,e)},ellipsis:function(e,t,n){e&&oG(e,t||1/0,n)},wrap:function(e,t,n){e&&sG(e,t,n)},getTextShape:function(e){return e.querySelector(`text`)}})}function hY(e,t,n,r,i){var a=n.indexOf(t),o=i.labelRender,s=$(e).append(o?fY(t,a,n,i):dY(t,a,n,i)).attr(`className`,Zq.labelItem.name).node(),c=R(QG(sJ(r,[t,a,n])),2),l=c[0],u=c[1],d=u.transform,f=$t(u,[`transform`]);tK(s,d);var p=sY(t,s,i);return s.getLocalEulerAngles()||s.setLocalEulerAngles(p),pY(s,L(L({},cY(t.value,p,i)),l)),e.attr(f),s}function gY(e,t,n,r,i){var a=cJ(t,n.labelFilter),o=XG(n,`label`),s,c=e.selectAll(Zq.label.class).data(a,function(e,t){return t}).join(function(e){return e.append(`g`).attr(`className`,Zq.label.name).transition(function(e){hY(this,e,t,o,n);var r=uY(e,t,n),i=r.x,a=r.y;return this.style.transform=`translate(${i}, ${a})`,null})},function(e){return e.transition(function(e){var i=this.querySelector(Zq.labelItem.class),a=hY(this,e,t,o,n),s=zq(i,a,r.update),c=uY(e,t,n),l=c.x,u=c.y,d=Bq(this,{transform:`translate(${l}, ${u})`},r.update);return z(z([],R(s),!1),[d],!1)})},function(e){return s=e,e.transition(function(){var e=this,t=Vq(this.childNodes[0],r.exit);return Pq(t,function(){return $(e).remove()}),t}),s}).transitions();return Fq(c,function(){mY.call(e,n,i)}),c}function _Y(e,t){return dJ(e,t.tickDirection,t)}function vY(e,t){var n=R(e,2),r=n[0],i=n[1];return[[0,0],[r*t,i*t]]}function yY(e,t,n,r,i){var a=i.tickLength,o=R(vY(r,JW(a,[e,t,n])),2),s=R(o[0],2),c=s[0],l=s[1],u=R(o[1],2),d=u[0],f=u[1];return{x1:c,x2:d,y1:l,y2:f}}function bY(e,t,n,r,i){var a=i.tickFormatter,o=_Y(t.value,i),s=`line`;return W(a)&&(s=function(){return JW(a,[t,n,r,o])}),e.append(s).attr(`className`,Zq.tickItem.name)}function xY(e,t,n,r,i,a,o){var s=_Y(e.value,a),c=yY(e,t,n,s,a),l=c.x1,u=c.x2,d=c.y1,f=c.y2,p=R(QG(sJ(o,[e,t,n,s])),2),m=p[0],h=p[1];r.node().nodeName===`line`&&r.styles(L({x1:l,x2:u,y1:d,y2:f},m)),i.attr(h),r.styles(m)}function SY(e,t,n,r,i,a){var o=bY($(this),e,t,n,r);xY(e,t,n,o,this,r,i);var s=R(hJ(e.value,r),2),c=s[0],l=s[1];return Bq(this,{transform:`translate(${c}, ${l})`},a)}function CY(e,t,n,r){var i=cJ(t,n.tickFilter),a=XG(n,`tick`);return e.selectAll(Zq.tick.class).data(i,function(e){return e.id||e.label}).join(function(e){return e.append(`g`).attr(`className`,Zq.tick.name).transition(function(e,t){return SY.call(this,e,t,i,n,a,!1)})},function(e){return e.transition(function(e,t){return this.removeChildren(),SY.call(this,e,t,i,n,a,r.update)})},function(e){return e.transition(function(){var e=this,t=Vq(this.childNodes[0],r.exit);return Pq(t,function(){return e.remove()}),t})}).transitions()}function wY(e,t,n){var r=n.titlePosition,i=r===void 0?`lb`:r,a=n.titleSpacing,o=iK(i),s=e.node().getLocalBounds(),c=R(s.min,2),l=c[0],u=c[1],d=R(s.halfExtents,2),f=d[0],p=d[1],m=R(t.node().getLocalBounds().halfExtents,2),h=m[0],g=m[1],_=R([l+f,u+p],2),v=_[0],y=_[1],b=R(BG(a),4),x=b[0],S=b[1],C=b[2],w=b[3];if([`start`,`end`].includes(i)&&n.type===`linear`){var T=n.startPos,E=n.endPos,D=R(i===`start`?[T,E]:[E,T],2),O=D[0],k=D[1],A=TG([-k[0]+O[0],-k[1]+O[1]]),j=R(yG(A,x),2),ee=j[0],te=j[1];return{x:O[0]+ee,y:O[1]+te}}return o.includes(`t`)&&(y-=p+g+x),o.includes(`r`)&&(v+=f+h+S),o.includes(`l`)&&(v-=f+h+w),o.includes(`b`)&&(y+=p+g+C),{x:v,y}}function TY(e,t,n){var r=e.getGeometryBounds().halfExtents[1]*2;if(t===`vertical`){if(n===`left`)return`rotate(-90) translate(0, ${r/2})`;if(n===`right`)return`rotate(-90) translate(0, -${r/2})`}return``}function EY(e,t,n,r,i){var a=XG(r,`title`),o=R(QG(a),2),s=o[0],c=o[1],l=c.transform,u=c.transformOrigin,d=$t(c,[`transform`,`transformOrigin`]);t.styles(d);var f=l||TY(e.node(),s.direction,s.position);e.styles(L(L({},s),{transformOrigin:u})),tK(e.node(),f);var p=wY($(n._offscreen||n.querySelector(Zq.mainGroup.class)),t,r),m=p.x,h=p.y;return Bq(t.node(),{transform:`translate(${m}, ${h})`},i)}function DY(e,t,n,r){var i=n.titleText;return e.selectAll(Zq.title.class).data([{title:i}].filter(function(e){return!!e.title}),function(e,t){return e.title}).join(function(a){return a.append(function(){return lG(i)}).attr(`className`,Zq.title.name).transition(function(){return EY($(this),e,t,n,r.enter)})},function(i){return i.transition(function(){return EY($(this),e,t,n,r.update)})},function(e){return e.remove()}).transitions()}function OY(e,t,n,r){var i=e.showLine,a=e.showTick,o=e.showLabel,s=t.maybeAppendByClassName(Zq.lineGroup,`g`),c=fG(i,s,function(t){return DJ(t,e,r)})||[],l=t.maybeAppendByClassName(Zq.tickGroup,`g`),u=fG(a,l,function(t){return CY(t,n,e,r)})||[],d=t.maybeAppendByClassName(Zq.labelGroup,`g`),f=fG(o,d,function(i){return gY(i,n,e,r,t.node())})||[];return z(z(z([],R(c),!1),R(u),!1),R(f),!1).filter(function(e){return!!e})}var kY=function(e){Qt(t,e);function t(t){return e.call(this,t,Xq)||this}return t.prototype.render=function(e,t,n){var r=this,i=e.titleText,a=e.data,o=e.animate,s=e.showTitle,c=e.showGrid,l=e.dataThreshold,u=e.truncRange,d=PG(a,l).filter(function(e){var t=e.value;return!(u&&t>u[0]&&t<u[1])}),f=Nq(n===void 0?o:n),p=$(t).maybeAppendByClassName(Zq.gridGroup,`g`),m=fG(c,p,function(t){return MJ(t,d,e,f)})||[],h=$(t).maybeAppendByClassName(Zq.mainGroup,`g`);i&&(!this.initialized&&f.enter||this.initialized&&f.update)&&OY(e,$(this.offscreenGroup),d,Nq(!1));var g=OY(e,$(h.node()),d,f),_=$(t).maybeAppendByClassName(Zq.titleGroup,`g`),v=fG(s,_,function(t){return DY(t,r,e,f)})||[];return z(z(z([],R(m),!1),R(g),!1),R(v),!1).flat().filter(function(e){return!!e})},t}(sK),AY=YW({text:`text`},`title`);function jY(e,t){var n=e.attributes,r=n.position,i=n.spacing,a=n.inset,o=n.text,s=e.getBBox(),c=t.getBBox(),l=iK(r),u=R(BG(o?i:0),4),d=u[0],f=u[1],p=u[2],m=u[3],h=R(BG(a),4),g=h[0],_=h[1],v=h[2],y=h[3],b=R([m+f,d+p],2),x=b[0],S=b[1],C=R([y+_,g+v],2),w=C[0],T=C[1];if(l[0]===`l`)return new qW(s.x,s.y,c.width+s.width+x+w,Math.max(c.height+T,s.height));if(l[0]===`t`)return new qW(s.x,s.y,Math.max(c.width+w,s.width),c.height+s.height+S+T);var E=R([t.attributes.width||c.width,t.attributes.height||c.height],2),D=E[0],O=E[1];return new qW(c.x,c.y,D+s.width+x+w,O+s.height+S+T)}function MY(e,t){var n=Object.entries(t).reduce(function(t,n){var r=R(n,2),i=r[0],a=r[1];return e.node().attr(i)||(t[i]=a),t},{});e.styles(n)}function NY(e){var t,n,r,i,a=e,o=a.width,s=a.height,c=a.position,l=R([o/2,s/2],2),u=l[0],d=l[1],f=R([+u,+d,`center`,`middle`],4),p=f[0],m=f[1],h=f[2],g=f[3],_=iK(c);return _.includes(`l`)&&(t=R([0,`start`],2),p=t[0],h=t[1]),_.includes(`r`)&&(n=R([+o,`end`],2),p=n[0],h=n[1]),_.includes(`t`)&&(r=R([0,`top`],2),m=r[0],g=r[1]),_.includes(`b`)&&(i=R([+s,`bottom`],2),m=i[0],g=i[1]),{x:p,y:m,textAlign:h,textBaseline:g}}var PY=function(e){Qt(t,e);function t(t){return e.call(this,t,{text:``,width:0,height:0,fill:`#4a505a`,fontWeight:`bold`,fontSize:12,fontFamily:`sans-serif`,inset:0,spacing:0,position:`top-left`})||this}return t.prototype.getAvailableSpace=function(){var e=this,t=this.attributes,n=t.width,r=t.height,i=t.position,a=t.spacing,o=t.inset,s=e.querySelector(AY.text.class);if(!s)return new qW(0,0,+n,+r);var c=s.getBBox(),l=c.width,u=c.height,d=R(BG(a),4),f=d[0],p=d[1],m=d[2],h=d[3],g=R([0,0,+n,+r],4),_=g[0],v=g[1],y=g[2],b=g[3],x=iK(i);if(x.includes(`i`))return new qW(_,v,y,b);x.forEach(function(e,t){var i,a,o,s;e===`t`&&(i=R(t===0?[u+m,+r-u-m]:[0,+r],2),v=i[0],b=i[1]),e===`r`&&(a=R([+n-l-h],1),y=a[0]),e===`b`&&(o=R([+r-u-f],1),b=o[0]),e===`l`&&(s=R(t===0?[l+p,+n-l-p]:[0,+n],2),_=s[0],y=s[1])});var S=R(BG(o),4),C=S[0],w=S[1],T=S[2],E=S[3],D=R([E+w,C+T],2),O=D[0],k=D[1];return new qW(_+E,v+C,y-O,b-k)},t.prototype.getBBox=function(){return this.title?this.title.getBBox():new qW(0,0,0,0)},t.prototype.render=function(e,t){var n=this;e.width,e.height,e.position,e.spacing;var r=$t(e,[`width`,`height`,`position`,`spacing`]),i=R(QG(r),1),a=i[0],o=NY(e),s=o.x,c=o.y,l=o.textAlign,u=o.textBaseline;fG(!!r.text,$(t),function(e){n.title=e.maybeAppendByClassName(AY.text,`text`).styles(a).call(MY,{x:s,y:c,textAlign:l,textBaseline:u}).node()})},t}(sK),FY=YW({prevBtnGroup:`prev-btn-group`,prevBtn:`prev-btn`,nextBtnGroup:`next-btn-group`,nextBtn:`next-btn`,pageInfoGroup:`page-info-group`,pageInfo:`page-info`,playWindow:`play-window`,contentGroup:`content-group`,controller:`controller`,clipPath:`clip-path`},`navigator`),IY=function(e){Qt(t,e);function t(t){var n=e.call(this,t,{x:0,y:0,animate:{easing:`linear`,duration:200,fill:`both`},buttonCursor:`pointer`,buttonFill:`black`,buttonD:OK(0,0,6),buttonSize:12,controllerPadding:5,controllerSpacing:5,formatter:function(e,t){return`${e}/${t}`},defaultPage:0,loop:!1,orientation:`horizontal`,pageNumFill:`black`,pageNumFontSize:12,pageNumTextAlign:`start`,pageNumTextBaseline:`middle`})||this;return n.playState=`idle`,n.contentGroup=n.appendChild(new Ny({class:FY.contentGroup.name})),n.playWindow=n.contentGroup.appendChild(new Ny({class:FY.playWindow.name})),n.innerCurrPage=n.defaultPage,n}return Object.defineProperty(t.prototype,`defaultPage`,{get:function(){var e=this.attributes.defaultPage;return cu(e,0,Math.max(this.pageViews.length-1,0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`pageViews`,{get:function(){return this.playWindow.children},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`controllerShape`,{get:function(){return this.totalPages>1?{width:55,height:0}:{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`pageShape`,{get:function(){var e=this.pageViews,t=R(nK(e.map(function(e){var t=e.getBBox(),n=t.width,r=t.height;return[n,r]})).map(function(e){return Math.max.apply(Math,z([],R(e),!1))}),2),n=t[0],r=t[1],i=this.attributes,a=i.pageWidth,o=a===void 0?n:a,s=i.pageHeight;return{pageWidth:o,pageHeight:s===void 0?r:s}},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.playWindow},Object.defineProperty(t.prototype,`totalPages`,{get:function(){return this.pageViews.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`currPage`,{get:function(){return this.innerCurrPage},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var t=e.prototype.getBBox.call(this),n=t.x,r=t.y,i=this.controllerShape,a=this.pageShape,o=a.pageWidth,s=a.pageHeight;return new qW(n,r,o+i.width,s)},t.prototype.goTo=function(e){var t=this,n=this.attributes.animate,r=this,i=r.currPage,a=r.playState,o=r.playWindow,s=r.pageViews;if(a!==`idle`||e<0||s.length<=0||e>=s.length)return null;s[i].setLocalPosition(0,0),this.prepareFollowingPage(e);var c=R(this.getFollowingPageDiff(e),2),l=c[0],u=c[1];this.playState=`running`;var d=Lq(o,[{transform:`translate(0, 0)`},{transform:`translate(${-l}, ${-u})`}],n);return Pq(d,function(){t.innerCurrPage=e,t.playState=`idle`,t.setVisiblePages([e]),t.updatePageInfo()}),d},t.prototype.prev=function(){var e=this.attributes.loop,t=this.pageViews.length,n=this.currPage;if(!e&&n<=0)return null;var r=e?(n-1+t)%t:cu(n-1,0,t);return this.goTo(r)},t.prototype.next=function(){var e=this.attributes.loop,t=this.pageViews.length,n=this.currPage;if(!e&&n>=t-1)return null;var r=e?(n+1)%t:cu(n+1,0,t);return this.goTo(r)},t.prototype.renderClipPath=function(e){var t=this.pageShape,n=t.pageWidth,r=t.pageHeight;if(!n||!r){this.contentGroup.style.clipPath=void 0;return}this.clipPath=e.maybeAppendByClassName(FY.clipPath,`rect`).styles({width:n,height:r}),this.contentGroup.attr(`clipPath`,this.clipPath.node())},t.prototype.setVisiblePages=function(e){this.playWindow.children.forEach(function(t,n){e.includes(n)?RW(t):zW(t)})},t.prototype.adjustControllerLayout=function(){var e=this,t=e.prevBtnGroup,n=e.nextBtnGroup,r=e.pageInfoGroup,i=this.attributes,a=i.orientation,o=i.controllerPadding,s=r.getBBox(),c=s.width;s.height;var l=R(a===`horizontal`?[-180,0]:[-90,90],2),u=l[0],d=l[1];t.setLocalEulerAngles(u),n.setLocalEulerAngles(d);var f=t.getBBox(),p=f.width,m=f.height,h=n.getBBox(),g=h.width,_=h.height,v=Math.max(p,c,g),y=a===`horizontal`?{offset:[[0,0],[p/2+o,0],[p+c+o*2,0]],textAlign:`start`}:{offset:[[v/2,-m-o],[v/2,0],[v/2,_+o]],textAlign:`center`},b=R(y.offset,3),x=R(b[0],2),S=x[0],C=x[1],w=R(b[1],2),T=w[0],E=w[1],D=R(b[2],2),O=D[0],k=D[1],A=y.textAlign,j=r.querySelector(`text`);j&&(j.style.textAlign=A),t.setLocalPosition(S,C),r.setLocalPosition(T,E),n.setLocalPosition(O,k)},t.prototype.updatePageInfo=function(){var e,t=this,n=t.currPage,r=t.pageViews,i=t.attributes.formatter;r.length<2||((e=this.pageInfoGroup.querySelector(FY.pageInfo.class))==null||e.attr(`text`,i(n+1,r.length)),this.adjustControllerLayout())},t.prototype.getFollowingPageDiff=function(e){var t=this.currPage;if(t===e)return[0,0];var n=this.attributes.orientation,r=this.pageShape,i=r.pageWidth,a=r.pageHeight,o=e<t?-1:1;return n===`horizontal`?[o*i,0]:[0,o*a]},t.prototype.prepareFollowingPage=function(e){var t=this,n=t.currPage,r=t.pageViews;if(this.setVisiblePages([e,n]),e!==n){var i=R(this.getFollowingPageDiff(e),2),a=i[0],o=i[1];r[e].setLocalPosition(a,o)}},t.prototype.renderController=function(e){var t=this,n=this.attributes.controllerSpacing,r=this.pageShape,i=r.pageWidth,a=r.pageHeight,o=this.pageViews.length>=2,s=e.maybeAppendByClassName(FY.controller,`g`);if(BW(s.node(),o),o){var c=XG(this.attributes,`button`),l=XG(this.attributes,`pageNum`),u=R(QG(c),2),d=u[0],f=u[1],p=d.size,m=$t(d,[`size`]),h=!s.select(FY.prevBtnGroup.class).node(),g=s.maybeAppendByClassName(FY.prevBtnGroup,`g`).styles(f);this.prevBtnGroup=g.node();var _=g.maybeAppendByClassName(FY.prevBtn,`path`),v=s.maybeAppendByClassName(FY.nextBtnGroup,`g`).styles(f);this.nextBtnGroup=v.node();var y=v.maybeAppendByClassName(FY.nextBtn,`path`);[_,y].forEach(function(e){e.styles(L(L({},m),{transformOrigin:`center`})),FG(e.node(),p,!0)});var b=s.maybeAppendByClassName(FY.pageInfoGroup,`g`);this.pageInfoGroup=b.node(),b.maybeAppendByClassName(FY.pageInfo,`text`).styles(l),this.updatePageInfo(),s.node().setLocalPosition(i+n,a/2),h&&(this.prevBtnGroup.addEventListener(`click`,function(){t.prev()}),this.nextBtnGroup.addEventListener(`click`,function(){t.next()}))}},t.prototype.render=function(e,t){var n=e.x,r=n===void 0?0:n,i=e.y,a=i===void 0?0:i;this.attr(`transform`,`translate(${r}, ${a})`);var o=$(t);this.renderClipPath(o),this.renderController(o),this.setVisiblePages([this.defaultPage]),this.goTo(this.defaultPage)},t.prototype.bindEvents=function(){var e=this,t=Nu(function(){return e.render(e.attributes,e)},50);this.playWindow.addEventListener(Nv.INSERTED,t),this.playWindow.addEventListener(Nv.REMOVED,t)},t}(sK);function LY(e,t,n){var r=1.4*n;return[[`M`,e-n,t-r],[`L`,e+n,t-r],[`L`,e+n,t+r],[`L`,e-n,t+r],[`Z`]]}var RY=1.4,zY=.4;function BY(e,t,n){var r=n,i=r*RY,a=r/2,o=r/6,s=e+i*zY;return[[`M`,e,t],[`L`,s,t+a],[`L`,e+i,t+a],[`L`,e+i,t-a],[`L`,s,t-a],[`Z`],[`M`,s,t+o],[`L`,e+i-2,t+o],[`M`,s,t-o],[`L`,e+i-2,t-o]]}function VY(e,t,n){var r=n,i=r*RY,a=r/2,o=r/6,s=t+i*zY;return[[`M`,e,t],[`L`,e-a,s],[`L`,e-a,t+i],[`L`,e+a,t+i],[`L`,e+a,s],[`Z`],[`M`,e-o,s],[`L`,e-o,t+i-2],[`M`,e+o,s],[`L`,e+o,t+i-2]]}MK.registerSymbol(`hiddenHandle`,LY),MK.registerSymbol(`verticalHandle`,BY),MK.registerSymbol(`horizontalHandle`,VY);function HY(e,t,n){return e===void 0&&(e=`horizontal`),e===`horizontal`?t:n}var UY,WY={CONTAINER:`component-poptip`,ARROW:`component-poptip-arrow`,TEXT:`component-poptip-text`},GY=(UY={},UY[`.${WY.CONTAINER}`]={visibility:`visible`,position:`absolute`,"background-color":`rgba(0, 0, 0)`,"box-shadow":`0px 0px 10px #aeaeae`,"border-radius":`3px`,color:`#fff`,opacity:.8,"font-size":`12px`,padding:`4px 6px`,display:`flex`,"justify-content":`center`,"align-items":`center`,"z-index":8,transition:`visibility 50ms`},UY[`.${WY.TEXT}`]={"text-align":`center`},UY[`.${WY.CONTAINER}[data-position='top']`]={transform:`translate(-50%, -100%)`},UY[`.${WY.CONTAINER}[data-position='left']`]={transform:`translate(-100%, -50%)`},UY[`.${WY.CONTAINER}[data-position='right']`]={transform:`translate(0, -50%)`},UY[`.${WY.CONTAINER}[data-position='bottom']`]={transform:`translate(-50%, 0)`},UY[`.${WY.CONTAINER}[data-position='top-left']`]={transform:`translate(0,-100%)`},UY[`.${WY.CONTAINER}[data-position='top-right']`]={transform:`translate(-100%,-100%)`},UY[`.${WY.CONTAINER}[data-position='left-top']`]={transform:`translate(-100%, 0)`},UY[`.${WY.CONTAINER}[data-position='left-bottom']`]={transform:`translate(-100%, -100%)`},UY[`.${WY.CONTAINER}[data-position='right-top']`]={transform:`translate(0, 0)`},UY[`.${WY.CONTAINER}[data-position='right-bottom']`]={transform:`translate(0, -100%)`},UY[`.${WY.CONTAINER}[data-position='bottom-left']`]={transform:`translate(0, 0)`},UY[`.${WY.CONTAINER}[data-position='bottom-right']`]={transform:`translate(-100%, 0)`},UY[`.${WY.ARROW}`]={width:`4px`,height:`4px`,transform:`rotate(45deg)`,"background-color":`rgba(0, 0, 0)`,position:`absolute`,"z-index":-1},UY[`.${WY.CONTAINER}[data-position='top']`]={transform:`translate(-50%, calc(-100% - 5px))`},UY[`[data-position='top'] .${WY.ARROW}`]={bottom:`-2px`},UY[`.${WY.CONTAINER}[data-position='left']`]={transform:`translate(calc(-100% - 5px), -50%)`},UY[`[data-position='left'] .${WY.ARROW}`]={right:`-2px`},UY[`.${WY.CONTAINER}[data-position='right']`]={transform:`translate(5px, -50%)`},UY[`[data-position='right'] .${WY.ARROW}`]={left:`-2px`},UY[`.${WY.CONTAINER}[data-position='bottom']`]={transform:`translate(-50%, 5px)`},UY[`[data-position='bottom'] .${WY.ARROW}`]={top:`-2px`},UY[`.${WY.CONTAINER}[data-position='top-left']`]={transform:`translate(0, calc(-100% - 5px))`},UY[`[data-position='top-left'] .${WY.ARROW}`]={left:`10px`,bottom:`-2px`},UY[`.${WY.CONTAINER}[data-position='top-right']`]={transform:`translate(-100%, calc(-100% - 5px))`},UY[`[data-position='top-right'] .${WY.ARROW}`]={right:`10px`,bottom:`-2px`},UY[`.${WY.CONTAINER}[data-position='left-top']`]={transform:`translate(calc(-100% - 5px), 0)`},UY[`[data-position='left-top'] .${WY.ARROW}`]={right:`-2px`,top:`8px`},UY[`.${WY.CONTAINER}[data-position='left-bottom']`]={transform:`translate(calc(-100% - 5px), -100%)`},UY[`[data-position='left-bottom'] .${WY.ARROW}`]={right:`-2px`,bottom:`8px`},UY[`.${WY.CONTAINER}[data-position='right-top']`]={transform:`translate(5px, 0)`},UY[`[data-position='right-top'] .${WY.ARROW}`]={left:`-2px`,top:`8px`},UY[`.${WY.CONTAINER}[data-position='right-bottom']`]={transform:`translate(5px, -100%)`},UY[`[data-position='right-bottom'] .${WY.ARROW}`]={left:`-2px`,bottom:`8px`},UY[`.${WY.CONTAINER}[data-position='bottom-left']`]={transform:`translate(0, 5px)`},UY[`[data-position='bottom-left'] .${WY.ARROW}`]={top:`-2px`,left:`8px`},UY[`.${WY.CONTAINER}[data-position='bottom-right']`]={transform:`translate(-100%, 5px)`},UY[`[data-position='bottom-right'] .${WY.ARROW}`]={top:`-2px`,right:`8px`},UY),KY=void 0;function qY(e,t,n,r,i,a){if(i===void 0&&(i=!1),a===void 0&&(a=!1),a)return[e,t];var o=n.getBoundingClientRect(),s=o.x,c=o.y,l=o.width,u=o.height;switch(r){case`top`:return i?[s+l/2,c]:[e,c];case`left`:return i?[s,c+u/2]:[s,t];case`bottom`:return i?[s+l/2,c+u]:[e,c+u];case`right`:return i?[s+l,c+u/2]:[s+l,t];case`top-right`:case`right-top`:return[s+l,c];case`left-bottom`:case`bottom-left`:return[s,c+u];case`right-bottom`:case`bottom-right`:return[s+l,c+u];case`top-left`:case`left-top`:default:return[s,c]}}var JY=function(e){var t;return function(){var n=[...arguments];return t||=e.apply(KY,n),t}};function YY(e){var t=e&&document.getElementById(e);return t||(t=document.createElement(`div`),t.setAttribute(`id`,e),document.body.appendChild(t)),t}function XY(e){return JY(YY)(e)}var ZY=function(e){Qt(t,e);function t(n){var r=e.call(this,Bu({style:{id:`component-poptip`}},t.defaultOptions,n))||this;return r.visibility=`visible`,r.map=new Map,r.domStyles=``,r.initShape(),r.render(r.attributes,r),r}return Object.defineProperty(t.prototype,`visible`,{get:function(){return this.visibility===`visible`},enumerable:!1,configurable:!0}),t.prototype.render=function(e,t){this.visibility=this.style.visibility,this.updatePoptipElement()},t.prototype.update=function(e){this.attr(Bu({},this.style,e)),this.render(this.attributes,this)},t.prototype.bind=function(e,t){var n=this;if(e){var r=this.style.text,i=function(i){var a=e,o=n.style,s=r;if(t){var c=typeof t==`function`?t.call(null,i):t,l=c.html,u=c.target,d=$t(c,[`html`,`target`]);o=ku({},n.style,d),(u||u===!1)&&(a=u),typeof l==`string`&&(s=l)}var f=o.position,p=o.arrowPointAtCenter,m=o.follow,h=o.offset;if(a){var g=i,_=g.clientX,v=g.clientY,y=R(qY(_,v,a,f,p,m),2),b=y[0],x=y[1];n.showTip(b,x,{text:s,position:f,offset:h})}else n.hideTip()},a=function(){n.hideTip()};e.addEventListener(`mousemove`,i),e.addEventListener(`mouseleave`,a),this.map.set(e,[i,a])}},t.prototype.unbind=function(e){if(this.map.has(e)){var t=R(this.map.get(e)||[],2),n=t[0],r=t[1];n&&e.removeEventListener(`mousemove`,n),r&&e.removeEventListener(`mouseleave`,r),this.map.delete(e)}},t.prototype.clear=function(){this.container.innerHTML=``},t.prototype.destroy=function(){var t=this,n;z([],R(this.map.keys()),!1).forEach(function(e){return t.unbind(e)}),(n=this.container)==null||n.remove(),e.prototype.destroy.call(this)},t.prototype.showTip=function(e,t,n){var r=Ku(n,`text`);if(!(r&&typeof r!=`string`)&&(this.applyStyles(),e&&t&&n)){var i=n.offset,a=n.position;if(a&&this.container.setAttribute(`data-position`,a),this.setOffsetPosition(e,t,i),typeof r==`string`){var o=this.container.querySelector(`.${WY.TEXT}`);o&&(o.innerHTML=r)}this.visibility=`visible`,this.container.style.visibility=`visible`}},t.prototype.hideTip=function(){this.visibility=`hidden`,this.container.style.visibility=`hidden`},t.prototype.getContainer=function(){return this.container},t.prototype.getClassName=function(){var e=this.style.containerClassName;return`${WY.CONTAINER}${e?` ${e}`:``}`},t.prototype.initShape=function(){var e=this,t=this.style.id;this.container=XY(t),this.container.className=this.getClassName(),this.container.addEventListener(`mousemove`,function(){return e.showTip()}),this.container.addEventListener(`mouseleave`,function(){return e.hideTip()})},t.prototype.updatePoptipElement=function(){var e=this.container;this.clear();var t=this.style,n=t.id,r=t.template,i=t.text;this.container.setAttribute(`id`,n),this.container.className=this.getClassName(),e.innerHTML=`<span class="${WY.ARROW}"></span>`,ru(r)?e.innerHTML+=r:r&&Du(r)&&e.appendChild(r),i&&(e.getElementsByClassName(WY.TEXT)[0].textContent=i),this.applyStyles(),this.container.style.visibility=this.visibility},t.prototype.applyStyles=function(){var e=QW({},GY,this.style.domStyles),t=Object.entries(e).reduce(function(e,t){var n=R(t,2),r=n[0],i=n[1],a=Object.entries(i).reduce(function(e,t){var n=R(t,2),r=n[0],i=n[1];return`${e}${r}: ${i};`},``);return`${e}${r}{${a}}`},``);if(this.domStyles!==t){this.domStyles=t;var n=this.container.querySelector(`style`);n&&this.container.removeChild(n),n=document.createElement(`style`),n.innerHTML=t,this.container.appendChild(n)}},t.prototype.setOffsetPosition=function(e,t,n){n===void 0&&(n=this.style.offset);var r=R(n,2),i=r[0],a=i===void 0?0:i,o=r[1],s=o===void 0?0:o;this.container.style.left=`${e+a}px`,this.container.style.top=`${t+s}px`},t.tag=`poptip`,t.defaultOptions={style:{x:0,y:0,width:0,height:0,target:null,visibility:`hidden`,text:``,position:`top`,follow:!1,offset:[0,0],domStyles:GY,template:`<div class="${WY.TEXT}"></div>`}},t}(sK),QY=YW({layout:`flex`,markerGroup:`marker-group`,marker:`marker`,labelGroup:`label-group`,label:`label`,valueGroup:`value-group`,focusGroup:`focus-group`,focus:`focus`,value:`value`,backgroundGroup:`background-group`,background:`background`},`legend-category-item`),$Y={offset:[0,20],domStyles:{".component-poptip":{opacity:`1`,padding:`8px 12px`,background:`#fff`,boxShadow:`0 2px 8px rgba(0, 0, 0, 0.15)`},".component-poptip-arrow":{display:`none`},".component-poptip-text":{color:`#000`,lineHeight:`20px`}}};function eX(e){var t=e.querySelector(QY.marker.class);return t?t.style:{}}var tX=function(e){Qt(t,e);function t(t){return e.call(this,t,{span:[1,1],marker:function(){return new Oy({style:{r:6}})},markerSize:10,labelFill:`#646464`,valueFill:`#646464`,labelFontSize:12,valueFontSize:12,labelTextBaseline:`middle`,valueTextBaseline:`middle`})||this}return Object.defineProperty(t.prototype,`showValue`,{get:function(){var e=this.attributes.valueText;return e?typeof e==`string`||typeof e==`number`?e!==``:typeof e==`function`?!0:e.attr(`text`)!==``:!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`actualSpace`,{get:function(){var e=this.labelGroup,t=this.valueGroup,n=this.attributes,r=n.markerSize,i=n.focus,a=n.focusMarkerSize,o=e.node().getBBox(),s=o.width,c=o.height,l=t.node().getBBox(),u=l.width,d=l.height;return{markerWidth:r,labelWidth:s,valueWidth:u,focusWidth:i?a??12:0,height:Math.max(r,c,d)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`span`,{get:function(){var e=this.attributes.span;if(!e)return[1,1];var t=R(BG(e),2),n=t[0],r=t[1],i=this.showValue?r:0,a=n+i;return[n/a,i/a]},enumerable:!1,configurable:!0}),t.prototype.setAttribute=function(t,n){e.prototype.setAttribute.call(this,t,n)},Object.defineProperty(t.prototype,`shape`,{get:function(){var e,t=this.attributes,n=t.markerSize,r=t.width,i=this.actualSpace,a=i.markerWidth,o=i.focusWidth,s=i.height,c=this.actualSpace,l=c.labelWidth,u=c.valueWidth,d=R(this.spacing,3),f=d[0],p=d[1],m=d[2];if(r){var h=r-n-f-p-o-m,g=R(this.span,2),_=g[0],v=g[1];e=R([_*h,v*h],2),l=e[0],u=e[1]}return{width:a+l+u+f+p+o+m,height:s,markerWidth:a,labelWidth:l,valueWidth:u,focusWidth:o}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`spacing`,{get:function(){var e=this.attributes,t=e.spacing,n=e.focus;if(!t)return[0,0,0];var r=R(BG(t),3),i=r[0],a=r[1],o=r[2];return[i,this.showValue?a:0,n?o:0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`layout`,{get:function(){var e=this.shape,t=e.markerWidth,n=e.labelWidth,r=e.valueWidth,i=e.focusWidth,a=e.width,o=e.height,s=R(this.spacing,3),c=s[0],l=s[1],u=s[2];return{height:o,width:a,markerWidth:t,labelWidth:n,valueWidth:r,focusWidth:i,position:[t/2,t+c,t+n+c+l,t+n+r+c+l+u+i/2]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`scaleSize`,{get:function(){var e=eX(this.markerGroup.node()),t=this.attributes,n=t.markerSize,r=t.markerStrokeWidth,i=r===void 0?e.strokeWidth:r,a=t.markerLineWidth,o=a===void 0?e.lineWidth:a,s=t.markerStroke,c=s===void 0?e.stroke:s,l=+(i||o||(c?1:0))*Math.sqrt(2),u=this.markerGroup.node().getBBox(),d=u.width,f=u.height;return(1-l/Math.max(d,f))*n},enumerable:!1,configurable:!0}),t.prototype.renderMarker=function(e){var t=this,n=this.attributes.marker,r=XG(this.attributes,`marker`);this.markerGroup=e.maybeAppendByClassName(QY.markerGroup,`g`).style(`zIndex`,0),fG(!!n,this.markerGroup,function(){var e=t.markerGroup.node(),i=e.childNodes?.[0],a=typeof n==`string`?new MK({style:{symbol:n},className:QY.marker.name}):n();i?a.nodeName===i.nodeName?i instanceof MK?i.update(L(L({},r),{symbol:n})):(UG(i,a),$(i).styles(r)):(i.remove(),$(a).attr(`className`,QY.marker.name).styles(r),e.appendChild(a)):(a instanceof MK||$(a).attr(`className`,QY.marker.name).styles(r),e.appendChild(a)),t.markerGroup.node().scale(1/t.markerGroup.node().getScale()[0]);var o=FG(t.markerGroup.node(),t.scaleSize,!0);t.markerGroup.node().style._transform=`scale(${o})`})},t.prototype.renderLabel=function(e){var t=XG(this.attributes,`label`),n=t.text,r=$t(t,[`text`]);this.labelGroup=e.maybeAppendByClassName(QY.labelGroup,`g`).style(`zIndex`,0),this.labelGroup.maybeAppendByClassName(QY.label,function(){return lG(n)}).styles(r)},t.prototype.renderValue=function(e){var t=this,n=XG(this.attributes,`value`),r=n.text,i=$t(n,[`text`]);this.valueGroup=e.maybeAppendByClassName(QY.valueGroup,`g`).style(`zIndex`,0),fG(this.showValue,this.valueGroup,function(){t.valueGroup.maybeAppendByClassName(QY.value,function(){return lG(r)}).styles(i)})},t.prototype.createPoptip=function(){var e=this.attributes.poptip||{};e.render;var t=$t(e,[`render`]),n=new ZY({style:QW($Y,t)});return this.poptipGroup=n,n},t.prototype.bindPoptip=function(e){var t=this,n=this.attributes.poptip;n&&(this.poptipGroup||this.createPoptip()).bind(e,function(){var e=t.attributes,r=e.labelText,i=e.valueText,a=e.markerFill,o=typeof r==`string`?r:r?.attr(`text`),s=typeof i==`string`?i:i?.attr(`text`);if(typeof n.render==`function`)return{html:n.render({label:o,value:s,color:a})};var c=``;return(typeof o==`string`||typeof o==`number`)&&(c+=`<div class="component-poptip-label">${o}</div>`),(typeof s==`string`||typeof s==`number`)&&(c+=`<div class="component-poptip-value">${s}</div>`),{html:c}})},t.prototype.renderFocus=function(e){var t=this,n=this.attributes,r=n.focus,i={x:0,y:0,size:n.focusMarkerSize,opacity:.6,symbol:`focus`,stroke:`#aaaaaa`,lineWidth:1};Eu(r)||(this.focusGroup=e.maybeAppendByClassName(QY.focusGroup,`g`).style(`zIndex`,0),fG(r,this.focusGroup,function(){var n=new MK({style:L(L({},i),{symbol:`focus`})}),r=new Oy({style:{r:i.size/2,fill:`transparent`}}),a=t.focusGroup.node();a.appendChild(r),a.appendChild(n),n.update({opacity:0}),e.node().addEventListener(`pointerenter`,function(){n.update({opacity:1})}),e.node().addEventListener(`pointerleave`,function(){n.update({opacity:0})})}))},t.prototype.renderPoptip=function(e){var t=this;if(this.attributes.poptip){var n=e.maybeAppendByClassName(QY.value,`g`).node(),r=e.maybeAppendByClassName(QY.label,`g`).node();[n,r].forEach(function(e){e&&t.bindPoptip(e)})}},t.prototype.renderBackground=function(e){var t=this.shape,n=t.width,r=t.height,i=XG(this.attributes,`background`);this.background=e.maybeAppendByClassName(QY.backgroundGroup,`g`).style(`zIndex`,-1),this.background.maybeAppendByClassName(QY.background,`rect`).styles(L({width:n,height:r},i))},t.prototype.adjustLayout=function(){var e=this.layout,t=e.labelWidth,n=e.valueWidth,r=e.height,i=R(e.position,4),a=i[0],o=i[1],s=i[2],c=i[3],l=r/2;this.markerGroup.styles({transform:`translate(${a}, ${l})${this.markerGroup.node().style._transform}`}),this.labelGroup.styles({transform:`translate(${o}, ${l})`}),this.focusGroup&&this.focusGroup.styles({transform:`translate(${c}, ${l})`}),oG(this.labelGroup.select(QY.label.class).node(),Math.ceil(t)),this.showValue&&(this.valueGroup.styles({transform:`translate(${s}, ${l})`}),oG(this.valueGroup.select(QY.value.class).node(),Math.ceil(n)))},t.prototype.render=function(e,t){var n=$(t),r=e.x,i=r===void 0?0:r,a=e.y,o=a===void 0?0:a;n.styles({transform:`translate(${i}, ${o})`}),this.renderMarker(n),this.renderLabel(n),this.renderValue(n),this.renderBackground(n),this.renderPoptip(n),this.renderFocus(n),this.adjustLayout()},t}(sK),nX=YW({page:`item-page`,navigator:`navigator`,item:`item`},`items`),rX=function(e,t,n){return n===void 0&&(n=!0),e?t(e):n},iX=function(e){Qt(t,e);function t(t){var n=e.call(this,t,{data:[],gridRow:1/0,gridCol:void 0,padding:0,width:1e3,height:100,rowPadding:0,colPadding:0,layout:`flex`,orientation:`horizontal`,click:ed,mouseenter:ed,mouseleave:ed})||this;return n.navigatorShape=[0,0],n}return Object.defineProperty(t.prototype,`pageViews`,{get:function(){return this.navigator.getContainer()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`grid`,{get:function(){var e=this.attributes,t=e.gridRow,n=e.gridCol,r=e.data;if(!t&&!n)throw Error(`gridRow and gridCol can not be set null at the same time`);return t&&n?[t,n]:t?[t,r.length]:[r.length,n]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`renderData`,{get:function(){var e=this.attributes,t=e.data,n=e.layout,r=e.poptip,i=e.focus,a=e.focusMarkerSize,o=XG(this.attributes,`item`);return t.map(function(e,s){var c=e.id,l=c===void 0?s:c,u=e.label,d=e.value;return{id:`${l}`,index:s,style:L({layout:n,labelText:u,valueText:d,poptip:r,focus:i,focusMarkerSize:a},Object.fromEntries(Object.entries(o).map(function(n){var r=R(n,2),i=r[0],a=r[1];return[i,JW(a,[e,s,t])]})))}})},enumerable:!1,configurable:!0}),t.prototype.getGridLayout=function(){var e=this,t=this.attributes,n=t.orientation,r=t.width,i=t.rowPadding,a=t.colPadding,o=R(this.navigatorShape,1),s=o[0],c=R(this.grid,2),l=c[0],u=c[1],d=u*l,f=0;return this.pageViews.children.map(function(t,o){var c,p,m=Math.floor(o/d),h=o%d,g=e.ifHorizontal(u,l),_=[Math.floor(h/g),h%g];n===`vertical`&&_.reverse();var v=R(_,2),y=v[0],b=v[1],x=(r-s-(u-1)*a)/u,S=t.getBBox().height,C=R([0,0],2),w=C[0],T=C[1];return n===`horizontal`?(c=R([f,y*(S+i)],2),w=c[0],T=c[1],f=b===u-1?0:f+x+a):(p=R([b*(x+a),f],2),w=p[0],T=p[1],f=y===l-1?0:f+S+i),{page:m,index:o,row:y,col:b,pageIndex:h,width:x,height:S,x:w,y:T}})},t.prototype.getFlexLayout=function(){var e=this.attributes,t=e.width,n=e.height,r=e.rowPadding,i=e.colPadding,a=R(this.navigatorShape,1),o=a[0],s=R(this.grid,2),c=s[0],l=s[1],u=R([t-o,n],2),d=u[0],f=u[1],p=R([0,0,0,0,0,0,0,0],8),m=p[0],h=p[1],g=p[2],_=p[3],v=p[4],y=p[5],b=p[6],x=p[7];return this.pageViews.children.map(function(e,t){var n,a,o,s,u=e.getBBox(),p=u.width,S=u.height,C=b===0?0:i,w=b+C+p;return w<=d&&rX(v,function(e){return e<l})?(n=R([b+C,x,w],3),m=n[0],h=n[1],b=n[2],{width:p,height:S,x:m,y:h,page:g,index:t,pageIndex:_++,row:y,col:v++}):(a=R([y+1,0,0,x+S+r],4),y=a[0],v=a[1],b=a[2],x=a[3],x+S<=f&&rX(y,function(e){return e<c})?(o=R([b,x,p],3),m=o[0],h=o[1],b=o[2],{width:p,height:S,x:m,y:h,page:g,index:t,pageIndex:_++,row:y,col:v++}):(s=R([0,0,p,0,g+1,0,0,0],8),m=s[0],h=s[1],b=s[2],x=s[3],g=s[4],_=s[5],y=s[6],v=s[7],{width:p,height:S,x:m,y:h,page:g,index:t,pageIndex:_++,row:y,col:v++}))})},Object.defineProperty(t.prototype,`itemsLayout`,{get:function(){this.navigatorShape=[0,0];var e=this.attributes.layout===`grid`?this.getGridLayout:this.getFlexLayout,t=e.call(this);return t.slice(-1)[0].page>0?(this.navigatorShape=[55,0],e.call(this)):t},enumerable:!1,configurable:!0}),t.prototype.ifHorizontal=function(e,t){var n=this.attributes.orientation;return HY(n,e,t)},t.prototype.flattenPage=function(e){e.querySelectorAll(nX.item.class).forEach(function(t){e.appendChild(t)}),e.querySelectorAll(nX.page.class).forEach(function(t){e.removeChild(t).destroy()})},t.prototype.renderItems=function(e){var t=this.attributes,n=t.click,r=t.mouseenter,i=t.mouseleave;this.flattenPage(e);var a=this.dispatchCustomEvent.bind(this);$(e).selectAll(nX.item.class).data(this.renderData,function(e){return e.id}).join(function(e){return e.append(function(e){var t=e.style;return new tX({style:t})}).attr(`className`,nX.item.name).on(`click`,function(){n?.(this),a(`itemClick`,{item:this})}).on(`pointerenter`,function(){r?.(this),a(`itemMouseenter`,{item:this})}).on(`pointerleave`,function(){i?.(this),a(`itemMouseleave`,{item:this})})},function(e){return e.each(function(e){var t=e.style;this.update(t)})},function(e){return e.remove()})},t.prototype.relayoutNavigator=function(){var e=this.attributes,t=e.layout,n=e.width,r=this.pageViews.children[0]?.getBBox().height||0,i=R(this.navigatorShape,2),a=i[0],o=i[1];this.navigator.update(t===`grid`?{pageWidth:n-a,pageHeight:r-o}:{})},t.prototype.adjustLayout=function(){var e=this,t=Object.entries(dG(this.itemsLayout,`page`)).map(function(e){var t=R(e,2),n=t[0],r=t[1];return{page:n,layouts:r}}),n=z([],R(this.navigator.getContainer().children),!1);t.forEach(function(t){var r=t.layouts,i=e.pageViews.appendChild(new Ny({className:nX.page.name}));r.forEach(function(e){var t=e.x,r=e.y,a=e.index,o=e.width,s=e.height,c=n[a];i.appendChild(c),qu(c,`__layout__`,e),c.update({x:t,y:r,width:o,height:s})})}),this.relayoutNavigator()},t.prototype.renderNavigator=function(e){var t=this.attributes.orientation,n=XG(this.attributes,`nav`),r=QW({orientation:t},n),i=this;return e.selectAll(nX.navigator.class).data([`nav`]).join(function(e){return e.append(function(){return new IY({style:r})}).attr(`className`,nX.navigator.name).each(function(){i.navigator=this})},function(e){return e.each(function(){this.update(r)})},function(e){return e.remove()}),this.navigator},t.prototype.getBBox=function(){return this.navigator.getBBox()},t.prototype.render=function(e,t){var n=this.attributes.data;if(!(!n||n.length===0)){var r=this.renderNavigator($(t));this.renderItems(r.getContainer()),this.adjustLayout()}},t.prototype.dispatchCustomEvent=function(e,t){var n=new Cv(e,{detail:t});this.dispatchEvent(n)},t}(sK),aX=YW({markerGroup:`marker-group`,marker:`marker`,labelGroup:`label-group`,label:`label`},`handle`),oX={showLabel:!0,formatter:function(e){return e.toString()},markerSize:25,markerStroke:`#c5c5c5`,markerFill:`#fff`,markerLineWidth:1,labelFontSize:12,labelFill:`#c5c5c5`,labelText:``,orientation:`vertical`,spacing:0};(function(e){Qt(t,e);function t(t){return e.call(this,t,oX)||this}return t.prototype.render=function(e,t){var n=$(t).maybeAppendByClassName(aX.markerGroup,`g`);this.renderMarker(n);var r=$(t).maybeAppendByClassName(aX.labelGroup,`g`);this.renderLabel(r)},t.prototype.renderMarker=function(e){var t=this,n=this.attributes,r=n.orientation,i=n.markerSymbol,a=i===void 0?HY(r,`horizontalHandle`,`verticalHandle`):i;fG(!!a,e,function(e){var n=XG(t.attributes,`marker`),r=L({symbol:a},n);t.marker=e.maybeAppendByClassName(aX.marker,function(){return new MK({style:r})}).update(r)})},t.prototype.renderLabel=function(e){var t=this,n=this.attributes,r=n.showLabel,i=n.orientation,a=n.spacing,o=a===void 0?0:a,s=n.formatter;fG(r,e,function(e){var n=XG(t.attributes,`label`),r=n.text,a=$t(n,[`text`]),c=e.select(aX.marker.class)?.node().getBBox()||{},l=c.width,u=l===void 0?0:l,d=c.height,f=R(HY(i,[0,(d===void 0?0:d)+o,`center`,`top`],[u+o,0,`start`,`middle`]),4),p=f[0],m=f[1],h=f[2],g=f[3];e.maybeAppendByClassName(aX.label,`text`).styles(L(L({},a),{x:p,y:m,text:s(r).toString(),textAlign:h,textBaseline:g}))})},t})(sK);var sX={showTitle:!0,padding:0,orientation:`horizontal`,backgroundFill:`transparent`,titleText:``,titleSpacing:4,titlePosition:`top-left`,titleFill:`#2C3542`,titleFontWeight:`bold`,titleFontFamily:`sans-serif`,titleFontSize:12},cX=QW({},sX,{});QW({},sX,ZG(oX,`handle`),{color:[`#d0e3fa`,`#acc7f6`,`#8daaf2`,`#6d8eea`,`#4d73cd`,`#325bb1`,`#5a3e75`,`#8c3c79`,`#e23455`,`#e7655b`],indicatorBackgroundFill:`#262626`,indicatorLabelFill:`white`,indicatorLabelFontSize:12,indicatorVisibility:`hidden`,labelAlign:`value`,labelDirection:`positive`,labelSpacing:5,showHandle:!0,showIndicator:!0,showLabel:!0,slidable:!0,titleText:``,type:`continuous`});var lX=YW({title:`title`,titleGroup:`title-group`,items:`items`,itemsGroup:`items-group`,contentGroup:`content-group`,ribbonGroup:`ribbon-group`,ribbon:`ribbon`,handlesGroup:`handles-group`,handle:`handle`,startHandle:`start-handle`,endHandle:`end-handle`,labelGroup:`label-group`,label:`label`,indicator:`indicator`},`legend`),uX=function(e){Qt(t,e);function t(t){return e.call(this,t,cX)||this}return t.prototype.renderTitle=function(e,t,n){var r=this.attributes,i=r.showTitle,a=r.titleText,o=XG(this.attributes,`title`),s=R(QG(o),2),c=s[0],l=s[1];this.titleGroup=e.maybeAppendByClassName(lX.titleGroup,`g`).styles(l);var u=L(L({width:t,height:n},c),{text:i?a:``});this.title=this.titleGroup.maybeAppendByClassName(lX.title,function(){return new PY({style:u})}).update(u)},t.prototype.renderItems=function(e,t){var n=t.x,r=t.y,i=t.width,a=t.height,o=XG(this.attributes,`title`,!0),s=R(QG(o),2),c=s[0],l=s[1],u=L(L({},c),{width:i,height:a,x:0,y:0});this.itemsGroup=e.maybeAppendByClassName(lX.itemsGroup,`g`).styles(L(L({},l),{transform:`translate(${n}, ${r})`}));var d=this;this.itemsGroup.selectAll(lX.items.class).data([`items`]).join(function(e){return e.append(function(){return new iX({style:u})}).attr(`className`,lX.items.name).each(function(){d.items=$(this)})},function(e){return e.update(u)},function(e){return e.remove()})},t.prototype.adjustLayout=function(){if(this.attributes.showTitle){var e=this.title.node().getAvailableSpace(),t=e.x,n=e.y;this.itemsGroup.node().style.transform=`translate(${t}, ${n})`}},Object.defineProperty(t.prototype,`availableSpace`,{get:function(){var e=this.attributes,t=e.showTitle,n=e.width,r=e.height;return t?this.title.node().getAvailableSpace():new qW(0,0,n,r)},enumerable:!1,configurable:!0}),t.prototype.getBBox=function(){var t=this.title?.node(),n=this.items?.node();return!t||!n?e.prototype.getBBox.call(this):jY(t,n)},t.prototype.render=function(e,t){var n=this.attributes,r=n.width,i=n.height,a=n.x,o=a===void 0?0:a,s=n.y,c=s===void 0?0:s,l=$(t);t.style.transform=`translate(${o}, ${c})`,this.renderTitle(l,r,i),this.renderItems(l,this.availableSpace),this.adjustLayout()},t}(sK),dX={backgroundFill:`#262626`,backgroundLineCap:`round`,backgroundLineWidth:1,backgroundStroke:`#333`,backgroundZIndex:-1,formatter:function(e){return e.toString()},labelFill:`#fff`,labelFontSize:12,labelTextBaseline:`middle`,padding:[2,4],position:`right`,radius:0,zIndex:999},fX=YW({background:`background`,labelGroup:`label-group`,label:`label`},`indicator`),pX=function(e){Qt(t,e);function t(t){var n=e.call(this,t,dX)||this;return n.point=[0,0],n.group=n.appendChild(new Ny({})),n.isMutationObserved=!0,n}return t.prototype.renderBackground=function(){if(this.label){var e=this.attributes,t=e.position,n=e.padding,r=R(BG(n),4),i=r[0],a=r[1],o=r[2],s=r[3],c=this.label.node().getLocalBounds(),l=c.min,u=c.max,d=new qW(l[0]-s,l[1]-i,u[0]+a-l[0]+s,u[1]+o-l[1]+i),f=this.getPath(t,d),p=XG(this.attributes,`background`);this.background=$(this.group).maybeAppendByClassName(fX.background,`path`).styles(L(L({},p),{d:f})),this.group.appendChild(this.label.node())}},t.prototype.renderLabel=function(){var e=this.attributes,t=e.formatter,n=e.labelText,r=XG(this.attributes,`label`),i=R(QG(r),2),a=i[0],o=i[1];a.text;var s=$t(a,[`text`]);this.label=$(this.group).maybeAppendByClassName(fX.labelGroup,`g`).styles(o),n&&this.label.maybeAppendByClassName(fX.label,function(){return lG(t(n))}).style(`text`,t(n).toString()).selectAll(`text`).styles(s)},t.prototype.adjustLayout=function(){var e=R(this.point,2),t=e[0],n=e[1],r=this.attributes,i=r.x,a=r.y;this.group.attr(`transform`,`translate(${i-t}, ${a-n})`)},t.prototype.getPath=function(e,t){var n=this.attributes.radius,r=t.x,i=t.y,a=t.width,o=t.height,s=[[`M`,r+n,i],[`L`,r+a-n,i],[`A`,n,n,0,0,1,r+a,i+n],[`L`,r+a,i+o-n],[`A`,n,n,0,0,1,r+a-n,i+o],[`L`,r+n,i+o],[`A`,n,n,0,0,1,r,i+o-n],[`L`,r,i+n],[`A`,n,n,0,0,1,r+n,i],[`Z`]],c={top:4,right:6,bottom:0,left:2}[e],l=this.createCorner([s[c].slice(-2),s[c+1].slice(-2)]);return s.splice.apply(s,z([c+1,1],R(l),!1)),s[0][0]=`M`,s},t.prototype.createCorner=function(e,t){t===void 0&&(t=10);var n=.8,r=HG.apply(void 0,z([],R(e),!1)),i=R(e,2),a=R(i[0],2),o=a[0],s=a[1],c=R(i[1],2),l=c[0],u=c[1],d=R(r?[l-o,[o,l]]:[u-s,[s,u]],2),f=d[0],p=R(d[1],2),m=p[0],h=p[1],g=f/2,_=f/Math.abs(f),v=t*_,y=v/2,b=v*Math.sqrt(3)/2*n,x=R([m,m+g-y,m+g,m+g+y,h],5),S=x[0],C=x[1],w=x[2],T=x[3],E=x[4];return r?(this.point=[w,s-b],[[`L`,S,s],[`L`,C,s],[`L`,w,s-b],[`L`,T,s],[`L`,E,s]]):(this.point=[o+b,w],[[`L`,o,S],[`L`,o,C],[`L`,o+b,w],[`L`,o,T],[`L`,o,E]])},t.prototype.applyVisibility=function(){this.attributes.visibility===`hidden`?zW(this):RW(this)},t.prototype.bindEvents=function(){this.label.on(Nv.BOUNDS_CHANGED,this.renderBackground)},t.prototype.render=function(){this.renderLabel(),this.renderBackground(),this.adjustLayout(),this.applyVisibility()},t}(sK);function mX(e){return e===void 0&&(e=``),{CONTAINER:`${e}tooltip`,TITLE:`${e}tooltip-title`,LIST:`${e}tooltip-list`,LIST_ITEM:`${e}tooltip-list-item`,NAME:`${e}tooltip-list-item-name`,MARKER:`${e}tooltip-list-item-marker`,NAME_LABEL:`${e}tooltip-list-item-name-label`,VALUE:`${e}tooltip-list-item-value`,CROSSHAIR_X:`${e}tooltip-crosshair-x`,CROSSHAIR_Y:`${e}tooltip-crosshair-y`}}var hX={overflow:`hidden`,"white-space":`nowrap`,"text-overflow":`ellipsis`};function gX(e){var t;e===void 0&&(e=``);var n=mX(e);return t={},t[`.${n.CONTAINER}`]={position:`absolute`,visibility:`visible`,"z-index":8,transition:`visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)`,"background-color":`rgba(255, 255, 255, 0.96)`,"box-shadow":`0 6px 12px 0 rgba(0, 0, 0, 0.12)`,"border-radius":`4px`,color:`rgba(0, 0, 0, 0.65)`,"font-size":`12px`,"line-height":`20px`,padding:`12px`,"min-width":`120px`,"max-width":`360px`,"font-family":`Roboto-Regular`},t[`.${n.TITLE}`]={color:`rgba(0, 0, 0, 0.45)`},t[`.${n.LIST}`]={margin:`0px`,"list-style-type":`none`,padding:`0px`},t[`.${n.LIST_ITEM}`]={"list-style-type":`none`,display:`flex`,"line-height":`2em`,"align-items":`center`,"justify-content":`space-between`,"white-space":`nowrap`},t[`.${n.MARKER}`]={width:`8px`,height:`8px`,"border-radius":`50%`,display:`inline-block`,"margin-right":`4px`},t[`.${n.NAME}`]={display:`flex`,"align-items":`center`,"max-width":`216px`},t[`.${n.NAME_LABEL}`]=L({flex:1},hX),t[`.${n.VALUE}`]=L({display:`inline-block`,float:`right`,flex:1,"text-align":`right`,"min-width":`28px`,"margin-left":`30px`,color:`rgba(0, 0, 0, 0.85)`},hX),t[`.${n.CROSSHAIR_X}`]={position:`absolute`,width:`1px`,"background-color":`rgba(0, 0, 0, 0.25)`},t[`.${n.CROSSHAIR_Y}`]={position:`absolute`,height:`1px`,"background-color":`rgba(0, 0, 0, 0.25)`},t}var _X=function(e){Qt(t,e);function t(t){var n=this,r=t.style?.template?.prefixCls,i=mX(r);return n=e.call(this,t,{data:[],x:0,y:0,visibility:`visible`,title:``,position:`bottom-right`,offset:[5,5],enterable:!1,container:{x:0,y:0},bounding:null,template:{prefixCls:``,container:`<div class="${i.CONTAINER}"></div>`,title:`<div class="${i.TITLE}"></div>`,item:`<li class="${i.LIST_ITEM}" data-index={index}>
        <span class="${i.NAME}">
          <span class="${i.MARKER}" style="background:{color}"></span>
          <span class="${i.NAME_LABEL}" title="{name}">{name}</span>
        </span>
        <span class="${i.VALUE}" title="{value}">{value}</span>
      </li>`},style:gX(r)})||this,n.timestamp=-1,n.prevCustomContentKey=n.attributes.contentKey,n.initShape(),n.render(n.attributes,n),n}return Object.defineProperty(t.prototype,`HTMLTooltipElement`,{get:function(){return this.element},enumerable:!1,configurable:!0}),t.prototype.getContainer=function(){return this.element},Object.defineProperty(t.prototype,`elementSize`,{get:function(){var e=this.element.offsetWidth,t=this.element.offsetHeight;return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`HTMLTooltipItemsElements`,{get:function(){var e=this.attributes,t=e.data,n=e.template;return t.map(function(e,t){var r=e.name,i=r===void 0?``:r,a=e.color,o=a===void 0?`black`:a,s=e.index,c=$t(e,[`name`,`color`,`index`]),l=L({name:i,color:o,index:s??t},c);return ef(_u(n.item,l))})},enumerable:!1,configurable:!0}),t.prototype.render=function(e,t){this.renderHTMLTooltipElement(),this.updatePosition()},t.prototype.destroy=function(){var t;(t=this.element)==null||t.remove(),e.prototype.destroy.call(this)},t.prototype.show=function(e,t){var n=this;if(e!==void 0&&t!==void 0){var r=this.element.style.visibility===`hidden`,i=function(){n.attributes.x=e??n.attributes.x,n.attributes.y=t??n.attributes.y,n.updatePosition()};r?this.closeTransition(i):i()}this.element.style.visibility=`visible`},t.prototype.hide=function(e,t){e===void 0&&(e=0),t===void 0&&(t=0),!(this.attributes.enterable&&this.isCursorEntered(e,t))&&(this.element.style.visibility=`hidden`)},t.prototype.initShape=function(){var e=this.attributes.template;this.element=ef(e.container),this.id&&this.element.setAttribute(`id`,this.id)},t.prototype.renderCustomContent=function(){if(!(this.prevCustomContentKey!==void 0&&this.prevCustomContentKey===this.attributes.contentKey)){this.prevCustomContentKey=this.attributes.contentKey;var e=this.attributes.content;e&&(typeof e==`string`?this.element.innerHTML=e:rK(this.element,e))}},t.prototype.renderHTMLTooltipElement=function(){var e,t=this.attributes,n=t.template,r=t.title,i=t.enterable,a=t.style,o=t.content,s=mX(n.prefixCls),c=this.element;if(this.element.style.pointerEvents=i?`auto`:`none`,o)this.renderCustomContent();else{r?(c.innerHTML=n.title,c.getElementsByClassName(s.TITLE)[0].innerHTML=r):(e=c.getElementsByClassName(s.TITLE)?.[0])==null||e.remove();var l=this.HTMLTooltipItemsElements,u=document.createElement(`ul`);u.className=s.LIST,rK(u,l);var d=this.element.querySelector(`.${s.LIST}`);d?d.replaceWith(u):c.appendChild(u)}JG(c,a)},t.prototype.getRelativeOffsetFromCursor=function(e){var t=this.attributes,n=t.position,r=t.offset,i=(e||n).split(`-`),a={left:[-1,0],right:[1,0],top:[0,-1],bottom:[0,1]},o=this.elementSize,s=o.width,c=o.height,l=[-s/2,-c/2];return i.forEach(function(e){var t=R(l,2),n=t[0],i=t[1],o=R(a[e],2),u=o[0],d=o[1];l=[n+(s/2+r[0])*u,i+(c/2+r[1])*d]}),l},t.prototype.setOffsetPosition=function(e){var t=R(e,2),n=t[0],r=t[1],i=this.attributes,a=i.x,o=a===void 0?0:a,s=i.y,c=s===void 0?0:s,l=i.container,u=l.x,d=l.y;this.element.style.left=`${+o+u+n}px`,this.element.style.top=`${+c+d+r}px`},t.prototype.updatePosition=function(){var e=this.attributes.showDelay,t=e===void 0?60:e,n=Date.now();this.timestamp>0&&n-this.timestamp<t||(this.timestamp=n,this.setOffsetPosition(this.autoPosition(this.getRelativeOffsetFromCursor())))},t.prototype.autoPosition=function(e){var t=R(e,2),n=t[0],r=t[1],i=this.attributes,a=i.x,o=i.y,s=i.bounding,c=i.position;if(!s)return[n,r];var l=this.element,u=l.offsetWidth,d=l.offsetHeight,f=R([+a+n,+o+r],2),p=f[0],m=f[1],h={left:`right`,right:`left`,top:`bottom`,bottom:`top`},g=s.x,_=s.y,v=s.width,y=s.height,b={left:p<g,right:p+u>g+v,top:m<_,bottom:m+d>_+y},x=[];c.split(`-`).forEach(function(e){b[e]?x.push(h[e]):x.push(e)});var S=x.join(`-`);return this.getRelativeOffsetFromCursor(S)},t.prototype.isCursorEntered=function(e,t){if(this.element){var n=this.element.getBoundingClientRect(),r=n.x,i=n.y,a=n.width,o=n.height;return new qW(r,i,a,o).isPointIn(e,t)}return!1},t.prototype.closeTransition=function(e){var t=this,n=this.element.style.transition;this.element.style.transition=`none`,e(),setTimeout(function(){t.element.style.transition=n},10)},t.tag=`tooltip`,t}(sK),vX=function(e){Qt(t,e);function t(n){var r=e.call(this,QW({},t.defaultOptions,n))||this;return r.hoverColor=`#f5f5f5`,r.selectedColor=`#e6f7ff`,r.background=r.appendChild(new Gy({})),r.label=r.background.appendChild(new Ny({})),r}return Object.defineProperty(t.prototype,`padding`,{get:function(){return BG(this.style.padding)},enumerable:!1,configurable:!0}),t.prototype.renderLabel=function(){var e=this.style,t=e.label,n=e.value,r=XG(this.attributes,`label`);$(this.label).maybeAppend(`.label`,function(){return lG(t)}).attr(`className`,`label`).styles(r),this.label.attr(`__data__`,n)},t.prototype.renderBackground=function(){var e=this.label.getBBox(),t=R(this.padding,4),n=t[0],r=t[1],i=t[2],a=t[3],o=e.width,s=e.height,c=o+a+r,l=s+n+i,u=XG(this.attributes,`background`),d=this.style,f=d.width,p=f===void 0?0:f,m=d.height,h=m===void 0?0:m,g=d.selected;this.background.attr(L(L({},u),{width:Math.max(c,p),height:Math.max(l,h),fill:g?this.selectedColor:`#fff`})),this.label.attr({transform:`translate(${a}, ${(l-s)/2})`})},t.prototype.render=function(){this.renderLabel(),this.renderBackground()},t.prototype.bindEvents=function(){var e=this;this.addEventListener(`pointerenter`,function(){e.style.selected||e.background.attr(`fill`,e.hoverColor)}),this.addEventListener(`pointerleave`,function(){e.style.selected||e.background.attr(`fill`,e.style.backgroundFill)});var t=this;this.addEventListener(`click`,function(){var n=e.style,r=n.label,i=n.value,a=n.onClick;a?.(i,{label:r,value:i},t)})},t.defaultOptions={style:{value:``,label:``,cursor:`pointer`}},t}(sK),yX=function(e){Qt(t,e);function t(n){var r=e.call(this,QW({},t.defaultOptions,n))||this;r.currentValue=t.defaultOptions.style?.defaultValue,r.isPointerInSelect=!1,r.select=r.appendChild(new Gy({className:`select`,style:{cursor:`pointer`,width:0,height:0}})),r.dropdown=r.appendChild(new Gy({className:`dropdown`}));var i=r.style.defaultValue;return i&&r.style.options?.some(function(e){return e.value===i})&&(r.currentValue=i),r}return t.prototype.setValue=function(e){this.currentValue=e,this.render()},t.prototype.getValue=function(){return this.currentValue},Object.defineProperty(t.prototype,`dropdownPadding`,{get:function(){return BG(this.style.dropdownPadding)},enumerable:!1,configurable:!0}),t.prototype.renderSelect=function(){var e=this,t=this.style,n=t.x,r=t.y,i=t.width,a=t.height,o=t.bordered,s=t.showDropdownIcon,c=XG(this.attributes,`select`),l=XG(this.attributes,`placeholder`);this.select.attr(L(L({x:n,y:r,width:i,height:a},c),{fill:`#fff`,strokeWidth:o?1:0}));var u=this.dropdownPadding;s&&$(this.select).maybeAppend(`.dropdown-icon`,`path`).style(`d`,`M-5,-3.5 L0,3.5 L5,-3.5`).style(`transform`,`translate(${n+i-10-u[1]-u[3]}, ${r+a/2})`).style(`lineWidth`,1).style(`stroke`,this.select.style.stroke);var d=this.style.options?.find(function(t){return t.value===e.currentValue}),f=L({x:n+u[3]},l);$(this.select).selectAll(`.placeholder`).data(d?[]:[1]).join(function(e){return e.append(`text`).attr(`className`,`placeholder`).styles(f).style(`y`,function(){var e=this.getBBox();return r+(a-e.height)/2})},function(e){return e.styles(f)},function(e){return e.remove()});var p=XG(this.attributes,`optionLabel`),m=L({x:n+u[3]},p);$(this.select).selectAll(`.value`).data(d?[d]:[]).join(function(e){return e.append(function(e){return lG(e.label)}).attr(`className`,`value`).styles(m).style(`y`,function(){var e=this.getBBox();return r+(a-e.height)/2})},function(e){return e.styles(m)},function(e){return e.remove()})},t.prototype.renderDropdown=function(){var e=this,t=this.style,n=t.x,r=t.y,i=t.width,a=t.height,o=t.options,s=t.onSelect,c=t.open,l=XG(this.attributes,`dropdown`),u=XG(this.attributes,`option`),d=this.dropdownPadding;$(this.dropdown).maybeAppend(`.dropdown-container`,`g`).attr(`className`,`dropdown-container`).selectAll(`.dropdown-item`).data(o,function(e){return e.value}).join(function(t){return t.append(function(t){return new vX({className:`dropdown-item`,style:L(L(L({},t),u),{width:i-d[1]-d[3],selected:t.value===e.currentValue,onClick:function(t,n,r){e.setValue(t),s?.(t,n,r),e.dispatchEvent(new Cv(`change`,{detail:{value:t,option:n,item:r}})),zW(e.dropdown)}})})}).each(function(e,t){var n=(this.parentNode?.children).reduce(function(e,n,r){return r<t&&(e+=n.getBBox().height),e},0);this.attr(`transform`,`translate(${d[3]}, ${d[0]+n})`)})},function(t){return t.update(function(t){return{selected:t.value===e.currentValue}})},function(e){return e.remove()});var f=(this.dropdown.getElementsByClassName(`dropdown-container`)?.[0])?.getBBox(),p=l.spacing;this.dropdown.attr(L({transform:`translate(${n}, ${r+a+p})`,width:f.width+d[1]+d[3],height:f.height+d[0]+d[2]},l)),!c&&zW(this.dropdown)},t.prototype.render=function(){this.renderSelect(),this.renderDropdown()},t.prototype.bindEvents=function(){var e=this;this.addEventListener(`click`,function(e){e.stopPropagation()}),this.select.addEventListener(`click`,function(){e.dropdown.style.visibility===`visible`?zW(e.dropdown):RW(e.dropdown)}),this.addEventListener(`pointerenter`,function(){e.isPointerInSelect=!0}),this.addEventListener(`pointerleave`,function(){e.isPointerInSelect=!1}),document==null||document.addEventListener(`click`,function(){e.isPointerInSelect||zW(e.dropdown)})},t.defaultOptions={style:{x:0,y:0,width:140,height:32,options:[],bordered:!0,defaultValue:``,selectRadius:8,selectStroke:`#d9d9d9`,showDropdownIcon:!0,placeholderText:``,placeholderFontSize:12,placeholderTextBaseline:`top`,placeholderFill:`#c2c2c2`,dropdownFill:`#fff`,dropdownStroke:`#d9d9d9`,dropdownRadius:8,dropdownShadowBlur:4,dropdownShadowColor:`rgba(0, 0, 0, 0.08)`,dropdownPadding:8,dropdownSpacing:10,optionPadding:[8,12],optionFontSize:12,optionTextBaseline:`top`,optionBackgroundFill:`#fff`,optionBackgroundRadius:4,optionLabelFontSize:12,optionLabelTextBaseline:`top`}},t}(sK),bX=function(e){Qt(t,e);function t(n){var r=e.call(this,QW({},{style:{backgroundOpacity:t.backgroundOpacities.default}},t.defaultOptions,n))||this;return r.showBackground=!0,r.background=r.appendChild(new Gy({})),r.icon=r.appendChild(new Ny({})),r}return Object.defineProperty(t.prototype,`label`,{get:function(){return`BaseIcon`},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`lineWidth`,{get:function(){return Math.log10(this.attributes.size)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`padding`,{get:function(){return BG(this.attributes.size/5)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`iconSize`,{get:function(){var e=this.attributes.size,t=R(this.padding,4),n=t[0],r=t[1],i=t[2],a=t[3];return Math.max(e-Math.max(a+r,n+i),this.lineWidth*2+1)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.attributes,t=e.x,n=e.y,r=e.size,i=r/2,a=XG(this.attributes,`background`);this.background.attr(L({x:t-i,y:n-i,width:r,height:r},a))},t.prototype.showIndicator=function(){if(this.label){var e=this.attributes.size,t=this.background.getBBox(),n=t.x,r=t.y;this.indicator.update({x:n+e/2,y:r-5,labelText:this.label,visibility:`visible`})}},t.prototype.hideIndicator=function(){this.indicator.update({visibility:`hidden`})},t.prototype.connectedCallback=function(){e.prototype.connectedCallback.call(this);var t=this.attributes.size,n=this.background.getBBox(),r=n.x,i=n.y,a=this.ownerDocument?.defaultView;a&&(this.indicator=a.appendChild(new pX({style:{x:r+t/2,y:i-t/2,visibility:`hidden`,position:`top`,radius:3,zIndex:100}})))},t.prototype.disconnectedCallback=function(){this.indicator.destroy()},t.prototype.render=function(){this.renderIcon(),this.showBackground&&this.renderBackground()},t.prototype.bindEvents=function(){var e=this,n=this.attributes.onClick;if(this.addEventListener(`click`,function(){n?.(e)}),this.showBackground){var r=function(){return e.background.attr({opacity:t.backgroundOpacities.default})},i=function(){return e.background.attr({opacity:t.backgroundOpacities.hover})},a=function(){return e.background.attr({opacity:t.backgroundOpacities.active})};this.addEventListener(`pointerenter`,function(){i(),e.showIndicator()}),this.addEventListener(`pointerleave`,function(){r(),e.hideIndicator()}),this.addEventListener(`pointerdown`,function(){a()}),this.addEventListener(`pointerup`,function(){r()})}},t.tag=`IconBase`,t.defaultOptions={style:{x:0,y:0,size:10,color:`#565758`,backgroundRadius:4,backgroundFill:`#e2e2e2`}},t.backgroundOpacities={default:0,hover:.8,active:1},t}(sK),xX=function(e,t){return t===void 0&&(t=`#565758`),new By({style:{fill:t,d:`M ${e},${e} L -${e},0 L ${e},-${e} Z`,transformOrigin:`center`}})},SX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.arcPath=function(e,t,n){var r=R([n,n],2),i=r[0],a=r[1],o=function(r){return[e+n*Math.cos(r),t+n*Math.sin(r)]},s=R(o(-5/4*Math.PI),2),c=s[0],l=s[1],u=R(o(1/4*Math.PI),2),d=u[0],f=u[1];return`M${c},${l},A${i},${a},0,1,1,${d},${f}`},Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this.iconSize,a=this.lineWidth,o=a+.5;$(this.icon).maybeAppend(`.reset`,`path`).styles({stroke:r,lineWidth:a,d:this.arcPath(t,n,i/2-a),markerStart:xX(o,r)})},t}(bX),CX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this.iconSize,a=i/2,o=i/2/3**.5,s=[[t,n],[t,n-o],[t-a,n],[t,n+o],[t,n],[t+a,n-o],[t+a,n+o],[t,n]];$(this.icon).maybeAppend(`.backward`,`polygon`).styles({points:s,fill:r})},t}(bX),wX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this.iconSize,a=i/2,o=i/2/3**.5,s=[[t,n],[t,n-o],[t+a,n],[t,n+o],[t,n],[t-a,n-o],[t-a,n+o],[t,n]];$(this.icon).maybeAppend(`.forward`,`polygon`).styles({points:s,fill:r})},t}(bX),TX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this.iconSize,a=i/3*3**.5*.8,o=[[t+a,n],[t-a/2,n-i/2*.8],[t-a/2,n+i/2*.8],[t+a,n]];$(this.icon).maybeAppend(`.play`,`polygon`).styles({points:o,fill:r})},t}(bX),EX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this.iconSize,a=i/3,o=[[t-a,n-i/2],[t-a,n+i/2],[t-a/2,n+i/2],[t-a/2,n-i/2],[t-a,n-i/2],[t+a/2,n-i/2],[t+a/2,n+i/2],[t+a,n+i/2],[t+a,n-i/2]];$(this.icon).maybeAppend(`.pause`,`polygon`).styles({points:o,fill:r})},t}(bX),DX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this,a=i.iconSize,o=i.lineWidth,s=o;$(this.icon).maybeAppend(`.left-line`,`line`).styles({x1:t-a/2,y1:n-a/2,x2:t-a/2,y2:n+a/2,stroke:r,lineWidth:o}),$(this.icon).maybeAppend(`.right-line`,`line`).styles({x1:t+a/2,y1:n-a/2,x2:t+a/2,y2:n+a/2,stroke:r,lineWidth:o}),$(this.icon).maybeAppend(`.left-arrow`,`line`).styles({x1:t,y1:n,x2:t-a/2+s*2,y2:n,stroke:r,lineWidth:o,markerEnd:xX(o*2,r)}),$(this.icon).maybeAppend(`.right-arrow`,`line`).styles({x1:t,y1:n,x2:t+a/2-s*2,y2:n,stroke:r,lineWidth:o,markerEnd:xX(o*2,r)})},t}(bX),OX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this,a=i.iconSize,o=i.lineWidth;$(this.icon).maybeAppend(`.line`,`line`).styles({x1:t,y1:n-a/2,x2:t,y2:n+a/2,stroke:r,lineWidth:o});var s=o;$(this.icon).maybeAppend(`.left-arrow`,`line`).styles({x1:t-a/2-s*2,y1:n,x2:t-s*2,y2:n,stroke:r,lineWidth:o,markerEnd:xX(o*2,r)}),$(this.icon).maybeAppend(`.right-arrow`,`line`).styles({x1:t+a/2+s*2,y1:n,x2:t+s*2,y2:n,stroke:r,lineWidth:o,markerEnd:xX(o*2,r)})},t}(bX),kX=function(e){return[[-e/2,-e/2],[-e/2,e/2],[e/2,e/2]]},AX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this,a=i.iconSize,o=i.lineWidth,s=o,c=(a-s*2-o)/4,l=(a-s*2-o)/2,u=R([t-a/2+s,n+a/2-s*2],2),d=u[0],f=u[1];$(this.icon).maybeAppend(`.coordinate`,`polyline`).styles({points:kX(a).map(function(e){var r=R(e,2),i=r[0],a=r[1];return[i+t,a+n]}),stroke:r,lineWidth:o}),$(this.icon).maybeAppend(`.line`,`polyline`).styles({points:[[d,f],[d+c,f-l],[d+c*2,f],[d+c*4,f-l*2]],stroke:r,lineWidth:o})},t}(bX),jX=function(e){Qt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return Object.defineProperty(t.prototype,`label`,{get:function(){return``},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`data`,{get:function(){return[1,4,2,4,3]},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.data,t=this.attributes,n=t.x,r=t.y,i=t.color,a=this,o=a.iconSize,s=a.lineWidth,c=s,l=(o-c)/e.length,u=(o-c*2)/4,d=R([n-o/2+c*2,r+o/2-c],2),f=d[0],p=d[1];$(this.icon).maybeAppend(`.coordinate`,`polyline`).styles({points:kX(o).map(function(e){var t=R(e,2),i=t[0],a=t[1];return[i+n,a+r]}),stroke:i,lineWidth:s}),$(this.icon).maybeAppend(`.bars`,`g`).selectAll(`.column`).data(this.data.map(function(e,t){return{value:e,index:t}})).join(function(e){return e.append(`line`).attr(`className`,`column`).style(`x1`,function(e){var t=e.index;return f+l*t}).style(`y1`,p).style(`x2`,function(e){var t=e.index;return f+l*t}).style(`y2`,function(e){var t=e.value;return p-u*t}).styles({y1:p,stroke:i,lineWidth:s})})},t}(bX),MX=function(e){Qt(t,e);function t(t){var n=e.call(this,QW({},{style:{color:`#d8d9d9`}},t))||this;return n.showBackground=!1,n}return t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.color,i=this,a=i.iconSize,o=i.lineWidth;$(this.icon).maybeAppend(`.split`,`line`).styles({x1:t,y1:n-a/2,x2:t,y2:n+a/2,stroke:r,lineWidth:o})},t}(bX),NX=function(e){Qt(t,e);function t(){var t=e.apply(this,z([],R(arguments),!1))||this;return t.showBackground=!1,t}return Object.defineProperty(t.prototype,`padding`,{get:function(){return BG(0)},enumerable:!1,configurable:!0}),t.prototype.renderIcon=function(){var e=this.iconSize,t=this.attributes,n=t.x,r=t.y,i=t.speed,a=i===void 0?1:i,o=Xu(this.attributes,[`x`,`y`,`transform`,`transformOrigin`,`width`,`height`,`size`,`color`,`speed`]),s=cu(e,20,1/0),c=20,l=L(L({},o),{x:n-s/2,y:r-c/2,width:s,height:c,defaultValue:a,bordered:!1,showDropdownIcon:!1,selectRadius:2,dropdownPadding:this.padding,dropdownRadius:2,dropdownSpacing:e/5,placeholderFontSize:e/2,optionPadding:0,optionLabelFontSize:e/2,optionBackgroundRadius:1,options:[{label:`1x`,value:1},{label:`1.5x`,value:1.5},{label:`2x`,value:2}]});$(this.icon).maybeAppend(`.speed`,function(){return new yX({style:l})}).attr(`className`,`speed`).each(function(){this.update(l)})},t.tag=`SpeedSelect`,t}(bX),PX=function(e){Qt(t,e);function t(t){var n=e.call(this,t)||this;return n.icon=n.appendChild(new Ny({})),n.currentType=n.attributes.type,n}return t.prototype.getType=function(){return this.currentType},t.prototype.render=function(){var e=this,t=this.attributes;t.onChange;var n=$t(t,[`onChange`]);$(this.icon).selectAll(`.icon`).data([this.currentType]).join(function(t){return t.append(function(t){var n=e.toggles.find(function(e){return R(e,1)[0]===t})?.[1];if(!n)throw Error(`Invalid type: ${t}`);return new n({})}).attr(`className`,`icon`).styles(n,!1).update({})},function(e){return e.styles({restStyles:n}).update({})},function(e){return e.remove()})},t.prototype.bindEvents=function(){var e=this,t=this.attributes.onChange;this.addEventListener(`click`,function(n){n.preventDefault(),n.stopPropagation();var r=(e.toggles.findIndex(function(t){return R(t,1)[0]===e.currentType})+1)%e.toggles.length,i=e.toggles[r][0];t?.(e.currentType),e.currentType=i,e.render()})},t.tag=`ToggleIcon`,t}(sK),FX=function(e){Qt(t,e);function t(t){var n=e.call(this,QW({},{style:{type:`play`}},t))||this;return n.toggles=[[`play`,TX],[`pause`,EX]],n}return t}(PX),IX=function(e){Qt(t,e);function t(t){var n=e.call(this,QW({},{style:{type:`range`}},t))||this;return n.toggles=[[`range`,DX],[`value`,OX]],n}return t}(PX),LX=function(e){Qt(t,e);function t(t){var n=e.call(this,QW({},{style:{type:`column`}},t))||this;return n.toggles=[[`line`,AX],[`column`,jX]],n}return t}(PX),RX={reset:SX,speed:NX,backward:CX,playPause:FX,forward:wX,selectionType:IX,chartType:LX,split:MX},zX=function(e){Qt(t,e);function t(n){var r=e.call(this,QW({},t.defaultOptions,n))||this;return r.background=r.appendChild(new Gy({})),r.functions=r.appendChild(new Ny({})),r}return Object.defineProperty(t.prototype,`padding`,{get:function(){return BG(this.attributes.padding)},enumerable:!1,configurable:!0}),t.prototype.renderBackground=function(){var e=this.style,t=e.x,n=e.y,r=e.width,i=e.height,a=XG(this.attributes,`background`);this.background.attr(L({x:t,y:n,width:r,height:i},a))},t.prototype.renderFunctions=function(){var e=this,t,n=this.attributes,r=n.functions,i=n.iconSize,a=n.iconSpacing,o=n.x,s=n.y,c=n.width,l=n.height,u=n.align,d=R(this.padding,4),f=d[1],p=d[3],m=r.reduce(function(e,t){return e.length&&t.length?e.concat.apply(e,z([`split`],R(t),!1)):e.concat.apply(e,z([],R(t),!1))},[]),h=m.length*(i+a)-a,g={left:p+i/2,center:(c-h)/2+i/2,right:c-h-p-f+i/2}[u]||0;(t=this.speedSelect)==null||t.destroy(),this.functions.removeChildren(),m.forEach(function(t,n){var r=RX[t],c={x:o+n*(i+a)+g,y:s+l/2,size:i};if(r===NX?(c.speed=e.attributes.speed,c.onSelect=function(n){return e.handleFunctionChange(t,{value:n})}):[FX,IX,LX].includes(r)?(c.onChange=function(n){return e.handleFunctionChange(t,{value:n})},r===FX&&(c.type=e.attributes.state===`play`?`pause`:`play`),r===IX&&(c.type=e.attributes.selectionType===`range`?`value`:`range`),r===LX&&(c.type=e.attributes.chartType===`line`?`column`:`line`)):c.onClick=function(){return e.handleFunctionChange(t,{value:t})},r===NX){var u=e.ownerDocument?.defaultView;u&&(e.speedSelect=new r({style:L(L({},c),{zIndex:100})}),u.appendChild(e.speedSelect))}else e.functions.appendChild(new r({style:c}))})},t.prototype.disconnectedCallback=function(){var t;e.prototype.disconnectedCallback.call(this),(t=this.speedSelect)==null||t.destroy()},t.prototype.render=function(){this.renderBackground(),this.renderFunctions()},t.prototype.handleFunctionChange=function(e,t){var n=this.attributes.onChange;n?.(e,t)},t.defaultOptions={style:{x:0,y:0,width:300,height:40,padding:0,align:`center`,iconSize:25,iconSpacing:0,speed:1,state:`pause`,chartType:`line`,selectionType:`range`,backgroundFill:`#fbfdff`,backgroundStroke:`#ebedf0`,functions:[[`reset`,`speed`],[`backward`,`playPause`,`forward`],[`selectionType`,`chartType`]]}},t}(sK),BX=function(e){Qt(t,e);function t(n){var r=e.call(this,QW({},t.defaultOptions,n))||this;return r.bindEvents(),r}return t.prototype.bindEvents=function(){var e=this;this.addEventListener(`mouseenter`,function(){e.attr(`lineWidth`,Math.ceil((e.style.r||0)/2))}),this.addEventListener(`mouseleave`,function(){e.attr(`lineWidth`,0)})},t.defaultOptions={style:{r:5,fill:`#3f7cf7`,lineWidth:0,stroke:`#3f7cf7`,strokeOpacity:.5,cursor:`pointer`}},t}(Oy),VX=function(e){Qt(t,e);function t(n){return e.call(this,QW({},t.defaultOptions,n))||this}return t.prototype.renderBackground=function(){var e=this.attributes,t=e.x,n=e.y,r=e.width,i=e.height,a=XG(this.attributes,`background`);$(this).maybeAppend(`background`,`rect`).attr(`className`,`background`).styles(L({x:t-r/2,y:n-i/2,width:r,height:i},a))},t.prototype.renderIcon=function(){var e=this.attributes,t=e.x,n=e.y,r=e.iconSize,i=XG(this.attributes,`icon`),a=1,o=r/2;$(this).maybeAppend(`icon-left-line`,`line`).attr(`className`,`icon-left-line`).styles(L({x1:t-a,y1:n-o,x2:t-a,y2:n+o},i)),$(this).maybeAppend(`icon-right-line`,`line`).attr(`className`,`icon-right-line`).styles(L({x1:t+a,y1:n-o,x2:t+a,y2:n+o},i))},t.prototype.renderBorder=function(){var e=this.attributes,t=e.x,n=e.y,r=e.width,i=e.height,a=e.type,o=XG(this.attributes,`border`),s=a===`start`?r/2:-r/2;$(this).maybeAppend(`border`,`line`).attr(`className`,`border`).styles(L({x1:s+t,y1:n-i/2,x2:s+t,y2:n+i/2},o))},t.prototype.render=function(){this.renderBackground(),this.renderIcon(),this.renderBorder()},t.defaultOptions={style:{x:0,y:0,width:10,height:50,iconSize:10,type:`start`,backgroundFill:`#fff`,backgroundFillOpacity:.5,iconStroke:`#9a9a9a`,iconLineWidth:1,borderStroke:`#e8e8e8`,borderLineWidth:1}},t}(sK);function HX(e,t){return typeof e==`number`?WX(e):UX(e,t)}function UX(e,t){var n=new Date(e);switch(t){case`half-hour`:case`hour`:case`four-hour`:return[0,6,12,18].includes(n.getHours())&&n.getMinutes()===0?$G(n,`HH:mm
YYYY-MM-DD`):$G(n,`HH:mm`);case`half-day`:return n.getHours()<12?`AM
${$G(n,`YYYY-MM-DD`)}`:`PM`;case`day`:return[1,10,20].includes(n.getDate())?$G(n,`DD
YYYY-MM`):$G(n,`DD`);case`week`:return n.getDate()<=7?$G(n,`DD
YYYY-MM`):$G(n,`DD`);case`month`:return[0,6].includes(n.getMonth())?$G(n,`MM
YYYY`):$G(n,`MM`);case`season`:return[0].includes(n.getMonth())?$G(n,`MM
YYYY`):$G(n,`MM`);case`year`:return $G(n,`YYYY`);default:return $G(n,`YYYY-MM-DD HH:mm`)}}function WX(e){var t=String(Math.floor(e/3600)).padStart(2,`0`),n=String(Math.floor(e%3600/60)).padStart(2,`0`),r=String(Math.floor(e%60)).padStart(2,`0`);return e<3600?`${n}:${r}`:`${t}:${n}:${r}`}var GX=function(e){Qt(t,e);function t(n){var r=e.call(this,QW({},t.defaultOptions,n))||this;r.axis=r.appendChild(new kY({style:{type:`linear`,startPos:[0,0],endPos:[0,0],data:[],showArrow:!1,animate:!1}})),r.timeline=r.appendChild(new Yq({style:{onChange:function(e){r.handleSliderChange(e)}}})),r.controller=r.appendChild(new zX({})),r.states={},r.handleSliderChange=function(e){var t=(function(){var e=r.states.values;return Array.isArray(e)?z([],R(e),!1):e})();r.setBySliderValues(e),r.dispatchOnChange(t)};var i=r.attributes,a=i.selectionType,o=i.chartType,s=i.speed,c=i.state,l=i.playMode,u=i.values;return r.states={chartType:o,playMode:l,selectionType:a,speed:s,state:c},r.setByTimebarValues(u),r}return Object.defineProperty(t.prototype,`data`,{get:function(){return this.attributes.data.sort(function(e,t){return e.time<t.time?-1:e.time>t.time?1:0})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`space`,{get:function(){var e=this.attributes,t=e.x,n=e.y,r=e.width,i=e.height,a=e.type,o=e.controllerHeight,s=cu(+i-o,0,+i),c=new qW(t,n+ +i-o,+r,o),l,u=0;a===`chart`?(u=35,l=new qW(t,n+s-u,+r,u)):l=new qW;var d=a===`time`?10:s,f=new qW(t,n+(a===`time`?s:s-d),+r,d-u);return{axisBBox:l,controllerBBox:c,timelineBBox:f}},enumerable:!1,configurable:!0}),t.prototype.setBySliderValues=function(e){var t=this.data,n=R(Array.isArray(e)?e:[0,e],2),r=n[0],i=n[1],a=t.length,o=t[Math.floor(r*a)],s=t[Math.ceil(i*a)-(Array.isArray(e)?0:1)];this.states.values=[o?.time??t[0].time,s?.time??1/0]},t.prototype.setByTimebarValues=function(e){var t=this.data,n=R(Array.isArray(e)?e:[void 0,e],2),r=n[0],i=n[1],a=t.find(function(e){return e.time===r}),o=t.find(function(e){return e.time===i});this.states.values=[a?.time??t[0]?.time,o?.time??1/0]},t.prototype.setByIndex=function(e){var t=this.data,n=R(e,2),r=n[0],i=n[1];this.states.values=[t[r]?.time??t[0].time,this.data[i]?.time??1/0]},Object.defineProperty(t.prototype,`sliderValues`,{get:function(){var e=this.states,t=e.values,n=e.selectionType,r=R(Array.isArray(t)?t:[void 0,t],2),i=r[0],a=r[1],o=this.data,s=o.length,c=n===`value`;return[function(){var e=o.findIndex(function(e){return e.time===i});return c?0:e>-1?e/s:0}(),function(){if(a===1/0)return 1;var e=o.findIndex(function(e){return e.time===a});return e>-1?e/s:c?.5:1}()]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,`values`,{get:function(){var e=this.states,t=e.values,n=e.selectionType,r=R(Array.isArray(t)?t:[this.data[0].time,t],2),i=r[0],a=r[1];return n===`value`?a:[i,a]},enumerable:!1,configurable:!0}),t.prototype.getDatumByRatio=function(e){var t=this.data,n=t.length,r=Math.floor(e*(n-1));return t[r]},Object.defineProperty(t.prototype,`chartHandleIconShape`,{get:function(){var e=this.states.selectionType,t=this.space.timelineBBox.height;return e===`range`?function(e){return new VX({style:{type:e,height:t,iconSize:t/6}})}:function(){return new Ry({style:{x1:0,y1:-t/2,x2:0,y2:t/2,lineWidth:2,stroke:`#c8c8c8`}})}},enumerable:!1,configurable:!0}),t.prototype.getChartStyle=function(e){var t=this,n=e.x,r=e.y,i=e.width,a=e.height,o=this.states,s=o.selectionType,c=o.chartType,l=this.data,u=this.attributes,d=u.type,f=u.labelFormatter,p=XG(this.attributes,`chart`);p.type;var m=$t(p,[`type`]),h=s===`range`;if(d===`time`)return L({handleIconShape:function(){return new BX({})},selectionFill:`#2e7ff8`,selectionFillOpacity:1,showLabelOnInteraction:!0,handleLabelDy:h?-15:0,autoFitLabel:h,handleSpacing:h?-15:0,trackFill:`#edeeef`,trackLength:i,trackOpacity:.5,trackRadius:a/2,trackSize:a/2,type:s,values:this.sliderValues,formatter:function(e){if(f)return f(e);var n=t.getDatumByRatio(e).time;return typeof n==`number`?WX(n):$G(n,`YYYY-MM-DD HH:mm:ss`)},transform:`translate(${n}, ${r})`,zIndex:1},m);var g=s===`range`?5:0,_=l.map(function(e){return e.value});return L({handleIconOffset:g,handleIconShape:this.chartHandleIconShape,selectionFill:`#fff`,selectionFillOpacity:.5,selectionType:`invert`,sparklineSpacing:.1,sparklineColumnLineWidth:0,sparklineColor:`#d4e5fd`,sparklineAreaOpacity:1,sparklineAreaLineWidth:0,sparklineData:_,sparklineType:c,sparklineScale:.8,trackLength:i,trackSize:a,type:s,values:this.sliderValues,transform:`translate(${n}, ${r})`,zIndex:1},m)},t.prototype.renderChart=function(e){e===void 0&&(e=this.space.timelineBBox),this.timeline.update(this.getChartStyle(e))},t.prototype.updateSelection=function(){this.timeline.setValues(this.sliderValues,!0),this.handleSliderChange(this.sliderValues)},t.prototype.getAxisStyle=function(e){var t=this.data,n=this.attributes,r=n.interval,i=n.labelFormatter,a=XG(this.attributes,`axis`),o=e.x,s=e.y,c=e.width,l=z(z([],R(t),!1),[{time:0}],!1).map(function(e,t,n){var r=e.time;return{label:`${r}`,value:t/(n.length-1),time:r}});return L({startPos:[o,s],endPos:[o+c,s],data:l,labelFilter:function(e,t){return t<l.length-1},labelFormatter:function(e){var t=e.time;return i?i(t):HX(t,r)}},a)},t.prototype.renderAxis=function(e){e===void 0&&(e=this.space.axisBBox),this.attributes.type===`chart`&&this.axis.update(this.getAxisStyle(e))},t.prototype.renderController=function(e){e===void 0&&(e=this.space.controllerBBox);var t=this.attributes.type,n=this.states,r=n.state,i=n.speed,a=n.selectionType,o=n.chartType,s=XG(this.attributes,`controller`),c=this,l=L(L(L({},e),{iconSize:20,speed:i,state:r,selectionType:a,chartType:o,onChange:function(e,t){var n=t.value;switch(e){case`reset`:c.internalReset();break;case`speed`:c.handleSpeedChange(n);break;case`backward`:c.internalBackward();break;case`playPause`:n===`play`?c.internalPlay():c.internalPause();break;case`forward`:c.internalForward();break;case`selectionType`:c.handleSelectionTypeChange(n);break;case`chartType`:c.handleChartTypeChange(n);break;default:break}}}),s);t===`time`&&(l.functions=[[`reset`,`speed`],[`backward`,`playPause`,`forward`],[`selectionType`]]),this.controller.update(l)},t.prototype.dispatchOnChange=function(e){var t=this.data,n=this.attributes.onChange,r=this.states,i=r.values,a=r.selectionType,o=R(i,2),s=o[0],c=o[1],l=c===1/0?t.at(-1).time:c;(!e||!function(e,t){return Array.isArray(e)?Array.isArray(t)?e[0]===t[0]&&(e[1]===t[1]||e[1]===1/0||t[1]===1/0):!1:Array.isArray(t)?!1:e===t}(e,a===`range`?[s,l]:l))&&n?.(a===`range`?[s,l]:l)},t.prototype.internalReset=function(e){var t,n,r=this.states.selectionType;this.internalPause(),this.setBySliderValues(r===`range`?[0,1]:[0,0]),this.renderController(),this.updateSelection(),e||((n=(t=this.attributes)?.onReset)==null||n.call(t),this.dispatchOnChange())},t.prototype.reset=function(){this.internalReset()},t.prototype.moveSelection=function(e,t){var n=this.data,r=n.length,i=this.states,a=i.values,o=i.selectionType,s=i.playMode,c=R(a,2),l=c[0],u=c[1],d=n.findIndex(function(e){return e.time===l}),f=n.findIndex(function(e){return e.time===u});f===-1&&(f=r);var p=e===`backward`?-1:1,m;o===`range`?s===`acc`?(m=[d,f+p],p===-1&&d===f&&(m=[d,r])):m=[d+p,f+p]:m=[d,f+p];var h=function(e){var t=R(e.sort(function(e,t){return e-t}),2),n=t[0],i=t[1],a=function(e){return cu(e,0,r)};return i>r?o===`value`?[0,0]:s===`acc`?[a(n),a(n)]:[0,a(i-n)]:n<0?s===`acc`?[0,a(i)]:[a(n+r-i),r]:[a(n),a(i)]}(m);return this.setByIndex(h),this.updateSelection(),h},t.prototype.internalBackward=function(e){var t,n,r=this.moveSelection(`backward`,e);return e||((n=(t=this.attributes)?.onBackward)==null||n.call(t),this.dispatchOnChange()),r},t.prototype.backward=function(){this.internalBackward()},t.prototype.internalPlay=function(e){var t=this,n,r,i=this.data,a=this.attributes.loop,o=this.states.speed,s=o===void 0?1:o;this.playInterval=window.setInterval(function(){t.internalForward()[1]===i.length&&!a&&(t.internalPause(),t.renderController())},1e3/s),this.states.state=`play`,!e&&((r=(n=this.attributes)?.onPlay)==null||r.call(n))},t.prototype.play=function(){this.internalPlay()},t.prototype.internalPause=function(e){var t,n;clearInterval(this.playInterval),this.states.state=`pause`,!e&&((n=(t=this.attributes)?.onPause)==null||n.call(t))},t.prototype.pause=function(){this.internalPause()},t.prototype.internalForward=function(e){var t,n,r=this.moveSelection(`forward`,e);return e||((n=(t=this.attributes)?.onForward)==null||n.call(t),this.dispatchOnChange()),r},t.prototype.forward=function(){this.internalForward()},t.prototype.handleSpeedChange=function(e){var t,n;this.states.speed=e,this.states.state===`play`&&(this.internalPause(!0),this.internalPlay(!0)),(n=(t=this.attributes)?.onSpeedChange)==null||n.call(t,e)},t.prototype.handleSelectionTypeChange=function(e){var t,n;this.states.selectionType=e,this.renderChart(),(n=(t=this.attributes)?.onSelectionTypeChange)==null||n.call(t,e)},t.prototype.handleChartTypeChange=function(e){var t,n;this.states.chartType=e,this.renderChart(),(n=(t=this.attributes)?.onChartTypeChange)==null||n.call(t,e)},t.prototype.render=function(){var e=this.space,t=e.axisBBox,n=e.controllerBBox,r=e.timelineBBox;this.renderController(n),this.renderAxis(t),this.renderChart(r),this.states.state===`play`&&this.internalPlay()},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.internalPause(!0)},t.defaultOptions={style:{x:0,y:0,axisLabelFill:`#6e6e6e`,axisLabelTextAlign:`left`,axisLabelTextBaseline:`top`,axisLabelTransform:`translate(5, -12)`,axisLineLineWidth:1,axisLineStroke:`#cacdd1`,axisTickLength:15,axisTickLineWidth:1,axisTickStroke:`#cacdd1`,chartShowLabel:!1,chartType:`line`,controllerAlign:`center`,controllerHeight:40,data:[],interval:`day`,loop:!1,playMode:`acc`,selectionType:`range`,type:`time`}},t}(sK);function KX(e){let{width:t,height:n,renderer:r}=e,i=qX(e),a=new ub({width:t,height:n,container:i,renderer:r||new uD});return[i,a]}function qX(e){var t;let{container:n,className:r,graphCanvas:i}=e;if(n)return typeof n==`string`?document.getElementById(n):n;let a=aH(r,!1),{width:o,height:s,containerStyle:c}=e,[l,u]=JX(e);return Object.assign(a.style,Object.assign({position:`absolute`,left:l+`px`,top:u+`px`,width:o+`px`,height:s+`px`},c)),(t=i.getContainer())==null||t.appendChild(a),a}function JX(e){let{width:t,height:n,placement:r,graphCanvas:i}=e,[a,o]=i.getSize(),[s,c]=iw(r);return[s*(a-t),c*(o-n)]}var YX=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},XX=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.typePrefix=`__data__`,this.draw=!1,this.fieldMap={node:new Map,edge:new Map,combo:new Map},this.selectedItems=[],this.bindEvents=()=>{let{graph:e}=this.context;e.on(Z.AFTER_DRAW,this.createElement)},this.changeState=(e,t)=>{let{graph:n}=this.context,{typePrefix:r}=this,i=Ku(e,[r,`id`]),a=Ku(e,[r,`style`,`labelText`]),[o]=i.split(`__`),s=this.fieldMap[o].get(a)||[];n.setElementState(Object.fromEntries(s?.map(e=>[e,t])))},this.click=e=>{if(this.options.trigger===`hover`)return;let t=Ku(e,[this.typePrefix,`id`]);this.selectedItems.includes(t)?(this.selectedItems=this.selectedItems.filter(e=>e!==t),this.changeState(e,[])):(this.selectedItems.push(t),this.changeState(e,`selected`))},this.mouseleave=e=>{this.options.trigger!==`click`&&(this.selectedItems=[],this.changeState(e,[]))},this.mouseenter=e=>{if(this.options.trigger===`click`)return;let t=Ku(e,[this.typePrefix,`id`]);this.selectedItems.includes(t)?this.selectedItems=this.selectedItems.filter(e=>e!==t):(this.selectedItems.push(t),this.changeState(e,`active`))},this.setFieldMap=(e,t,n)=>{if(!e)return;let r=this.fieldMap[n];if(r)if(!r.has(e))r.set(e,[t]);else{let n=r.get(e);n&&(n.push(t),r.set(e,n))}},this.getEvents=()=>({mouseenter:this.mouseenter,mouseleave:this.mouseleave,click:this.click}),this.getMarkerData=(e,t)=>{if(!e)return[];let{model:n,element:r}=this.context,{nodes:i,edges:a,combos:o}=n.getData(),s={},c=t=>W(e)?e(t):e,l={node:`circle`,edge:`line`,combo:`rect`},u={circle:`circle`,ellipse:`circle`,image:`bowtie`,rect:`square`,star:`cross`,triangle:`triangle`,diamond:`diamond`,cubic:`dot`,line:`hyphen`,polyline:`hyphen`,quadratic:`hv`,"cubic-horizontal":`hyphen`,"cubic-vertical":`line`},d=(e,t)=>r?.getElementComputedStyle(e,t),f=(e,t)=>{e.forEach(e=>{let{id:n}=e,i=Ku(e,[`data`,c(e)]),a=r?.getElementType(t,e)||`circle`,o=d(t,e),f=(t===`edge`?o?.stroke:o?.fill)||`#1783ff`;n&&i&&i.replace(/\s+/g,``)&&(this.setFieldMap(i,n,t),s[i]||(s[i]={id:`${t}__${n}`,label:i,marker:u[a]||l[t],elementType:t,lineWidth:1,stroke:f,fill:f}))})};switch(t){case`node`:f(i,`node`);break;case`edge`:f(a,`edge`);break;case`combo`:f(o,`combo`);break;default:return[]}return Object.values(s)},this.createElement=()=>{if(this.draw){this.updateElement();return}let e=this.options,{width:t,height:n,nodeField:r,edgeField:i,comboField:a,trigger:o,position:s,container:c,containerStyle:l,className:u}=e,d=YX(e,[`width`,`height`,`nodeField`,`edgeField`,`comboField`,`trigger`,`position`,`container`,`containerStyle`,`className`]),f=this.getMarkerData(r,`node`),p=this.getMarkerData(i,`edge`),m=this.getMarkerData(a,`combo`),h=[...f,...m,...p],g=Object.assign({width:t,height:n,data:h,itemMarkerLineWidth:({lineWidth:e})=>e,itemMarker:({marker:e})=>e,itemMarkerStroke:({stroke:e})=>e,itemMarkerFill:({fill:e})=>e,gridCol:f.length},d,this.getEvents()),_=new uX({className:`legend`,style:g});this.category=_,this.upsertCanvas().appendChild(_),this.draw=!0},this.bindEvents()}update(e){super.update(e),this.clear(),this.createElement()}clear(){var e,t;(e=this.canvas)==null||e.destroy(),(t=this.container)==null||t.remove(),this.canvas=void 0,this.container=void 0,this.draw=!1}updateElement(){this.category&&this.category.update({itemMarkerOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5,itemLabelOpacity:({id:e})=>!this.selectedItems.length||this.selectedItems.includes(e)?1:.5})}upsertCanvas(){if(this.canvas)return this.canvas;let e=this.context.canvas,[t,n]=e.getSize(),{width:r=t,height:i=n,position:a,container:o,containerStyle:s,className:c}=this.options,[l,u]=KX({width:r,height:i,graphCanvas:e,container:o,containerStyle:s,placement:a,className:`legend`});return this.container=l,c&&l.classList.add(c),this.canvas=u,this.canvas}destroy(){this.clear(),this.context.graph.off(Z.AFTER_DRAW,this.createElement),super.destroy()}};XX.defaultOptions={position:`bottom`,trigger:`hover`,orientation:`horizontal`,layout:`flex`,itemSpacing:4,rowPadding:10,colPadding:10,itemMarkerSize:16,itemLabelFontSize:16,width:240,height:160};var ZX=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.onDraw=e=>{e?.data?.render||this.onRender()},this.shapes=new Map,this.landmarkMap=new Map,this.mask=null,this.isMaskDragging=!1,this.onMaskDragStart=e=>{this.mask&&(this.isMaskDragging=!0,this.mask.setPointerCapture(e.pointerId),this.mask.addEventListener(`pointermove`,this.onMaskDrag),this.mask.addEventListener(`pointerup`,this.onMaskDragEnd),this.mask.addEventListener(`pointercancel`,this.onMaskDragEnd))},this.onMaskDrag=e=>{if(!this.mask||!this.isMaskDragging)return;let{size:[t,n]}=this.options,{movementX:r,movementY:i}=e,{left:a,top:o,width:s,height:c}=this.mask.style,[,,l,u]=this.maskBBox,d=parseInt(a)+r,f=parseInt(o)+i,p=parseInt(s),m=parseInt(c);d<0&&(d=0),f<0&&(f=0),d+p>t&&(d=$X(t-p,0)),f+m>n&&(f=$X(n-m,0)),p<l&&(r>0?(d=$X(d-r,0),p=QX(p+r,t)):r<0&&(p=QX(p-r,t))),m<u&&(i>0?(f=$X(f-i,0),m=QX(m+i,n)):i<0&&(m=QX(m-i,n))),Object.assign(this.mask.style,{left:d+`px`,top:f+`px`,width:p+`px`,height:m+`px`});let h=parseInt(a)-d,g=parseInt(o)-f;if(h===0&&g===0)return;let _=this.context.canvas.getCamera().getZoom(),v=this.canvas.getCamera().getZoom(),y=_/v;this.context.graph.translateBy([h*y,g*y],!1)},this.onMaskDragEnd=e=>{this.mask&&(this.isMaskDragging=!1,this.mask.releasePointerCapture(e.pointerId),this.mask.removeEventListener(`pointermove`,this.onMaskDrag),this.mask.removeEventListener(`pointerup`,this.onMaskDragEnd),this.mask.removeEventListener(`pointercancel`,this.onMaskDragEnd))},this.onTransform=Zu(()=>{this.isMaskDragging||(this.updateMask(),this.setCamera())},32,{leading:!0}),this.setOnRender(),this.bindEvents()}update(e){this.unbindEvents(),super.update(e),`delay`in e&&this.setOnRender(),this.bindEvents()}setOnRender(){this.onRender=Nu(()=>{this.renderMinimap(),this.renderMask()},this.options.delay)}bindEvents(){let{graph:e}=this.context;e.on(Z.AFTER_DRAW,this.onDraw),e.on(Z.AFTER_RENDER,this.onRender),e.on(Z.AFTER_ANIMATE,this.onRender),e.on(Z.AFTER_TRANSFORM,this.onTransform)}unbindEvents(){let{graph:e}=this.context;e.off(Z.AFTER_DRAW,this.onDraw),e.off(Z.AFTER_RENDER,this.onRender),e.off(Z.AFTER_ANIMATE,this.onRender),e.off(Z.AFTER_TRANSFORM,this.onTransform)}renderMinimap(){let e=this.getElements(),t=this.initCanvas();this.setShapes(t,e)}getElements(){let{filter:e}=this.options,{model:t,element:n}=this.context,r=t.getData(),i={nodes:r.nodes.filter(e=>n?.getElement(Q(e))),edges:r.edges.filter(e=>{let t=n?.getElement(Q(e));return t&&QO(t)}),combos:r.combos.filter(e=>n?.getElement(Q(e)))};if(!e)return i;let{nodes:a,edges:o,combos:s}=i;return{nodes:a.filter(t=>e(Q(t),`node`)),edges:o.filter(t=>e(Q(t),`edge`)),combos:s.filter(t=>e(Q(t),`combo`))}}setShapes(e,t){let{nodes:n,edges:r,combos:i}=t,{shape:a}=this.options,{element:o}=this.context;if(a===`key`){let t=new Set,a=n=>{let r=Q(n);t.add(r);let i=o.getElement(r);if(!i)return;let a=i.getShape(`key`),s=this.shapes.get(r)||a.cloneNode();s.setPosition(a.getPosition()),i.style.zIndex&&(s.style.zIndex=i.style.zIndex),s.id=i.id,this.shapes.has(r)?Object.entries(a.attributes).forEach(([e,t])=>{s.style[e]!==t&&(s.style[e]=t)}):(e.appendChild(s),this.shapes.set(r,s))};r.forEach(a),i.forEach(a),n.forEach(a),this.shapes.forEach((n,r)=>{t.has(r)||(e.removeChild(n),this.shapes.delete(r))});return}let s=(e,t)=>{let n=o.getElement(e).getPosition();return t.setPosition(n),t};e.removeChildren(),r.forEach(t=>e.appendChild(a(Q(t),`edge`))),i.forEach(t=>{e.appendChild(s(Q(t),a(Q(t),`combo`)))}),n.forEach(t=>{e.appendChild(s(Q(t),a(Q(t),`node`)))})}initCanvas(){let{renderer:e,size:[t,n]}=this.options;if(this.canvas){let{width:r,height:i}=this.canvas.getConfig();(t!==r||n!==i)&&this.canvas.resize(t,n),e&&this.canvas.setRenderer(e)}else{let{className:r,position:i,container:a,containerStyle:o}=this.options,[s,c]=KX({renderer:e,width:t,height:n,placement:i,className:`minimap`,container:a,containerStyle:o,graphCanvas:this.context.canvas});r&&s.classList.add(r),this.container=s,this.canvas=c}return this.setCamera(),this.canvas}createLandmark(e,t,n){let r=`${e.join(`,`)}-${t.join(`,`)}-${n}`;if(this.landmarkMap.has(r))return this.landmarkMap.get(r);let i=this.canvas.getCamera().createLandmark(r,{position:e,focalPoint:t,zoom:n});return this.landmarkMap.set(r,i),i}setCamera(){let{canvas:e}=this.context,t=this.canvas?.getCamera();if(!t)return;let{size:[n,r],padding:i}=this.options,[a,o,s,c]=CS(i),{min:l,max:u,center:d}=e.getBounds(`elements`),f=u[0]-l[0],p=u[1]-l[1],m=n-c-o,h=r-a-s,g=m/f,_=h/p,v=Math.min(g,_),y=this.createLandmark(d,d,v);t.gotoLandmark(y,0)}get maskBBox(){let{canvas:e}=this.context,t=e.getSize(),n=e.getCanvasByViewport([0,0]),r=e.getCanvasByViewport(t),i=this.canvas.canvas2Viewport(uw(n)),a=this.canvas.canvas2Viewport(uw(r)),o=a.x-i.x,s=a.y-i.y;return[i.x,i.y,o,s]}calculateMaskBBox(){let{size:[e,t]}=this.options,[n,r,i,a]=this.maskBBox;return n<0&&(i=QX(i+n,e),n=0),r<0&&(a=QX(a+r,t),r=0),n+i>e&&(i=$X(e-n,0)),r+a>t&&(a=$X(t-r,0)),[QX(n,e),QX(r,t),$X(i,0),$X(a,0)]}renderMask(){let{maskStyle:e}=this.options;this.mask||(this.mask=document.createElement(`div`),this.mask.addEventListener(`pointerdown`,this.onMaskDragStart),this.mask.draggable=!0,this.mask.addEventListener(`dragstart`,e=>e.preventDefault&&e.preventDefault())),this.container.appendChild(this.mask),Object.assign(this.mask.style,Object.assign(Object.assign({},e),{cursor:`move`,position:`absolute`,pointerEvents:`auto`})),this.updateMask()}updateMask(){if(!this.mask)return;let[e,t,n,r]=this.calculateMaskBBox();Object.assign(this.mask.style,{top:t+`px`,left:e+`px`,width:n+`px`,height:r+`px`})}destroy(){var e,t,n;this.unbindEvents(),(e=this.canvas)==null||e.destroy(),(t=this.mask)==null||t.remove(),(n=this.container)==null||n.remove(),super.destroy()}};ZX.defaultOptions={size:[240,160],shape:`key`,padding:10,position:`right-bottom`,maskStyle:{border:`1px solid #ddd`,background:`rgba(0, 0, 0, 0.1)`},containerStyle:{border:`1px solid #ddd`,background:`#fff`},delay:128};var QX=(e,t)=>Math.min(e,t),$X=(e,t)=>Math.max(e,t),eZ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},tZ={x1:0,y1:0,x2:0,y2:0,visibility:`hidden`},nZ=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.initSnapline=()=>{let e=this.context.canvas.getLayer(`transient`);this.horizontalLine||=e.appendChild(new Ry({style:Object.assign(Object.assign({},tZ),this.options.horizontalLineStyle)})),this.verticalLine||=e.appendChild(new Ry({style:Object.assign(Object.assign({},tZ),this.options.verticalLineStyle)}))},this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!0,this.autoSnapToLine=(e,t,n)=>eZ(this,void 0,void 0,function*(){let{verticalX:r,horizontalY:i}=n,{tolerance:a}=this.options,{min:[o,s],max:[c,l],center:[u,d]}=t,f=0,p=0;r!==null&&(rZ(c,r)<a&&(f=r-c),rZ(o,r)<a&&(f=r-o),rZ(u,r)<a&&(f=r-u),f!==0&&(this.isVerticalSticking=!0)),i!==null&&(rZ(l,i)<a&&(p=i-l),rZ(s,i)<a&&(p=i-s),rZ(d,i)<a&&(p=i-d),p!==0&&(this.isHorizontalSticking=!0)),(f!==0||p!==0)&&(yield this.context.graph.translateElementBy({[e]:[f,p]},!1))}),this.enableSnap=e=>{let{target:t}=e,n=.5;if(this.isHorizontalSticking||this.isVerticalSticking){let[r,i]=this.getDelta(e);if(this.isHorizontalSticking&&this.isVerticalSticking&&Math.abs(r)<=n&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[t.id]:[-r,-i]},!1),!1;if(this.isHorizontalSticking&&Math.abs(i)<=n)return this.context.graph.translateElementBy({[t.id]:[0,-i]},!1),!1;if(this.isVerticalSticking&&Math.abs(r)<=n)return this.context.graph.translateElementBy({[t.id]:[-r,0]},!1),!1;this.isHorizontalSticking=!1,this.isVerticalSticking=!1,this.enableStick=!1,setTimeout(()=>{this.enableStick=!0},200)}return this.enableStick},this.calcSnaplineMetadata=(e,t)=>{let{tolerance:n,shape:r}=this.options,{min:[i,a],max:[o,s],center:[c,l]}=t,u=null,d=null,f=null,p=null,m=null,h=null;return this.getNodes().some(t=>{if(Gu(e.id,t.id))return!1;let{min:[g,_],max:[v,y],center:[b,x]}=iZ(t,r).getRenderBounds();return u===null&&(rZ(b,c)<n?u=b:rZ(g,i)<n||rZ(g,o)<n?u=g:(rZ(v,o)<n||rZ(v,i)<n)&&(u=v),u!==null&&(d=Math.min(_,a),f=Math.max(y,s))),p===null&&(rZ(x,l)<n?p=x:rZ(_,a)<n||rZ(_,s)<n?p=_:(rZ(y,s)<n||rZ(y,a)<n)&&(p=y),p!==null&&(m=Math.min(g,i),h=Math.max(v,o))),u!==null&&p!==null}),{verticalX:u,verticalMinY:d,verticalMaxY:f,horizontalY:p,horizontalMinX:m,horizontalMaxX:h}},this.onDragStart=()=>{this.initSnapline()},this.onDrag=e=>eZ(this,void 0,void 0,function*(){let{target:t}=e;if(this.options.autoSnap&&!this.enableSnap(e))return;let n=iZ(t,this.options.shape).getRenderBounds(),r=this.calcSnaplineMetadata(t,n);this.hideSnapline(),(r.verticalX!==null||r.horizontalY!==null)&&this.updateSnapline(r),this.options.autoSnap&&(yield this.autoSnapToLine(t.id,n,r))}),this.onDragEnd=()=>{this.hideSnapline()},this.bindEvents()}getNodes(){let{filter:e}=this.options,t=(this.context.element?.getNodes()||[]).filter(e=>QO(e)&&this.context.viewport?.isInViewport(e.getRenderBounds()));return e?t.filter(t=>e(t)):t}hideSnapline(){this.horizontalLine.style.visibility=`hidden`,this.verticalLine.style.visibility=`hidden`}getLineWidth(e){let{lineWidth:t}=this.options[`${e}LineStyle`];return+(t||tZ.lineWidth||1)/this.context.graph.getZoom()}updateSnapline(e){let{verticalX:t,verticalMinY:n,verticalMaxY:r,horizontalY:i,horizontalMinX:a,horizontalMaxX:o}=e,[s,c]=this.context.canvas.getSize(),{offset:l}=this.options;i===null?this.horizontalLine.style.visibility=`hidden`:Object.assign(this.horizontalLine.style,{x1:l===1/0?0:a-l,y1:i,x2:l===1/0?s:o+l,y2:i,visibility:`visible`,lineWidth:this.getLineWidth(`horizontal`)}),t===null?this.verticalLine.style.visibility=`hidden`:Object.assign(this.verticalLine.style,{x1:t,y1:l===1/0?0:n-l,x2:t,y2:l===1/0?c:r+l,visibility:`visible`,lineWidth:this.getLineWidth(`vertical`)})}getDelta(e){let t=this.context.graph.getZoom();return UC([e.dx,e.dy],t)}bindEvents(){return eZ(this,void 0,void 0,function*(){let{graph:e}=this.context;e.on(Kx.DRAG_START,this.onDragStart),e.on(Kx.DRAG,this.onDrag),e.on(Kx.DRAG_END,this.onDragEnd)})}unbindEvents(){let{graph:e}=this.context;e.off(Kx.DRAG_START,this.onDragStart),e.off(Kx.DRAG,this.onDrag),e.off(Kx.DRAG_END,this.onDragEnd)}destroyElements(){var e,t;(e=this.horizontalLine)==null||e.destroy(),(t=this.verticalLine)==null||t.destroy()}destroy(){this.destroyElements(),this.unbindEvents(),super.destroy()}};nZ.defaultOptions={tolerance:5,offset:20,autoSnap:!0,shape:`key`,verticalLineStyle:{stroke:`#1783FF`},horizontalLineStyle:{stroke:`#1783FF`},filter:()=>!0};var rZ=(e,t)=>Math.abs(e-t),iZ=(e,t)=>typeof t==`function`?t(e):e.getShape(t),aZ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},oZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},sZ=[`timestamp`,`time`,`date`,`datetime`],cZ=class e extends iH{get padding(){return CS(this.options.padding)}constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.backup(),this.upsertTimebar()}play(){var e;(e=this.timebar)==null||e.play()}pause(){var e;(e=this.timebar)==null||e.pause()}forward(){var e;(e=this.timebar)==null||e.forward()}backward(){var e;(e=this.timebar)==null||e.backward()}reset(){var e;(e=this.timebar)==null||e.reset()}update(e){super.update(e),this.backup(),this.upsertTimebar()}backup(){this.originalData=lZ(this.context.graph.getData())}upsertTimebar(){let{canvas:e}=this.context,t=this.options,{onChange:n,timebarType:r,data:i,x:a,y:o,width:s,height:c,mode:l}=t,u=oZ(t,[`onChange`,`timebarType`,`data`,`x`,`y`,`width`,`height`,`mode`]),d=e.getSize(),[f]=this.padding;this.upsertCanvas().ready.then(()=>{var e;let t=Object.assign(Object.assign({x:d[0]/2-s/2,y:f,onChange:e=>{let t=(Gl(e)?e:[e,e]).map(e=>Su(e)?e.getTime():e);this.options.mode===`modify`?this.filterElements(t):this.hiddenElements(t),n?.(t)}},u),{data:i.map(e=>G(e)?{time:e,value:0}:e),width:s,height:c,type:r});this.timebar?this.timebar.update(t):(this.timebar=new GX({style:t}),(e=this.canvas)==null||e.appendChild(this.timebar))})}upsertCanvas(){if(this.canvas)return this.canvas;let{className:e,height:t,position:n}=this.options,r=this.context.canvas,[i]=r.getSize(),[a,,o]=this.padding,[s,c]=KX({width:i,height:t+a+o,graphCanvas:r,className:`timebar`,placement:n});return this.container=s,e&&s.classList.add(e),this.canvas=c,this.canvas}filterElements(e){return aZ(this,void 0,void 0,function*(){if(!this.originalData)return;let{elementTypes:t,getTime:n}=this.options,{graph:r,element:i}=this.context,a=lZ(this.originalData);t.forEach(t=>{let r=`${t}s`;a[r]=(this.originalData[r]||[]).filter(t=>{let r=n(t);return!!uZ(r,e)})});let o=[...a.nodes,...a.combos].map(e=>Q(e));a.edges=a.edges.filter(e=>{let t=e.source,n=e.target;return o.includes(t)&&o.includes(n)}),r.setData(a),yield i.draw({animation:!1,silence:!0})?.finished})}hiddenElements(e){let{graph:t}=this.context,{elementTypes:n,getTime:r}=this.options,i=[],a=[];n.forEach(t=>{let n=`${t}s`;(this.originalData?.[n]||[]).forEach(t=>{let n=Q(t),o=r(t);uZ(o,e)?a.push(n):i.push(n)})}),t.hideElement(i,!1),t.showElement(a,!1)}destroy(){var e,t,n;let{graph:r}=this.context;this.originalData&&r.setData(Object.assign({},this.originalData)),(e=this.timebar)==null||e.destroy(),(t=this.canvas)==null||t.destroy(),(n=this.container)==null||n.remove(),this.originalData=void 0,this.container=void 0,this.timebar=void 0,this.canvas=void 0,super.destroy()}};cZ.defaultOptions={position:`bottom`,enable:!0,timebarType:`time`,className:`g6-timebar`,width:450,height:60,zIndex:3,elementTypes:[`node`],padding:10,mode:`modify`,getTime:e=>dZ(e,sZ,void 0),loop:!1};var lZ=e=>{let{nodes:t=[],edges:n=[],combos:r=[]}=e;return{nodes:[...t],edges:[...n],combos:[...r]}},uZ=(e,t)=>{if(G(t))return e===t;let[n,r]=t;return e>=n&&e<=r},dZ=(e,t,n)=>{for(let n=0;n<t.length;n++){let r=t[n],i=e.data?.[r];if(i)return i}return n};function fZ(e){let t={top:`unset`,right:`unset`,bottom:`unset`,left:`unset`};return e.split(`-`).forEach(e=>{t[e]=`8px`}),t.flexDirection=e.startsWith(`top`)||e.startsWith(`bottom`)?`row`:`column`,t}var pZ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},mZ=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.$element=aH(`toolbar`,!1),this.onToolbarItemClick=e=>{let{onClick:t}=this.options;if(e.target instanceof Element&&e.target.className.includes(`g6-toolbar-item`)){let n=e.target.getAttribute(`value`);t?.(n,e.target)}};let r=this.context.canvas.getContainer();this.$element.style.display=`flex`,r.appendChild(this.$element),oH(`g6-toolbar-css`,`style`,{},`
  .g6-toolbar {
    position: absolute;
    z-index: 100;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    opacity: 0.65;
  }
  .g6-toolbar .g6-toolbar-item {
    display: inline-block;
    width: 16px;
    height: 16px;
    padding: 4px;
    cursor: pointer;
    box-sizing: content-box;
  }

  .g6-toolbar .g6-toolbar-item:hover {
    background-color: #f0f0f0;
  }

  .g6-toolbar .g6-toolbar-item svg {
    display: inline-block;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }
`,document.head),oH(`g6-toolbar-svgicon`,`div`,{display:`none`},`
  <svg>
    <symbol id="zoom-in" viewBox="64 64 896 896">
      <path d="M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="zoom-out" viewBox="64 64 896 896">
      <path d="M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"></path>
    </symbol>
    <symbol id="edit" viewBox="64 64 896 896">
      <path d="M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"></path>
    </symbol>
    <symbol id="delete" viewBox="64 64 896 896">
      <path d="M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"></path>
    </symbol>
    <symbol id="redo" viewBox="64 64 896 896">
      <path d="M758.2 839.1C851.8 765.9 912 651.9 912 523.9 912 303 733.5 124.3 512.6 124 291.4 123.7 112 302.8 112 523.9c0 125.2 57.5 236.9 147.6 310.2 3.5 2.8 8.6 2.2 11.4-1.3l39.4-50.5c2.7-3.4 2.1-8.3-1.2-11.1-8.1-6.6-15.9-13.7-23.4-21.2a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-9.3 9.3-19.1 18-29.3 26L668.2 724a8 8 0 00-14.1 3l-39.6 162.2c-1.2 5 2.6 9.9 7.7 9.9l167 .8c6.7 0 10.5-7.7 6.3-12.9l-37.3-47.9z"></path>
    </symbol>
    <symbol id="undo" viewBox="64 64 896 896">
      <path d="M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 00-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 01-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7 29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6 29.4 29.4 52.5 63.6 68.6 101.7 16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 01-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 00-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z"></path>
    </symbol>
    <symbol id="export" viewBox="64 64 896 896">
      <path d="M880 912H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32h360c4.4 0 8 3.6 8 8v56c0 4.4-3.6 8-8 8H184v656h656V520c0-4.4 3.6-8 8-8h56c4.4 0 8 3.6 8 8v360c0 17.7-14.3 32-32 32zM770.87 199.13l-52.2-52.2a8.01 8.01 0 014.7-13.6l179.4-21c5.1-.6 9.5 3.7 8.9 8.9l-21 179.4c-.8 6.6-8.9 9.4-13.6 4.7l-52.4-52.4-256.2 256.2a8.03 8.03 0 01-11.3 0l-42.4-42.4a8.03 8.03 0 010-11.3l256.1-256.3z"></path>
    </symbol>
    <symbol id="auto-fit" viewBox="64 64 896 896">
      <path d="M952 474H829.8C812.5 327.6 696.4 211.5 550 194.2V72c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v122.2C327.6 211.5 211.5 327.6 194.2 474H72c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h122.2C211.5 696.4 327.6 812.5 474 829.8V952c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V829.8C696.4 812.5 812.5 696.4 829.8 550H952c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zM512 756c-134.8 0-244-109.2-244-244s109.2-244 244-244 244 109.2 244 244-109.2 244-244 244z"></path>
      <path d="M512 392c-32.1 0-62.1 12.4-84.8 35.2-22.7 22.7-35.2 52.7-35.2 84.8s12.5 62.1 35.2 84.8C449.9 619.4 480 632 512 632s62.1-12.5 84.8-35.2C619.4 574.1 632 544 632 512s-12.5-62.1-35.2-84.8A118.57 118.57 0 00512 392z"></path>
    </symbol>
    <symbol id="reset" viewBox="64 64 896 896">
      <path d="M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"></path>
    </symbol>
    <symbol id="exit-fullscreen" viewBox="0 0 1024 1024">
      <path d="M418.13333333 361.43786666c0 0.2048-0.13653333 0.4096-0.13653334 0.68266667C417.99679999 362.32533333 418.13333333 362.53013333 418.13333333 362.73493333 418.13333333 371.54133333 414.44693333 379.392 408.78079999 385.39946666 408.43946666 385.7408 408.30293333 386.21866666 408.02986666 386.49173333c-1.09226667 1.09226667-2.59413333 1.77493333-3.82293333 2.73066667C398.40426666 393.65973333 391.64586666 396.8 383.93173333 396.8 383.72693333 396.8 383.59039999 396.73173333 383.38559999 396.73173333S382.97599999 396.8 382.77119999 396.8L112.29866666 396.8C92.50133333 396.8 76.79999999 381.50826666 76.79999999 362.66666666 76.66346666 343.89333333 92.63786666 328.53333333 112.16213333 328.53333333l189.44 0L87.44959999 114.51733333C73.59146666 100.59093333 73.25013333 78.5408 86.63039999 65.29706666c13.17546667-13.44853333 35.36213333-12.97066667 49.152 0.88746667l214.08426667 214.08426667L349.86666666 90.89706666C349.79839999 71.23626666 365.22666666 55.46666666 383.99999999 55.46666666 402.77333333 55.33013333 418.13333333 71.30453333 418.13333333 90.8288L418.13333333 361.43786666zM928.90453333 328.53333333l-189.44 0 214.15253333-214.08426667c13.85813333-13.9264 14.19946667-35.90826667 0.88746667-49.22026666-13.17546667-13.44853333-35.36213333-12.97066667-49.152 0.88746666l-214.08426667 214.08426667L691.26826666 90.89706666C691.26826666 71.23626666 675.83999999 55.46666666 657.06666666 55.46666666 638.29333333 55.33013333 622.93333333 71.30453333 622.93333333 90.8288l0 270.60906666c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 362.32533333 622.93333333 362.53013333 622.93333333 362.73493333 622.93333333 371.54133333 626.61973333 379.392 632.28586666 385.39946666c0.34133333 0.34133333 0.47786667 0.8192 0.8192 1.09226667 1.09226667 1.09226667 2.59413333 1.77493333 3.8912 2.73066667C642.66239999 393.65973333 649.42079999 396.8 657.13493333 396.8c0.2048 0 0.34133333-0.06826667 0.54613333-0.06826667S658.09066666 396.8 658.29546666 396.8l270.5408 0C948.56533333 396.8 964.26666666 381.50826666 964.26666666 362.66666666 964.40319999 343.89333333 948.42879999 328.53333333 928.90453333 328.53333333zM418.13333333 635.73333333c0-8.8064-3.6864-16.5888-9.35253334-22.66453333C408.43946666 612.72746666 408.30293333 612.2496 408.02986666 611.90826666 406.86933333 610.88426666 405.43573333 610.2016 404.20693333 609.24586666 398.47253333 604.80853333 391.64586666 601.6 383.93173333 601.6 383.72693333 601.6 383.59039999 601.73653333 383.38559999 601.73653333S382.97599999 601.6 382.77119999 601.6L112.29866666 601.6C92.50133333 601.6 76.79999999 616.96 76.79999999 635.73333333 76.66346666 654.50666666 92.63786666 669.86666666 112.16213333 669.86666666l189.44 0-214.15253334 214.15253334c-13.85813333 13.85813333-14.19946667 35.84-0.88746666 49.22026666 13.17546667 13.44853333 35.36213333 12.9024 49.152-0.95573333l214.08426666-214.08426667 0 189.37173334c0 19.59253333 15.42826667 35.49866667 34.2016 35.36213333C402.77333333 943.2064 418.13333333 927.232 418.13333333 907.5712L418.13333333 637.09866666c0-0.27306667-0.13653333-0.47786667-0.13653334-0.68266666C417.99679999 636.14293333 418.13333333 635.93813333 418.13333333 635.73333333zM739.46453333 669.86666666l189.44 0c19.456 0 35.49866667-15.36 35.36213333-34.13333333C964.26666666 616.96 948.56533333 601.6 928.76799999 601.6L658.29546666 601.6C658.09066666 601.6 657.88586666 601.73653333 657.68106666 601.73653333S657.33973333 601.6 657.13493333 601.6C649.42079999 601.6 642.59413333 604.80853333 636.85973333 609.24586666 635.63093333 610.2016 634.19733333 610.88426666 633.03679999 611.90826666 632.76373333 612.2496 632.62719999 612.72746666 632.28586666 613.0688 626.61973333 619.14453333 622.93333333 626.92693333 622.93333333 635.73333333c0 0.2048 0.13653333 0.4096 0.13653333 0.68266667C623.06986666 636.6208 622.93333333 636.8256 622.93333333 637.09866666l0 270.5408C622.93333333 927.232 638.29333333 943.2064 657.06666666 942.93333333c18.77333333 0.13653333 34.2016-15.70133333 34.2016-35.36213333l0-189.37173334 214.08426667 214.08426667c13.78986667 13.85813333 35.90826667 14.40426667 49.152 0.95573333 13.312-13.312 12.97066667-35.36213333-0.88746667-49.22026666L739.46453333 669.86666666z"  ></path></symbol>
    <symbol id="request-fullscreen" viewBox="0 0 1024 1024">
      <path d="M69.818182 87.598545v273.128728a34.909091 34.909091 0 0 0 69.818182 0V163.653818l221.928727 222.021818a33.512727 33.512727 0 0 0 47.383273-47.383272L186.926545 116.363636h197.073455a34.909091 34.909091 0 0 0 0-69.818181H110.871273C85.364364 46.545455 69.818182 59.671273 69.818182 87.598545zM938.542545 46.545455H665.413818a34.909091 34.909091 0 0 0 0 69.818181h197.073455L640.465455 338.292364a33.512727 33.512727 0 0 0 47.383272 47.383272l221.928728-222.021818v197.073455a34.909091 34.909091 0 0 0 69.818181 0V87.598545c0-27.927273-15.453091-41.053091-40.96-41.05309z m-827.671272 907.636363h273.128727a34.909091 34.909091 0 0 0 0-69.818182H186.926545l222.021819-221.928727a33.512727 33.512727 0 0 0-47.383273-47.383273L139.636364 837.073455V640a34.909091 34.909091 0 0 0-69.818182 0v273.128727c0 27.927273 15.546182 41.053091 41.053091 41.053091z m868.724363-41.053091V640a34.909091 34.909091 0 0 0-69.818181 0v197.073455L687.941818 615.051636a33.512727 33.512727 0 0 0-47.383273 47.383273L862.487273 884.363636H665.413818a34.909091 34.909091 0 0 0 0 69.818182h273.128727c25.6 0 41.053091-13.125818 41.053091-41.053091z"  ></path></symbol>
  </svg>
`),this.$element.addEventListener(`click`,this.onToolbarItemClick),this.update(n)}update(e){let t=Object.create(null,{update:{get:()=>super.update}});return pZ(this,void 0,void 0,function*(){t.update.call(this,e);let{className:n,position:r,style:i}=this.options;this.$element.className=`g6-toolbar ${n||``}`,Object.assign(this.$element.style,i,fZ(r)),this.$element.innerHTML=yield this.getDOMContent()})}destroy(){this.$element.removeEventListener(`click`,this.onToolbarItemClick),this.$element.remove(),super.destroy()}getDOMContent(){return pZ(this,void 0,void 0,function*(){return(yield this.options.getItems()).map(e=>`
          <div class="g6-toolbar-item" value="${e.value}" title="${e.title??``}">
            <svg aria-hidden="true" focusable="false">
              <use xlink:href="#${e.id}"></use>
            </svg>
          </div>`).join(``)})}};mZ.defaultOptions={position:`top-left`};var hZ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},gZ=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.currentTarget=null,this.tooltipElement=null,this.container=null,this.isEnable=(e,t)=>{let{enable:n}=this.options;return typeof n==`function`?n(e,t):n},this.onClick=e=>{let{target:{id:t}}=e;this.currentTarget===t?this.hide(e):this.show(e)},this.onPointerMove=e=>{let{target:t}=e;!this.currentTarget||t.id===this.currentTarget||this.show(e)},this.onPointerLeave=e=>{this.hide(e)},this.onCanvasMove=e=>{this.hide(e)},this.onPointerOver=e=>{this.show(e)},this.showById=e=>hZ(this,void 0,void 0,function*(){let t={target:{id:e}};yield this.show(t)}),this.getElementData=(e,t)=>{let{model:n}=this.context;switch(t){case`node`:return n.getNodeData([e]);case`edge`:return n.getEdgeData([e]);case`combo`:return n.getComboData([e]);default:return[]}},this.show=e=>hZ(this,void 0,void 0,function*(){var t,n;let{client:r,target:{id:i}}=e;if(rk(e.target))return;let a=this.context.graph.getElementType(i),{getContent:o,title:s}=this.options,c=this.getElementData(i,a);if(!this.tooltipElement||!this.isEnable(e,c))return;let l={};if(o){if(l.content=yield o(e,c),!l.content)return}else{let e=this.context.graph.getElementRenderStyle(i),t=a===`node`?e.fill:e.stroke;l={title:s||a,data:c.map(e=>({name:`ID`,value:e.id||`${e.source} -> ${e.target}`,color:t}))}}this.currentTarget=i;let u,d;if(r)u=r.x,d=r.y;else{let e=Ku(c,`0.style`,{x:0,y:0});u=e.x,d=e.y}(n=(t=this.options).onOpenChange)==null||n.call(t,!0),this.tooltipElement.update(Object.assign(Object.assign(Object.assign({},this.tooltipStyleProps),{x:u,y:d,style:{".tooltip":{visibility:`visible`}}}),l))}),this.hide=e=>{var t,n,r,i,a;if(!e){(n=(t=this.options).onOpenChange)==null||n.call(t,!1),(r=this.tooltipElement)==null||r.hide(),this.currentTarget=null;return}if(!this.tooltipElement||!this.currentTarget)return;let{client:{x:o,y:s}}=e;(a=(i=this.options).onOpenChange)==null||a.call(i,!1),this.tooltipElement.hide(o,s),this.currentTarget=null},this.initTooltip=()=>{var e;let t=new _X({className:`tooltip`,style:this.tooltipStyleProps});return(e=this.container)==null||e.appendChild(t.HTMLTooltipElement),t},this.render(),this.bindEvents()}getEvents(){return this.options.trigger===`click`?{"node:click":this.onClick,"edge:click":this.onClick,"combo:click":this.onClick,"canvas:click":this.onPointerLeave,contextmenu:this.onPointerLeave,drag:this.onPointerLeave}:{"node:pointerover":this.onPointerOver,"node:pointermove":this.onPointerMove,"canvas:pointermove":this.onCanvasMove,"edge:pointerover":this.onPointerOver,"edge:pointermove":this.onPointerMove,"combo:pointerover":this.onPointerOver,"combo:pointermove":this.onPointerMove,contextmenu:this.onPointerLeave,"node:drag":this.onPointerLeave}}update(e){var t;this.unbindEvents(),super.update(e),this.tooltipElement&&((t=this.container)==null||t.removeChild(this.tooltipElement.HTMLTooltipElement)),this.tooltipElement=this.initTooltip(),this.bindEvents()}render(){let{canvas:e}=this.context,t=e.getContainer();t&&(this.container=t,this.tooltipElement=this.initTooltip())}unbindEvents(){let{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.off(n,t[n])})}bindEvents(){let{graph:e}=this.context,t=this.getEvents();Object.keys(t).forEach(n=>{e.on(n,t[n])})}get tooltipStyleProps(){let{canvas:e}=this.context,{center:t}=e.getBounds(),{top:n,left:r}=e.getContainer().getBoundingClientRect(),{style:i,position:a,enterable:o,container:s={x:-r,y:-n},title:c,offset:l}=this.options,[u,d]=t,[f,p]=e.getSize();return{x:u,y:d,container:s,title:c,bounding:{x:0,y:0,width:f,height:p},position:a,enterable:o,offset:l,style:i}}destroy(){var e;this.unbindEvents(),this.tooltipElement&&((e=this.container)==null||e.removeChild(this.tooltipElement.HTMLTooltipElement)),super.destroy()}};gZ.defaultOptions={trigger:`hover`,position:`top-right`,enterable:!1,enable:!0,offset:[10,10],style:{".tooltip":{visibility:`hidden`}}};var _Z=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},vZ;function yZ(e,t){return vZ||=document.createElement(`canvas`),vZ.width=e,vZ.height=t,vZ.getContext(`2d`).clearRect(0,0,e,t),vZ}function bZ(e,t,n,r){return _Z(this,void 0,void 0,function*(){let i=yZ(e,t),a=i.getContext(`2d`),{rotate:o,opacity:s,textFill:c,textFontSize:l,textFontFamily:u,textFontVariant:d,textFontWeight:f,textAlign:p,textBaseline:m}=r;return a.textAlign=p,a.textBaseline=m,a.translate(e/2,t/2),a.font=`${l}px ${u} ${d} ${f}`,o&&a.rotate(o),s&&(a.globalAlpha=s),c&&(a.fillStyle=c,a.fillText(`${n}`,0,0)),i.toDataURL()})}function xZ(e,t,n,r){return _Z(this,void 0,void 0,function*(){let i=yZ(e,t),a=i.getContext(`2d`),{rotate:o,opacity:s}=r;o&&a.rotate(o),s&&(a.globalAlpha=s);let c=new Image;return c.crossOrigin=`anonymous`,c.src=n,new Promise(n=>{c.onload=function(){let r=e>c.width?(e-c.width)/2:0,o=t>c.height?(t-c.height)/2:0;a.drawImage(c,0,0,c.width,c.height,r,o,e-r*2,t-o*2),n(i.toDataURL())}})})}var SZ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},CZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},wZ=class e extends iH{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.$element=aH(`watermark`),this.context.canvas.getContainer().appendChild(this.$element),this.update(n)}update(e){let t=Object.create(null,{update:{get:()=>super.update}});return SZ(this,void 0,void 0,function*(){t.update.call(this,e);let n=this.options,{width:r,height:i,text:a,imageURL:o}=n,s=CZ(n,[`width`,`height`,`text`,`imageURL`]);Object.keys(s).forEach(t=>{t.startsWith(`background`)&&(this.$element.style[t]=e[t])});let c=o?yield xZ(r,i,o,s):yield bZ(r,i,a,s);this.$element.style.backgroundImage=`url(${c})`})}destroy(){super.destroy(),this.$element.remove()}};wZ.defaultOptions={width:200,height:100,opacity:.2,rotate:Math.PI/12,text:``,textFill:`#000`,textFontSize:16,textAlign:`center`,textBaseline:`middle`,backgroundRepeat:`repeat`};var TZ=[`#7E92B5`,`#F4664A`,`#FFBE3A`],EZ={type:`group`,color:[`#1783FF`,`#00C9C9`,`#F08F56`,`#D580FF`,`#7863FF`,`#DB9D0D`,`#60C42D`,`#FF80CA`,`#2491B3`,`#17C76F`]},DZ={type:`group`,color:[`#99ADD1`,`#1783FF`,`#00C9C9`,`#F08F56`,`#D580FF`,`#7863FF`,`#DB9D0D`,`#60C42D`,`#FF80CA`,`#2491B3`,`#17C76F`]};function OZ(e){let{bgColor:t,textColor:n,nodeColor:r,nodeColorDisabled:i,nodeStroke:a,nodeHaloStrokeOpacityActive:o=.15,nodeHaloStrokeOpacitySelected:s=.25,nodeOpacityDisabled:c=.06,nodeIconOpacityInactive:l=.85,nodeOpacityInactive:u=.25,nodeBadgePalette:d=TZ,nodePaletteOptions:f=EZ,edgeColor:p,edgeColorDisabled:m,edgePaletteOptions:h=DZ,comboColor:g,comboColorDisabled:_,comboStroke:v,comboStrokeDisabled:y,edgeColorInactive:b}=e;return{background:t,node:{palette:f,style:{donutOpacity:1,badgeBackgroundOpacity:1,badgeFill:`#fff`,badgeFontSize:8,badgePadding:[0,4],badgePalette:d,fill:r,fillOpacity:1,halo:!1,iconFill:`#fff`,iconOpacity:1,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelFill:n,labelFillOpacity:.85,labelLineHeight:16,labelPadding:[0,2],labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelOffsetY:2,lineWidth:0,portFill:r,portLineWidth:1,portStroke:a,portStrokeOpacity:.65,size:32,stroke:a,strokeOpacity:1,zIndex:2},state:{selected:{halo:!0,haloLineWidth:24,haloStrokeOpacity:s,labelFontSize:12,labelFontWeight:`bold`,lineWidth:4,stroke:a},active:{halo:!0,haloLineWidth:12,haloStrokeOpacity:o},highlight:{labelFontWeight:`bold`,lineWidth:4,stroke:a,strokeOpacity:.85},inactive:{badgeBackgroundOpacity:u,donutOpacity:u,fillOpacity:u,iconOpacity:l,labelFill:n,labelFillOpacity:u,strokeOpacity:u},disabled:{badgeBackgroundOpacity:.25,donutOpacity:c,fill:i,fillOpacity:c,iconFill:i,iconOpacity:.25,labelFill:n,labelFillOpacity:.25,strokeOpacity:c}},animation:{enter:`fade`,exit:`fade`,show:`fade`,hide:`fade`,expand:`node-expand`,collapse:`node-collapse`,update:[{fields:[`x`,`y`,`fill`,`stroke`]}],translate:[{fields:[`x`,`y`]}]}},edge:{palette:h,style:{badgeBackgroundFill:p,badgeFill:`#fff`,badgeFontSize:8,badgeOffsetX:10,fillOpacity:1,halo:!1,haloLineWidth:12,haloStrokeOpacity:1,increasedLineWidthForHitTesting:2,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[4,4,4,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,labelPlacement:`center`,labelTextBaseline:`middle`,lineWidth:1,stroke:p,strokeOpacity:1,zIndex:1},state:{selected:{halo:!0,haloStrokeOpacity:.25,labelFontSize:14,labelFontWeight:`bold`,lineWidth:3},active:{halo:!0,haloStrokeOpacity:.15},highlight:{labelFontWeight:`bold`,lineWidth:3},inactive:{stroke:b,fillOpacity:.08,labelOpacity:.25,strokeOpacity:.08,badgeBackgroundOpacity:.25},disabled:{stroke:m,fillOpacity:.45,strokeOpacity:.45,labelOpacity:.25,badgeBackgroundOpacity:.45}},animation:{enter:`fade`,exit:`fade`,expand:`path-in`,collapse:`path-out`,show:`fade`,hide:`fade`,update:[{fields:[`sourceNode`,`targetNode`]},{fields:[`stroke`],shape:`key`}],translate:[{fields:[`sourceNode`,`targetNode`]}]}},combo:{style:{collapsedMarkerFill:t,collapsedMarkerFontSize:12,collapsedMarkerFillOpacity:1,collapsedSize:32,collapsedFillOpacity:1,fill:g,halo:!1,haloLineWidth:12,haloStroke:v,haloStrokeOpacity:.25,labelBackground:!1,labelBackgroundFill:t,labelBackgroundLineWidth:0,labelBackgroundOpacity:.75,labelBackgroundPadding:[2,4,2,4],labelFill:n,labelFontSize:12,labelFontWeight:400,labelOpacity:1,lineDash:0,lineWidth:1,fillOpacity:.04,strokeOpacity:1,padding:10,stroke:v},state:{selected:{halo:!0,labelFontSize:14,labelFontWeight:700,lineWidth:4},active:{halo:!0},highlight:{labelFontWeight:700,lineWidth:4},inactive:{fillOpacity:.65,labelOpacity:.25,strokeOpacity:.65},disabled:{fill:_,fillOpacity:.25,labelOpacity:.25,stroke:y,strokeOpacity:.25}},animation:{enter:`fade`,exit:`fade`,show:`fade`,hide:`fade`,expand:`combo-expand`,collapse:`combo-collapse`,update:[{fields:[`x`,`y`]},{fields:[`fill`,`stroke`,`lineWidth`],shape:`key`}],translate:[{fields:[`x`,`y`]}]}}}}const kZ=OZ({bgColor:`#000000`,comboColor:`#fdfdfd`,comboColorDisabled:`#d0e4ff`,comboStroke:`#99add1`,comboStrokeDisabled:`#969696`,edgeColor:`#637088`,edgeColorDisabled:`#637088`,edgeColorInactive:`#D0E4FF`,edgePaletteOptions:{type:`group`,color:[`#637088`,`#0F55A6`,`#008383`,`#9C5D38`,`#8B53A6`,`#4E40A6`,`#8F6608`,`#3E801D`,`#A65383`,`#175E75`,`#0F8248`]},nodeColor:`#1783ff`,nodeColorDisabled:`#D0E4FF`,nodeHaloStrokeOpacityActive:.25,nodeHaloStrokeOpacitySelected:.45,nodeIconOpacityInactive:.45,nodeOpacityDisabled:.25,nodeOpacityInactive:.45,nodeStroke:`#d0e4ff`,textColor:`#ffffff`}),AZ=OZ({bgColor:`#ffffff`,comboColor:`#99ADD1`,comboColorDisabled:`#f0f0f0`,comboStroke:`#99add1`,comboStrokeDisabled:`#d9d9d9`,edgeColor:`#99add1`,edgeColorDisabled:`#d9d9d9`,edgeColorInactive:`#1B324F`,nodeColor:`#1783ff`,nodeColorDisabled:`#1B324F`,nodeHaloStrokeOpacityActive:.15,nodeHaloStrokeOpacitySelected:.25,nodeIconOpacityInactive:.85,nodeOpacityDisabled:.06,nodeOpacityInactive:.25,nodeStroke:`#000000`,textColor:`#000000`});var jZ=class extends IC{beforeDraw(e,t){return e}afterLayout(e,t){}},MZ=class extends jZ{beforeDraw(e){let{model:t}=this.context,n=e.add.combos,r=e=>{let n=[];return e.forEach((e,r)=>{let i=t.getAncestorsData(r,`combo`).map(e=>Q(e)).reverse();n.push([r,e,i.length])}),new Map(n.sort(([,,e],[,,t])=>t-e).map(([e,t])=>[e,t]))};return e.add.combos=r(n),e.update.combos=r(e.update.combos),e}};function NZ(e,t,n,r,i){let a=Q(r),o=`${n}s`,s=i?r:e.add[o].get(a)||e.update[o].get(a)||e.remove[o].get(a)||r;Object.entries(e).forEach(([e,n])=>{t===e?n[o].set(a,s):n[o].delete(a)})}function PZ(e,t){return Object.keys(e).every(n=>e[n]===t[n])}var FZ=class extends jZ{beforeDraw(e,t){if(t.stage===`visibility`||!this.context.model.model.hasTreeStructure(`combo`))return e;let{model:n}=this.context,{add:r,update:i}=e,a=[...e.update.combos.entries(),...e.add.combos.entries()];for(;a.length;){let[t,o]=a.pop();if(Uw(o)){let o=n.getDescendantsData(t),s=o.map(Q),{internal:c,external:l}=XD(s,e=>n.getRelatedEdgesData(e));o.forEach(t=>{let r=Q(t),i=a.findIndex(([e])=>e===r);i!==-1&&a.splice(i,1);let o=n.getElementType(r);NZ(e,`remove`,o,t)}),c.forEach(t=>NZ(e,`remove`,`edge`,t)),l.forEach(e=>{let t=Q(e);this.context.element?.getElement(t)?i.edges.set(t,e):r.edges.set(t,e)})}else{let r=n.getChildrenData(t),i=r.map(Q),{edges:o}=XD(i,e=>n.getRelatedEdgesData(e));[...r,...o].forEach(t=>{let r=Q(t),i=n.getElementType(r);this.context.element?.getElement(r)?NZ(e,`update`,i,t):NZ(e,`add`,i,t),i===`combo`&&a.push([r,t])})}}return e}},IZ=(e,t,n,r)=>{let i=`${n}s`,a=Q(r);!e.add[i].has(a)&&!e.update[i].has(a)&&e[t][i].set(Q(r),r)},LZ=class extends jZ{getElement(e){return this.context.element.getElement(e)}handleExpand(e,t){if(IZ(t,`add`,`node`,e),Uw(e))return;let n=Q(e);IZ(t,`add`,`node`,e),this.context.model.getRelatedEdgesData(n).forEach(e=>{NZ(t,`add`,`edge`,e)}),this.context.model.getChildrenData(n).forEach(e=>{this.handleExpand(e,t)})}beforeDraw(e){let{graph:t,model:n}=this.context;if(!n.model.hasTreeStructure(`tree`))return e;let{add:{nodes:r,edges:i},update:{nodes:a}}=e,o=new Map,s=new Map;r.forEach((e,t)=>{Uw(e)&&o.set(t,e)}),i.forEach(e=>{if(t.getElementType(e.source)!==`node`)return;let n=t.getNodeData(e.source);Uw(n)&&o.set(e.source,n)}),a.forEach((e,t)=>{let n=this.getElement(t);if(!n)return;let r=n.attributes.collapsed;Uw(e)?r||o.set(t,e):r&&s.set(t,e)});let c=new Set;return o.forEach((t,r)=>{n.getDescendantsData(r).forEach(t=>{let r=Q(t);c.has(r)||(NZ(e,`remove`,`node`,t),n.getRelatedEdgesData(r).forEach(t=>{NZ(e,`remove`,`edge`,t)}),c.add(r))})}),s.forEach((t,r)=>{if(n.getAncestorsData(r,`tree`).some(Uw)){NZ(e,`remove`,`node`,t);return}this.handleExpand(t,e)}),e}};function RZ(e,t,n){Xx[e][t]&&eS.warn(`The extension ${t} of ${e} has been registered before, and will be overridden.`),Object.assign(Xx[e],{[t]:n})}var zZ=function(){function e(t){H(this,e),this.dragndropPluginOptions=t}return U(e,[{key:`apply`,value:function(t){var n=this,r=t.renderingService,i=t.renderingContext.root.ownerDocument,a=i.defaultView,o=function(e){var t=e.target,r=t===i,o=r&&n.dragndropPluginOptions.isDocumentDraggable?i:t.closest&&t.closest(`[draggable=true]`);if(o){var s=!1,c=e.timeStamp,l=[e.clientX,e.clientY],u=null,d=[e.clientX,e.clientY],f=function(){var e=Bf(Rf().mark(function e(a){var f,p,m,h,g,_;return Rf().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}if(f=a.timeStamp-c,p=Nd([a.clientX,a.clientY],l),!(f<=n.dragndropPluginOptions.dragstartTimeThreshold||p<=n.dragndropPluginOptions.dragstartDistanceThreshold)){e.next=1;break}return e.abrupt(`return`);case 1:a.type=`dragstart`,o.dispatchEvent(a),s=!0;case 2:if(a.type=`drag`,a.dx=a.clientX-d[0],a.dy=a.clientY-d[1],o.dispatchEvent(a),d=[a.clientX,a.clientY],r){e.next=4;break}return m=n.dragndropPluginOptions.overlap===`pointer`?[a.canvasX,a.canvasY]:t.getBounds().center,e.next=3,i.elementsFromPoint(m[0],m[1]);case 3:h=e.sent,g=h[h.indexOf(t)+1],_=g?.closest(`[droppable=true]`)||(n.dragndropPluginOptions.isDocumentDroppable?i:null),u!==_&&(u&&(a.type=`dragleave`,a.target=u,u.dispatchEvent(a)),_&&(a.type=`dragenter`,a.target=_,_.dispatchEvent(a)),u=_,u&&(a.type=`dragover`,a.target=u,u.dispatchEvent(a)));case 4:case`end`:return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();a.addEventListener(`pointermove`,f);var p=function(e){if(s){e.detail={preventClick:!0};var t=e.clone();u&&(t.type=`drop`,t.target=u,u.dispatchEvent(t)),t.type=`dragend`,o.dispatchEvent(t),s=!1}a.removeEventListener(`pointermove`,f)};t.addEventListener(`pointerup`,p,{once:!0}),t.addEventListener(`pointerupoutside`,p,{once:!0})}};r.hooks.init.tap(e.tag,function(){a.addEventListener(`pointerdown`,o)}),r.hooks.destroy.tap(e.tag,function(){a.removeEventListener(`pointerdown`,o)})}}])}();zZ.tag=`Dragndrop`;var BZ=function(e){function t(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return H(this,t),e=Fs(this,t),e.name=`dragndrop`,e.options=n,e}return Ls(t,e),U(t,[{key:`init`,value:function(){this.addRenderingPlugin(new zZ(Cs({overlap:`pointer`,isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:`destroy`,value:function(){this.removeAllRenderingPlugins()}},{key:`setOptions`,value:function(e){Object.assign(this.plugins[0].dragndropPluginOptions,e)}}])}(qf),VZ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},HZ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},UZ=[`main`],WZ=[`background`,`main`,`label`,`transient`];function GZ(e){return e.main}var KZ=class{getConfig(){return this.config}getLayer(e=`main`){return this.extends.layers[e]||GZ(this.getLayers())}getLayers(){return this.extends.layers}getRenderer(e){return this.extends.renderers[e]}getCamera(e=`main`){return this.getLayer(e).getCamera()}getRoot(e=`main`){return this.getLayer(e).getRoot()}getContextService(e=`main`){return this.getLayer(e).getContextService()}setCursor(e){this.config.cursor=e,this.getLayer().setCursor(e)}get document(){return this.getLayer().document}get context(){return this.getLayer().context}constructor(e){this.config={enableMultiLayer:!0},Object.assign(this.config,e);let t=this.config,{renderer:n,background:r,cursor:i,enableMultiLayer:a}=t,o=HZ(t,[`renderer`,`background`,`cursor`,`enableMultiLayer`]),s=a?WZ:UZ,c=qZ(n,s),l=Object.fromEntries(s.map(e=>{let t=new ub(Object.assign(Object.assign({},o),{supportsMutipleCanvasesInOneContainer:a,renderer:c[e],background:a?e===`background`?r:void 0:r}));return[e,t]}));JZ(l),this.extends={config:this.config,renderer:n,renderers:c,layers:l}}get ready(){return Promise.all(Object.entries(this.getLayers()).map(([,e])=>e.ready))}resize(e,t){Object.assign(this.extends.config,{width:e,height:t}),Object.values(this.getLayers()).forEach(n=>{let r=n.getCamera(),i=r.getPosition(),a=r.getFocalPoint();n.resize(e,t),r.setPosition(i),r.setFocalPoint(a)})}getBounds(e){return jS(Object.values(this.getLayers()).map(t=>e?t.getRoot().childNodes.find(t=>t.classList.includes(e)):t.getRoot()).filter(e=>e?.childNodes.length>0).map(e=>e.getBounds()))}getContainer(){let e=this.extends.config.container;return typeof e==`string`?document.getElementById(e):e}getSize(){return[this.extends.config.width||0,this.extends.config.height||0]}appendChild(e,t){let n=e.style?.$layer||`main`;return this.getLayer(n).appendChild(e,t)}setRenderer(e){if(e===this.extends.renderer)return;let t=qZ(e,this.config.enableMultiLayer?WZ:UZ);this.extends.renderers=t,Object.entries(t).forEach(([e,t])=>this.getLayer(e).setRenderer(t)),JZ(this.getLayers())}getCanvasByViewport(e){return lw(this.getLayer().viewport2Canvas(uw(e)))}getViewportByCanvas(e){return lw(this.getLayer().canvas2Viewport(uw(e)))}getViewportByClient(e){return lw(this.getLayer().client2Viewport(uw(e)))}getClientByViewport(e){return lw(this.getLayer().viewport2Client(uw(e)))}getClientByCanvas(e){return this.getClientByViewport(this.getViewportByCanvas(e))}getCanvasByClient(e){let t=this.getLayer(),n=t.client2Viewport(uw(e));return lw(t.viewport2Canvas(n))}toDataURL(){return VZ(this,arguments,void 0,function*(e={}){let t=globalThis.devicePixelRatio||1,{mode:n=`viewport`}=e,r=HZ(e,[`mode`]),[i,a,o,s]=[0,0,0,0];if(n===`viewport`)[o,s]=this.getSize();else if(n===`overall`){let e=this.getBounds(),t=DS(e);[i,a]=e.min,[o,s]=t}let c=ef(`<div id="virtual-image"></div>`),l=new ub({width:o,height:s,renderer:new uD,devicePixelRatio:t,container:c,background:this.extends.config.background});yield l.ready,l.appendChild(this.getLayer(`background`).getRoot().cloneNode(!0)),l.appendChild(this.getRoot().cloneNode(!0));let u=this.getLayer(`label`).getRoot().cloneNode(!0),d=l.viewport2Canvas({x:0,y:0}),f=this.getCanvasByViewport([0,0]);u.translate([f[0]-d.x,f[1]-d.y]),u.scale(1/this.getCamera().getZoom()),l.appendChild(u),l.appendChild(this.getLayer(`transient`).getRoot().cloneNode(!0));let p=this.getCamera(),m=l.getCamera();if(n===`viewport`)m.setZoom(p.getZoom()),m.setPosition(p.getPosition()),m.setFocalPoint(p.getFocalPoint());else if(n===`overall`){let[e,t,n]=m.getPosition(),[r,o,s]=m.getFocalPoint();m.setPosition([e+i,t+a,n]),m.setFocalPoint([r+i,o+a,s])}let h=l.getContextService();return new Promise(e=>{l.addEventListener(tb.RERENDER,()=>VZ(this,void 0,void 0,function*(){yield new Promise(e=>setTimeout(e,300));let t=yield h.toDataURL(r);e(t)}))})})}destroy(){Object.values(this.getLayers()).forEach(e=>{e.getCamera().cancelLandmarkAnimation(),e.destroy()})}};function qZ(e,t){return Object.fromEntries(t.map(t=>{let n=e?.(t)||new uD;return n instanceof uD&&n.setConfig({enableDirtyRectangleRendering:!1}),t===`main`?n.registerPlugin(new BZ({isDocumentDraggable:!0,isDocumentDroppable:!0,dragstartDistanceThreshold:10,dragstartTimeThreshold:100})):n.unregisterPlugin(n.getPlugin(`dom-interaction`)),[t,n]}))}function JZ(e){Object.entries(e).forEach(([e,t])=>{let n=t.getContextService().getDomElement();n?.style&&(n.style.gridArea=`1 / 1 / 2 / 2`,n.style.outline=`none`,n.tabIndex=1,e!==`main`&&(n.style.pointerEvents=`none`)),n?.parentElement&&(n.parentElement.style.display=`grid`,n.parentElement.style.isolation=`isolate`)})}var YZ=e=>e?parseInt(e):0;function XZ(e){let t=getComputedStyle(e),n=e.clientWidth||YZ(t.width),r=e.clientHeight||YZ(t.height),i=YZ(t.paddingLeft)+YZ(t.paddingRight),a=YZ(t.paddingTop)+YZ(t.paddingBottom);return[n-i,r-a]}function ZZ(e){if(!e)return[0,0];let t=640,n=480,[r,i]=XZ(e);return t=r||t,n=i||n,[Math.max(G(t)?t:1,1),Math.max(G(n)?n:1,1)]}var QZ=class{constructor(e){this.type=e}},$Z=class extends QZ{constructor(e,t){super(e),this.data=t}},eQ=class extends QZ{constructor(e,t,n,r){super(e),this.animationType=t,this.animation=n,this.data=r}},tQ=class extends QZ{constructor(e,t,n){super(e),this.elementType=t,this.data=n}},nQ=class extends QZ{constructor(e,t){super(e),this.data=t}};function rQ(e,t){e.emit(t.type,t)}function iQ(e){if(!e)return null;if(e instanceof Yy)return{type:`canvas`,element:e};let t=e;for(;t;){if(AO(t))return{type:`node`,element:t};if(jO(t))return{type:`edge`,element:t};if(MO(t))return{type:`combo`,element:t};t=t.parentElement}return null}function aQ(e){return e?.style?.zIndex||0}var oQ=`cachedStyle`,sQ=e=>`__${e}__`;function cQ(e,t){let n=Array.isArray(t)?t:[t];Ku(e,oQ)||qu(e,oQ,{}),n.forEach(t=>{qu(Ku(e,oQ),sQ(t),e.attributes[t])})}function lQ(e,t){return Ku(e,[oQ,sQ(t)])}function uQ(e,t){return sQ(t)in(Ku(e,oQ)||{})}var dQ=class{constructor(e){this.tasks=[],this.animations=new Set,this.context=e}getTasks(){let e=[...this.tasks];return this.tasks=[],e}add(e,t){this.tasks.push([e,t])}animate(e,t,n){var r,i,a;(r=t?.before)==null||r.call(t);let o=this.getTasks().map(([t,r])=>{var i,a,o;let{element:s,elementType:c,stage:l}=t,u=sS(this.context.options,c,l,e);(i=r?.before)==null||i.call(r);let d=u.length?uS(s,this.inferStyle(t,n),u):null;return d?((a=r?.beforeAnimate)==null||a.call(r,d),d.finished.then(()=>{var e,t;(e=r?.afterAnimate)==null||e.call(r,d),(t=r?.after)==null||t.call(r),this.animations.delete(d)})):(o=r?.after)==null||o.call(r),d}).filter(Boolean);o.forEach(e=>this.animations.add(e));let s=nS(o);return s?((i=t?.beforeAnimate)==null||i.call(t,s),s.finished.then(()=>{var e,n;(e=t?.afterAnimate)==null||e.call(t,s),(n=t?.after)==null||n.call(t),this.release()})):(a=t?.after)==null||a.call(t),s}inferStyle(e,t){let{element:n,elementType:r,stage:i,originalStyle:a,updatedStyle:o={}}=e;e.modifiedStyle||=Object.assign(Object.assign({},a),o);let{modifiedStyle:s}=e,c={},l={};if(i===`enter`)Object.assign(c,{opacity:0});else if(i===`exit`)Object.assign(l,{opacity:0});else if(i===`show`)Object.assign(c,{opacity:0}),Object.assign(l,{opacity:lQ(n,`opacity`)??iS(`opacity`)});else if(i===`hide`)Object.assign(c,{opacity:lQ(n,`opacity`)??iS(`opacity`)}),Object.assign(l,{opacity:0});else if(i===`collapse`){let{collapse:e}=t||{},{target:i,descendants:o,position:c}=e;if(r===`node`){if(o.includes(n.id)){let[e,t,n]=c;Object.assign(l,{x:e,y:t,z:n})}}else if(r===`combo`){if(n.id===i||o.includes(n.id)){let[e,t]=c;Object.assign(l,{x:e,y:t,childrenNode:a.childrenNode})}}else r===`edge`&&Object.assign(l,{sourceNode:s.sourceNode,targetNode:s.targetNode})}else if(i===`expand`){let{expand:e}=t||{},{target:i,descendants:a,position:o}=e;if(r===`node`){if(n.id===i||a.includes(n.id)){let[e,t,n]=o;Object.assign(c,{x:e,y:t,z:n})}}else if(r===`combo`){if(n.id===i||a.includes(n.id)){let[e,t,n]=o;Object.assign(c,{x:e,y:t,z:n,childrenNode:s.childrenNode})}}else r===`edge`&&Object.assign(c,{sourceNode:s.sourceNode,targetNode:s.targetNode})}return[Object.keys(c).length>0?Object.assign({},a,c):a,Object.keys(l).length>0?Object.assign({},s,l):s]}stop(){this.animations.forEach(e=>e.cancel())}clear(){this.tasks=[]}release(){let{canvas:e}=this.context,t=e.document?.timeline?.animationsWithPromises;t&&(e.document.timeline.animationsWithPromises=t.filter(e=>e.playState!==`finished`))}destroy(){this.stop(),this.animations.clear(),this.tasks=[]}},fQ=class{constructor(e){this.batchCount=0,this.context=e}emit(e){let{graph:t}=this.context;t.emit(e.type,e)}startBatch(e=!0){this.batchCount++,this.batchCount===1&&this.emit(new $Z(Z.BATCH_START,{initiate:e}))}endBatch(){this.batchCount--,this.batchCount===0&&this.emit(new $Z(Z.BATCH_END))}get isBatching(){return this.batchCount>0}destroy(){this.context=null}},pQ=class extends FC{constructor(e){super(e),this.currentTarget=null,this.currentTargetType=null,this.category=`behavior`,this.forwardCanvasEvents=e=>{let{target:t}=e,n=iQ(t);if(!n)return;let{graph:r,canvas:i}=this.context,{type:a,element:o}=n;if(`destroyed`in o&&(rk(o)||o.destroyed))return;let{type:s,detail:c,button:l}=e,u=Object.assign(Object.assign({},e),{target:o,targetType:a,originalTarget:t});s===X.POINTER_MOVE&&(this.currentTarget!==o&&(this.currentTarget&&r.emit(`${this.currentTargetType}:${X.POINTER_LEAVE}`,Object.assign(Object.assign({},u),{type:X.POINTER_LEAVE,target:this.currentTarget,targetType:this.currentTargetType})),o&&(Object.assign(u,{type:X.POINTER_ENTER}),r.emit(`${a}:${X.POINTER_ENTER}`,u))),this.currentTarget=o,this.currentTargetType=a),s===X.CLICK&&l===2||(r.emit(`${a}:${s}`,u),r.emit(s,u)),s===X.CLICK&&c===2&&(Object.assign(u,{type:X.DBLCLICK}),r.emit(`${a}:${X.DBLCLICK}`,u),r.emit(X.DBLCLICK,u)),s===X.POINTER_DOWN&&l===2&&(Object.assign(u,{type:X.CONTEXT_MENU,preventDefault:()=>{var e;(e=i.getContainer())==null||e.addEventListener(X.CONTEXT_MENU,e=>e.preventDefault(),{once:!0})}}),r.emit(`${a}:${X.CONTEXT_MENU}`,u),r.emit(X.CONTEXT_MENU,u))},this.forwardContainerEvents=e=>{this.context.graph.emit(e.type,e)},this.forwardEvents(),this.setBehaviors(this.context.options.behaviors||[])}setBehaviors(e){this.setExtensions(e)}forwardEvents(){let e=this.context.canvas.getContainer();e&&[Ux.KEY_DOWN,Ux.KEY_UP].forEach(t=>{e.addEventListener(t,this.forwardContainerEvents)});let t=this.context.canvas.document;t&&[X.CLICK,X.DBLCLICK,X.POINTER_OVER,X.POINTER_LEAVE,X.POINTER_ENTER,X.POINTER_MOVE,X.POINTER_OUT,X.POINTER_DOWN,X.POINTER_UP,X.CONTEXT_MENU,X.DRAG_START,X.DRAG,X.DRAG_END,X.DRAG_ENTER,X.DRAG_OVER,X.DRAG_LEAVE,X.DROP,X.WHEEL].forEach(e=>{t.addEventListener(e,this.forwardCanvasEvents)})}destroy(){let e=this.context.canvas.getContainer();e&&[Ux.KEY_DOWN,Ux.KEY_UP].forEach(t=>{e.removeEventListener(t,this.forwardContainerEvents)}),this.context.canvas.document.removeAllEventListeners(),super.destroy()}},mQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function hQ(e,t){let{data:n,style:r}=e,i=mQ(e,[`data`,`style`]),{data:a,style:o}=t,s=mQ(t,[`data`,`style`]),c=Object.assign(Object.assign({},i),s);return(n||a)&&Object.assign(c,{data:Object.assign(Object.assign({},n),a)}),(r||o)&&Object.assign(c,{style:Object.assign(Object.assign({},r),o)}),c}function gQ(e){let{data:t,style:n}=e,r=mQ(e,[`data`,`style`]);return t&&(r.data=Object.assign({},t)),n&&(r.style=Object.assign({},n)),r}function _Q(e={},t={}){let{states:n=[],data:r={},style:i={},children:a=[]}=e,o=mQ(e,[`states`,`data`,`style`,`children`]),{states:s=[],data:c={},style:l={},children:u=[]}=t,d=mQ(t,[`states`,`data`,`style`,`children`]),f=(e,t)=>e.length===t.length?e.every((e,n)=>e===t[n]):!1,p=(e,t)=>{let n=Object.keys(e),r=Object.keys(t);return n.length===r.length?n.every(n=>e[n]===t[n]):!1};return!(!p(o,d)||!f(a,u)||!f(n,s)||!p(r,c)||!p(i,l))}var vQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function yQ(e){let{id:t=Q(e),style:n,data:r}=e,i=vQ(e,[`id`,`style`,`data`]),a=Object.assign(Object.assign({},e),{style:Object.assign({},n),data:Object.assign({},r)});return yS(e)?Object.assign({id:t,data:a},i):{id:t,data:a}}function bQ(e){return e.data}function xQ(e){if(e.hasTreeStructure(`tree`))return;e.attachTreeStructure(Jx);let t=e.getAllEdges();for(let n of t){let{source:t,target:r}=n;e.setParent(r,t,Jx)}}var SQ=class{constructor(){this.latestRemovedComboIds=new Set,this.comboIds=new Set,this.changes=[],this.batchCount=0,this.isTraceless=!1,this.enableUpdateNodeLikeHierarchy=!0,this.model=new bk}pushChange(e){if(this.isTraceless)return;let{type:t}=e;if(t===zx.NodeUpdated||t===zx.EdgeUpdated||t===zx.ComboUpdated){let{value:n,original:r}=e;this.changes.push({value:gQ(n),original:gQ(r),type:t})}else this.changes.push({value:gQ(e.value),type:t})}getChanges(){return this.changes}clearChanges(){this.changes=[]}batch(e){this.batchCount++,this.model.batch(e),this.batchCount--}isBatching(){return this.batchCount>0}silence(e){this.isTraceless=!0,e(),this.isTraceless=!1}isCombo(e){return this.comboIds.has(e)||this.latestRemovedComboIds.has(e)}getData(){return{nodes:this.getNodeData(),edges:this.getEdgeData(),combos:this.getComboData()}}getNodeData(e){return this.model.getAllNodes().reduce((t,n)=>{let r=bQ(n);return this.isCombo(Q(r))||(e===void 0||e.includes(Q(r)))&&t.push(r),t},[])}getEdgeDatum(e){return bQ(this.model.getEdge(e))}getEdgeData(e){return this.model.getAllEdges().reduce((t,n)=>{let r=bQ(n);return(e===void 0||e.includes(Q(r)))&&t.push(r),t},[])}getComboData(e){return this.model.getAllNodes().reduce((t,n)=>{let r=bQ(n);return this.isCombo(Q(r))&&(e===void 0||e.includes(Q(r)))&&t.push(r),t},[])}getRootsData(e=Jx){return this.model.getRoots(e).map(bQ)}getAncestorsData(e,t){let{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getAncestors(e,t).map(bQ)}getDescendantsData(e){let t=this.getElementDataById(e),n=[];return Iw(t,e=>{e!==t&&n.push(e)},e=>this.getChildrenData(Q(e)),`TB`),n}getParentData(e,t){let{model:n}=this;if(!t){eS.warn(`The hierarchy structure key is not specified`);return}if(!n.hasNode(e)||!n.hasTreeStructure(t))return;let r=n.getParent(e,t);return r?bQ(r):void 0}getChildrenData(e){let t=this.getElementType(e)===`node`?Jx:qx,{model:n}=this;return!n.hasNode(e)||!n.hasTreeStructure(t)?[]:n.getChildren(e,t).map(bQ)}getElementsDataByType(e){return e===`node`?this.getNodeData():e===`edge`?this.getEdgeData():e===`combo`?this.getComboData():[]}getElementDataById(e){return this.getElementType(e)===`edge`?this.getEdgeDatum(e):this.getNodeLikeDatum(e)}getNodeLikeDatum(e){let t=this.model.getNode(e);return bQ(t)}getNodeLikeData(e){return this.model.getAllNodes().reduce((t,n)=>{let r=bQ(n);return e?e.includes(Q(r))&&t.push(r):t.push(r),t},[])}getElementDataByState(e,t){return this.getElementsDataByType(e).filter(e=>e.states?.includes(t))}getElementState(e){return this.getElementDataById(e)?.states||[]}hasNode(e){return this.model.hasNode(e)&&!this.isCombo(e)}hasEdge(e){return this.model.hasEdge(e)}hasCombo(e){return this.model.hasNode(e)&&this.isCombo(e)}getRelatedEdgesData(e,t=`both`){return this.model.getRelatedEdges(e,t).map(bQ)}getNeighborNodesData(e){return this.model.getNeighbors(e).map(bQ)}setData(e){let{nodes:t=[],edges:n=[],combos:r=[]}=e,{nodes:i,edges:a,combos:o}=this.getData(),s=MC(i,t,e=>Q(e),_Q),c=MC(a,n,e=>Q(e),_Q),l=MC(o,r,e=>Q(e),_Q);this.batch(()=>{let e={nodes:s.enter,edges:c.enter,combos:l.enter};this.addData(e),this.computeZIndex(e,`add`,!0);let t={nodes:s.update,edges:c.update,combos:l.update};this.updateData(t),this.computeZIndex(t,`update`,!0);let n={nodes:s.exit.map(Q),edges:c.exit.map(Q),combos:l.exit.map(Q)};this.removeData(n)})}addData(e){let{nodes:t,edges:n,combos:r}=e;this.batch(()=>{this.addComboData(r),this.addNodeData(t),this.addEdgeData(n)}),this.computeZIndex(e,`add`)}addNodeData(e=[]){e.length&&(this.model.addNodes(e.map(e=>(this.pushChange({value:e,type:zx.NodeAdded}),yQ(e)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({nodes:e},`add`))}addEdgeData(e=[]){e.length&&(this.model.addEdges(e.map(e=>(this.pushChange({value:e,type:zx.EdgeAdded}),yQ(e)))),this.computeZIndex({edges:e},`add`))}addComboData(e=[]){if(!e.length)return;let{model:t}=this;t.hasTreeStructure(`combo`)||t.attachTreeStructure(qx),t.addNodes(e.map(e=>(this.comboIds.add(Q(e)),this.pushChange({value:e,type:zx.ComboAdded}),yQ(e)))),this.updateNodeLikeHierarchy(e),this.computeZIndex({combos:e},`add`)}addChildrenData(e,t){let n=this.getNodeLikeDatum(e),r=t.map(Q);this.addNodeData(t),this.updateNodeData([{id:e,children:[...n.children||[],...r]}]),this.addEdgeData(r.map(t=>({source:e,target:t})))}computeZIndex(e,t,n=!1){!n&&this.isBatching()||this.batch(()=>{let{nodes:n=[],edges:r=[],combos:i=[]}=e;i.forEach(e=>{let n=Q(e);if(t===`add`&&G(e.style?.zIndex)||t===`update`&&!(`combo`in e))return;let r=this.getParentData(n,qx),i=r?(r.style?.zIndex??0)+1:0;this.preventUpdateNodeLikeHierarchy(()=>{this.updateComboData([{id:n,style:{zIndex:i}}])})}),n.forEach(e=>{let n=Q(e);if(t===`add`&&G(e.style?.zIndex)||t===`update`&&!(`combo`in e)&&!(`children`in e))return;let r=0,i=this.getParentData(n,qx);if(i)r=(i.style?.zIndex||0)+1;else{let e=this.getParentData(n,Jx);e&&(r=e?.style?.zIndex||0)}this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:n,style:{zIndex:r}}])})}),r.forEach(e=>{if(G(e.style?.zIndex))return;let{id:t,source:n,target:r}=e;if(!t)t=Q(e);else{let e=this.getEdgeDatum(t);n=e.source,r=e.target}if(!n||!r)return;let i=this.getNodeLikeDatum(n)?.style?.zIndex||0,a=this.getNodeLikeDatum(r)?.style?.zIndex||0;this.updateEdgeData([{id:Q(e),style:{zIndex:Math.max(i,a)-1}}])})})}getFrontZIndex(e){let t=this.getElementType(e),n=this.getElementDataById(e),r=this.getData();if(Object.assign(r,{[`${t}s`]:r[`${t}s`].filter(t=>Q(t)!==e)}),t===`combo`&&!Uw(n)){let t=new Set(this.getAncestorsData(e,qx).map(Q));r.nodes=r.nodes.filter(e=>!t.has(Q(e))),r.combos=r.combos.filter(e=>!t.has(Q(e))),r.edges=r.edges.filter(({source:e,target:n})=>!t.has(e)&&!t.has(n))}return Math.max(n.style?.zIndex||0,0,...Object.values(r).flat().map(e=>(e?.style?.zIndex||0)+1))}updateNodeLikeHierarchy(e){if(!this.enableUpdateNodeLikeHierarchy)return;let{model:t}=this;e.forEach(e=>{let n=Q(e),r=SC(e);r!==void 0&&(t.hasTreeStructure(`combo`)||t.attachTreeStructure(qx),r===null&&this.refreshComboData(n),this.setParent(n,SC(e),qx));let i=e.children||[];if(i.length){t.hasTreeStructure(`tree`)||t.attachTreeStructure(Jx);let e=i.filter(e=>t.hasNode(e));e.forEach(e=>this.setParent(e,n,Jx)),e.length!==i.length&&this.updateNodeData([{id:n,children:e}])}})}preventUpdateNodeLikeHierarchy(e){this.enableUpdateNodeLikeHierarchy=!1,e(),this.enableUpdateNodeLikeHierarchy=!0}updateData(e){let{nodes:t,edges:n,combos:r}=e;this.batch(()=>{this.updateNodeData(t),this.updateComboData(r),this.updateEdgeData(n)}),this.computeZIndex(e,`update`)}updateNodeData(e=[]){if(!e.length)return;let{model:t}=this;this.batch(()=>{let n=[];e.forEach(e=>{let r=Q(e),i=bQ(t.getNode(r));if(_Q(i,e))return;let a=hQ(i,e);this.pushChange({value:a,original:i,type:zx.NodeUpdated}),t.mergeNodeData(r,a),n.push(a)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({nodes:e},`update`)}refreshData(){let{nodes:e,edges:t,combos:n}=this.getData();e.forEach(e=>{this.pushChange({value:e,original:e,type:zx.NodeUpdated})}),t.forEach(e=>{this.pushChange({value:e,original:e,type:zx.EdgeUpdated})}),n.forEach(e=>{this.pushChange({value:e,original:e,type:zx.ComboUpdated})})}syncNodeLikeDatum(e){let{model:t}=this,n=Q(e);if(!t.hasNode(n))return;let r=bQ(t.getNode(n)),i=hQ(r,e);t.mergeNodeData(n,i)}syncEdgeDatum(e){let{model:t}=this,n=Q(e);if(!t.hasEdge(n))return;let r=bQ(t.getEdge(n)),i=hQ(r,e);t.mergeEdgeData(n,i)}updateEdgeData(e=[]){if(!e.length)return;let{model:t}=this;this.batch(()=>{e.forEach(e=>{let n=Q(e),r=bQ(t.getEdge(n));if(_Q(r,e))return;e.source&&r.source!==e.source&&t.updateEdgeSource(n,e.source),e.target&&r.target!==e.target&&t.updateEdgeTarget(n,e.target);let i=hQ(r,e);this.pushChange({value:i,original:r,type:zx.EdgeUpdated}),t.mergeEdgeData(n,i)})}),this.computeZIndex({edges:e},`update`)}updateComboData(e=[]){if(!e.length)return;let{model:t}=this;t.batch(()=>{let n=[];e.forEach(e=>{let r=Q(e),i=bQ(t.getNode(r));if(_Q(i,e))return;let a=hQ(i,e);this.pushChange({value:a,original:i,type:zx.ComboUpdated}),t.mergeNodeData(r,a),n.push(a)}),this.updateNodeLikeHierarchy(n)}),this.computeZIndex({combos:e},`update`)}setParent(e,t,n,r=!0){if(e===t)return;let i=this.getNodeLikeDatum(e),a=SC(i);if(a!==t&&n===`combo`){let n={id:e,combo:t};this.isCombo(e),this.syncNodeLikeDatum(n)}this.model.setParent(e,t,n),r&&n===`combo`&&iu([a,t]).forEach(e=>{e!==void 0&&this.refreshComboData(e)})}refreshComboData(e){let t=this.getComboData([e])[0],n=this.getAncestorsData(e,qx);t&&this.pushChange({value:t,original:t,type:zx.ComboUpdated}),n.forEach(e=>{this.pushChange({value:e,original:e,type:zx.ComboUpdated})})}getElementPosition(e){let t=this.getElementDataById(e);return aw(t)}translateNodeLikeBy(e,t){this.isCombo(e)?this.translateComboBy(e,t):this.translateNodeBy(e,t)}translateNodeLikeTo(e,t){this.isCombo(e)?this.translateComboTo(e,t):this.translateNodeTo(e,t)}translateNodeBy(e,t){let n=this.getElementPosition(e),r=BC(n,[...t,0].slice(0,3));this.translateNodeTo(e,r)}translateNodeTo(e,t){let[n=0,r=0,i=0]=t;this.preventUpdateNodeLikeHierarchy(()=>{this.updateNodeData([{id:e,style:{x:n,y:r,z:i}}])})}translateComboBy(e,t){let[n=0,r=0,i=0]=t;if([n,r,i].some(isNaN)||[n,r,i].every(e=>e===0))return;let a=this.getComboData([e])[0];if(!a)return;let o=new Set;Iw(a,e=>{let t=Q(e);if(o.has(t))return;o.add(t);let[a,s,c]=aw(e),l=hQ(e,{style:{x:a+n,y:s+r,z:c+i}});this.pushChange({value:l,original:e,type:this.isCombo(t)?zx.ComboUpdated:zx.NodeUpdated}),this.model.mergeNodeData(t,l)},e=>this.getChildrenData(Q(e)),`BT`)}translateComboTo(e,t){if(t.some(isNaN))return;let[n=0,r=0,i=0]=t,a=this.getComboData([e])?.[0];if(!a)return;let[o,s,c]=aw(a),l=n-o,u=r-s,d=i-c;Iw(a,e=>{let t=Q(e),[n,r,i]=aw(e),a=hQ(e,{style:{x:n+l,y:r+u,z:i+d}});this.pushChange({value:a,original:e,type:this.isCombo(t)?zx.ComboUpdated:zx.NodeUpdated}),this.model.mergeNodeData(t,a)},e=>this.getChildrenData(Q(e)),`BT`)}removeData(e){let{nodes:t,edges:n,combos:r}=e;this.batch(()=>{this.removeEdgeData(n),this.removeNodeData(t),this.removeComboData(r),this.latestRemovedComboIds=new Set(r)})}removeNodeData(e=[]){e.length&&this.batch(()=>{e.forEach(e=>{this.removeEdgeData(this.getRelatedEdgesData(e).map(Q)),this.pushChange({value:this.getNodeData([e])[0],type:zx.NodeRemoved}),this.removeNodeLikeHierarchy(e)}),this.model.removeNodes(e)})}removeEdgeData(e=[]){e.length&&(e.forEach(e=>this.pushChange({value:this.getEdgeData([e])[0],type:zx.EdgeRemoved})),this.model.removeEdges(e))}removeComboData(e=[]){e.length&&this.batch(()=>{e.forEach(e=>{this.pushChange({value:this.getComboData([e])[0],type:zx.ComboRemoved}),this.removeNodeLikeHierarchy(e),this.comboIds.delete(e)}),this.model.removeNodes(e)})}removeNodeLikeHierarchy(e){if(this.model.hasTreeStructure(`combo`)){let t=SC(this.getNodeLikeDatum(e));this.setParent(e,void 0,qx,!1),this.model.getChildren(e,qx).forEach(e=>{let n=bQ(e),r=Q(n);this.setParent(Q(n),t,qx,!1);let i=hQ(n,{id:Q(n),combo:t});this.pushChange({value:i,original:n,type:this.isCombo(r)?zx.ComboUpdated:zx.NodeUpdated}),this.model.mergeNodeData(Q(n),i)}),Wl(t)||this.refreshComboData(t)}}getElementType(e){if(this.model.hasNode(e))return this.isCombo(e)?`combo`:`node`;if(this.model.hasEdge(e))return`edge`;throw Error($x(`Unknown element type of id: ${e}`))}destroy(){let{model:e}=this,t=e.getAllNodes(),n=e.getAllEdges();e.removeEdges(n.map(e=>e.id)),e.removeNodes(t.map(e=>e.id)),this.context={}}},CQ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},wQ=class{constructor(e){this.elementMap={},this.shapeTypeMap={},this.paletteStyle={},this.defaultStyle={},this.stateStyle={},this.visibilityCache=new WeakMap,this.context=e}init(){this.initContainer()}initContainer(){if(!this.container||this.container.destroyed){let{canvas:e}=this.context;this.container=e.appendChild(new Ny({className:`elements`}))}}emit(e,t){t.silence||rQ(this.context.graph,e)}forEachElementData(e){Fw.forEach(t=>{let n=this.context.model.getElementsDataByType(t);e(t,n)})}getElementType(e,t){let{options:n,graph:r}=this.context,i=n[e]?.type||t.type;return i?typeof i==`string`?i:i.call(r,t):e===`edge`?`line`:`circle`}getTheme(e){return tS(this.context.options)[e]||{}}getThemeStyle(e){return this.getTheme(e).style||{}}getThemeStateStyle(e,t){let{state:n={}}=this.getTheme(e);return Object.assign({},...t.map(e=>n[e]||{}))}computePaletteStyle(){let{options:e}=this.context;this.paletteStyle={},this.forEachElementData((t,n)=>{let r=Object.assign({},nT(this.getTheme(t)?.palette),nT(e[t]?.palette));r?.field&&Object.assign(this.paletteStyle,rT(n,r))})}getPaletteStyle(e,t){let n=this.paletteStyle[t];return n?e===`edge`?{stroke:n}:{fill:n}:{}}computeElementDefaultStyle(e,t){let{options:n}=this.context,r=n[e]?.style||{};`transform`in r&&Array.isArray(r.transform)&&(r.transform=[...r.transform]),this.defaultStyle[Q(t.datum)]=Qw(r,t)}computeElementsDefaultStyle(e){let{graph:t}=this.context;this.forEachElementData((n,r)=>{let i=r.length;for(let a=0;a<i;a++){let i=r[a];(e===void 0||e.includes(Q(i)))&&this.computeElementDefaultStyle(n,{datum:i,graph:t})}})}getDefaultStyle(e){return this.defaultStyle[e]||{}}getElementState(e){try{let{model:t}=this.context;return t.getElementState(e)}catch{return[]}}getElementStateStyle(e,t,n){let{options:r}=this.context,i=r[e]?.state?.[t]||{};return Qw(i,n)}computeElementStatesStyle(e,t,n){this.stateStyle[Q(n.datum)]=Object.assign({},...t.map(t=>this.getElementStateStyle(e,t,n)))}computeElementsStatesStyle(e){let{graph:t}=this.context;this.forEachElementData((n,r)=>{let i=r.length;for(let a=0;a<i;a++){let i=r[a];if(e===void 0||e.includes(Q(i))){let e=this.getElementState(Q(i));this.computeElementStatesStyle(n,e,{datum:i,graph:t})}}})}getStateStyle(e){return this.stateStyle[e]||{}}computeStyle(e,t){e&&[`translate`,`zIndex`].includes(e)||(this.computePaletteStyle(),this.computeElementsDefaultStyle(t),this.computeElementsStatesStyle(t))}getElement(e){return this.elementMap[e]}getNodes(){return this.context.model.getNodeData().map(({id:e})=>this.elementMap[e])}getEdges(){return this.context.model.getEdgeData().map(e=>this.elementMap[Q(e)])}getCombos(){return this.context.model.getComboData().map(({id:e})=>this.elementMap[e])}getElementComputedStyle(e,t){let n=Q(t),r=this.getThemeStyle(e),i=this.getPaletteStyle(e,n),a=t.style||{},o=this.getDefaultStyle(n),s=this.getThemeStateStyle(e,this.getElementState(n)),c=this.getStateStyle(n),l=Object.assign({},r,i,a,o,s,c);if(e===`combo`){let e=this.context.model.getChildrenData(n),t=l.collapsed?[]:e.map(Q).filter(e=>this.getElement(e));Object.assign(l,{childrenNode:t,childrenData:e})}return l}getDrawData(e){this.init();let t=this.computeChangesAndDrawData(e);if(!t)return null;let{type:n=`draw`,stage:r=n}=e;return this.markDestroyElement(t.drawData),this.computeStyle(r),{type:n,stage:r,data:t}}draw(e={animation:!0}){let t=this.getDrawData(e);if(!t)return;let{data:{drawData:{add:n,update:r,remove:i}}}=t;return this.destroyElements(i,e),this.createElements(n,e),this.updateElements(r,e),this.setAnimationTask(e,t)}preLayoutDraw(){return CQ(this,arguments,void 0,function*(e={animation:!0}){var t;let n=this.getDrawData(e);if(!n)return;let{data:{drawData:r}}=n;yield((t=this.context.layout)?.preLayout)?.call(t,r);let{add:i,update:a,remove:o}=r;return this.destroyElements(o,e),this.createElements(i,e),this.updateElements(a,e),this.setAnimationTask(e,n)})}setAnimationTask(e,t){let{animation:n,silence:r}=e,{data:{dataChanges:i,drawData:a},stage:o,type:s}=t;return this.context.animation.animate(n,r?{}:{before:()=>this.emit(new $Z(Z.BEFORE_DRAW,{dataChanges:i,animation:n,stage:o,render:s===`render`}),e),beforeAnimate:t=>this.emit(new eQ(Z.BEFORE_ANIMATE,Bx.DRAW,t,a),e),afterAnimate:t=>this.emit(new eQ(Z.AFTER_ANIMATE,Bx.DRAW,t,a),e),after:()=>this.emit(new $Z(Z.AFTER_DRAW,{dataChanges:i,animation:n,stage:o,render:s===`render`,firstRender:this.context.graph.rendered===!1}),e)})}computeChangesAndDrawData(e){let{model:t}=this.context,n=t.getChanges(),r=IU(n);if(r.length===0)return null;let{NodeAdded:i=[],NodeUpdated:a=[],NodeRemoved:o=[],EdgeAdded:s=[],EdgeUpdated:c=[],EdgeRemoved:l=[],ComboAdded:u=[],ComboUpdated:d=[],ComboRemoved:f=[]}=su(r,e=>e.type),p=e=>new Map(e.map(e=>{let t=e.value;return[Q(t),t]})),m={add:{nodes:p(i),edges:p(s),combos:p(u)},update:{nodes:p(a),edges:p(c),combos:p(d)},remove:{nodes:p(o),edges:p(l),combos:p(f)}},h=this.transformData(m,e);return t.clearChanges(),{dataChanges:n,drawData:h}}transformData(e,t){let n=this.context.transform.getTransformInstance();return Object.values(n).reduce((e,n)=>n.beforeDraw(e,t),e)}createElement(e,t,n){var r;let i=Q(t);if(this.getElement(i))return;let a=this.getElementType(e,t),o=this.getElementComputedStyle(e,t),s=Zx(e,a);if(!s)return eS.warn(`The element ${a} of ${e} is not registered.`);this.emit(new tQ(Z.BEFORE_ELEMENT_CREATE,e,t),n);let c=this.container.appendChild(new s({id:i,context:this.context,style:o}));this.shapeTypeMap[i]=a,this.elementMap[i]=c;let{stage:l=`enter`}=n;(r=this.context.animation)==null||r.add({element:c,elementType:e,stage:l,originalStyle:Object.assign({},c.attributes),updatedStyle:o},{after:()=>{var r;this.emit(new tQ(Z.AFTER_ELEMENT_CREATE,e,t),n),(r=c.onCreate)==null||r.call(c)}})}createElements(e,t){let{nodes:n,edges:r,combos:i}=e;[[`node`,n],[`combo`,i],[`edge`,r]].forEach(([e,n])=>{n.forEach(n=>this.createElement(e,n,t))})}getUpdateStageStyle(e,t,n){let{stage:r=`update`}=n;if(r===`translate`)if(e===`node`||e===`combo`){let{style:{x:e=0,y:n=0,z:r=0}={}}=t;return{x:e,y:n,z:r}}else return{};return this.getElementComputedStyle(e,t)}updateElement(e,t,n){var r;let i=Q(t),{stage:a=`update`}=n,o=this.getElement(i);if(!o)return()=>null;this.emit(new tQ(Z.BEFORE_ELEMENT_UPDATE,e,t),n);let s=this.getElementType(e,t),c=this.getUpdateStageStyle(e,t,n);this.shapeTypeMap[i]!==s&&(o.destroy(),delete this.shapeTypeMap[i],delete this.elementMap[i],this.createElement(e,t,{animation:!1,silence:!0}));let l=a===`visibility`?c.visibility===`hidden`?`hide`:`show`:a;l===`hide`&&delete c.visibility,(r=this.context.animation)==null||r.add({element:o,elementType:e,stage:l,originalStyle:Object.assign({},o.attributes),updatedStyle:c},{before:()=>{let e=this.elementMap[i];a!==`collapse`&&ek(e,c),a===`visibility`&&(uQ(e,`opacity`)||cQ(e,`opacity`),this.visibilityCache.set(e,l===`show`?`visible`:`hidden`),l===`show`&&NC(e,`visible`))},after:()=>{var r;let o=this.elementMap[i];a===`collapse`&&ek(o,c),l===`hide`&&NC(o,this.visibilityCache.get(o)),this.emit(new tQ(Z.AFTER_ELEMENT_UPDATE,e,t),n),(r=o.onUpdate)==null||r.call(o)}})}updateElements(e,t){let{nodes:n,edges:r,combos:i}=e;[[`node`,n],[`combo`,i],[`edge`,r]].forEach(([e,n])=>{n.forEach(n=>this.updateElement(e,n,t))})}markDestroyElement(e){Object.values(e.remove).forEach(e=>{e.forEach(e=>{let t=Q(e),n=this.getElement(t);n&&nk(n)})})}destroyElement(e,t,n){var r;let{stage:i=`exit`}=n,a=Q(t),o=this.elementMap[a];if(!o)return()=>null;this.emit(new tQ(Z.BEFORE_ELEMENT_DESTROY,e,t),n),(r=this.context.animation)==null||r.add({element:o,elementType:e,stage:i,originalStyle:Object.assign({},o.attributes),updatedStyle:{}},{after:()=>{var r;this.clearElement(a),o.destroy(),(r=o.onDestroy)==null||r.call(o),this.emit(new tQ(Z.AFTER_ELEMENT_DESTROY,e,t),n)}})}destroyElements(e,t){let{nodes:n,edges:r,combos:i}=e;[[`combo`,i],[`edge`,r],[`node`,n]].forEach(([e,n])=>{n.forEach(n=>this.destroyElement(e,n,t))})}clearElement(e){delete this.paletteStyle[e],delete this.defaultStyle[e],delete this.stateStyle[e],delete this.elementMap[e],delete this.shapeTypeMap[e]}alignLayoutResultToElement(e,t){var n;let r=e.nodes?.find(e=>Q(e)===t);if(r){let i=aw(this.context.model.getNodeLikeDatum(t)),a=aw(r),o=VC(i,a);(n=e.nodes)==null||n.forEach(e=>{e.style?.x&&(e.style.x+=o[0]),e.style?.y&&(e.style.y+=o[1]),e.style?.z&&(e.style.z+=o[2]||0)})}}collapseNode(e,t){return CQ(this,void 0,void 0,function*(){let{animation:n}=t,{model:r}=this.context,i=this.computeChangesAndDrawData({stage:`collapse`,animation:n});if(!i)return;let{drawData:a}=i,{add:o,remove:s,update:c}=a;this.markDestroyElement(a);let l={animation:n,stage:`collapse`,data:a};this.destroyElements(s,l),this.createElements(o,l),this.updateElements(c,l),yield this.context.animation.animate(n,{beforeAnimate:e=>this.emit(new eQ(Z.BEFORE_ANIMATE,Bx.COLLAPSE,e,a),l),afterAnimate:e=>this.emit(new eQ(Z.AFTER_ANIMATE,Bx.COLLAPSE,e,a),l)},{collapse:{target:e,descendants:Array.from(s.nodes).map(([,e])=>Q(e)),position:aw(c.nodes.get(e))}})?.finished})}expandNode(e,t){return CQ(this,void 0,void 0,function*(){let{model:n,layout:r}=this.context,{animation:i,align:a}=t,o=aw(n.getNodeData([e])[0]),s=this.computeChangesAndDrawData({stage:`expand`,animation:i});if(this.createElements(s.drawData.add,{animation:!1,stage:`expand`,target:e}),this.context.animation.clear(),this.computeStyle(`expand`),!s)return;let{drawData:c}=s,{update:l,add:u}=c,d={animation:i,stage:`expand`,data:c};u.edges.forEach(e=>l.edges.set(Q(e),e)),u.nodes.forEach(e=>l.nodes.set(Q(e),e)),this.updateElements(l,d),yield this.context.animation.animate(i,{beforeAnimate:e=>this.emit(new eQ(Z.BEFORE_ANIMATE,Bx.EXPAND,e,c),d),afterAnimate:e=>this.emit(new eQ(Z.AFTER_ANIMATE,Bx.EXPAND,e,c),d)},{expand:{target:e,descendants:Array.from(u.nodes).map(([,e])=>Q(e)),position:o}})?.finished})}collapseCombo(e,t){return CQ(this,void 0,void 0,function*(){let{model:n,element:r}=this.context;if(n.getAncestorsData(e,`combo`).some(e=>Uw(e)))return;let i=r.getElement(e),a=i.getComboPosition(Object.assign(Object.assign({},i.attributes),{collapsed:!0})),o=this.computeChangesAndDrawData({stage:`collapse`,animation:t});if(!o)return;let{dataChanges:s,drawData:c}=o;this.markDestroyElement(c);let{update:l,remove:u}=c,d={animation:t,stage:`collapse`,data:c};this.destroyElements(u,d),this.updateElements(l,d);let f=e=>Array.from(e).map(([,e])=>Q(e));yield this.context.animation.animate(t,{before:()=>this.emit(new $Z(Z.BEFORE_DRAW,{dataChanges:s,animation:t}),d),beforeAnimate:e=>this.emit(new eQ(Z.BEFORE_ANIMATE,Bx.COLLAPSE,e,c),d),afterAnimate:e=>this.emit(new eQ(Z.AFTER_ANIMATE,Bx.COLLAPSE,e,c),d),after:()=>this.emit(new $Z(Z.AFTER_DRAW,{dataChanges:s,animation:t}),d)},{collapse:{target:e,descendants:[...f(u.nodes),...f(u.combos)],position:a}})?.finished})}expandCombo(e,t){return CQ(this,void 0,void 0,function*(){let{model:n}=this.context,r=aw(n.getComboData([e])[0]);this.computeStyle(`expand`);let i=this.computeChangesAndDrawData({stage:`expand`,animation:t});if(!i)return;let{dataChanges:a,drawData:o}=i,{add:s,update:c}=o,l={animation:t,stage:`expand`,data:o,target:e};this.createElements(s,l),this.updateElements(c,l);let u=e=>Array.from(e).map(([,e])=>Q(e));yield this.context.animation.animate(t,{before:()=>this.emit(new $Z(Z.BEFORE_DRAW,{dataChanges:a,animation:t}),l),beforeAnimate:e=>this.emit(new eQ(Z.BEFORE_ANIMATE,Bx.EXPAND,e,o),l),afterAnimate:e=>this.emit(new eQ(Z.AFTER_ANIMATE,Bx.EXPAND,e,o),l),after:()=>this.emit(new $Z(Z.AFTER_DRAW,{dataChanges:a,animation:t}),l)},{expand:{target:e,descendants:[...u(s.nodes),...u(s.combos)],position:r}})?.finished})}clear(){this.container.destroy(),this.initContainer(),this.elementMap={},this.shapeTypeMap={},this.defaultStyle={},this.stateStyle={},this.paletteStyle={}}destroy(){this.clear(),this.container.destroy(),this.context={}}},TQ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},EQ=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},DQ=class{get presetOptions(){return{animation:!!aS(this.context.options,!0)}}get options(){let{options:e}=this.context;return e.layout}constructor(e){this.instances=[],this.context=e}getLayoutInstance(){return this.instances}preLayout(e){return TQ(this,void 0,void 0,function*(){var t,n,r;let{graph:i,model:a}=this.context,{add:o}=e;rQ(i,new $Z(Z.BEFORE_LAYOUT,{type:`pre`}));let s=yield this.context.layout?.simulate();(t=s?.nodes)==null||t.forEach(e=>{let t=Q(e),n=o.nodes.get(t);a.syncNodeLikeDatum(e),n&&Object.assign(n.style,e.style)}),(n=s?.edges)==null||n.forEach(e=>{let t=Q(e),n=o.edges.get(t);a.syncEdgeDatum(e),n&&Object.assign(n.style,e.style)}),(r=s?.combos)==null||r.forEach(e=>{let t=Q(e),n=o.combos.get(t);a.syncNodeLikeDatum(e),n&&Object.assign(n.style,e.style)}),rQ(i,new $Z(Z.AFTER_LAYOUT,{type:`pre`})),this.transformDataAfterLayout(`pre`,e)})}postLayout(){return TQ(this,arguments,void 0,function*(e=this.options){if(!e)return;let t=Array.isArray(e)?e:[e],{graph:n}=this.context;rQ(n,new $Z(Z.BEFORE_LAYOUT,{type:`post`}));for(let e=0;e<t.length;e++){let r=t[e],i=this.getLayoutData(r),a=Object.assign(Object.assign({},this.presetOptions),r);rQ(n,new $Z(Z.BEFORE_STAGE_LAYOUT,{options:a,index:e}));let o=yield this.stepLayout(i,a,e);rQ(n,new $Z(Z.AFTER_STAGE_LAYOUT,{options:a,index:e})),r.animation||this.updateElementPosition(o,!1)}rQ(n,new $Z(Z.AFTER_LAYOUT,{type:`post`})),this.transformDataAfterLayout(`post`)})}transformDataAfterLayout(e,t){let n=this.context.transform.getTransformInstance();Object.values(n).forEach(n=>n.afterLayout(e,t))}simulate(){return TQ(this,void 0,void 0,function*(){if(!this.options)return{};let e=Array.isArray(this.options)?this.options:[this.options],t={};for(let n=0;n<e.length;n++){let r=e[n],i=this.getLayoutData(r);t=yield this.stepLayout(i,Object.assign(Object.assign(Object.assign({},this.presetOptions),r),{animation:!1}),n)}return t})}stepLayout(e,t,n){return TQ(this,void 0,void 0,function*(){return wk(t)?yield this.treeLayout(e,t,n):yield this.graphLayout(e,t,n)})}graphLayout(e,t,n){return TQ(this,void 0,void 0,function*(){let{animation:r,enableWorker:i,iterations:a=300}=t,o=this.initGraphLayout(t);if(!o)return{};if(this.instances[n]=o,this.instance=o,i){let t=o;return this.supervisor=new UV(t.graphData2LayoutModel(e),t.instance,{iterations:a}),Ek(yield this.supervisor.execute())}if(hP(o))return r?yield o.execute(e,{onTick:e=>{this.updateElementPosition(e,!1)}}):(o.execute(e),o.stop(),o.tick(a));let s=yield o.execute(e);return r&&(yield this.updateElementPosition(s,r)?.finished),s})}treeLayout(e,t,n){return TQ(this,void 0,void 0,function*(){let{type:n,animation:r}=t,i=Zx(`layout`,n);if(!i)return{};let{nodes:a=[],edges:o=[]}=e,s=new bk({nodes:a.map(e=>({id:Q(e),data:e.data||{}})),edges:o.map(e=>({id:Q(e),source:e.source,target:e.target,data:e.data||{}}))});xQ(s);let c={nodes:[],edges:[]},l={nodes:[],edges:[]};s.getRoots(Jx).forEach(e=>{Iw(e,e=>{e.children=s.getSuccessors(e.id)},e=>s.getSuccessors(e.id),`TB`);let n=i(e,t),{x:r,y:a,z:o=0}=n;Iw(n,e=>{let{id:t,x:n,y:i,z:s=0}=e;c.nodes.push({id:t,style:{x:r,y:a,z:o}}),l.nodes.push({id:t,style:{x:n,y:i,z:s}})},e=>e.children,`TB`)});let u=this.inferTreeLayoutOffset(l);return OQ(l,u),r&&(OQ(c,u),this.updateElementPosition(c,!1),yield this.updateElementPosition(l,r)?.finished),l})}inferTreeLayoutOffset(e){var t;let[n,r]=[1/0,-1/0],[i,a]=[1/0,-1/0];(t=e.nodes)==null||t.forEach(e=>{let{x:t=0,y:o=0}=e.style||{};n=Math.min(n,t),r=Math.max(r,t),i=Math.min(i,o),a=Math.max(a,o)});let{canvas:o}=this.context,s=o.getSize(),[c,l]=o.getCanvasByViewport([0,0]),[u,d]=o.getCanvasByViewport(s);if(n>=c&&r<=u&&i>=l&&a<=d)return[0,0];let f=(c+u)/2,p=(l+d)/2;return[f-(n+r)/2,p-(i+a)/2]}stopLayout(){this.instance&&hP(this.instance)&&(this.instance.stop(),this.instance=void 0),this.supervisor&&=(this.supervisor.stop(),void 0),this.animationResult&&=(this.animationResult.finish(),void 0)}getLayoutData(e){let{nodeFilter:t=()=>!0,preLayout:n=!1,isLayoutInvisibleNodes:r=!1}=e,{nodes:i,edges:a,combos:o}=this.context.model.getData(),{element:s,model:c}=this.context,l=e=>s.getElement(e),u=n?e=>!r&&(e.style?.visibility===`hidden`||c.getAncestorsData(e.id,`tree`).some(Uw)||c.getAncestorsData(e.id,`combo`).some(Uw))?!1:t(e):e=>{let n=Q(e),r=l(n);return!r||rk(r)?!1:t(e)},d=i.filter(u),f=new Map(d.map(e=>[Q(e),e]));o.forEach(e=>f.set(Q(e),e));let p=a.filter(({source:e,target:t})=>f.has(e)&&f.has(t));return{nodes:d,edges:p,combos:o}}initGraphLayout(e){let{element:t,viewport:n}=this.context,{type:r,enableWorker:i,animation:a,iterations:o}=e,s=EQ(e,[`type`,`enableWorker`,`animation`,`iterations`]),[c,l]=n.getCanvasSize(),u=[c/2,l/2],d=e?.nodeSize??(e=>{let n=t?.getElement(e.id);return n?n.attributes.size:t?.getElementComputedStyle(`node`,e).size}),f=Zx(`layout`,r);if(!f)return eS.warn(`The layout of ${r} is not registered.`);let p=new(Object.getPrototypeOf(f.prototype)===xk.prototype?f:Dk(f,this.context))(this.context),m={nodeSize:d,width:c,height:l,center:u};switch(p.id){case`d3-force`:case`d3-force-3d`:Object.assign(m,{center:{x:c/2,y:l/2,z:0}});break;default:break}return Bu(p.options,m,s),p}updateElementPosition(e,t){let{model:n,element:r}=this.context;return r?(n.updateData(e),r.draw({animation:t,silence:!0})):null}destroy(){var e;this.stopLayout(),this.context={},(e=this.supervisor)==null||e.kill(),this.supervisor=void 0,this.instance=void 0,this.instances=[],this.animationResult=void 0}},OQ=(e,t)=>{var n;let[r,i]=t;(n=e.nodes)==null||n.forEach(e=>{if(e.style){let{x:t=0,y:n=0}=e.style;e.style.x=t+r,e.style.y=n+i}else e.style={x:r,y:i}})};function kQ(e){return[AQ].reduce((e,t)=>t(e),e)}function AQ(e){return!e.layout||Array.isArray(e.layout)||`preLayout`in e.layout||[`antv-dagre`,`combo-combined`,`compact-box`,`circular`,`concentric`,`dagre`,`fishbone`,`grid`,`indented`,`mds`,`radial`,`random`,`snake`,`dendrogram`,`mindmap`].includes(e.layout.type)&&(e.layout.preLayout=!0),e}var jQ=class extends FC{constructor(e){super(e),this.category=`plugin`,this.setPlugins(this.context.options.plugins||[])}setPlugins(e){this.setExtensions(e)}getPluginInstance(e){let t=this.extensionMap[e];if(t)return t;eS.warn(`Cannot find the plugin ${e}, will try to find it by type.`);let n=this.extensions.find(t=>t.type===e);if(n)return this.extensionMap[n.key]}};const MQ=[`update-related-edges`,`collapse-expand-node`,`collapse-expand-combo`,`get-edge-actual-ends`,`arrange-draw-order`];var NQ=class extends FC{constructor(e){super(e),this.category=`transform`,this.setTransforms(this.context.options.transforms||[])}getTransforms(){}setTransforms(e){this.setExtensions([...MQ.slice(0,MQ.length-1),...e,MQ[MQ.length-1]])}getTransformInstance(e){return e?this.extensionMap[e]:this.extensionMap}},PQ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},FQ=class{get padding(){return CS(this.context.options.padding)}get paddingOffset(){let[e,t,n,r]=this.padding,[i,a,o]=[(r-t)/2,(e-n)/2,0];return[i,a,o]}constructor(e){this.landmarkCounter=0,this.context=e;let[t,n]=this.paddingOffset,{zoom:r,rotation:i,x:a=t,y:o=n}=e.options;this.transform({mode:`absolute`,scale:r,translate:[a,o],rotate:i},!1)}get camera(){let{canvas:e}=this.context;return new Proxy(e.getCamera(),{get:(t,n)=>{let r=Object.entries(e.getLayers()).filter(([e])=>![`main`].includes(e)).map(([,e])=>e.getCamera()),i=t[n];if(typeof i==`function`)return(...e)=>{let a=i.apply(t,e);return r.forEach(t=>{t[n].apply(t,e)}),a}}})}createLandmark(e){return this.camera.createLandmark(`landmark-${this.landmarkCounter++}`,e)}getAnimation(e){let t=aS(this.context.options,e);return t?Yu(Object.assign({},t),[`easing`,`duration`]):!1}getCanvasSize(){let{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t,n]}getCanvasCenter(){let{canvas:e}=this.context,{width:t=0,height:n=0}=e.getConfig();return[t/2,n/2,0]}getViewportCenter(){let[e,t]=this.camera.getPosition();return[e,t,0]}getGraphCenter(){return this.context.graph.getViewportByCanvas(this.getCanvasCenter())}getZoom(){return this.camera.getZoom()}getRotation(){return this.camera.getRoll()}getTranslateOptions(e){let{camera:t}=this,{mode:n,translate:r=[]}=e,i=this.getZoom(),a=t.getPosition(),o=t.getFocalPoint(),[s,c]=this.getCanvasCenter(),[l=0,u=0,d=0]=r,f=UC([-l,-u,-d],i);return n===`relative`?{position:BC(a,f),focalPoint:BC(o,f)}:{position:BC([s,c,a[2]],f),focalPoint:BC([s,c,o[2]],f)}}getRotateOptions(e){let{mode:t,rotate:n=0}=e;return{roll:t===`relative`?this.camera.getRoll()+n:n}}getZoomOptions(e){let{zoomRange:t}=this.context.options,n=this.camera.getZoom(),{mode:r,scale:i=1}=e;return cu(r===`relative`?n*i:i,...t)}transform(e,t){return PQ(this,void 0,void 0,function*(){let{graph:n}=this.context,{translate:r,rotate:i,scale:a,origin:o}=e;this.cancelAnimation();let s=this.getAnimation(t);if(rQ(n,new nQ(Z.BEFORE_TRANSFORM,e)),!i&&a&&!r&&o&&!s){this.camera.setZoomByViewportPoint(this.getZoomOptions(e),o),rQ(n,new nQ(Z.AFTER_TRANSFORM,e));return}let c={};if(r&&Object.assign(c,this.getTranslateOptions(e)),G(i)&&Object.assign(c,this.getRotateOptions(e)),G(a)&&Object.assign(c,{zoom:this.getZoomOptions(e)}),s)return rQ(n,new eQ(Z.BEFORE_ANIMATE,Bx.TRANSFORM,null,e)),new Promise(t=>{this.transformResolver=t,this.camera.gotoLandmark(this.createLandmark(c),Object.assign(Object.assign({},s),{onfinish:()=>{rQ(n,new eQ(Z.AFTER_ANIMATE,Bx.TRANSFORM,null,e)),rQ(n,new nQ(Z.AFTER_TRANSFORM,e)),this.transformResolver=void 0,t()}}))});this.camera.gotoLandmark(this.createLandmark(c),{duration:0}),rQ(n,new nQ(Z.AFTER_TRANSFORM,e))})}fitView(e,t){return PQ(this,void 0,void 0,function*(){let[n,r,i,a]=this.padding,{when:o=`always`,direction:s=`both`}=e||{},[c,l]=this.context.canvas.getSize(),u=c-a-r,d=l-n-i,f=this.context.canvas.getBounds(),p=this.getBBoxInViewport(f),[m,h]=DS(p);if(o===`overflow`&&!(s===`x`&&m>=u||s===`y`&&h>=d||s===`both`&&m>=u&&h>=d))return yield this.fitCenter({animation:t});let g=u/m,_=d/h,v=s===`x`?g:s===`y`?_:Math.min(g,_),y=this.getAnimation(t);yield this.transform({mode:`relative`,scale:v,translate:BC(VC(this.getCanvasCenter(),this.getBBoxInViewport(f).center),UC(this.paddingOffset,v))},y)})}fitCenter(e){return PQ(this,void 0,void 0,function*(){let t=this.context.canvas.getBounds();yield this.focus(t,e)})}focusElements(e){return PQ(this,arguments,void 0,function*(e,t={}){let{element:n}=this.context;if(!n)return;let r=e=>t.shapes?e.getShape(t.shapes).getRenderBounds():e.getRenderBounds(),i=jS(e.map(e=>r(n.getElement(e))));yield this.focus(i,t)})}focus(e,t){return PQ(this,void 0,void 0,function*(){let n=this.context.graph.getViewportByCanvas(e.center),r=t.position||this.getCanvasCenter(),i=VC(r,n);yield this.transform({mode:`relative`,translate:BC(i,this.paddingOffset)},t.animation)})}getBBoxInViewport(e){let{min:t,max:n}=e,{graph:r}=this.context,[i,a]=r.getViewportByCanvas(t),[o,s]=r.getViewportByCanvas(n),c=new tp;return c.setMinMax([i,a,0],[o,s,0]),c}isInViewport(e,t=!1,n=0){let{graph:r}=this.context,i=this.getCanvasSize(),[a,o]=r.getCanvasByViewport([0,0]),[s,c]=r.getCanvasByViewport(i),l=new tp;return l.setMinMax([a,o,0],[s,c,0]),n&&(l=AS(l,n)),xS(e)?NS(e,l):t?MS(e,l):l.intersects(e)}cancelAnimation(){var e;this.camera.landmarks?.length&&this.camera.cancelLandmarkAnimation(),(e=this.transformResolver)==null||e.call(this)}},IQ=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},LQ=class e extends hk{constructor(t){var n;super(),this.options={},this.rendered=!1,this.destroyed=!1,this.context={model:new SQ},this.isCollapsingExpanding=!1,this.onResize=Nu(()=>{this.resize()},300),this._setOptions(Object.assign({},e.defaultOptions,t),!0),this.context.graph=this,this.options.autoResize&&((n=globalThis.addEventListener)==null||n.call(globalThis,`resize`,this.onResize))}getOptions(){return this.options}setOptions(e){this._setOptions(e,!1)}_setOptions(e,t){if(this.updateCanvas(e),Object.assign(this.options,kQ(e)),t){let{data:t}=e;t&&this.addData(t);return}let{behaviors:n,combo:r,data:i,edge:a,layout:o,node:s,plugins:c,theme:l,transforms:u}=e;n&&this.setBehaviors(n),i&&this.setData(i),s&&this.setNode(s),a&&this.setEdge(a),r&&this.setCombo(r),o&&this.setLayout(o),l&&this.setTheme(l),c&&this.setPlugins(c),u&&this.setTransforms(u)}getSize(){return this.context.canvas?this.context.canvas.getSize():[this.options.width||0,this.options.height||0]}setSize(e,t){e&&(this.options.width=e),t&&(this.options.height=t),this.resize(e,t)}setZoomRange(e){this.options.zoomRange=e}getZoomRange(){return this.options.zoomRange}setNode(e){this.options.node=e,this.context.model.refreshData()}setEdge(e){this.options.edge=e,this.context.model.refreshData()}setCombo(e){this.options.combo=e,this.context.model.refreshData()}getTheme(){return this.options.theme}setTheme(e){this.options.theme=W(e)?e(this.getTheme()):e}setLayout(e){this.options.layout=W(e)?e(this.getLayout()):e}getLayout(){return this.options.layout}setBehaviors(e){var t;this.options.behaviors=W(e)?e(this.getBehaviors()):e,(t=this.context.behavior)==null||t.setBehaviors(this.options.behaviors)}updateBehavior(e){this.setBehaviors(t=>t.map(t=>typeof t==`object`&&t.key===e.key?Object.assign(Object.assign({},t),e):t))}getBehaviors(){return this.options.behaviors||[]}setPlugins(e){var t;this.options.plugins=W(e)?e(this.getPlugins()):e,(t=this.context.plugin)==null||t.setPlugins(this.options.plugins)}updatePlugin(e){this.setPlugins(t=>t.map(t=>typeof t==`object`&&t.key===e.key?Object.assign(Object.assign({},t),e):t))}getPlugins(){return this.options.plugins||[]}getPluginInstance(e){return this.context.plugin.getPluginInstance(e)}setTransforms(e){var t;this.options.transforms=W(e)?e(this.getTransforms()):e,(t=this.context.transform)==null||t.setTransforms(this.options.transforms)}updateTransform(e){this.setTransforms(t=>t.map(t=>typeof t==`object`&&t.key===e.key?Object.assign(Object.assign({},t),e):t)),this.context.model.refreshData()}getTransforms(){return this.options.transforms||[]}getData(){return this.context.model.getData()}getElementData(e){return Array.isArray(e)?e.map(e=>this.context.model.getElementDataById(e)):this.context.model.getElementDataById(e)}getNodeData(e){return e===void 0?this.context.model.getNodeData():Array.isArray(e)?this.context.model.getNodeData(e):this.context.model.getNodeLikeDatum(e)}getEdgeData(e){return e===void 0?this.context.model.getEdgeData():Array.isArray(e)?this.context.model.getEdgeData(e):this.context.model.getEdgeDatum(e)}getComboData(e){return e===void 0?this.context.model.getComboData():Array.isArray(e)?this.context.model.getComboData(e):this.context.model.getNodeLikeDatum(e)}setData(e){this.context.model.setData(W(e)?e(this.getData()):e)}addData(e){this.context.model.addData(W(e)?e(this.getData()):e)}addNodeData(e){this.context.model.addNodeData(W(e)?e(this.getNodeData()):e)}addEdgeData(e){this.context.model.addEdgeData(W(e)?e(this.getEdgeData()):e)}addComboData(e){this.context.model.addComboData(W(e)?e(this.getComboData()):e)}addChildrenData(e,t){this.context.model.addChildrenData(e,t)}updateData(e){this.context.model.updateData(W(e)?e(this.getData()):e)}updateNodeData(e){this.context.model.updateNodeData(W(e)?e(this.getNodeData()):e)}updateEdgeData(e){this.context.model.updateEdgeData(W(e)?e(this.getEdgeData()):e)}updateComboData(e){this.context.model.updateComboData(W(e)?e(this.getComboData()):e)}removeData(e){this.context.model.removeData(W(e)?e(this.getData()):e)}removeNodeData(e){this.context.model.removeNodeData(W(e)?e(this.getNodeData()):e)}removeEdgeData(e){this.context.model.removeEdgeData(W(e)?e(this.getEdgeData()):e)}removeComboData(e){this.context.model.removeComboData(W(e)?e(this.getComboData()):e)}getElementType(e){return this.context.model.getElementType(e)}getRelatedEdgesData(e,t=`both`){return this.context.model.getRelatedEdgesData(e,t)}getNeighborNodesData(e){return this.context.model.getNeighborNodesData(e)}getAncestorsData(e,t){return this.context.model.getAncestorsData(e,t)}getParentData(e,t){return this.context.model.getParentData(e,t)}getChildrenData(e){return this.context.model.getChildrenData(e)}getDescendantsData(e){return this.context.model.getDescendantsData(e)}getElementDataByState(e,t){return this.context.model.getElementDataByState(e,t)}initCanvas(){return IQ(this,void 0,void 0,function*(){if(this.context.canvas)return yield this.context.canvas.ready;let{container:e=`container`,width:t,height:n,renderer:r,cursor:i,background:a,canvas:o,devicePixelRatio:s=globalThis.devicePixelRatio??1}=this.options;if(e instanceof KZ)this.context.canvas=e,i&&e.setCursor(i),r&&e.setRenderer(r),yield e.ready;else{let c=ru(e)?document.getElementById(e):e,l=ZZ(c);this.emit(Z.BEFORE_CANVAS_INIT,{container:c,width:t,height:n});let u=Object.assign(Object.assign({},o),{container:c,width:t||l[0],height:n||l[1],background:a,renderer:r,cursor:i,devicePixelRatio:s}),d=new KZ(u);this.context.canvas=d,yield d.ready,this.emit(Z.AFTER_CANVAS_INIT,{canvas:d})}})}updateCanvas(e){let{renderer:t,cursor:n,height:r,width:i}=e,a=this.context.canvas;a&&(t&&(this.emit(Z.BEFORE_RENDERER_CHANGE,{renderer:this.options.renderer}),a.setRenderer(t),this.emit(Z.AFTER_RENDERER_CHANGE,{renderer:t})),n&&a.setCursor(n),(G(i)||G(r))&&this.setSize(i??this.options.width??0,r??this.options.height??0))}initRuntime(){this.context.options=this.options,this.context.batch||(this.context.batch=new fQ(this.context)),this.context.plugin||(this.context.plugin=new jQ(this.context)),this.context.viewport||(this.context.viewport=new FQ(this.context)),this.context.transform||(this.context.transform=new NQ(this.context)),this.context.element||(this.context.element=new wQ(this.context)),this.context.animation||(this.context.animation=new dQ(this.context)),this.context.layout||(this.context.layout=new DQ(this.context)),this.context.behavior||(this.context.behavior=new pQ(this.context))}prepare(){return IQ(this,void 0,void 0,function*(){if(yield Promise.resolve(),this.destroyed){console.error($x(`The graph instance has been destroyed`));return}yield this.initCanvas(),this.initRuntime()})}render(){return IQ(this,void 0,void 0,function*(){if(yield this.prepare(),rQ(this,new $Z(Z.BEFORE_RENDER)),this.options.layout)if(!this.rendered&&Tk(this.options.layout)){let e=yield this.context.element.preLayoutDraw({type:`render`});yield Promise.all([e?.finished,this.autoFit()])}else{let e=this.context.element.draw({type:`render`});yield Promise.all([e?.finished,this.context.layout.postLayout()]),yield this.autoFit()}else{let e=this.context.element.draw({type:`render`});yield Promise.all([e?.finished,this.autoFit()])}this.rendered=!0,rQ(this,new $Z(Z.AFTER_RENDER))})}draw(){return IQ(this,void 0,void 0,function*(){yield this.prepare(),yield this.context.element.draw()?.finished})}layout(e){return IQ(this,void 0,void 0,function*(){yield this.context.layout.postLayout(e)})}stopLayout(){this.context.layout.stopLayout()}clear(){return IQ(this,void 0,void 0,function*(){let{model:e,element:t}=this.context;e.setData({}),e.clearChanges(),t?.clear()})}destroy(){var e;rQ(this,new $Z(Z.BEFORE_DESTROY));let{layout:t,animation:n,element:r,model:i,canvas:a,behavior:o,plugin:s}=this.context;s?.destroy(),o?.destroy(),t?.destroy(),n?.destroy(),r?.destroy(),i.destroy(),a?.destroy(),this.options={},this.context={},this.off(),(e=globalThis.removeEventListener)==null||e.call(globalThis,`resize`,this.onResize),this.destroyed=!0,rQ(this,new $Z(Z.AFTER_DESTROY))}getCanvas(){return this.context.canvas}resize(e,t){let n=ZZ(this.context.canvas?.getContainer()),r=[e||n[0],t||n[1]];if(!this.context.canvas)return;let i=this.context.canvas.getSize();Gu(r,i)||(rQ(this,new $Z(Z.BEFORE_SIZE_CHANGE,{size:r})),this.context.canvas.resize(...r),rQ(this,new $Z(Z.AFTER_SIZE_CHANGE,{size:r})))}fitView(e,t){return IQ(this,void 0,void 0,function*(){yield this.context.viewport?.fitView(e,t)})}fitCenter(e){return IQ(this,void 0,void 0,function*(){yield this.context.viewport?.fitCenter({animation:e})})}autoFit(){return IQ(this,void 0,void 0,function*(){let{autoFit:e}=this.context.options;if(e)if(ru(e))e===`view`?yield this.fitView():e===`center`&&(yield this.fitCenter());else{let{type:t,animation:n}=e;t===`view`?yield this.fitView(e.options,n):t===`center`&&(yield this.fitCenter(n))}})}focusElement(e,t){return IQ(this,void 0,void 0,function*(){yield this.context.viewport?.focusElements(Array.isArray(e)?e:[e],{animation:t})})}zoomBy(e,t,n){return IQ(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:`relative`,scale:e,origin:n},t)})}zoomTo(e,t,n){return IQ(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:`absolute`,scale:e,origin:n},t)})}getZoom(){return this.context.viewport.getZoom()}rotateBy(e,t,n){return IQ(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:`relative`,rotate:e,origin:n},t)})}rotateTo(e,t,n){return IQ(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:`absolute`,rotate:e,origin:n},t)})}getRotation(){return this.context.viewport.getRotation()}translateBy(e,t){return IQ(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:`relative`,translate:e},t)})}translateTo(e,t){return IQ(this,void 0,void 0,function*(){yield this.context.viewport.transform({mode:`absolute`,translate:e},t)})}getPosition(){return VC([0,0],this.getCanvasByViewport([0,0]))}translateElementBy(e,t){return IQ(this,arguments,void 0,function*(e,t,n=!0){let[r,i]=Kl(e)?[e,t??!0]:[{[e]:t},n];Object.entries(r).forEach(([e,t])=>this.context.model.translateNodeLikeBy(e,t)),yield this.context.element.draw({animation:i,stage:`translate`})?.finished})}translateElementTo(e,t){return IQ(this,arguments,void 0,function*(e,t,n=!0){let[r,i]=Kl(e)?[e,t??!0]:[{[e]:t},n];Object.entries(r).forEach(([e,t])=>this.context.model.translateNodeLikeTo(e,t)),yield this.context.element.draw({animation:i,stage:`translate`})?.finished})}getElementPosition(e){return this.context.model.getElementPosition(e)}getElementRenderStyle(e){return Xu(this.context.element.getElement(e).attributes,[`context`])}setElementVisibility(e,t){return IQ(this,arguments,void 0,function*(e,t,n=!0){let[r,i]=Kl(e)?[e,t??!0]:[{[e]:t},n],a={nodes:[],edges:[],combos:[]};Object.entries(r).forEach(([e,t])=>{let n=this.getElementType(e);a[`${n}s`].push({id:e,style:{visibility:t}})});let{model:o,element:s}=this.context;o.preventUpdateNodeLikeHierarchy(()=>{o.updateData(a)}),yield s.draw({animation:i,stage:`visibility`})?.finished})}showElement(e,t){return IQ(this,void 0,void 0,function*(){let n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(e=>[e,`visible`])),t)})}hideElement(e,t){return IQ(this,void 0,void 0,function*(){let n=Array.isArray(e)?e:[e];yield this.setElementVisibility(Object.fromEntries(n.map(e=>[e,`hidden`])),t)})}getElementVisibility(e){return this.context.element.getElement(e)?.style?.visibility??`visible`}setElementZIndex(e,t){return IQ(this,void 0,void 0,function*(){let n={nodes:[],edges:[],combos:[]},r=Kl(e)?e:{[e]:t};Object.entries(r).forEach(([e,t])=>{let r=this.getElementType(e);n[`${r}s`].push({id:e,style:{zIndex:t}})});let{model:i,element:a}=this.context;i.preventUpdateNodeLikeHierarchy(()=>i.updateData(n)),yield a.draw({animation:!1,stage:`zIndex`})?.finished})}frontElement(e){return IQ(this,void 0,void 0,function*(){let t=Array.isArray(e)?e:[e],{model:n}=this.context,r={};t.map(e=>{let t=n.getFrontZIndex(e);if(n.getElementType(e)===`combo`){let i=n.getAncestorsData(e,`combo`).at(-1)||this.getComboData(e),a=[i,...n.getDescendantsData(Q(i))],o=t-aQ(i);a.forEach(e=>{r[Q(e)]=this.getElementZIndex(Q(e))+o});let{internal:s}=XD(a.map(Q),e=>n.getRelatedEdgesData(e));s.forEach(e=>{let t=Q(e);r[t]=this.getElementZIndex(t)+o})}else r[e]=t}),yield this.setElementZIndex(r)})}getElementZIndex(e){return aQ(this.context.model.getElementDataById(e))}setElementState(e,t){return IQ(this,arguments,void 0,function*(e,t,n=!0){let[r,i]=Kl(e)?[e,t??!0]:[{[e]:t},n],a=e=>e?Array.isArray(e)?e:[e]:[],o={nodes:[],edges:[],combos:[]};Object.entries(r).forEach(([e,t])=>{let n=this.getElementType(e);o[`${n}s`].push({id:e,states:a(t)})}),this.updateData(o),yield this.context.element.draw({animation:i,stage:`state`})?.finished})}getElementState(e){return this.context.model.getElementState(e)}getElementRenderBounds(e){return this.context.element.getElement(e).getRenderBounds()}collapseElement(e){return IQ(this,arguments,void 0,function*(e,t=!0){let{model:n,element:r}=this.context;if(Uw(n.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof t==`boolean`&&(t={animation:t,align:!0});let i=n.getElementType(e);yield this.frontElement(e),this.isCollapsingExpanding=!0,n.updateData(i===`node`?{nodes:[{id:e,style:{collapsed:!0}}]}:{combos:[{id:e,style:{collapsed:!0}}]}),i===`node`?yield r.collapseNode(e,t):i===`combo`&&(yield r.collapseCombo(e,!!t.animation)),this.isCollapsingExpanding=!1})}expandElement(e){return IQ(this,arguments,void 0,function*(e,t=!0){let{model:n,element:r}=this.context;if(!Uw(n.getNodeLikeData([e])[0])||this.isCollapsingExpanding)return;typeof t==`boolean`&&(t={animation:t,align:!0});let i=n.getElementType(e);this.isCollapsingExpanding=!0,n.updateData(i===`node`?{nodes:[{id:e,style:{collapsed:!1}}]}:{combos:[{id:e,style:{collapsed:!1}}]}),i===`node`?yield r.expandNode(e,t):i===`combo`&&(yield r.expandCombo(e,!!t.animation)),this.isCollapsingExpanding=!1})}setElementCollapsibility(e,t){let n=this.getElementType(e);n===`node`?this.updateNodeData([{id:e,style:{collapsed:t}}]):n===`combo`&&this.updateComboData([{id:e,style:{collapsed:t}}])}toDataURL(){return IQ(this,arguments,void 0,function*(e={}){return this.context.canvas.toDataURL(e)})}getCanvasByViewport(e){return this.context.canvas.getCanvasByViewport(e)}getViewportByCanvas(e){return this.context.canvas.getViewportByCanvas(e)}getClientByCanvas(e){return this.context.canvas.getClientByCanvas(e)}getCanvasByClient(e){return this.context.canvas.getCanvasByClient(e)}getViewportCenter(){return this.context.viewport.getViewportCenter()}getCanvasCenter(){return this.context.viewport.getCanvasCenter()}on(e,t,n){return super.on(e,t,n)}once(e,t){return super.once(e,t)}off(e,t){return super.off(e,t)}};LQ.defaultOptions={autoResize:!1,theme:`light`,rotation:0,zoom:1,zoomRange:[.01,10]};var RQ=class extends jZ{beforeDraw(e){let{add:t,update:n}=e,{model:r}=this.context;return[...t.edges.entries(),...n.edges.entries()].forEach(([,e])=>{zQ(r,e)}),e}};const zQ=(e,t)=>{let{source:n,target:r}=t,i=e.getElementDataById(n),a=e.getElementDataById(r),o=ZD(i,t=>e.getParentData(t,qx)),s=ZD(a,t=>e.getParentData(t,qx)),c=Q(o),l=Q(s),u={sourceNode:c,targetNode:l};return t.style?Object.assign(t.style,u):t.style=u,t},BQ=(e,t,n)=>{let[r,i]=t,[a,o]=n;if(i===r)return a;let s=(e-r)/(i-r);return a+s*(o-a)},VQ=(e,t,n)=>{let[r,i]=t,[a,o]=n,s=Math.log(e-r+1)/Math.log(i-r+1);return a+s*(o-a)},HQ=(e,t,n,r=2)=>{let[i,a]=t,[o,s]=n,c=((e-i)/(a-i))**+r;return o+c*(s-o)},UQ=(e,t,n)=>{let[r,i]=t,[a,o]=n,s=Math.sqrt((e-r)/(i-r));return a+s*(o-a)};var WQ=class e extends jZ{constructor(t,n){super(t,Bu({},e.defaultOptions,n)),this.assignSizeByCentrality=(e,t,n,r,i,a)=>{let o=[t,n],s=[r[0],i[0]],c=[r[1],i[1]],l=[r[2],i[2]],u=(e,t)=>{if(typeof a==`function`)return a(e,o,t);switch(a){case`linear`:return BQ(e,o,t);case`log`:return VQ(e,o,t);case`pow`:return HQ(e,o,t,2);case`sqrt`:return UQ(e,o,t);default:return t[0]}};return[u(e,s),u(e,c),u(e,l)]}}beforeDraw(e){let{model:t}=this.context,n=t.getNodeData(),r=Xw(this.options.maxSize),i=Xw(this.options.minSize),a=this.getCentralities(this.options.centrality),o=a.size>0?Math.max(...a.values()):0,s=a.size>0?Math.min(...a.values()):0;return n.forEach(t=>{let n=this.assignSizeByCentrality(a.get(Q(t))||0,s,o,i,r,this.options.scale),c=this.context.element?.getElement(Q(t)),l={size:n};this.assignLabelStyle(l,n,t,c),(!c||!PZ(l,c.attributes))&&NZ(e,c?`update`:`add`,`node`,Bu(t,{style:l}),!0)}),e}assignLabelStyle(e,t,n,r){let i=r?r.config.style:this.context.element?.getElementComputedStyle(`node`,n);if(Object.assign(e,Yu(i,[`labelFontSize`,`labelLineHeight`])),this.options.mapLabelSize){let n=this.getLabelSizeByNodeSize(t,1/0,Number(e.labelFontSize));Object.assign(e,{labelFontSize:n,labelLineHeight:n+wS(e.labelPadding)})}return e}getLabelSizeByNodeSize(e,t,n){let r=Math.min(...e)/2,[i,a]=Array.isArray(this.options.mapLabelSize)?this.options.mapLabelSize:[n,t];return Math.min(a,Math.max(r,i))}getCentralities(e){let{model:t}=this.context,n=t.getData();if(typeof e==`function`)return e(n);let r=t.getRelatedEdgesData.bind(t);return wC(n,r,e)}};WQ.defaultOptions={centrality:{type:`degree`},maxSize:80,minSize:20,scale:`linear`,mapLabelSize:!1};var GQ=class e extends jZ{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n))}get ref(){return this.context.model.getRootsData()[0]}afterLayout(){var e;let t=aw(this.ref),{graph:n,model:r}=this.context;(e=r.getData().nodes)==null||e.forEach(e=>{if(Q(e)===Q(this.ref))return;let i=tw(VC(aw(e),t)),a=Math.abs(i)>Math.PI/2,o=!e.children||e.children.length===0,s=Q(e),c=this.context.element?.getElement(s);if(!c||!c.isVisible())return;let l=Xw(n.getElementRenderStyle(s).size)[0]/2,u=(o?1:-1)*(l+this.options.offset),d=[[`translate`,u*Math.cos(i),u*Math.sin(i)],[`rotate`,a?gp(i)+180:gp(i)]];r.updateNodeData([{id:Q(e),style:{labelTextAlign:a===o?`right`:`left`,labelTextBaseline:`middle`,labelTransform:d}}])}),n.draw()}};GQ.defaultOptions={offset:5};var KQ=`quadratic`,qQ=[`top`,`top-right`,`right`,`right-bottom`,`bottom`,`bottom-left`,`left`,`left-top`],JQ=class e extends jZ{constructor(t,n){super(t,Object.assign({},e.defaultOptions,n)),this.cacheMergeStyle=new Map,this.getAffectedParallelEdges=e=>{let{add:{edges:t},update:{nodes:n,edges:r,combos:i},remove:{edges:a}}=e,{model:o}=this.context,s=new Map,c=(e,t)=>{o.getRelatedEdgesData(t).forEach(e=>!s.has(Q(e))&&s.set(Q(e),e))};n.forEach(c),i.forEach(c);let l=e=>{let t=o.getEdgeData().map(e=>zQ(o,e));XQ(e,t,!0).forEach(e=>!s.has(Q(e))&&s.set(Q(e),e))};if(a.size&&a.forEach(l),t.size&&t.forEach(l),r.size){let e=LU(IU(o.getChanges())).update.edges;r.forEach(t=>{l(t);let n=e.find(e=>Q(e.value)===Q(t))?.original;n&&!ZQ(t,n)&&l(n)})}Uu(this.options.edges)||s.forEach((e,t)=>!this.options.edges.includes(t)&&s.delete(t));let u=o.getEdgeData().map(Q);return new Map([...s].sort((e,t)=>u.indexOf(e[0])-u.indexOf(t[0])))},this.applyBundlingStyle=(e,t,n)=>{let{edgeMap:r,reverses:i}=YQ(t);r.forEach(t=>{t.forEach((t,r,a)=>{let o=a.length,s=t.style||{};if(t.source===t.target){let e=qQ.length;s.loopPlacement=qQ[r%e],s.loopDist=Math.floor(r/e)*n+50}else if(o===1)s.curveOffset=0;else{let e=(r%2==0?1:-1)*(i[`${t.source}|${t.target}|${r}`]?-1:1);s.curveOffset=o%2==1?e*Math.ceil(r/2)*n*2:e*(Math.floor(r/2)*n*2+n)}let c=Object.assign(t,{type:KQ,style:s}),l=this.context.element?.getElement(Q(t));(!l||!PZ(c.style,l.attributes))&&NZ(e,l?`update`:`add`,`edge`,c,!0)})})},this.resetEdgeStyle=e=>{let t=e.style||{},n=this.cacheMergeStyle.get(Q(e))||{};return Object.keys(n).forEach(r=>{Gu(t[r],n[r])&&(e[r]?t[r]=e[r]:delete t[r])}),Object.assign(e,{style:t})},this.applyMergingStyle=(e,t)=>{let{edgeMap:n,reverses:r}=YQ(t);n.forEach(t=>{if(t.length===1){let n=t[0],r=this.context.element?.getElement(Q(n)),i=this.resetEdgeStyle(n);(!r||!PZ(i,r.attributes))&&NZ(e,r?`update`:`add`,`edge`,i);return}let n=t.map(({source:e,target:t,style:n={}},i)=>{let{startArrow:a,endArrow:o}=n,s={},[c,l]=r[`${e}|${t}|${i}`]?[`endArrow`,`startArrow`]:[`startArrow`,`endArrow`];return xu(a)&&(s[c]=a),xu(o)&&(s[l]=o),s}).reduce((e,t)=>Object.assign(Object.assign({},e),t),{});t.forEach((t,r,i)=>{if(r!==0){NZ(e,`remove`,`edge`,t);return}let a=Object.assign({},W(this.options.style)?this.options.style(i):this.options.style,{childrenData:i});this.cacheMergeStyle.set(Q(t),a);let o=Object.assign(Object.assign({},t),{type:`line`,style:Object.assign(Object.assign(Object.assign({},t.style),n),a)}),s=this.context.element?.getElement(Q(t));(!s||!PZ(o.style,s.attributes))&&NZ(e,s?`update`:`add`,`edge`,o,!0)})})}}beforeDraw(e){let t=this.getAffectedParallelEdges(e);return t.size===0||(this.options.mode===`bundle`?this.applyBundlingStyle(e,t,this.options.distance):this.applyMergingStyle(e,t)),e}};JQ.defaultOptions={mode:`bundle`,distance:15};const YQ=e=>{let t=new Map,n=new Set,r={},i=new Map;for(let[a,o]of e){if(n.has(a))continue;let{source:s,target:c}=o,l=`${s}-${c}`;t.has(l)||(t.set(l,[]),i.set(l,new Set));let u=t.get(l),d=i.get(l);u&&d&&!d.has(a)&&(u.push(o),d.add(a),n.add(a));for(let[u,d]of e){if(n.has(u)||u===a)continue;if(ZQ(o,d)){let e=t.get(l),a=i.get(l);e&&a&&!a.has(u)&&(e.push(d),a.add(u),s===d.target&&c===d.source&&(r[`${d.source}|${d.target}|${e.length-1}`]=!0),n.add(u))}}}return{edgeMap:t,reverses:r}},XQ=(e,t,n)=>t.filter(t=>(n||Q(t)!==Q(e))&&ZQ(t,e)),ZQ=(e,t)=>{let{sourceNode:n,targetNode:r}=e.style||{},{sourceNode:i,targetNode:a}=t.style||{};return n===i&&r===a||n===a&&r===i};var QQ=class extends jZ{beforeDraw(e,t){let{stage:n}=t;if(n===`visibility`)return e;let{model:r}=this.context,{update:{nodes:i,edges:a,combos:o}}=e,s=(e,t)=>{r.getRelatedEdgesData(t).forEach(e=>!a.has(Q(e))&&a.set(Q(e),e))};return i.forEach(s),o.forEach(s),e}},$Q={animation:{"combo-collapse":_S,"combo-expand":vS,"node-collapse":pS,"node-expand":mS,"path-in":hS,"path-out":gS,fade:dS,translate:fS},behavior:{"brush-select":Mw,"click-select":Hw,"collapse-expand":ak,"create-edge":lk,"drag-canvas":dk,"drag-element-force":jk,"drag-element":pk,"fix-element-size":Nk,"focus-element":Fk,"hover-activate":Ik,"lasso-select":Lk,"auto-adapt-label":RC,"optimize-viewport-transform":Rk,"scroll-canvas":Bk,"zoom-canvas":Hk},combo:{circle:bD,rect:xD},edge:{cubic:lO,line:pO,polyline:DO,quadratic:OO,"cubic-horizontal":uO,"cubic-radial":dO,"cubic-vertical":fO},layout:{"antv-dagre":PM,"combo-combined":vP,"compact-box":WV.compactBox,"d3-force":hF,"force-atlas2":HB,circular:RM,concentric:UM,dagre:LB,dendrogram:WV.dendrogram,fishbone:KV,force:GN,fruchterman:GB,grid:qB,indented:WV.indented,mds:fP,mindmap:WV.mindmap,radial:sV,random:mV,snake:ZV},node:{circle:PT,diamond:IT,ellipse:UT,hexagon:WT,html:fD,image:mD,rect:hD,star:gD,donut:RT,triangle:_D},palette:{spectral:$V,tableau:eH,oranges:tH,greens:nH,blues:rH},theme:{dark:kZ,light:AZ},plugin:{"bubble-sets":fU,"edge-bundling":vU,"edge-filter-lens":OU,"grid-line":FU,background:cH,contextmenu:_U,fisheye:MU,fullscreen:NU,history:BU,hull:IW,legend:XX,minimap:ZX,snapline:nZ,timebar:cZ,toolbar:mZ,tooltip:gZ,watermark:wZ},transform:{"arrange-draw-order":MZ,"collapse-expand-combo":FZ,"collapse-expand-node":LZ,"get-edge-actual-ends":RQ,"map-node-size":WQ,"place-radial-labels":GQ,"process-parallel-edges":JQ,"update-related-edges":QQ},shape:{circle:Oy,ellipse:jy,group:Ny,html:Fy,image:wT,line:Ry,path:By,polygon:Hy,polyline:Wy,rect:Gy,text:qy,label:fT,badge:pT}};function e$(){Object.entries($Q).forEach(([e,t])=>{Object.entries(t).forEach(([t,n])=>{RZ(e,t,n)})})}e$();var t$=t(Ht()),n$=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},r$=Object.assign({},t$),{version:i$,render:a$,unmountComponentAtNode:o$}=r$,s$;function c$(){return n$(this,void 0,void 0,function*(){if(!s$&&Number((i$||``).split(`.`)[0])>=18)try{let e=yield ye(()=>import(`./client-Lo9oiyFk.js`).then(o()),__vite__mapDeps([3,4,2]));e.createRoot&&(s$=e.createRoot)}catch{}})}function l$(e){let{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:t}=r$;t&&typeof t==`object`&&(t.usingClientEntryPoint=e)}var u$=`__rc_react_root__`;function d$(e,t){l$(!0);let n=t[u$]||s$(t);l$(!1),n.render(e),t[u$]=n}function f$(e,t){a$(e,t)}function p$(e,t){return n$(this,void 0,void 0,function*(){yield c$(),s$?d$(e,t):f$(e,t)})}function m$(e){return n$(this,void 0,void 0,function*(){return Promise.resolve().then(()=>{var t;(t=e[u$])==null||t.unmount(),delete e[u$]})})}function h$(e){o$(e)}function g$(e){return n$(this,void 0,void 0,function*(){if(yield c$(),s$)return m$(e);h$(e)})}var _$=class extends fD{getKeyStyle(e){return Object.assign({},super.getKeyStyle(e))}constructor(e){super(e)}update(e){super.update(e)}connectedCallback(){super.connectedCallback();let{component:e}=this.attributes;p$(e,this.getDomElement())}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===`component`&&t!==n&&p$(this.attributes.component,this.getDomElement())}destroy(){g$(this.getDomElement()),super.destroy()}};const v$={black:`#000000`,dark_blue:`#0000AA`,dark_green:`#00AA00`,dark_aqua:`#00AAAA`,dark_red:`#AA0000`,dark_purple:`#AA00AA`,gold:`#FFAA00`,gray:`#AAAAAA`,dark_gray:`#555555`,blue:`#5555FF`,green:`#55FF55`,aqua:`#55FFFF`,red:`#FF5555`,light_purple:`#FF55FF`,yellow:`#FFFF55`,white:`#FFFFFF`},y$=e=>v$[e]||e;function b$(e){return Array.isArray(e)?(0,B.jsx)(B.Fragment,{children:e.map((e,t)=>(0,B.jsx)(`span`,{children:b$(e)},t))}):(0,B.jsx)(`span`,{style:{color:y$(e?.color??``)},children:e?.translate||e?.text||``})}var x$=({children:e,className:t})=>(0,B.jsx)(`div`,{className:t,children:e});const S$=({...e})=>{let t=Ye(),n=wt(),r=n.dialogsFolder,[i,a]=(0,I.useState)([]);(0,I.useEffect)(()=>{(async()=>{if(!r)return;let e=[],t=[];for await(let[e,n]of r.entries()){let r=e.replace(/\.json$/,``),i=await ke.getState().getDialogSequence(r);if(i&&(i.fromDB=()=>!0),n.kind===`file`&&e.endsWith(`.json`))try{t.push({id:r,handle:n,dialogSequence:i})}catch(t){It.error(`Failed to parse dialog file:`,e,t)}}t.sort((e,t)=>e.id.localeCompare(t.id)),e.push(...t),a(e)})().catch(e=>It.error(`Failed to load entries:`,e))},[r]);let o=async(e,t)=>{let n=await(await t.getFile()).text(),r=JSON.parse(n),o=i.map(t=>t.id===e?{...t,dialogSequence:r}:t);It.info(`Load dialog sequence:`,r),a(o),await ke.getState().addDialogSequence(r)};return(0,B.jsx)(B.Fragment,{children:(0,B.jsx)(Pt,{...e,children:(0,B.jsx)(x$,{className:`w-full max-h-full text-inherit`,children:(0,B.jsx)(ds,{emptyContent:(0,B.jsx)(`div`,{className:`text-center select-none`,children:`---  ---`}),items:i,label:`Dialog Sequence List`,onAction:async e=>{let r=i.find(t=>t.id===e);r&&((!r.dialogSequence||r.dialogSequence.fromDB)&&await o(e,r.handle),await n.openTab({type:`permanent`,key:e}),t(`/${e}`))},children:e=>(0,B.jsx)(Wo,{className:`group`,description:e.dialogSequence?.title||e.dialogSequence?.description||` `,endContent:(0,B.jsxs)(ua,{placement:`right`,children:[(0,B.jsx)(ca,{children:(0,B.jsx)(Le,{className:`opacity-0 group-hover:opacity-100 transition-opacity`})}),(0,B.jsx)(oa,{children:(0,B.jsxs)(ds,{"aria-label":`Actions`,onAction:async t=>{switch(It.info(`Action:`,t,e.id),t){case`reload`:await o(e.id,e.handle);break;case`edit`:break;case`copy`:break;default:break}},children:[(0,B.jsx)(Wo,{startContent:(0,B.jsx)(De,{size:18}),children:``},`reload`),(0,B.jsx)(Wo,{startContent:(0,B.jsx)(st,{size:18}),children:``},`edit`),(0,B.jsx)(Wo,{showDivider:!0,startContent:(0,B.jsx)(kt,{size:18}),children:``},`copy`),(0,B.jsx)(Wo,{className:`text-danger`,color:`danger`,startContent:(0,B.jsx)(Mt,{size:18}),children:``},`delete`)]})})]}),startContent:(0,B.jsx)(Pe,{size:40}),children:e.handle.name},e.id)})})})})};RZ(Yx.NODE,`dialog-entry`,_$);const C$=({data:e})=>{let t=e,n=e.states?.includes(`active`),r=e.states?.includes(`selected`),i=`${n&&`bg-foreground-100`} ${r&&`border-1`}`;return typeof t.text==`string`&&(t.text={translate:t.text}),(0,B.jsx)(zr,{className:`w-full h-full ${i}`.trim(),id:t.id,children:(0,B.jsxs)(Ir,{children:[(0,B.jsx)(`p`,{children:b$(t.speaker)}),(0,B.jsx)(`p`,{children:b$(t.text)})]})})},w$=e=>{let{options:t,onRender:n,onDestroy:r}=e,i=(0,I.useRef)(void 0),a=(0,I.useRef)(null);return(0,I.useEffect)(()=>(i.current=new LQ({container:a.current,autoResize:!0,autoFit:{type:`view`,options:{when:`overflow`,direction:`y`},animation:{duration:1e3,easing:`ease-in-out`}},layout:{type:`antv-dagre`},zoomRange:[.3,1],behaviors:[`drag-canvas`,`zoom-canvas`,`hover-activate`,`click-select`]}),()=>{let e=i.current;e&&(e.destroy(),r?.(),i.current=void 0)}),[]),(0,I.useEffect)(()=>{let e=a.current,r=i.current;!e||!r||r.destroyed||(r.setOptions(t),r.render().then(()=>n?.(r)).catch(e=>console.debug(e)))},[t]),(0,B.jsx)(`div`,{ref:a,className:`w-full h-full`,id:e.id})},T$=({label:e,description:t,classNames:n={base:Te(`inline-flex flex-row-reverse w-full max-w-full bg-content2 hover:bg-content3`,`justify-between cursor-pointer rounded-xl py-3 px-1.5`),wrapper:`p-0 h-5 overflow-visible mr-1`,thumb:Te(`w-6 h-6 border-2 shadow-lg`,`group-data-[hover=true]:border-primary`,`group-data-[selected=true]:ms-6`,`group-data-[pressed=true]:w-7`,`group-data-pressed:group-data-selected:ms-4`)},...r})=>{let i=Array.isArray(t)?t:t?[t]:[];return(0,B.jsx)(yi,{classNames:n,...r,children:(0,B.jsxs)(`div`,{className:`flex flex-col gap-1`,children:[(0,B.jsx)(`p`,{className:`text-tiny`,children:e}),i.map((e,t)=>(0,B.jsx)(`p`,{className:`text-tiny text-default-400`,children:e},t))]})})};function E$(){let e=wt(),{id:t}=Ke(),n=ke(),r={id:t||``,start:`start`,entries:[{id:`start`,text:{translate:`dialog.${t}.entry.start.text`}}]},[i,a]=(0,I.useState)(r);(0,I.useEffect)(()=>{It.info(`Dialog Sequence:`,t,e.loaded),t&&e.loaded&&n.getDialogSequence(t).then(n=>{It.info(`Dialog Sequence:`,n),n?a(n):e.openTab({type:`new`,key:t}).then(()=>{a(r)})})},[t,n,e.loaded]);let o=(0,I.useMemo)(()=>({nodes:i.entries.map(e=>({...e})),edges:[...i.entries?.map((e,t)=>t<i.entries.length-1?{source:e.id,target:i.entries[t+1].id}:null).filter(Boolean)].filter(e=>e.source&&e.target)}),[i.entries]),s=(0,I.useMemo)(()=>({data:o,node:{type:`dialog-entry`,style:e=>{let t={component:(0,B.jsx)(C$,{data:e}),portLinkToCenter:!0,ports:[{placement:`top`},{placement:`right`},{placement:`bottom`},{placement:`left`}]};return Object.assign(t,{size:[400,200],dx:-200,dy:-100}),t}},edge:{type:`polyline`,style:{stroke:`#8b9baf`,lineWidth:2,radius:20,endArrow:!0,labelText:e=>e.data?.text??``,labelBackground:!0,labelBackgroundFill:`#f8f8f8`,labelBackgroundOpacity:1,labelBackgroundLineWidth:2,labelBackgroundStroke:`#8b9baf`,labelPadding:[1,10],labelBackgroundRadius:4,router:{type:`orth`}}}}),[o]),c=e=>{e.preventDefault();let t=Object.fromEntries(new FormData(e.currentTarget)),n={...i,...t,allowClose:t.allowClose===`true`,invulnerable:t.invulnerable===`true`,invisible:t.invisible===`true`};a(n),It.info(`Dialog Sequence:`,n)};return(0,B.jsxs)(`div`,{className:`w-full h-full overflow-hidden`,children:[(0,B.jsxs)(Mo,{"aria-label":`Options`,classNames:{base:`absolute z-10 md:pl-3`,panel:`absolute z-9 w-full sm:w-auto md:pl-3`},children:[(0,B.jsx)(No,{title:``,children:(0,B.jsx)(zr,{className:`w-full sm:w-96 py-2 mt-10 max-h-[calc(100vh-11rem)]`,children:(0,B.jsx)(Pt,{className:`scrollbar-1 scrollbar-auto gutter-both`,children:(0,B.jsx)(Ir,{children:(0,B.jsxs)(li,{className:`w-full gap-3`,onSubmit:c,children:[(0,B.jsx)(wi,{isClearable:!0,isRequired:!0,defaultValue:i.id,label:`ID ()`,labelPlacement:`inside`,name:`id`,type:`text`}),(0,B.jsxs)(fs,{defaultSelectedKeys:[i.type?.toString()??`SCREEN`],label:``,name:`type`,children:[(0,B.jsx)(Wo,{children:``},`OVERLAY`),(0,B.jsx)(Wo,{children:``},`SCREEN`),(0,B.jsx)(Wo,{children:``},`MENU`)]}),(0,B.jsx)(wi,{isClearable:!0,defaultValue:i.title,label:``,labelPlacement:`inside`,name:`title`,type:`text`}),(0,B.jsx)(Ji,{isClearable:!0,defaultValue:i.description,label:``,labelPlacement:`inside`,minRows:1,name:`description`,placeholder:``}),(0,B.jsx)(T$,{defaultSelected:i.allowClose,description:` Esc `,label:``,name:`allowClose`,value:`true`}),(0,B.jsx)(T$,{defaultSelected:i.invulnerable,description:[``,``],label:``,name:`invulnerable`,value:`true`}),(0,B.jsx)(T$,{defaultSelected:i.invisible,description:[``,``],label:``,name:`invisible`,value:`true`}),(0,B.jsxs)(`div`,{className:`flex gap-2 w-full mt-3`,children:[(0,B.jsx)(M,{className:`w-4/7`,type:`reset`,variant:`flat`,children:``}),(0,B.jsx)(M,{className:`w-4/7`,color:`primary`,type:`submit`,children:``})]})]})})})})},`property`),(0,B.jsx)(No,{title:``},`sequence`)]}),(0,B.jsx)(w$,{id:`dialog-entries`,options:s})]},`title-${i.id}`)}const D$=()=>{let[e,t]=(0,I.useState)([{id:`player`,name:``,value:{translate:`%i`}},{id:`moirstral`,name:`Moirstral`,value:{translate:`Moirstral`,color:`red`}}]);return{speakers:e,setSpeakers:t,addSpeaker:n=>{t([...e,n])}}},O$=({speakers:e})=>(0,B.jsxs)(`div`,{className:`inline-flex items-center h-full w-full`,children:[(0,B.jsx)(Rt,{className:`min-w-6`,size:20}),(0,B.jsx)(ge,{className:`ml-4`,orientation:`vertical`}),(0,B.jsx)(Ze,{className:`items-center gap-3 px-3 h-full flex max-w-[calc(100%-6rem)]`,orientation:`horizontal`,size:60,children:e.map(e=>(0,B.jsx)(et,{className:`cursor-pointer hover:opacity-hover`,size:`md`,style:{color:y$(e.value.color)},variant:`shadow`,children:e.name||e.value.translate},e.id))}),(0,B.jsx)(M,{isIconOnly:!0,className:`text-default-500`,variant:`light`,onPress:()=>{alert(`add speaker`)},children:(0,B.jsx)(Ge,{size:18})},`add-speaker`)]});function k$(){let[e,t]=(0,I.useState)(!1),n=wt(),r=Ye(),i=(0,I.useRef)(null);(0,I.useEffect)(()=>{n.loadSession().then(()=>It.info(`Session loaded`));let e=()=>{window.innerWidth<768?t(!0):t(!1)};return e(),window.addEventListener(`resize`,e),()=>window.removeEventListener(`resize`,e)},[]),(0,I.useEffect)(()=>{let n=n=>{window.innerWidth>=768||!e&&i.current&&(i.current.contains(n.target)||t(!0))};return document.addEventListener(`mousedown`,n),()=>{document.removeEventListener(`mousedown`,n)}},[e]);let a=()=>{t(!e)},{speakers:o}=D$();return(0,B.jsxs)(`div`,{className:`relative flex flex-col h-screen`,children:[(0,B.jsx)(fe,{}),!(`showOpenFilePicker`in self)&&(0,B.jsx)(`aside`,{className:`fixed top-16 w-full z-999`,children:(0,B.jsx)(gs,{className:`w-19/20 md:max-w-4xl mx-auto`,color:`warning`,description:` Chrome  Edge `,title:` File System Access API`,variant:`faded`})}),(0,B.jsx)(xt,{}),(0,B.jsxs)(`aside`,{ref:i,className:`fixed left-0 top-0 h-full w-56 bg-foreground-50 transition-transform duration-300 ease-in-out shadow-medium z-40 text-foreground-600`,style:{transform:e?`translateX(-100%)`:`translateX(0)`},children:[(0,B.jsx)(M,{isIconOnly:!0,className:`${e?`pl-3`:`p-0 bg-foreground-50 text-inherit`} 2xl:hidden absolute top-4 -right-4`,radius:`full`,size:`sm`,onPress:a,children:e?(0,B.jsx)(gt,{className:`transition-transform duration-300 hover:translate-x-1`}):(0,B.jsx)(He,{className:`transition-transform duration-300 hover:-translate-x-1`})}),(0,B.jsx)(`p`,{className:`font-bold text-inherit p-5`,children:Me.name}),(0,B.jsx)(S$,{className:`scrollbar-2 scrollbar-auto gutter-both max-w-full max-h-[calc(100vh-8rem)] mx-3 overflow-x-hidden`}),wt(e=>e.dialogsFolder)&&(0,B.jsxs)(Mr,{className:`w-full max-w-full h-16`,children:[(0,B.jsx)(ae,{content:``,children:(0,B.jsx)(M,{isIconOnly:!0,className:`text-inherit`,variant:`ghost`,onPress:()=>{alert(`TODO`)},children:(0,B.jsx)(De,{size:18})})}),(0,B.jsxs)(M,{className:`text-inherit`,variant:`ghost`,onPress:()=>{if(n.tabs.some(e=>e.type===`new`)){m({title:``,color:`warning`});return}r(`dialog-${Math.random().toString(36).substring(2,7)}`)},children:[(0,B.jsx)(Ge,{size:18}),``]}),(0,B.jsx)(ae,{content:``,children:(0,B.jsx)(M,{isIconOnly:!0,className:`text-inherit`,variant:`ghost`,onPress:()=>{alert(`TODO`)},children:(0,B.jsx)(Je,{size:18})})})]})]}),(0,B.jsx)(`main`,{className:`container flex-grow pb-12 pl-0 ${e?``:`md:pl-56`} max-w-full`,children:(0,B.jsx)(Ue,{})}),(0,B.jsx)(`aside`,{className:`fixed left-0 bottom-0 w-full h-12 p-0 bg-background pl-4 ${e?``:`md:pl-60`} shadow-medium z-10`,children:(0,B.jsx)(O$,{speakers:o})})]})}function A$(){return(0,B.jsxs)(ct,{children:[(0,B.jsx)(_t,{element:(0,B.jsx)(ut,{}),path:`/404/:url`}),(0,B.jsxs)(_t,{element:(0,B.jsx)(k$,{}),children:[(0,B.jsx)(_t,{element:(0,B.jsx)(vs,{}),path:`/`}),(0,B.jsx)(_t,{element:(0,B.jsx)(E$,{}),path:`/:id`})]}),(0,B.jsx)(_t,{element:(0,B.jsx)(ut,{}),path:`*`})]})}var j$=A$;Xt.createRoot(document.getElementById(`root`)).render((0,B.jsx)(I.StrictMode,{children:(0,B.jsx)(Re,{basename:`/dialog-editor/`,children:(0,B.jsx)(Dt,{children:(0,B.jsx)(j$,{})})})}));